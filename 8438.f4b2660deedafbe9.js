(self.webpackChunkPaperize=self.webpackChunkPaperize||[]).push([[8438],{8438:(De,J,M)=>{"use strict";M.r(J),M.d(J,{EncryptModule:()=>ut});var s=M(6895),i=M(5847),d=M(5861),c=M(1571),B=M(6837),E=M(3439),v=M(3259),y=M(1135),h=M(4004),x=M(8505),A=M(6451),H=M(6805),C=M(2961),N=M(7206),T=M(4585),p=M(592);const S=[{name:"RSA",service:class m{encryptString(mt,X){var ue=this;return(0,d.Z)(function*(){const{publicKey:Me}=yield ue._generateKeys(mt);console.log("[INFO] encrypting data...");const et=Me.encrypt(X);console.log("[INFO] encoding encrypted data...");const gt=p.util.encode64(et);return console.log("[INFO] Generate SHA256 hash of encrypted data..."),`${gt}`})()}decryptString(mt,X){var ue=this;return(0,d.Z)(function*(){const{privateKey:Me}=yield ue._generateKeys(mt);console.log("[INFO] decoding data...");const et=p.util.decode64(X);console.log("[INFO] decrypting data...");const gt=Me.decrypt(et);return console.log("[INFO] data decrypted."),gt})()}_generateKeys(mt){return(0,d.Z)(function*(){console.log("[INFO] generating prng with passphrase...");const X=p.random.createInstance();X.seedFileSync=()=>mt,console.log("[INFO] generating RSA-4096 Keypair...");const{privateKey:ue,publicKey:Me}=p.pki.rsa.generateKeyPair({bits:4096,prng:X,workers:-1});return console.log("[INFO] Keypair generated."),{privateKey:ue,publicKey:Me}})()}}},{name:"OpenPGP",service:class I{encryptString(mt,X){return(0,d.Z)(function*(){const ue=yield(0,T.tn)({binary:(new TextEncoder).encode(X),format:"utf8"}),Me=yield(0,T.HI)({message:ue,passwords:[mt],format:"binary"});return btoa(Me.toString())})()}decryptString(mt,X){return(0,d.Z)(function*(){const ue=atob(X),Me=new Uint8Array(ue.split(",").map(Tt=>parseInt(Tt))),et=yield(0,T.Rk)({binaryMessage:Me}),gt=yield(0,T.pe)({message:et,passwords:[mt],format:"binary"});return(new TextDecoder).decode(gt.data)})()}_generateKeys(mt){return(0,d.Z)(function*(){const{privateKey:X,publicKey:ue}=yield(0,T.k$)({passphrase:mt,curve:"p521",userIDs:[{name:"Jon Smith",email:"jon@example.com"}],format:"armored"}),Me=yield(0,T.xh)({armoredKey:ue}),et=yield(0,T.IM)({privateKey:yield(0,T.Lo)({armoredKey:X}),passphrase:mt});return console.log("[INFO] public key:",Me.armor()),{publicKey:Me,privateKey:et}})()}}}];let O=(()=>{class je{constructor(){this.state$=new y.X(null),this._appToken="paperize-qrcode",this._algs=S}encryptString(X,ue,Me="OpenPGP"){var et=this;return(0,d.Z)(function*(){const gt=yield et._getAlgoService(Me);et.state$.next("[INFO] Encrypting data..."),yield et._sleep(1618);const Tt=yield gt.encryptString(X,ue).then(Lt=>`${et._appToken}:${Lt}`);yield et._sleep(1618),et.state$.next("[INFO] Generate SHA256 hash...");const $t=(0,N.SHA256)(Tt).toString(),qt=$t.substring(0,9);return yield et._sleep(1618),et.state$.next("[INFO] Data encrypted successfully"),{encrypted:Tt,hash:$t,shortHash:qt}})()}decryptString(X,ue,Me="OpenPGP"){var et=this;return(0,d.Z)(function*(){const gt=yield et._getAlgoService(Me);et.state$.next("[INFO] decrypting data..."),et._sleep(1618);const Tt=yield gt.decryptString(X,ue.replace(`${et._appToken}:`,""));return et.state$.next("[INFO] data decrypted."),Tt})()}_getAlgoService(X){const ue=this._algs.find(et=>et.name===X);if(!ue)throw new Error(`Algorithm ${ue} not supported.`);const{service:Me=null}=ue;return new Me}_sleep(X=1e3){return(0,d.Z)(function*(){yield new Promise(ue=>{const Me=setTimeout(()=>{ue(!0),clearTimeout(Me)},X)})})()}}return je.\u0275fac=function(X){return new(X||je)},je.\u0275prov=c.Yz7({token:je,factory:je.\u0275fac,providedIn:"root"}),je})();var V=M(4327);let G=(()=>{class je{constructor(){this.state$=new y.X(null),this._actions=[]}setCanvas(X,ue){const Me=X.getContext("2d");if(!Me)throw new Error("[ERROR] Canvas context is not set.");return this.state$.next("[INFO] set Canvas element to build QR code..."),this._canvas=X,this._context=Me,this._setSize(ue?.size),this._context.clearRect(0,0,this._canvas.width,this._canvas.height),this._context.font="30px Arial",this}_setSize(X){if(!this._canvas)throw new Error("[ERROR] Canvas element is not set.");return this._canvas.width=X?.width||window.innerWidth,this._canvas.height=X?.height||window.innerWidth,this}setbackground(X){var ue=this;return this._actions.push((0,d.Z)(function*(){return yield ue._setbackground(X)})),this}_setbackground(X){var ue=this;return(0,d.Z)(function*(){return ue._context.beginPath(),ue._context.rect(0,0,ue._canvas.width,ue._canvas.height),ue._context.fillStyle=X,ue._context.fill(),ue})()}drawImage(X){var ue=this;return this._actions.push((0,d.Z)(function*(){return yield ue._drawImage(X)})),this}_drawImage(X){var ue=this;return(0,d.Z)(function*(){if(!ue._context)throw new Error("[ERROR] Canvas context is not set.");const Me=new Image;return Me.src=X,yield new Promise(et=>{Me.onload=()=>{et(!0)}}),ue._context.drawImage(Me,10,0,ue._canvas.width-20,ue._canvas.height-30),ue})()}drawText(X){var ue=this;return this._actions.push((0,d.Z)(function*(){return yield ue._drawText(X)})),this}_drawText(X){var ue=this;return(0,d.Z)(function*(){if(!ue._context)throw new Error("[ERROR] Canvas context is not set.");const Me=ue._context.measureText(X).width;return ue._context.textAlign="left",ue._context.fillStyle="#000",ue._context.fillText(X,ue._canvas.width/2-Me/2,ue._canvas.height-15),ue})()}download(X){var ue=this;return(0,d.Z)(function*(){if(!ue._canvas)throw new Error("[ERROR] Canvas element is not set.");const Me=yield new Promise((et,gt)=>{ue._canvas.toBlob(Tt=>{Tt?(ue.state$.next("[INFO] Saving QR code..."),et(Tt)):gt("[ERROR] Canvas toBlob method failed.")})});return yield ue._sleep(1618),(0,V.saveAs)(Me,`${X}.png`),ue.state$.next("[INFO] QR code downloaded"),ue})()}build(){var X=this;return(0,d.Z)(function*(){X.state$.next("[INFO] Building QR code with aditional metadata..."),X._canvas.style.opacity="0";for(const ue of X._actions)yield ue(),yield X._sleep();return X.state$.next("[INFO] QR code builded successfully"),yield X._sleep(1618),X._canvas.style.opacity="1",X._actions=[],X.state$.next("[INFO] QR code ready to display"),X})()}_sleep(X=1e3){return(0,d.Z)(function*(){yield new Promise(ue=>{const Me=setTimeout(()=>{ue(!0),clearTimeout(Me)},X)})})()}}return je.\u0275fac=function(X){return new(X||je)},je.\u0275prov=c.Yz7({token:je,factory:je.\u0275fac,providedIn:"root"}),je})();var k=M(8639);const D=(()=>{class je{constructor(X,ue,Me,et,gt){this._legacyCanvasSize=je.DEFAULT_CANVAS_SIZE,this._preferredCamera="environment",this._maxScansPerSecond=25,this._lastScanTimestamp=-1,this._destroyed=this._flashOn=this._paused=this._active=!1,this.$video=X,this.$canvas=document.createElement("canvas"),Me&&"object"==typeof Me?this._onDecode=ue:(console.warn(Me||et||gt?"You're using a deprecated version of the QrScanner constructor which will be removed in the future":"Note that the type of the scan result passed to onDecode will change in the future. To already switch to the new api today, you can pass returnDetailedScanResult: true."),this._legacyOnDecode=ue),this._onDecodeError=(ue="object"==typeof Me?Me:{}).onDecodeError||("function"==typeof Me?Me:this._onDecodeError),this._calculateScanRegion=ue.calculateScanRegion||("function"==typeof et?et:this._calculateScanRegion),this._preferredCamera=ue.preferredCamera||gt||this._preferredCamera,this._legacyCanvasSize="number"==typeof Me?Me:"number"==typeof et?et:this._legacyCanvasSize,this._maxScansPerSecond=ue.maxScansPerSecond||this._maxScansPerSecond,this._onPlay=this._onPlay.bind(this),this._onLoadedMetaData=this._onLoadedMetaData.bind(this),this._onVisibilityChange=this._onVisibilityChange.bind(this),this._updateOverlay=this._updateOverlay.bind(this),X.disablePictureInPicture=!0,X.playsInline=!0,X.muted=!0;let Tt=!1;if(X.hidden&&(X.hidden=!1,Tt=!0),document.body.contains(X)||(document.body.appendChild(X),Tt=!0),Me=X.parentElement,ue.highlightScanRegion||ue.highlightCodeOutline){if(et=!!ue.overlay,this.$overlay=ue.overlay||document.createElement("div"),(gt=this.$overlay.style).position="absolute",gt.display="none",gt.pointerEvents="none",this.$overlay.classList.add("scan-region-highlight"),!et&&ue.highlightScanRegion){this.$overlay.innerHTML='<svg class="scan-region-highlight-svg" viewBox="0 0 238 238" preserveAspectRatio="none" style="position:absolute;width:100%;height:100%;left:0;top:0;fill:none;stroke:#e9b213;stroke-width:4;stroke-linecap:round;stroke-linejoin:round"><path d="M31 2H10a8 8 0 0 0-8 8v21M207 2h21a8 8 0 0 1 8 8v21m0 176v21a8 8 0 0 1-8 8h-21m-176 0H10a8 8 0 0 1-8-8v-21"/></svg>';try{this.$overlay.firstElementChild.animate({transform:["scale(.98)","scale(1.01)"]},{duration:400,iterations:1/0,direction:"alternate",easing:"ease-in-out"})}catch{}Me.insertBefore(this.$overlay,this.$video.nextSibling)}ue.highlightCodeOutline&&(this.$overlay.insertAdjacentHTML("beforeend",'<svg class="code-outline-highlight" preserveAspectRatio="none" style="display:none;width:100%;height:100%;fill:none;stroke:#e9b213;stroke-width:5;stroke-dasharray:25;stroke-linecap:round;stroke-linejoin:round"><polygon/></svg>'),this.$codeOutlineHighlight=this.$overlay.lastElementChild)}this._scanRegion=this._calculateScanRegion(X),requestAnimationFrame(()=>{let $t=window.getComputedStyle(X);"none"===$t.display&&(X.style.setProperty("display","block","important"),Tt=!0),"visible"!==$t.visibility&&(X.style.setProperty("visibility","visible","important"),Tt=!0),Tt&&(console.warn("QrScanner has overwritten the video hiding style to avoid Safari stopping the playback."),X.style.opacity="0",X.style.width="0",X.style.height="0",this.$overlay&&this.$overlay.parentElement&&this.$overlay.parentElement.removeChild(this.$overlay),delete this.$overlay,delete this.$codeOutlineHighlight),this.$overlay&&this._updateOverlay()}),X.addEventListener("play",this._onPlay),X.addEventListener("loadedmetadata",this._onLoadedMetaData),document.addEventListener("visibilitychange",this._onVisibilityChange),window.addEventListener("resize",this._updateOverlay),this._qrEnginePromise=je.createQrEngine()}static set WORKER_PATH(X){console.warn("Setting QrScanner.WORKER_PATH is not required and not supported anymore. Have a look at the README for new setup instructions.")}static hasCamera(){return(0,d.Z)(function*(){try{return!!(yield je.listCameras(!1)).length}catch{return!1}})()}static listCameras(X=!1){return(0,d.Z)(function*(){if(!navigator.mediaDevices)return[];let Me,ue=function(){var et=(0,d.Z)(function*(){return(yield navigator.mediaDevices.enumerateDevices()).filter(gt=>"videoinput"===gt.kind)});return function(){return et.apply(this,arguments)}}();try{X&&(yield ue()).every(et=>!et.label)&&(Me=yield navigator.mediaDevices.getUserMedia({audio:!1,video:!0}))}catch{}try{return(yield ue()).map((et,gt)=>({id:et.deviceId,label:et.label||(0===gt?"Default Camera":`Camera ${gt+1}`)}))}finally{Me&&(console.warn("Call listCameras after successfully starting a QR scanner to avoid creating a temporary video stream"),je._stopVideoStream(Me))}})()}hasFlash(){var X=this;return(0,d.Z)(function*(){let ue;try{if(X.$video.srcObject){if(!(X.$video.srcObject instanceof MediaStream))return!1;ue=X.$video.srcObject}else ue=(yield X._getCameraStream()).stream;return"torch"in ue.getVideoTracks()[0].getSettings()}catch{return!1}finally{ue&&ue!==X.$video.srcObject&&(console.warn("Call hasFlash after successfully starting the scanner to avoid creating a temporary video stream"),je._stopVideoStream(ue))}})()}isFlashOn(){return this._flashOn}toggleFlash(){var X=this;return(0,d.Z)(function*(){X._flashOn?yield X.turnFlashOff():yield X.turnFlashOn()})()}turnFlashOn(){var X=this;return(0,d.Z)(function*(){if(!X._flashOn&&!X._destroyed&&(X._flashOn=!0,X._active&&!X._paused))try{if(!(yield X.hasFlash()))throw"No flash available";yield X.$video.srcObject.getVideoTracks()[0].applyConstraints({advanced:[{torch:!0}]})}catch(ue){throw X._flashOn=!1,ue}})()}turnFlashOff(){var X=this;return(0,d.Z)(function*(){X._flashOn&&(X._flashOn=!1,yield X._restartVideoStream())})()}destroy(){this.$video.removeEventListener("loadedmetadata",this._onLoadedMetaData),this.$video.removeEventListener("play",this._onPlay),document.removeEventListener("visibilitychange",this._onVisibilityChange),window.removeEventListener("resize",this._updateOverlay),this._destroyed=!0,this._flashOn=!1,this.stop(),je._postWorkerMessage(this._qrEnginePromise,"close")}start(){var X=this;return(0,d.Z)(function*(){if(X._destroyed)throw Error("The QR scanner can not be started as it had been destroyed.");if((!X._active||X._paused)&&("https:"!==window.location.protocol&&console.warn("The camera stream is only accessible if the page is transferred via https."),X._active=!0,!document.hidden))if(X._paused=!1,X.$video.srcObject)yield X.$video.play();else try{let{stream:ue,facingMode:Me}=yield X._getCameraStream();!X._active||X._paused?je._stopVideoStream(ue):(X._setVideoMirror(Me),X.$video.srcObject=ue,yield X.$video.play(),X._flashOn&&(X._flashOn=!1,X.turnFlashOn().catch(()=>{})))}catch(ue){if(!X._paused)throw X._active=!1,ue}})()}stop(){this.pause(),this._active=!1}pause(X=!1){var ue=this;return(0,d.Z)(function*(){if(ue._paused=!0,!ue._active)return!0;ue.$video.pause(),ue.$overlay&&(ue.$overlay.style.display="none");let Me=()=>{ue.$video.srcObject instanceof MediaStream&&(je._stopVideoStream(ue.$video.srcObject),ue.$video.srcObject=null)};return X?(Me(),!0):(yield new Promise(et=>setTimeout(et,300)),!!ue._paused&&(Me(),!0))})()}setCamera(X){var ue=this;return(0,d.Z)(function*(){X!==ue._preferredCamera&&(ue._preferredCamera=X,yield ue._restartVideoStream())})()}static scanImage(X,ue,Me,et,gt=!1,Tt=!1){return(0,d.Z)(function*(){let $t,qt=!1;ue&&("scanRegion"in ue||"qrEngine"in ue||"canvas"in ue||"disallowCanvasResizing"in ue||"alsoTryWithoutScanRegion"in ue||"returnDetailedScanResult"in ue)?($t=ue.scanRegion,Me=ue.qrEngine,et=ue.canvas,gt=ue.disallowCanvasResizing||!1,Tt=ue.alsoTryWithoutScanRegion||!1,qt=!0):console.warn(ue||Me||et||gt||Tt?"You're using a deprecated api for scanImage which will be removed in the future.":"Note that the return type of scanImage will change in the future. To already switch to the new api today, you can pass returnDetailedScanResult: true."),ue=!!Me;try{let Lt,or,_r;if([Me,Lt]=yield Promise.all([Me||je.createQrEngine(),je._loadImage(X)]),[et,or]=je._drawToCanvas(Lt,$t,et,gt),Me instanceof Worker){let Xt=Me;ue||je._postWorkerMessageSync(Xt,"inversionMode","both"),_r=yield new Promise((cr,$r)=>{let Hr,Yr,yr,Cr=-1;Yr=lr=>{lr.data.id===Cr&&(Xt.removeEventListener("message",Yr),Xt.removeEventListener("error",yr),clearTimeout(Hr),null!==lr.data.data?cr({data:lr.data.data,cornerPoints:je._convertPoints(lr.data.cornerPoints,$t)}):$r(je.NO_QR_CODE_FOUND))},yr=lr=>{Xt.removeEventListener("message",Yr),Xt.removeEventListener("error",yr),clearTimeout(Hr),$r("Scanner error: "+(lr?lr.message||lr:"Unknown Error"))},Xt.addEventListener("message",Yr),Xt.addEventListener("error",yr),Hr=setTimeout(()=>yr("timeout"),1e4);let dr=or.getImageData(0,0,et.width,et.height);Cr=je._postWorkerMessageSync(Xt,"decode",dr,[dr.data.buffer])})}else _r=yield Promise.race([new Promise((Xt,cr)=>window.setTimeout(()=>cr("Scanner error: timeout"),1e4)),(0,d.Z)(function*(){try{var[Xt]=yield Me.detect(et);if(!Xt)throw je.NO_QR_CODE_FOUND;return{data:Xt.rawValue,cornerPoints:je._convertPoints(Xt.cornerPoints,$t)}}catch(cr){if(/not implemented|service unavailable/.test(Xt=cr.message||cr))return je._disableBarcodeDetector=!0,je.scanImage(X,{scanRegion:$t,canvas:et,disallowCanvasResizing:gt,alsoTryWithoutScanRegion:Tt});throw`Scanner error: ${Xt}`}})()]);return qt?_r:_r.data}catch(Lt){if(!$t||!Tt)throw Lt;let or=yield je.scanImage(X,{qrEngine:Me,canvas:et,disallowCanvasResizing:gt});return qt?or:or.data}finally{ue||je._postWorkerMessage(Me,"close")}})()}setGrayscaleWeights(X,ue,Me,et=!0){je._postWorkerMessage(this._qrEnginePromise,"grayscaleWeights",{red:X,green:ue,blue:Me,useIntegerApproximation:et})}setInversionMode(X){je._postWorkerMessage(this._qrEnginePromise,"inversionMode",X)}static createQrEngine(X){return(0,d.Z)(function*(){return X&&console.warn("Specifying a worker path is not required and not supported anymore."),!je._disableBarcodeDetector&&"BarcodeDetector"in window&&BarcodeDetector.getSupportedFormats&&(yield BarcodeDetector.getSupportedFormats()).includes("qr_code")?new BarcodeDetector({formats:["qr_code"]}):M.e(6920).then(M.bind(M,6920)).then(ue=>ue.createWorker())})()}_onPlay(){this._scanRegion=this._calculateScanRegion(this.$video),this._updateOverlay(),this.$overlay&&(this.$overlay.style.display=""),this._scanFrame()}_onLoadedMetaData(){this._scanRegion=this._calculateScanRegion(this.$video),this._updateOverlay()}_onVisibilityChange(){document.hidden?this.pause():this._active&&this.start()}_calculateScanRegion(X){let ue=Math.round(.6666666666666666*Math.min(X.videoWidth,X.videoHeight));return{x:Math.round((X.videoWidth-ue)/2),y:Math.round((X.videoHeight-ue)/2),width:ue,height:ue,downScaledWidth:this._legacyCanvasSize,downScaledHeight:this._legacyCanvasSize}}_updateOverlay(){requestAnimationFrame(()=>{if(this.$overlay){var X=this.$video,ue=X.videoWidth,Me=X.videoHeight,et=X.offsetWidth,gt=X.offsetHeight,Tt=X.offsetLeft,$t=X.offsetTop,qt=window.getComputedStyle(X),Lt=qt.objectFit,or=ue/Me,_r=et/gt;switch(Lt){case"none":var Xt=ue,cr=Me;break;case"fill":Xt=et,cr=gt;break;default:("cover"===Lt?or>_r:or<_r)?Xt=(cr=gt)*or:cr=(Xt=et)/or,"scale-down"===Lt&&(Xt=Math.min(Xt,ue),cr=Math.min(cr,Me))}var[$r,Hr]=qt.objectPosition.split(" ").map((yr,Cr)=>{const dr=parseFloat(yr);return yr.endsWith("%")?(Cr?gt-cr:et-Xt)*dr/100:dr});_r=this._scanRegion.height||Me,Lt=this._scanRegion.x||0;var Yr=this._scanRegion.y||0;(or=this.$overlay.style).width=(qt=this._scanRegion.width||ue)/ue*Xt+"px",or.height=_r/Me*cr+"px",or.top=`${$t+Hr+Yr/Me*cr}px`,Me=/scaleX\(-1\)/.test(X.style.transform),or.left=`${Tt+(Me?et-$r-Xt:$r)+(Me?ue-Lt-qt:Lt)/ue*Xt}px`,or.transform=X.style.transform}})}static _convertPoints(X,ue){if(!ue)return X;let Me=ue.x||0,et=ue.y||0,gt=ue.width&&ue.downScaledWidth?ue.width/ue.downScaledWidth:1;ue=ue.height&&ue.downScaledHeight?ue.height/ue.downScaledHeight:1;for(let Tt of X)Tt.x=Tt.x*gt+Me,Tt.y=Tt.y*ue+et;return X}_scanFrame(){var X=this;!this._active||this.$video.paused||this.$video.ended||("requestVideoFrameCallback"in this.$video?this.$video.requestVideoFrameCallback.bind(this.$video):requestAnimationFrame)((0,d.Z)(function*(){if(!(1>=X.$video.readyState)){var ue=Date.now()-X._lastScanTimestamp,Me=1e3/X._maxScansPerSecond;ue<Me&&(yield new Promise(gt=>setTimeout(gt,Me-ue))),X._lastScanTimestamp=Date.now();try{var et=yield je.scanImage(X.$video,{scanRegion:X._scanRegion,qrEngine:X._qrEnginePromise,canvas:X.$canvas})}catch(gt){if(!X._active)return;X._onDecodeError(gt)}!je._disableBarcodeDetector||(yield X._qrEnginePromise)instanceof Worker||(X._qrEnginePromise=je.createQrEngine()),et?(X._onDecode?X._onDecode(et):X._legacyOnDecode&&X._legacyOnDecode(et.data),X.$codeOutlineHighlight&&(clearTimeout(X._codeOutlineHighlightRemovalTimeout),X._codeOutlineHighlightRemovalTimeout=void 0,X.$codeOutlineHighlight.setAttribute("viewBox",`${X._scanRegion.x||0} ${X._scanRegion.y||0} ${X._scanRegion.width||X.$video.videoWidth} ${X._scanRegion.height||X.$video.videoHeight}`),X.$codeOutlineHighlight.firstElementChild.setAttribute("points",et.cornerPoints.map(({x:gt,y:Tt})=>`${gt},${Tt}`).join(" ")),X.$codeOutlineHighlight.style.display="")):X.$codeOutlineHighlight&&!X._codeOutlineHighlightRemovalTimeout&&(X._codeOutlineHighlightRemovalTimeout=setTimeout(()=>X.$codeOutlineHighlight.style.display="none",100))}X._scanFrame()}))}_onDecodeError(X){X!==je.NO_QR_CODE_FOUND&&console.log(X)}_getCameraStream(){var X=this;return(0,d.Z)(function*(){if(!navigator.mediaDevices)throw"Camera not found.";let ue=/^(environment|user)$/.test(X._preferredCamera)?"facingMode":"deviceId",Me=[{width:{min:1024}},{width:{min:768}},{}],et=Me.map(gt=>Object.assign({},gt,{[ue]:{exact:X._preferredCamera}}));for(let gt of[...et,...Me])try{let Tt=yield navigator.mediaDevices.getUserMedia({video:gt,audio:!1});return{stream:Tt,facingMode:X._getFacingMode(Tt)||(gt.facingMode?X._preferredCamera:"environment"===X._preferredCamera?"user":"environment")}}catch{}throw"Camera not found."})()}_restartVideoStream(){var X=this;return(0,d.Z)(function*(){let ue=X._paused;(yield X.pause(!0))&&!ue&&X._active&&(yield X.start())})()}static _stopVideoStream(X){for(let ue of X.getTracks())ue.stop(),X.removeTrack(ue)}_setVideoMirror(X){this.$video.style.transform="scaleX("+("user"===X?-1:1)+")"}_getFacingMode(X){return(X=X.getVideoTracks()[0])?/rear|back|environment/i.test(X.label)?"environment":/front|user|face/i.test(X.label)?"user":null:null}static _drawToCanvas(X,ue,Me,et=!1){Me=Me||document.createElement("canvas");let gt=ue&&ue.x?ue.x:0,Tt=ue&&ue.y?ue.y:0,$t=ue&&ue.width?ue.width:X.videoWidth||X.width,qt=ue&&ue.height?ue.height:X.videoHeight||X.height;return et||(et=ue&&ue.downScaledWidth?ue.downScaledWidth:$t,ue=ue&&ue.downScaledHeight?ue.downScaledHeight:qt,Me.width!==et&&(Me.width=et),Me.height!==ue&&(Me.height=ue)),(ue=Me.getContext("2d",{alpha:!1})).imageSmoothingEnabled=!1,ue.drawImage(X,gt,Tt,$t,qt,0,0,Me.width,Me.height),[Me,ue]}static _loadImage(X){return(0,d.Z)(function*(){if(X instanceof Image)return yield je._awaitImageLoad(X),X;if(X instanceof HTMLVideoElement||X instanceof HTMLCanvasElement||X instanceof SVGImageElement||"OffscreenCanvas"in window&&X instanceof OffscreenCanvas||"ImageBitmap"in window&&X instanceof ImageBitmap)return X;if(!(X instanceof File||X instanceof Blob||X instanceof URL||"string"==typeof X))throw"Unsupported image type.";{let ue=new Image;ue.src=X instanceof File||X instanceof Blob?URL.createObjectURL(X):X.toString();try{return yield je._awaitImageLoad(ue),ue}finally{(X instanceof File||X instanceof Blob)&&URL.revokeObjectURL(ue.src)}}})()}static _awaitImageLoad(X){return(0,d.Z)(function*(){X.complete&&0!==X.naturalWidth||(yield new Promise((ue,Me)=>{let et=gt=>{X.removeEventListener("load",et),X.removeEventListener("error",et),gt instanceof ErrorEvent?Me("Image load error"):ue()};X.addEventListener("load",et),X.addEventListener("error",et)}))})()}static _postWorkerMessage(X,ue,Me,et){return(0,d.Z)(function*(){return je._postWorkerMessageSync(yield X,ue,Me,et)})()}static _postWorkerMessageSync(X,ue,Me,et){if(!(X instanceof Worker))return-1;let gt=je._workerMessageId++;return X.postMessage({id:gt,type:ue,data:Me},et),gt}}return je.DEFAULT_CANVAS_SIZE=400,je.NO_QR_CODE_FOUND="No QR code found",je._disableBarcodeDetector=!1,je._workerMessageId=0,je})();let l=(()=>{class je{constructor(){this.state$=new y.X(null)}scanWithCamera(X){var ue=this;return(0,d.Z)(function*(){ue.state$.next("[INFO] Initialize scanner...");const Me=yield D.hasCamera(),et=yield D.listCameras().then(Tt=>Tt.length>0).catch(()=>!1);if(!Me||!et)throw ue.state$.next("[ERROR] No camera available."),new Error("[ERROR] No camera available.");return{decodedText:(yield new Promise(function(){var Tt=(0,d.Z)(function*($t,qt){ue._scanner=new D(X,Lt=>{ue._scanner.stop(),ue.state$.next("[INFO] Scanning with success."),$t(Lt)},{highlightScanRegion:!0,highlightCodeOutline:!0}),ue.state$.next("[INFO] Start scanning..."),yield ue._scanner.start()});return function($t,qt){return Tt.apply(this,arguments)}}())).data}})()}scanFile(X){return(0,d.Z)(function*(){yield new Promise(Me=>{setTimeout(()=>Me(!0),250)});const{data:ue="No QR code found."}=yield D.scanImage(X,{returnDetailedScanResult:!0}).catch(Me=>{throw Me||"Error scanning image"});return console.log("decodedText",ue),{decodedText:ue}})()}stop(){return(0,d.Z)(function*(){throw new Error("Not implemented")})()}_cameraScanResult(){return(0,d.Z)(function*(){})()}}return je.\u0275fac=function(X){return new(X||je)},je.\u0275prov=c.Yz7({token:je,factory:je.\u0275fac,providedIn:"root"}),je})();var F=M(433);const Y=["toggleElement"],W=["qrVideoElement"],ne=["canvas"];function de(je,mt){if(1&je){const X=c.EpF();c.TgZ(0,"div",18)(1,"ion-label",19),c._uU(2," Your secert password "),c.TgZ(3,"small",20),c.NdJ("click",function(){c.CHM(X);const Me=c.oxw();return c.KtG(Me.toggleIsMnemonicSeedPhrase())}),c._uU(4," ( "),c.TgZ(5,"ion-text",4),c._uU(6," use seed phrase "),c.qZA(),c._uU(7," ) "),c.qZA()(),c.TgZ(8,"ion-item",21)(9,"ion-input",22,23),c.NdJ("ngModelChange",function(Me){c.CHM(X);const et=c.oxw();return c.KtG(et.secret[0]=Me)}),c.qZA(),c.TgZ(11,"ion-icon",24),c.NdJ("click",function(){c.CHM(X);const Me=c.MAs(10);return c.KtG(Me.type="text"===Me.type?"password":"text")}),c.qZA()(),c.TgZ(12,"ion-note",25),c._uU(13," minimum length 6 caracters "),c.qZA()()}if(2&je){const X=c.MAs(10),ue=c.oxw();c.xp6(9),c.Q6J("ngModel",ue.secret[0])("autofocus",!0),c.xp6(2),c.Q6J("name","text"===X.type?"eye-outline":"eye-off-outline"),c.xp6(1),c.Q6J("hidden",(ue.secret[0].length||0)<1||!((ue.secret[0].length||0)<=5))}}function Ae(je,mt){if(1&je){const X=c.EpF();c.TgZ(0,"ion-chip",28),c.NdJ("click",function(){const et=c.CHM(X).index,gt=c.oxw(2);return c.KtG(gt.removeAndGenerateWord(et,!gt.isImportSeedWords))}),c.ALo(1,"async"),c.TgZ(2,"ion-label"),c._uU(3),c.qZA(),c._UZ(4,"ion-icon",29),c.qZA()}if(2&je){const X=mt.$implicit,ue=c.oxw(2);c.Q6J("disabled",c.lcZ(1,2,ue.isWoring$)),c.xp6(3),c.Oqu(X)}}function Re(je,mt){if(1&je){const X=c.EpF();c.TgZ(0,"ion-item",20),c.NdJ("click",function(){const et=c.CHM(X).$implicit;c.oxw(2);const gt=c.MAs(2);return c.oxw(2).selectWord(et),gt.value="",c.KtG(gt.setFocus())}),c.TgZ(1,"ion-label",35),c._uU(2),c.qZA(),c.TgZ(3,"ion-button",36),c._UZ(4,"ion-icon",37),c.qZA()()}if(2&je){const X=mt.$implicit;c.xp6(2),c.hij(" ",X," ")}}function Fe(je,mt){if(1&je&&(c.TgZ(0,"ion-list",0),c.YNc(1,Re,5,1,"ion-item",34),c.qZA()),2&je){const X=c.oxw(3);c.xp6(1),c.Q6J("ngForOf",X.seedWordList)}}const be=function(je){return{active:je}};function Pe(je,mt){if(1&je){const X=c.EpF();c.TgZ(0,"div",30)(1,"ion-input",31,32),c.NdJ("ionChange",function(Me){c.CHM(X);const et=c.oxw(2);return c.KtG(et.autocomplet(Me))}),c.qZA(),c.TgZ(3,"ion-note",25),c._uU(4," maximum number of 12 words reached "),c.qZA(),c.YNc(5,Fe,2,1,"ion-list",33),c.qZA()}if(2&je){const X=c.oxw(2);c.xp6(1),c.Q6J("autofocus",!0)("hidden",X.secret.length>=12)("placeholder",X.secret.length<12?"type word...":"maximum number of 12 words reached")("disabled",X.secret.length>=12)("ngClass",c.VKq(7,be,X.seedWordList.length>0)),c.xp6(2),c.Q6J("hidden",X.secret.length<12),c.xp6(2),c.Q6J("ngIf",X.seedWordList.length>0)}}function We(je,mt){if(1&je){const X=c.EpF();c.TgZ(0,"div",18)(1,"ion-label",19),c._uU(2," Your secert seed 12 words pharse "),c.TgZ(3,"small"),c._uU(4," ( "),c.TgZ(5,"ion-text",4)(6,"span",20),c.NdJ("click",function(){c.CHM(X);const Me=c.oxw();return c.KtG(Me.toggleImportSeedWords())}),c._uU(7),c.qZA()(),c._uU(8," or "),c.TgZ(9,"ion-text",4)(10,"span",20),c.NdJ("click",function(){c.CHM(X);const Me=c.oxw();return c.KtG(Me.toggleIsMnemonicSeedPhrase())}),c._uU(11,"use simple password"),c.qZA()(),c._uU(12," ) "),c.qZA()(),c.YNc(13,Ae,5,4,"ion-chip",26),c.YNc(14,Pe,6,9,"div",27),c.qZA()}if(2&je){const X=c.oxw();c.xp6(7),c.hij(" ",X.isImportSeedWords?"generate":"import"," seed phrase "),c.xp6(6),c.Q6J("ngForOf",X.secret),c.xp6(1),c.Q6J("ngIf",!0===X.isImportSeedWords)}}function Ze(je,mt){if(1&je){const X=c.EpF();c.TgZ(0,"ion-item",9),c.ALo(1,"async"),c.TgZ(2,"ion-label",19),c._uU(3,"Datas to encrypt "),c.TgZ(4,"small"),c._uU(5,"(max 200 characters)"),c.qZA()(),c.TgZ(6,"ion-textarea",38,39),c.NdJ("ngModelChange",function(Me){c.CHM(X);const et=c.oxw();return c.KtG(et.text=Me)}),c.ALo(8,"async"),c.qZA(),c.TgZ(9,"span",40),c._uU(10),c.qZA()()}if(2&je){const X=c.MAs(7),ue=c.oxw();c.Q6J("disabled",c.lcZ(1,4,ue.isWoring$)),c.xp6(6),c.Q6J("disabled",c.lcZ(8,6,ue.isWoring$)||!1)("ngModel",ue.text),c.xp6(4),c.hij("",(null==X||null==X.value?null:X.value.length)||0,"/200")}}function Ct(je,mt){if(1&je){const X=c.EpF();c.TgZ(0,"ion-button",41),c.NdJ("click",function(){c.CHM(X);const Me=c.oxw();return c.KtG(Me.encrypt())}),c.ALo(1,"async"),c._uU(2," Generate QrCode "),c.qZA()}if(2&je){const X=c.oxw();c.Q6J("disabled",c.lcZ(1,1,X.isWoring$)||(X.isMnemonicSeedPhrase?X.secret.length<12:X.secret[0].length<6)||0===X.text.length)}}function tt(je,mt){if(1&je){const X=c.EpF();c.TgZ(0,"ion-button",42),c.NdJ("click",function(){c.CHM(X);const Me=c.oxw();return c.KtG(Me.encrypt())}),c._uU(1," Generate QrCode "),c.qZA()}}function Ht(je,mt){if(1&je){const X=c.EpF();c.TgZ(0,"ion-button",41),c.NdJ("click",function(){c.CHM(X),c.oxw();const Me=c.MAs(4);return c.KtG(Me.click())}),c.ALo(1,"async"),c._uU(2," file scan "),c.qZA()}if(2&je){const X=c.oxw(2);c.Q6J("disabled",c.lcZ(1,1,X.isWoring$)||(X.isMnemonicSeedPhrase?X.secret.length<12:X.secret[0].length<6))}}function ct(je,mt){if(1&je){const X=c.EpF();c.TgZ(0,"ion-button",42),c.NdJ("click",function(){c.CHM(X),c.oxw();const Me=c.MAs(4);return c.KtG(Me.click())}),c._uU(1," file scan "),c.qZA()}}function jt(je,mt){if(1&je){const X=c.EpF();c.TgZ(0,"div"),c.YNc(1,Ht,3,3,"ion-button",13),c.YNc(2,ct,2,0,"ion-button",14),c.TgZ(3,"input",43,44),c.NdJ("change",function(Me){c.CHM(X);const et=c.oxw();return c.KtG(et.scanFile(Me))}),c.qZA()()}if(2&je){const X=c.oxw();c.xp6(1),c.Q6J("ngIf",!0===(null==X.toggleEncryptionElement||null==X.toggleEncryptionElement.nativeElement?null:X.toggleEncryptionElement.nativeElement.checked)),c.xp6(1),c.Q6J("ngIf",!1===(null==X.toggleEncryptionElement||null==X.toggleEncryptionElement.nativeElement?null:X.toggleEncryptionElement.nativeElement.checked)||!1),c.xp6(1),c.Q6J("hidden",!0)}}const Rt=function(){return{action:"decrypt"}};function Le(je,mt){1&je&&(c.TgZ(0,"p"),c._uU(1," You already have a backup QrCode? "),c._UZ(2,"br"),c._uU(3," Go to "),c.TgZ(4,"a",45),c._uU(5,"decrypt"),c.qZA(),c._uU(6," page. "),c.qZA()),2&je&&(c.xp6(4),c.Q6J("routerLink","./")("queryParams",c.DdM(2,Rt)))}const Ge=function(){return{action:"encrypt"}};function K(je,mt){1&je&&(c.TgZ(0,"p"),c._uU(1," You want backup secret data as QR Code? "),c._UZ(2,"br"),c._uU(3," Go to "),c.TgZ(4,"a",45),c._uU(5,"encrypt"),c.qZA(),c._uU(6," page. "),c.qZA()),2&je&&(c.xp6(4),c.Q6J("routerLink","./")("queryParams",c.DdM(2,Ge)))}function U(je,mt){if(1&je&&(c.TgZ(0,"small"),c._uU(1),c.qZA()),2&je){const X=mt.ngIf;c.xp6(1),c.hij(" ",X," ")}}function ee(je,mt){if(1&je&&(c.TgZ(0,"div",50),c._UZ(1,"ion-spinner",51),c.TgZ(2,"ion-text",52),c.YNc(3,U,2,1,"small",15),c.ALo(4,"async"),c.qZA()()),2&je){const X=c.oxw(2);c.xp6(3),c.Q6J("ngIf",c.lcZ(4,1,X.serviceState$))}}function me(je,mt){1&je&&(c.TgZ(0,"ion-text",52)(1,"small"),c._uU(2," Waiting to encrypt your secret data "),c.qZA()())}function Ue(je,mt){if(1&je&&(c.TgZ(0,"div",50),c.YNc(1,me,3,0,"ion-text",53),c.ALo(2,"async"),c.qZA()),2&je){const X=c.oxw(2);let ue;c.xp6(1),c.Q6J("ngIf",!(null!=(ue=c.lcZ(2,1,X.result$))&&ue.encryptedText))}}function z(je,mt){1&je&&c._UZ(0,"canvas",null,54)}function Ie(je,mt){if(1&je){const X=c.EpF();c.TgZ(0,"ion-button",55),c.NdJ("click",function(){c.CHM(X);const Me=c.oxw(2);return c.KtG(Me.download())}),c.TgZ(1,"ion-text",4),c._uU(2,"download"),c.qZA()()}}const lt=function(je){return{isHiddenForMobile:je}};function Pt(je,mt){if(1&je&&(c.TgZ(0,"ion-col",46),c.ALo(1,"async"),c.ALo(2,"async"),c.YNc(3,ee,5,3,"div",47),c.ALo(4,"async"),c.YNc(5,Ue,3,3,"ng-template",null,48,c.W1O),c.YNc(7,z,2,0,"canvas",15),c.ALo(8,"async"),c.YNc(9,Ie,3,0,"ion-button",49),c.ALo(10,"async"),c.ALo(11,"async"),c.qZA()),2&je){const X=c.MAs(6),ue=c.oxw();let Me,et,gt;c.Q6J("ngClass",c.VKq(17,lt,!(c.lcZ(1,5,ue.isWoring$)||null!=(Me=c.lcZ(2,7,ue.result$))&&Me.encryptedText))),c.xp6(3),c.Q6J("ngIf",c.lcZ(4,9,ue.isWoring$))("ngIfElse",X),c.xp6(4),c.Q6J("ngIf",null==(et=c.lcZ(8,11,ue.result$))?null:et.encryptedText),c.xp6(2),c.Q6J("ngIf",!1===c.lcZ(10,13,ue.isWoring$)&&(null==(gt=c.lcZ(11,15,ue.result$))?null:gt.shortHash))}}function kt(je,mt){if(1&je&&(c.TgZ(0,"div",60),c._uU(1),c.qZA()),2&je){const X=mt.ngIf;c.xp6(1),c.hij(" ",X," ")}}function at(je,mt){1&je&&(c.TgZ(0,"ion-text",52)(1,"small"),c._uU(2," Scan QR Code to decrypt secret data "),c.qZA()())}function _t(je,mt){if(1&je&&(c.TgZ(0,"ion-col",56),c.ALo(1,"async"),c.ALo(2,"async"),c.YNc(3,kt,2,1,"div",57),c.ALo(4,"async"),c.YNc(5,at,3,0,"ng-template",null,58,c.W1O),c._UZ(7,"div",59),c.qZA()),2&je){const X=c.MAs(6),ue=c.oxw();let Me,et;c.Q6J("ngClass",c.VKq(9,lt,!(c.lcZ(1,3,ue.isWoring$)||null!=(Me=c.lcZ(2,5,ue.result$))&&Me.decryptedText))),c.xp6(3),c.Q6J("ngIf",null==(et=c.lcZ(4,7,ue.result$))?null:et.decryptedText)("ngIfElse",X)}}const Qt=[{path:"",component:(()=>{class je{constructor(X,ue,Me,et,gt){this._route=X,this._service=ue,this._canvasService=Me,this._alertCtrl=et,this._scanService=gt,this.result$=new y.X(null),this.action$=this._route.queryParams.pipe((0,h.U)(Tt=>Tt?.action||"encrypt"),(0,x.b)(()=>this.result$.next(null)),(0,x.b)(()=>this._componentState$.next(null))),this.isWoring$=new y.X(!1),this._componentState$=new y.X(null),this.serviceState$=(0,A.T)(this._componentState$,this._service.state$,this._canvasService.state$).pipe((0,h.U)(Tt=>Tt?.replace("[INFO] "," ")?.replace("[ERROR] "," ")?.replace("..."," "))),this.actions="encrypt",this.isImportSeedWords=!1,this.isMnemonicSeedPhrase=!1,this.secret=[""],this.text="",this.seedWordList=[]}get isEncryptionEnabled(){return this.toggleEncryptionElement?.nativeElement?.checked}encrypt(){var X=this;return(0,d.Z)(function*(){let ue,Me;if(X.isEncryptionEnabled){const $t=yield X._alertCtrl.create({header:"Warning",message:`\n          <p>\n            Please make sure that you have backup of your ${X.isMnemonicSeedPhrase?"seed phrase words":"password"}. <br/>\n            If you lose your seed words, you will definitly lose access to your encryppted data.\n          </p>\n          <ion-text color="primary">\n            <p>Current ${X.isMnemonicSeedPhrase?"seed phrase words":"password"}:</p>\n            <pre class="ion-text-wrap">\n              ${X.secret.join(" ")}\n            </pre>\n          </ion-text>\n          `,buttons:[{text:"Cancel",role:"cancel"},{text:"Continue",role:"confirm"}]});yield $t.present();const{role:qt}=yield $t.onDidDismiss();if("confirm"!==qt)return;X.isWoring$.next(!0);const Lt=X.text;yield new Promise(Xt=>setTimeout(Xt,25));const{encrypted:or,shortHash:_r}=yield X._service.encryptString(X.secret.join(" "),Lt);ue=or,Me=_r}X.isWoring$.next(!0),Me=Me||Date.now().toString();const et=yield X.generateQR(ue||X.text);X.result$.next({encryptedText:ue||X.text,shortHash:Me}),yield new Promise($t=>setTimeout($t,1025));const gt=X.canvasElement?.nativeElement;yield X._canvasService.setCanvas(gt,{size:{width:600,height:600}}).setbackground("#fff").drawImage(et).drawText(Me).build(),X.isWoring$.next(!1),X.isImportSeedWords=!1,yield(yield X._alertCtrl.create({header:"Caution",message:`\n        <p>\n          Please download and try to scan the QR code to make sure that your data backup was successful and can be recovered. <br/>\n          If you have any scanning issue, try again to generate a new QR code.\n        </p>\n        <p>\n          And again, make sure that you have backup of your ${X.isMnemonicSeedPhrase?"seed words":"password"}. <br/>\n          <b>If you lose your seed words, you will definitly lose access to your encryppted data</b>.\n        </p>\n        `,buttons:[{text:"ok",role:"confirm"}]})).present()})()}download(){var X=this;return(0,d.Z)(function*(){const{shortHash:ue=Date.now().toString()}=yield function _(je,mt){const X="object"==typeof mt;return new Promise((ue,Me)=>{const et=new C.Hp({next:gt=>{ue(gt),et.unsubscribe()},error:Me,complete:()=>{X?ue(mt.defaultValue):Me(new H.K)}});je.subscribe(et)})}(X.result$);yield X._canvasService.download(ue),X.result$.next(null)})()}scanFile(X){var ue=this;return(0,d.Z)(function*(){const Me=X.target.files[0],{decodedText:et="",result:gt}=yield ue._scanService.scanFile(Me);if(console.log(`Code matched = ${et}`,gt),ue.isEncryptionEnabled){const Tt=yield ue._service.decryptString(ue.secret.join(" "),et);console.log("[INFO] decrypted text:",Tt),ue.result$.next({decryptedText:Tt})}else ue.result$.next({decryptedText:et})})()}scanWithCamera(){var X=this;return(0,d.Z)(function*(){const{decodedText:ue}=yield X._scanService.scanWithCamera(X.qrVideoElement.nativeElement);console.log(`Code matched = ${ue}`)})()}generateQR(X){return(0,d.Z)(function*(){console.log("[INFO] generating QR code...");try{const ue=yield(0,v.hz)(X,{type:"image/png",rendererOpts:{quality:1},errorCorrectionLevel:"L"});return console.log("[INFO] QR code generated."),ue}catch(ue){throw ue}})()}removeAndGenerateWord(X,ue=!0){var Me=this;return(0,d.Z)(function*(){if(ue){const et=(0,B.OF)(E.U).split(" ")[X];Me.secret[X]=et}else Me.secret.splice(X,1)})()}autocomplet(X){var ue=this;return(0,d.Z)(function*(){const et=X.target.value?.toLowerCase();if(!et||et.length<=1)return void(ue.seedWordList=[]);const gt=E.U.filter(Tt=>Tt.startsWith(et));ue.seedWordList=gt?.length<=0?[]:gt.filter(Tt=>!ue.secret.includes(Tt)).slice(0,3)})()}selectWord(X){var ue=this;return(0,d.Z)(function*(){if(ue.seedWordList=[],ue.secret.length>=12)throw new Error("[ERROR] Maximum seed words count is 12");if(ue.secret.includes(X))throw new Error("[ERROR] Word already exists");if(E.U.findIndex(Me=>Me===X)<0)throw new Error("[ERROR] Word is not valid. Please select word from autocomplet list");ue.secret.push(X)})()}toggleImportSeedWords(){var X=this;return(0,d.Z)(function*(){X.isImportSeedWords=!X.isImportSeedWords,X.isImportSeedWords?X.secret=[]:(X.isMnemonicSeedPhrase=!0,X.secret=(0,B.OF)(E.U).split(" "))})()}toggleIsMnemonicSeedPhrase(){var X=this;return(0,d.Z)(function*(){X.isMnemonicSeedPhrase=!X.isMnemonicSeedPhrase,X.secret=X.isMnemonicSeedPhrase?(0,B.OF)(E.U).split(" "):[""]})()}}return je.\u0275fac=function(X){return new(X||je)(c.Y36(i.gz),c.Y36(O),c.Y36(G),c.Y36(k.Br),c.Y36(l))},je.\u0275cmp=c.Xpm({type:je,selectors:[["app-qrgenerator-page"]],viewQuery:function(X,ue){if(1&X&&(c.Gf(Y,5,c.SBq),c.Gf(W,5,c.SBq),c.Gf(ne,5,c.SBq)),2&X){let Me;c.iGM(Me=c.CRH())&&(ue.toggleEncryptionElement=Me.first),c.iGM(Me=c.CRH())&&(ue.qrVideoElement=Me.first),c.iGM(Me=c.CRH())&&(ue.canvasElement=Me.first)}},decls:47,vars:32,consts:[[1,"ion-no-padding"],[1,"ion-no-padding","ion-justify-content-start","ion-align-items-center"],["size","12","size-md","6",1,"ion-padding"],[1,"form-container"],["color","primary"],["name","qr-code-outline"],["color","medium"],["class","chips-container",4,"ngIf"],["lines","none",3,"disabled",4,"ngIf"],["lines","none",3,"disabled"],["rel","noopener","href","https://openpgpjs.org/","target","_blank"],["checked","true","slot","end"],["toggleElement",""],["class","ion-margin-vertical",3,"disabled","click",4,"ngIf"],["class","ion-margin-vertical",3,"click",4,"ngIf"],[4,"ngIf"],["size","12","size-md","6","class","canvas-conntainer ion-no-padding ion-text-center",3,"ngClass",4,"ngIf"],["size","12","size-md","6","class","preview-conntainer ion-no-padding ion-text-center",3,"ngClass",4,"ngIf"],[1,"chips-container"],["color","medium","position","stacked"],[3,"click"],["lines","none",1,"autocomplet-container"],["type","text","placeholder","type password...",3,"ngModel","autofocus","ngModelChange"],["passwordInputElement",""],["slot","end",1,"toggle-input-type",3,"name","click"],[3,"hidden"],["color","primary",3,"disabled","click",4,"ngFor","ngForOf"],["class","autocomplet-container ion-padding-top",4,"ngIf"],["color","primary",3,"disabled","click"],["name","close-circle"],[1,"autocomplet-container","ion-padding-top"],["type","text",3,"autofocus","hidden","placeholder","disabled","ngClass","ionChange"],["inputWordElement",""],["class","ion-no-padding",4,"ngIf"],[3,"click",4,"ngFor","ngForOf"],[1,"ion-padding-start"],["slot","end","fill","none"],["color","primary","slot","icon-only","name","add-circle"],["minlength","5","maxlength","200","placeholder","type data to encrypt here...",3,"disabled","ngModel","ngModelChange"],["textareaEl",""],[1,"maxCount"],[1,"ion-margin-vertical",3,"disabled","click"],[1,"ion-margin-vertical",3,"click"],["title","file","type","file","accept","image/*","capture","camera",3,"hidden","change"],["inputFile",""],[3,"routerLink","queryParams"],["size","12","size-md","6",1,"canvas-conntainer","ion-no-padding","ion-text-center",3,"ngClass"],["class","info-text",4,"ngIf","ngIfElse"],["defaultMessage",""],["fill","none","color","light",3,"click",4,"ngIf"],[1,"info-text"],["color","light",1,"ion-margin-vertical"],["color","light"],["color","light",4,"ngIf"],["canvas",""],["fill","none","color","light",3,"click"],["size","12","size-md","6",1,"preview-conntainer","ion-no-padding","ion-text-center",3,"ngClass"],["class","preview-text",4,"ngIf","ngIfElse"],["defaultTemplate",""],["id","qrcode-reader","width","600px","height","600px"],[1,"preview-text"]],template:function(X,ue){1&X&&(c.TgZ(0,"ion-content",0)(1,"ion-grid",0)(2,"ion-row",1)(3,"ion-col",2)(4,"div",3)(5,"ion-text",4)(6,"h1"),c._UZ(7,"ion-icon",5),c.TgZ(8,"span"),c._uU(9,"Paperize"),c.qZA()()(),c.TgZ(10,"ion-text",6)(11,"p"),c._uU(12," Backup as QR code is the most advenced way to store your private key or sensitive data on a secure place. "),c.qZA()(),c.TgZ(13,"ion-text",4)(14,"h2"),c._uU(15),c.ALo(16,"async"),c.qZA()(),c.YNc(17,de,14,4,"div",7),c.YNc(18,We,15,3,"div",7),c.YNc(19,Ze,11,8,"ion-item",8),c.ALo(20,"async"),c.TgZ(21,"ion-item",9),c.ALo(22,"async"),c.TgZ(23,"ion-label",6),c._uU(24," Enable OpenPGP Encryption "),c.TgZ(25,"small"),c._uU(26,"( "),c.TgZ(27,"a",10),c._uU(28,"how it work?"),c.qZA(),c._uU(29," )"),c.qZA()(),c._UZ(30,"ion-toggle",11,12),c.qZA(),c.YNc(32,Ct,3,3,"ion-button",13),c.ALo(33,"async"),c.YNc(34,tt,2,0,"ion-button",14),c.ALo(35,"async"),c.YNc(36,jt,5,3,"div",15),c.ALo(37,"async"),c.TgZ(38,"ion-text",6),c.YNc(39,Le,7,3,"p",15),c.ALo(40,"async"),c.YNc(41,K,7,3,"p",15),c.ALo(42,"async"),c.qZA()()(),c.YNc(43,Pt,12,19,"ion-col",16),c.ALo(44,"async"),c.YNc(45,_t,8,11,"ion-col",17),c.ALo(46,"async"),c.qZA()()()),2&X&&(c.xp6(15),c.hij("","encrypt"===c.lcZ(16,12,ue.action$)?"Encryption":"Decrypting"," data"),c.xp6(2),c.Q6J("ngIf",!1===ue.isMnemonicSeedPhrase&&!0===(null==ue.toggleEncryptionElement||null==ue.toggleEncryptionElement.nativeElement?null:ue.toggleEncryptionElement.nativeElement.checked)),c.xp6(1),c.Q6J("ngIf",!0===ue.isMnemonicSeedPhrase&&!0===ue.toggleEncryptionElement.nativeElement.checked),c.xp6(1),c.Q6J("ngIf","encrypt"===c.lcZ(20,14,ue.action$)),c.xp6(2),c.Q6J("disabled",c.lcZ(22,16,ue.isWoring$)),c.xp6(11),c.Q6J("ngIf","encrypt"===c.lcZ(33,18,ue.action$)&&!0===(null==ue.toggleEncryptionElement||null==ue.toggleEncryptionElement.nativeElement?null:ue.toggleEncryptionElement.nativeElement.checked)),c.xp6(2),c.Q6J("ngIf","encrypt"===c.lcZ(35,20,ue.action$)&&!1===(null==ue.toggleEncryptionElement||null==ue.toggleEncryptionElement.nativeElement?null:ue.toggleEncryptionElement.nativeElement.checked)),c.xp6(2),c.Q6J("ngIf","decrypt"===c.lcZ(37,22,ue.action$)),c.xp6(3),c.Q6J("ngIf","encrypt"===c.lcZ(40,24,ue.action$)),c.xp6(2),c.Q6J("ngIf","decrypt"===c.lcZ(42,26,ue.action$)),c.xp6(2),c.Q6J("ngIf","encrypt"===c.lcZ(44,28,ue.action$)),c.xp6(2),c.Q6J("ngIf","decrypt"===c.lcZ(46,30,ue.action$)))},dependencies:[s.mk,s.sg,s.O5,F.JJ,F.wO,F.nD,F.On,i.yS,k.YG,k.hM,k.wI,k.W2,k.jY,k.gu,k.pK,k.Ie,k.Q$,k.q_,k.uN,k.Nd,k.PQ,k.yW,k.g2,k.ho,k.w,k.j9,k.Fo,s.Ov],styles:["[_nghost-%COMP%]   h1[_ngcontent-%COMP%]{display:flex;flex-direction:row;flex-wrap:nowrap;justify-content:flex-start;align-items:center;align-content:center;font-size:4.2rem}[_nghost-%COMP%]   h1[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{margin-left:.5rem}[_nghost-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1.2rem;margin:3rem 0 .5rem}[_nghost-%COMP%]   ion-grid[_ngcontent-%COMP%], [_nghost-%COMP%]   ion-row[_ngcontent-%COMP%]{height:100%}[_nghost-%COMP%]   ion-item[_ngcontent-%COMP%]{--padding-start: 0;--inner-padding-end: 0}[_nghost-%COMP%]   .chips-container[_ngcontent-%COMP%]{padding:0 0 1rem}[_nghost-%COMP%]   .chips-container[_ngcontent-%COMP%] > ion-label[_ngcontent-%COMP%]{display:block;margin-bottom:1rem}[_nghost-%COMP%]   .chips-container[_ngcontent-%COMP%] > ion-label[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]{cursor:pointer}[_nghost-%COMP%]   ion-input[_ngcontent-%COMP%], [_nghost-%COMP%]   ion-textarea[_ngcontent-%COMP%]{font-family:monospace,Courier New,Courier,serif}[_nghost-%COMP%]   .toggle-input-type[_ngcontent-%COMP%]{cursor:pointer}[_nghost-%COMP%]   ion-textarea[_ngcontent-%COMP%]{border:solid 1px var(--ion-color-medium);border-radius:6px;padding:.5em}[_nghost-%COMP%]   span.maxCount[_ngcontent-%COMP%]{font-size:.8rem;display:block;margin-right:0;margin-top:8px;position:relative;text-align:right;opacity:.5}[_nghost-%COMP%]   .form-container[_ngcontent-%COMP%]{max-width:618px}[_nghost-%COMP%]   .info-text[_ngcontent-%COMP%]{position:absolute;top:50%;left:50%;width:100%;transform:translate(-50%,-50%)}[_nghost-%COMP%]   .info-text[_ngcontent-%COMP%]   ion-spinner[_ngcontent-%COMP%]{margin:0rem auto 2rem;display:block;padding:2rem}[_nghost-%COMP%]   .autocomplet-container[_ngcontent-%COMP%]{position:relative}[_nghost-%COMP%]   .autocomplet-container[_ngcontent-%COMP%]   ion-input[_ngcontent-%COMP%]{border:solid 1px var(--ion-color-medium);border-radius:8px;padding-left:.5rem!important;--padding-start: 0}[_nghost-%COMP%]   .autocomplet-container[_ngcontent-%COMP%]   ion-input.active[_ngcontent-%COMP%]{border-radius:8px 8px 0 0;box-shadow:0 .2rem .4rem #0000004d}[_nghost-%COMP%]   .autocomplet-container[_ngcontent-%COMP%]   ion-list[_ngcontent-%COMP%]{position:absolute;width:100%;z-index:2;border:solid 1px var(--ion-color-medium);border-top:none;border-radius:0 0 8px 8px;box-shadow:0 .2rem .4rem #0000004d}[_nghost-%COMP%]   .autocomplet-container[_ngcontent-%COMP%]   ion-list[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]{cursor:pointer}[_nghost-%COMP%]   .canvas-conntainer[_ngcontent-%COMP%]{display:flex;flex-direction:column;flex-wrap:nowrap;justify-content:center;align-items:center;align-content:center;padding:2rem;height:100%;background:rgba(var(--ion-color-primary-rgb),1)}[_nghost-%COMP%]   .canvas-conntainer[_ngcontent-%COMP%]   canvas[_ngcontent-%COMP%]{width:100%;max-width:75vh;height:auto;border-radius:2rem;padding:1rem}[_nghost-%COMP%]   .preview-conntainer[_ngcontent-%COMP%]{display:flex;flex-direction:column;flex-wrap:nowrap;justify-content:center;align-items:center;align-content:center;padding:2rem;height:100%;background:rgba(var(--ion-color-primary-rgb),1)}[_nghost-%COMP%]   .preview-conntainer[_ngcontent-%COMP%] > div.preview-text[_ngcontent-%COMP%]{padding:1rem;background:rgba(var(--ion-color-light-rgb),.1);color:var(--ion-color-light);letter-spacing:.2rem;width:80%;max-width:500px;font-weight:600;font-family:monospace,Courier New,serif}[_nghost-%COMP%]   .canvas-conntainer[_ngcontent-%COMP%], [_nghost-%COMP%]   .preview-conntainer[_ngcontent-%COMP%]{position:fixed;right:0;z-index:10}[_nghost-%COMP%]   a[_ngcontent-%COMP%]{cursor:pointer}@media screen and (max-width: 768px){[_nghost-%COMP%]   .isHiddenForMobile[_ngcontent-%COMP%]{display:none}}"]}),je})()}];let Z=(()=>{class je{}return je.\u0275fac=function(X){return new(X||je)},je.\u0275mod=c.oAB({type:je}),je.\u0275inj=c.cJS({imports:[i.Bz.forChild(Qt),i.Bz]}),je})(),ut=(()=>{class je{}return je.\u0275fac=function(X){return new(X||je)},je.\u0275mod=c.oAB({type:je}),je.\u0275inj=c.cJS({imports:[s.ez,F.u5,Z,k.Pc]}),je})()},5182:(De,J)=>{"use strict";function M(v){if(!Number.isSafeInteger(v)||v<0)throw new Error(`Wrong positive integer: ${v}`)}function s(v){if("boolean"!=typeof v)throw new Error(`Expected boolean, not ${v}`)}function i(v,...y){if(!(v instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(y.length>0&&!y.includes(v.length))throw new TypeError(`Expected Uint8Array of length ${y}, not of length=${v.length}`)}function d(v){if("function"!=typeof v||"function"!=typeof v.create)throw new Error("Hash should be wrapped by utils.wrapConstructor");M(v.outputLen),M(v.blockLen)}function c(v,y=!0){if(v.destroyed)throw new Error("Hash instance has been destroyed");if(y&&v.finished)throw new Error("Hash#digest() has already been called")}function B(v,y){i(v);const h=y.outputLen;if(v.length<h)throw new Error(`digestInto() expects output buffer of length at least ${h}`)}Object.defineProperty(J,"__esModule",{value:!0}),J.output=J.exists=J.hash=J.bytes=J.bool=J.number=void 0,J.number=M,J.bool=s,J.bytes=i,J.hash=d,J.exists=c,J.output=B,J.default={number:M,bool:s,bytes:i,hash:d,exists:c,output:B}},9463:(De,J,M)=>{"use strict";Object.defineProperty(J,"__esModule",{value:!0}),J.SHA2=void 0;const s=M(5182),i=M(9303);J.SHA2=class c extends i.Hash{constructor(E,v,y,h){super(),this.blockLen=E,this.outputLen=v,this.padOffset=y,this.isLE=h,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(E),this.view=(0,i.createView)(this.buffer)}update(E){s.default.exists(this);const{view:v,buffer:y,blockLen:h}=this,x=(E=(0,i.toBytes)(E)).length;for(let A=0;A<x;){const H=Math.min(h-this.pos,x-A);if(H!==h)y.set(E.subarray(A,A+H),this.pos),this.pos+=H,A+=H,this.pos===h&&(this.process(v,0),this.pos=0);else{const C=(0,i.createView)(E);for(;h<=x-A;A+=h)this.process(C,A)}}return this.length+=E.length,this.roundClean(),this}digestInto(E){s.default.exists(this),s.default.output(E,this),this.finished=!0;const{buffer:v,view:y,blockLen:h,isLE:x}=this;let{pos:A}=this;v[A++]=128,this.buffer.subarray(A).fill(0),this.padOffset>h-A&&(this.process(y,0),A=0);for(let C=A;C<h;C++)v[C]=0;(function d(B,E,v,y){if("function"==typeof B.setBigUint64)return B.setBigUint64(E,v,y);const h=BigInt(32),x=BigInt(4294967295),A=Number(v>>h&x),H=Number(v&x),_=y?0:4;B.setUint32(E+(y?4:0),A,y),B.setUint32(E+_,H,y)})(y,h-8,BigInt(8*this.length),x),this.process(y,0);const H=(0,i.createView)(E);this.get().forEach((C,_)=>H.setUint32(4*_,C,x))}digest(){const{buffer:E,outputLen:v}=this;this.digestInto(E);const y=E.slice(0,v);return this.destroy(),y}_cloneInto(E){E||(E=new this.constructor),E.set(...this.get());const{blockLen:v,buffer:y,length:h,finished:x,destroyed:A,pos:H}=this;return E.length=h,E.pos=H,E.finished=x,E.destroyed=A,h%v&&E.buffer.set(y),E}}},1251:(De,J)=>{"use strict";Object.defineProperty(J,"__esModule",{value:!0}),J.add=J.toBig=J.split=J.fromBig=void 0;const M=BigInt(2**32-1),s=BigInt(32);function i(P,D=!1){return D?{h:Number(P&M),l:Number(P>>s&M)}:{h:0|Number(P>>s&M),l:0|Number(P&M)}}function d(P,D=!1){let l=new Uint32Array(P.length),F=new Uint32Array(P.length);for(let Y=0;Y<P.length;Y++){const{h:W,l:ne}=i(P[Y],D);[l[Y],F[Y]]=[W,ne]}return[l,F]}function I(P,D,l,F){const Y=(D>>>0)+(F>>>0);return{h:P+l+(Y/2**32|0)|0,l:0|Y}}J.fromBig=i,J.split=d,J.toBig=(P,D)=>BigInt(P>>>0)<<s|BigInt(D>>>0),J.add=I,J.default={fromBig:i,split:d,toBig:J.toBig,shrSH:(P,D,l)=>P>>>l,shrSL:(P,D,l)=>P<<32-l|D>>>l,rotrSH:(P,D,l)=>P>>>l|D<<32-l,rotrSL:(P,D,l)=>P<<32-l|D>>>l,rotrBH:(P,D,l)=>P<<64-l|D>>>l-32,rotrBL:(P,D,l)=>P>>>l-32|D<<64-l,rotr32H:(P,D)=>D,rotr32L:(P,D)=>P,rotlSH:(P,D,l)=>P<<l|D>>>32-l,rotlSL:(P,D,l)=>D<<l|P>>>32-l,rotlBH:(P,D,l)=>D<<l-32|P>>>64-l,rotlBL:(P,D,l)=>P<<l-32|D>>>64-l,add:I,add3L:(P,D,l)=>(P>>>0)+(D>>>0)+(l>>>0),add3H:(P,D,l,F)=>D+l+F+(P/2**32|0)|0,add4L:(P,D,l,F)=>(P>>>0)+(D>>>0)+(l>>>0)+(F>>>0),add4H:(P,D,l,F,Y)=>D+l+F+Y+(P/2**32|0)|0,add5H:(P,D,l,F,Y,W)=>D+l+F+Y+W+(P/2**32|0)|0,add5L:(P,D,l,F,Y)=>(P>>>0)+(D>>>0)+(l>>>0)+(F>>>0)+(Y>>>0)}},9576:(De,J)=>{"use strict";Object.defineProperty(J,"__esModule",{value:!0}),J.crypto=void 0,J.crypto={node:void 0,web:"object"==typeof self&&"crypto"in self?self.crypto:void 0}},9578:(De,J,M)=>{"use strict";Object.defineProperty(J,"__esModule",{value:!0}),J.hmac=void 0;const s=M(5182),i=M(9303);class d extends i.Hash{constructor(E,v){super(),this.finished=!1,this.destroyed=!1,s.default.hash(E);const y=(0,i.toBytes)(v);if(this.iHash=E.create(),!(this.iHash instanceof i.Hash))throw new TypeError("Expected instance of class which extends utils.Hash");const h=this.blockLen=this.iHash.blockLen;this.outputLen=this.iHash.outputLen;const x=new Uint8Array(h);x.set(y.length>this.iHash.blockLen?E.create().update(y).digest():y);for(let A=0;A<x.length;A++)x[A]^=54;this.iHash.update(x),this.oHash=E.create();for(let A=0;A<x.length;A++)x[A]^=106;this.oHash.update(x),x.fill(0)}update(E){return s.default.exists(this),this.iHash.update(E),this}digestInto(E){s.default.exists(this),s.default.bytes(E,this.outputLen),this.finished=!0,this.iHash.digestInto(E),this.oHash.update(E),this.oHash.digestInto(E),this.destroy()}digest(){const E=new Uint8Array(this.oHash.outputLen);return this.digestInto(E),E}_cloneInto(E){E||(E=Object.create(Object.getPrototypeOf(this),{}));const{oHash:v,iHash:y,finished:h,destroyed:x,blockLen:A,outputLen:H}=this;return E.finished=h,E.destroyed=x,E.blockLen=A,E.outputLen=H,E.oHash=v._cloneInto(E.oHash),E.iHash=y._cloneInto(E.iHash),E}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}J.hmac=(B,E,v)=>new d(B,E).update(v).digest(),J.hmac.create=(B,E)=>new d(B,E)},3332:(De,J,M)=>{"use strict";var s=M(7156).default;Object.defineProperty(J,"__esModule",{value:!0}),J.pbkdf2Async=J.pbkdf2=void 0;const i=M(5182),d=M(9578),c=M(9303);function B(x,A,H,C){i.default.hash(x);const _=(0,c.checkOpts)({dkLen:32,asyncTick:10},C),{c:N,dkLen:T,asyncTick:I}=_;if(i.default.number(N),i.default.number(T),i.default.number(I),N<1)throw new Error("PBKDF2: iterations (c) should be >= 1");const p=(0,c.toBytes)(A),m=(0,c.toBytes)(H),S=new Uint8Array(T),O=d.hmac.create(x,p),V=O._cloneInto().update(m);return{c:N,dkLen:T,asyncTick:I,DK:S,PRF:O,PRFSalt:V}}function E(x,A,H,C,_){return x.destroy(),A.destroy(),C&&C.destroy(),_.fill(0),H}function h(){return(h=s(function*(x,A,H,C){const{c:_,dkLen:N,asyncTick:T,DK:I,PRF:p,PRFSalt:m}=B(x,A,H,C);let S;const O=new Uint8Array(4),V=(0,c.createView)(O),G=new Uint8Array(p.outputLen);for(let k=1,P=0;P<N;k++,P+=p.outputLen){const D=I.subarray(P,P+p.outputLen);V.setInt32(0,k,!1),(S=m._cloneInto(S)).update(O).digestInto(G),D.set(G.subarray(0,D.length)),yield(0,c.asyncLoop)(_-1,T,l=>{p._cloneInto(S).update(G).digestInto(G);for(let F=0;F<D.length;F++)D[F]^=G[F]})}return E(p,m,I,S,G)})).apply(this,arguments)}J.pbkdf2=function v(x,A,H,C){const{c:_,dkLen:N,DK:T,PRF:I,PRFSalt:p}=B(x,A,H,C);let m;const S=new Uint8Array(4),O=(0,c.createView)(S),V=new Uint8Array(I.outputLen);for(let G=1,k=0;k<N;G++,k+=I.outputLen){const P=T.subarray(k,k+I.outputLen);O.setInt32(0,G,!1),(m=p._cloneInto(m)).update(S).digestInto(V),P.set(V.subarray(0,P.length));for(let D=1;D<_;D++){I._cloneInto(m).update(V).digestInto(V);for(let l=0;l<P.length;l++)P[l]^=V[l]}}return E(I,p,T,m,V)},J.pbkdf2Async=function y(x,A,H,C){return h.apply(this,arguments)}},8527:(De,J,M)=>{"use strict";Object.defineProperty(J,"__esModule",{value:!0}),J.sha256=void 0;const s=M(9463),i=M(9303),d=(h,x,A)=>h&x^~h&A,c=(h,x,A)=>h&x^h&A^x&A,B=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),E=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),v=new Uint32Array(64);class y extends s.SHA2{constructor(){super(64,32,8,!1),this.A=0|E[0],this.B=0|E[1],this.C=0|E[2],this.D=0|E[3],this.E=0|E[4],this.F=0|E[5],this.G=0|E[6],this.H=0|E[7]}get(){const{A:x,B:A,C:H,D:C,E:_,F:N,G:T,H:I}=this;return[x,A,H,C,_,N,T,I]}set(x,A,H,C,_,N,T,I){this.A=0|x,this.B=0|A,this.C=0|H,this.D=0|C,this.E=0|_,this.F=0|N,this.G=0|T,this.H=0|I}process(x,A){for(let S=0;S<16;S++,A+=4)v[S]=x.getUint32(A,!1);for(let S=16;S<64;S++){const O=v[S-15],V=v[S-2],G=(0,i.rotr)(O,7)^(0,i.rotr)(O,18)^O>>>3,k=(0,i.rotr)(V,17)^(0,i.rotr)(V,19)^V>>>10;v[S]=k+v[S-7]+G+v[S-16]|0}let{A:H,B:C,C:_,D:N,E:T,F:I,G:p,H:m}=this;for(let S=0;S<64;S++){const V=m+((0,i.rotr)(T,6)^(0,i.rotr)(T,11)^(0,i.rotr)(T,25))+d(T,I,p)+B[S]+v[S]|0,k=((0,i.rotr)(H,2)^(0,i.rotr)(H,13)^(0,i.rotr)(H,22))+c(H,C,_)|0;m=p,p=I,I=T,T=N+V|0,N=_,_=C,C=H,H=V+k|0}H=H+this.A|0,C=C+this.B|0,_=_+this.C|0,N=N+this.D|0,T=T+this.E|0,I=I+this.F|0,p=p+this.G|0,m=m+this.H|0,this.set(H,C,_,N,T,I,p,m)}roundClean(){v.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}J.sha256=(0,i.wrapConstructor)(()=>new y)},319:(De,J,M)=>{"use strict";Object.defineProperty(J,"__esModule",{value:!0}),J.sha384=J.sha512_256=J.sha512=J.SHA512=void 0;const s=M(9463),i=M(1251),d=M(9303),[c,B]=i.default.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(A=>BigInt(A))),E=new Uint32Array(80),v=new Uint32Array(80);class y extends s.SHA2{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:H,Al:C,Bh:_,Bl:N,Ch:T,Cl:I,Dh:p,Dl:m,Eh:S,El:O,Fh:V,Fl:G,Gh:k,Gl:P,Hh:D,Hl:l}=this;return[H,C,_,N,T,I,p,m,S,O,V,G,k,P,D,l]}set(H,C,_,N,T,I,p,m,S,O,V,G,k,P,D,l){this.Ah=0|H,this.Al=0|C,this.Bh=0|_,this.Bl=0|N,this.Ch=0|T,this.Cl=0|I,this.Dh=0|p,this.Dl=0|m,this.Eh=0|S,this.El=0|O,this.Fh=0|V,this.Fl=0|G,this.Gh=0|k,this.Gl=0|P,this.Hh=0|D,this.Hl=0|l}process(H,C){for(let W=0;W<16;W++,C+=4)E[W]=H.getUint32(C),v[W]=H.getUint32(C+=4);for(let W=16;W<80;W++){const ne=0|E[W-15],de=0|v[W-15],Ae=i.default.rotrSH(ne,de,1)^i.default.rotrSH(ne,de,8)^i.default.shrSH(ne,de,7),Re=i.default.rotrSL(ne,de,1)^i.default.rotrSL(ne,de,8)^i.default.shrSL(ne,de,7),Fe=0|E[W-2],be=0|v[W-2],Pe=i.default.rotrSH(Fe,be,19)^i.default.rotrBH(Fe,be,61)^i.default.shrSH(Fe,be,6),We=i.default.rotrSL(Fe,be,19)^i.default.rotrBL(Fe,be,61)^i.default.shrSL(Fe,be,6),Ze=i.default.add4L(Re,We,v[W-7],v[W-16]),Ct=i.default.add4H(Ze,Ae,Pe,E[W-7],E[W-16]);E[W]=0|Ct,v[W]=0|Ze}let{Ah:_,Al:N,Bh:T,Bl:I,Ch:p,Cl:m,Dh:S,Dl:O,Eh:V,El:G,Fh:k,Fl:P,Gh:D,Gl:l,Hh:F,Hl:Y}=this;for(let W=0;W<80;W++){const ne=i.default.rotrSH(V,G,14)^i.default.rotrSH(V,G,18)^i.default.rotrBH(V,G,41),de=i.default.rotrSL(V,G,14)^i.default.rotrSL(V,G,18)^i.default.rotrBL(V,G,41),Ae=V&k^~V&D,Fe=i.default.add5L(Y,de,G&P^~G&l,B[W],v[W]),be=i.default.add5H(Fe,F,ne,Ae,c[W],E[W]),Pe=0|Fe,We=i.default.rotrSH(_,N,28)^i.default.rotrBH(_,N,34)^i.default.rotrBH(_,N,39),Ze=i.default.rotrSL(_,N,28)^i.default.rotrBL(_,N,34)^i.default.rotrBL(_,N,39),Ct=_&T^_&p^T&p,tt=N&I^N&m^I&m;F=0|D,Y=0|l,D=0|k,l=0|P,k=0|V,P=0|G,({h:V,l:G}=i.default.add(0|S,0|O,0|be,0|Pe)),S=0|p,O=0|m,p=0|T,m=0|I,T=0|_,I=0|N;const Ht=i.default.add3L(Pe,Ze,tt);_=i.default.add3H(Ht,be,We,Ct),N=0|Ht}({h:_,l:N}=i.default.add(0|this.Ah,0|this.Al,0|_,0|N)),({h:T,l:I}=i.default.add(0|this.Bh,0|this.Bl,0|T,0|I)),({h:p,l:m}=i.default.add(0|this.Ch,0|this.Cl,0|p,0|m)),({h:S,l:O}=i.default.add(0|this.Dh,0|this.Dl,0|S,0|O)),({h:V,l:G}=i.default.add(0|this.Eh,0|this.El,0|V,0|G)),({h:k,l:P}=i.default.add(0|this.Fh,0|this.Fl,0|k,0|P)),({h:D,l}=i.default.add(0|this.Gh,0|this.Gl,0|D,0|l)),({h:F,l:Y}=i.default.add(0|this.Hh,0|this.Hl,0|F,0|Y)),this.set(_,N,T,I,p,m,S,O,V,G,k,P,D,l,F,Y)}roundClean(){E.fill(0),v.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}J.SHA512=y;class h extends y{constructor(){super(),this.Ah=573645204,this.Al=-64227540,this.Bh=-1621794909,this.Bl=-934517566,this.Ch=596883563,this.Cl=1867755857,this.Dh=-1774684391,this.Dl=1497426621,this.Eh=-1775747358,this.El=-1467023389,this.Fh=-1101128155,this.Fl=1401305490,this.Gh=721525244,this.Gl=746961066,this.Hh=246885852,this.Hl=-2117784414,this.outputLen=32}}class x extends y{constructor(){super(),this.Ah=-876896931,this.Al=-1056596264,this.Bh=1654270250,this.Bl=914150663,this.Ch=-1856437926,this.Cl=812702999,this.Dh=355462360,this.Dl=-150054599,this.Eh=1731405415,this.El=-4191439,this.Fh=-1900787065,this.Fl=1750603025,this.Gh=-619958771,this.Gl=1694076839,this.Hh=1203062813,this.Hl=-1090891868,this.outputLen=48}}J.sha512=(0,d.wrapConstructor)(()=>new y),J.sha512_256=(0,d.wrapConstructor)(()=>new h),J.sha384=(0,d.wrapConstructor)(()=>new x)},9303:(De,J,M)=>{"use strict";var s=M(7156).default;Object.defineProperty(J,"__esModule",{value:!0}),J.randomBytes=J.wrapConstructorWithOpts=J.wrapConstructor=J.checkOpts=J.Hash=J.concatBytes=J.toBytes=J.utf8ToBytes=J.asyncLoop=J.nextTick=J.hexToBytes=J.bytesToHex=J.isLE=J.rotr=J.createView=J.u32=J.u8=void 0;const i=M(9576);if(J.u8=V=>new Uint8Array(V.buffer,V.byteOffset,V.byteLength),J.u32=V=>new Uint32Array(V.buffer,V.byteOffset,Math.floor(V.byteLength/4)),J.createView=V=>new DataView(V.buffer,V.byteOffset,V.byteLength),J.rotr=(V,G)=>V<<32-G|V>>>G,J.isLE=68===new Uint8Array(new Uint32Array([287454020]).buffer)[0],!J.isLE)throw new Error("Non little-endian hardware is not supported");const v=Array.from({length:256},(V,G)=>G.toString(16).padStart(2,"0"));function H(){return(H=s(function*(V,G,k){let P=Date.now();for(let D=0;D<V;D++){k(D);const l=Date.now()-P;l>=0&&l<G||(yield(0,J.nextTick)(),P+=l)}})).apply(this,arguments)}function C(V){if("string"!=typeof V)throw new TypeError("utf8ToBytes expected string, got "+typeof V);return(new TextEncoder).encode(V)}function _(V){if("string"==typeof V&&(V=C(V)),!(V instanceof Uint8Array))throw new TypeError(`Expected input type is Uint8Array (got ${typeof V})`);return V}J.bytesToHex=function y(V){if(!(V instanceof Uint8Array))throw new Error("Uint8Array expected");let G="";for(let k=0;k<V.length;k++)G+=v[V[k]];return G},J.hexToBytes=function h(V){if("string"!=typeof V)throw new TypeError("hexToBytes: expected string, got "+typeof V);if(V.length%2)throw new Error("hexToBytes: received invalid unpadded hex");const G=new Uint8Array(V.length/2);for(let k=0;k<G.length;k++){const P=2*k,D=V.slice(P,P+2),l=Number.parseInt(D,16);if(Number.isNaN(l)||l<0)throw new Error("Invalid byte sequence");G[k]=l}return G},J.nextTick=function(){var V=s(function*(){});return function(){return V.apply(this,arguments)}}(),J.asyncLoop=function A(V,G,k){return H.apply(this,arguments)},J.utf8ToBytes=C,J.toBytes=_,J.concatBytes=function N(...V){if(!V.every(P=>P instanceof Uint8Array))throw new Error("Uint8Array list expected");if(1===V.length)return V[0];const G=V.reduce((P,D)=>P+D.length,0),k=new Uint8Array(G);for(let P=0,D=0;P<V.length;P++){const l=V[P];k.set(l,D),D+=l.length}return k},J.Hash=class T{clone(){return this._cloneInto()}},J.checkOpts=function p(V,G){if(void 0!==G&&("object"!=typeof G||!(V=>"[object Object]"===Object.prototype.toString.call(V)&&V.constructor===Object)(G)))throw new TypeError("Options should be object or undefined");return Object.assign(V,G)},J.wrapConstructor=function m(V){const G=P=>V().update(_(P)).digest(),k=V();return G.outputLen=k.outputLen,G.blockLen=k.blockLen,G.create=()=>V(),G},J.wrapConstructorWithOpts=function S(V){const G=(P,D)=>V(D).update(_(P)).digest(),k=V({});return G.outputLen=k.outputLen,G.blockLen=k.blockLen,G.create=P=>V(P),G},J.randomBytes=function O(V=32){if(i.crypto.web)return i.crypto.web.getRandomValues(new Uint8Array(V));if(i.crypto.node)return new Uint8Array(i.crypto.node.randomBytes(V).buffer);throw new Error("The environment doesn't have randomBytes function")}},5521:(De,J)=>{"use strict";function M(D){if(!Number.isSafeInteger(D))throw new Error(`Wrong integer: ${D}`)}function s(...D){const l=(W,ne)=>de=>W(ne(de));return{encode:Array.from(D).reverse().reduce((W,ne)=>W?l(W,ne.encode):ne.encode,void 0),decode:D.reduce((W,ne)=>W?l(W,ne.decode):ne.decode,void 0)}}function i(D){return{encode:l=>{if(!Array.isArray(l)||l.length&&"number"!=typeof l[0])throw new Error("alphabet.encode input should be an array of numbers");return l.map(F=>{if(M(F),F<0||F>=D.length)throw new Error(`Digit index outside alphabet: ${F} (alphabet: ${D.length})`);return D[F]})},decode:l=>{if(!Array.isArray(l)||l.length&&"string"!=typeof l[0])throw new Error("alphabet.decode input should be array of strings");return l.map(F=>{if("string"!=typeof F)throw new Error(`alphabet.decode: not string element=${F}`);const Y=D.indexOf(F);if(-1===Y)throw new Error(`Unknown letter: "${F}". Allowed: ${D}`);return Y})}}}function d(D=""){if("string"!=typeof D)throw new Error("join separator should be string");return{encode:l=>{if(!Array.isArray(l)||l.length&&"string"!=typeof l[0])throw new Error("join.encode input should be array of strings");for(let F of l)if("string"!=typeof F)throw new Error(`join.encode: non-string input=${F}`);return l.join(D)},decode:l=>{if("string"!=typeof l)throw new Error("join.decode input should be string");return l.split(D)}}}function c(D,l="="){if(M(D),"string"!=typeof l)throw new Error("padding chr should be string");return{encode(F){if(!Array.isArray(F)||F.length&&"string"!=typeof F[0])throw new Error("padding.encode input should be array of strings");for(let Y of F)if("string"!=typeof Y)throw new Error(`padding.encode: non-string input=${Y}`);for(;F.length*D%8;)F.push(l);return F},decode(F){if(!Array.isArray(F)||F.length&&"string"!=typeof F[0])throw new Error("padding.encode input should be array of strings");for(let W of F)if("string"!=typeof W)throw new Error(`padding.decode: non-string input=${W}`);let Y=F.length;if(Y*D%8)throw new Error("Invalid padding: string should have whole number of bytes");for(;Y>0&&F[Y-1]===l;Y--)if(!((Y-1)*D%8))throw new Error("Invalid padding: string has too much padding");return F.slice(0,Y)}}}function B(D){if("function"!=typeof D)throw new Error("normalize fn should be function");return{encode:l=>l,decode:l=>D(l)}}function E(D,l,F){if(l<2)throw new Error(`convertRadix: wrong from=${l}, base cannot be less than 2`);if(F<2)throw new Error(`convertRadix: wrong to=${F}, base cannot be less than 2`);if(!Array.isArray(D))throw new Error("convertRadix: data should be array");if(!D.length)return[];let Y=0;const W=[],ne=Array.from(D);for(ne.forEach(de=>{if(M(de),de<0||de>=l)throw new Error(`Wrong integer: ${de}`)});;){let de=0,Ae=!0;for(let Re=Y;Re<ne.length;Re++){const Fe=ne[Re],be=l*de+Fe;if(!Number.isSafeInteger(be)||l*de/l!==de||be-Fe!=l*de)throw new Error("convertRadix: carry overflow");if(de=be%F,ne[Re]=Math.floor(be/F),!Number.isSafeInteger(ne[Re])||ne[Re]*F+de!==be)throw new Error("convertRadix: carry overflow");Ae&&(ne[Re]?Ae=!1:Y=Re)}if(W.push(de),Ae)break}for(let de=0;de<D.length-1&&0===D[de];de++)W.push(0);return W.reverse()}Object.defineProperty(J,"__esModule",{value:!0}),J.bytes=J.stringToBytes=J.str=J.bytesToString=J.hex=J.utf8=J.bech32m=J.bech32=J.base58check=J.base58xmr=J.base58xrp=J.base58flickr=J.base58=J.base64url=J.base64=J.base32crockford=J.base32hex=J.base32=J.base16=J.utils=J.assertNumber=void 0,J.assertNumber=M;const v=(D,l)=>l?v(l,D%l):D,y=(D,l)=>D+(l-v(D,l));function h(D,l,F,Y){if(!Array.isArray(D))throw new Error("convertRadix2: data should be array");if(l<=0||l>32)throw new Error(`convertRadix2: wrong from=${l}`);if(F<=0||F>32)throw new Error(`convertRadix2: wrong to=${F}`);if(y(l,F)>32)throw new Error(`convertRadix2: carry overflow from=${l} to=${F} carryBits=${y(l,F)}`);let W=0,ne=0;const de=2**F-1,Ae=[];for(const Re of D){if(M(Re),Re>=2**l)throw new Error(`convertRadix2: invalid data word=${Re} from=${l}`);if(W=W<<l|Re,ne+l>32)throw new Error(`convertRadix2: carry overflow pos=${ne} from=${l}`);for(ne+=l;ne>=F;ne-=F)Ae.push((W>>ne-F&de)>>>0);W&=2**ne-1}if(W=W<<F-ne&de,!Y&&ne>=l)throw new Error("Excess padding");if(!Y&&W)throw new Error(`Non-zero padding: ${W}`);return Y&&ne>0&&Ae.push(W>>>0),Ae}function x(D){return M(D),{encode:l=>{if(!(l instanceof Uint8Array))throw new Error("radix.encode input should be Uint8Array");return E(Array.from(l),256,D)},decode:l=>{if(!Array.isArray(l)||l.length&&"number"!=typeof l[0])throw new Error("radix.decode input should be array of strings");return Uint8Array.from(E(l,D,256))}}}function A(D,l=!1){if(M(D),D<=0||D>32)throw new Error("radix2: bits should be in (0..32]");if(y(8,D)>32||y(D,8)>32)throw new Error("radix2: carry overflow");return{encode:F=>{if(!(F instanceof Uint8Array))throw new Error("radix2.encode input should be Uint8Array");return h(Array.from(F),8,D,!l)},decode:F=>{if(!Array.isArray(F)||F.length&&"number"!=typeof F[0])throw new Error("radix2.decode input should be array of strings");return Uint8Array.from(h(F,D,8,l))}}}function H(D){if("function"!=typeof D)throw new Error("unsafeWrapper fn should be function");return function(...l){try{return D.apply(null,l)}catch{}}}function C(D,l){if(M(D),"function"!=typeof l)throw new Error("checksum fn should be function");return{encode(F){if(!(F instanceof Uint8Array))throw new Error("checksum.encode: input should be Uint8Array");const Y=l(F).slice(0,D),W=new Uint8Array(F.length+D);return W.set(F),W.set(Y,F.length),W},decode(F){if(!(F instanceof Uint8Array))throw new Error("checksum.decode: input should be Uint8Array");const Y=F.slice(0,-D),W=l(Y).slice(0,D),ne=F.slice(-D);for(let de=0;de<D;de++)if(W[de]!==ne[de])throw new Error("Invalid checksum");return Y}}}J.utils={alphabet:i,chain:s,checksum:C,radix:x,radix2:A,join:d,padding:c},J.base16=s(A(4),i("0123456789ABCDEF"),d("")),J.base32=s(A(5),i("ABCDEFGHIJKLMNOPQRSTUVWXYZ234567"),c(5),d("")),J.base32hex=s(A(5),i("0123456789ABCDEFGHIJKLMNOPQRSTUV"),c(5),d("")),J.base32crockford=s(A(5),i("0123456789ABCDEFGHJKMNPQRSTVWXYZ"),d(""),B(D=>D.toUpperCase().replace(/O/g,"0").replace(/[IL]/g,"1"))),J.base64=s(A(6),i("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),c(6),d("")),J.base64url=s(A(6),i("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"),c(6),d(""));const _=D=>s(x(58),i(D),d(""));J.base58=_("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"),J.base58flickr=_("123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"),J.base58xrp=_("rpshnaf39wBUDNEGHJKLM4PQRST7VWXYZ2bcdeCg65jkm8oFqi1tuvAxyz");const N=[0,2,3,5,6,7,9,10,11];J.base58xmr={encode(D){let l="";for(let F=0;F<D.length;F+=8){const Y=D.subarray(F,F+8);l+=J.base58.encode(Y).padStart(N[Y.length],"1")}return l},decode(D){let l=[];for(let F=0;F<D.length;F+=11){const Y=D.slice(F,F+11),W=N.indexOf(Y.length),ne=J.base58.decode(Y);for(let de=0;de<ne.length-W;de++)if(0!==ne[de])throw new Error("base58xmr: wrong padding");l=l.concat(Array.from(ne.slice(ne.length-W)))}return Uint8Array.from(l)}},J.base58check=D=>s(C(4,l=>D(D(l))),J.base58);const I=s(i("qpzry9x8gf2tvdw0s3jn54khce6mua7l"),d("")),p=[996825010,642813549,513874426,1027748829,705979059];function m(D){const l=D>>25;let F=(33554431&D)<<5;for(let Y=0;Y<p.length;Y++)1==(l>>Y&1)&&(F^=p[Y]);return F}function S(D,l,F=1){const Y=D.length;let W=1;for(let ne=0;ne<Y;ne++){const de=D.charCodeAt(ne);if(de<33||de>126)throw new Error(`Invalid prefix (${D})`);W=m(W)^de>>5}W=m(W);for(let ne=0;ne<Y;ne++)W=m(W)^31&D.charCodeAt(ne);for(let ne of l)W=m(W)^ne;for(let ne=0;ne<6;ne++)W=m(W);return W^=F,I.encode(h([W%2**30],30,5,!1))}function O(D){const l="bech32"===D?1:734539939,F=A(5),Y=F.decode,W=F.encode,ne=H(Y);function Ae(be,Pe=90){if("string"!=typeof be)throw new Error("bech32.decode input should be string, not "+typeof be);if(be.length<8||!1!==Pe&&be.length>Pe)throw new TypeError(`Wrong string length: ${be.length} (${be}). Expected (8..${Pe})`);const We=be.toLowerCase();if(be!==We&&be!==be.toUpperCase())throw new Error("String must be lowercase or uppercase");const Ze=(be=We).lastIndexOf("1");if(0===Ze||-1===Ze)throw new Error('Letter "1" must be present between prefix and data only');const Ct=be.slice(0,Ze),tt=be.slice(Ze+1);if(tt.length<6)throw new Error("Data must be at least 6 characters long");const Ht=I.decode(tt).slice(0,-6),ct=S(Ct,Ht,l);if(!tt.endsWith(ct))throw new Error(`Invalid checksum in ${be}: expected "${ct}"`);return{prefix:Ct,words:Ht}}return{encode:function de(be,Pe,We=90){if("string"!=typeof be)throw new Error("bech32.encode prefix should be string, not "+typeof be);if(!Array.isArray(Pe)||Pe.length&&"number"!=typeof Pe[0])throw new Error("bech32.encode words should be array of numbers, not "+typeof Pe);const Ze=be.length+7+Pe.length;if(!1!==We&&Ze>We)throw new TypeError(`Length ${Ze} exceeds limit ${We}`);return`${be=be.toLowerCase()}1${I.encode(Pe)}${S(be,Pe,l)}`},decode:Ae,decodeToBytes:function Fe(be){const{prefix:Pe,words:We}=Ae(be,!1);return{prefix:Pe,words:We,bytes:Y(We)}},decodeUnsafe:H(Ae),fromWords:Y,fromWordsUnsafe:ne,toWords:W}}J.bech32=O("bech32"),J.bech32m=O("bech32m"),J.utf8={encode:D=>(new TextDecoder).decode(D),decode:D=>(new TextEncoder).encode(D)},J.hex=s(A(4),i("0123456789abcdef"),d(""),B(D=>{if("string"!=typeof D||D.length%2)throw new TypeError(`hex.decode: expected string, got ${typeof D} with length ${D.length}`);return D.toLowerCase()}));const V={utf8:J.utf8,hex:J.hex,base16:J.base16,base32:J.base32,base64:J.base64,base64url:J.base64url,base58:J.base58,base58xmr:J.base58xmr},G=`Invalid encoding type. Available types: ${Object.keys(V).join(", ")}`;J.bytesToString=(D,l)=>{if("string"!=typeof D||!V.hasOwnProperty(D))throw new TypeError(G);if(!(l instanceof Uint8Array))throw new TypeError("bytesToString() expects Uint8Array");return V[D].encode(l)},J.str=J.bytesToString,J.stringToBytes=(D,l)=>{if(!V.hasOwnProperty(D))throw new TypeError(G);if("string"!=typeof l)throw new TypeError("stringToBytes() expects string");return V[D].decode(l)},J.bytes=J.stringToBytes},6837:(De,J,M)=>{"use strict";J.OF=void 0;const i=M(5182),c=(M(3332),M(8527)),E=(M(319),M(9303)),v=M(5521);function A(O){i.default.bytes(O,16,20,24,28,32)}J.OF=function H(O,V=128){if(i.default.number(V),V%32!=0||V>256)throw new TypeError("Invalid entropy");return function T(O,V){return A(O),_(V).encode(O).join((O=>"\u3042\u3044\u3053\u304f\u3057\u3093"===O[0])(V)?"\u3000":" ")}((0,E.randomBytes)(V/8),O)};const C=O=>{const V=8-O.length/4;return new Uint8Array([(0,c.sha256)(O)[0]>>V<<V])};function _(O){if(!Array.isArray(O)||2048!==O.length||"string"!=typeof O[0])throw new Error("Worlist: expected array of 2048 strings");return O.forEach(V=>{if("string"!=typeof V)throw new Error(`Wordlist: non-string element: ${V}`)}),v.utils.chain(v.utils.checksum(1,C),v.utils.radix2(11,!0),v.utils.alphabet(O))}},3439:(De,J)=>{"use strict";J.U=void 0,J.U="abandon\nability\nable\nabout\nabove\nabsent\nabsorb\nabstract\nabsurd\nabuse\naccess\naccident\naccount\naccuse\nachieve\nacid\nacoustic\nacquire\nacross\nact\naction\nactor\nactress\nactual\nadapt\nadd\naddict\naddress\nadjust\nadmit\nadult\nadvance\nadvice\naerobic\naffair\nafford\nafraid\nagain\nage\nagent\nagree\nahead\naim\nair\nairport\naisle\nalarm\nalbum\nalcohol\nalert\nalien\nall\nalley\nallow\nalmost\nalone\nalpha\nalready\nalso\nalter\nalways\namateur\namazing\namong\namount\namused\nanalyst\nanchor\nancient\nanger\nangle\nangry\nanimal\nankle\nannounce\nannual\nanother\nanswer\nantenna\nantique\nanxiety\nany\napart\napology\nappear\napple\napprove\napril\narch\narctic\narea\narena\nargue\narm\narmed\narmor\narmy\naround\narrange\narrest\narrive\narrow\nart\nartefact\nartist\nartwork\nask\naspect\nassault\nasset\nassist\nassume\nasthma\nathlete\natom\nattack\nattend\nattitude\nattract\nauction\naudit\naugust\naunt\nauthor\nauto\nautumn\naverage\navocado\navoid\nawake\naware\naway\nawesome\nawful\nawkward\naxis\nbaby\nbachelor\nbacon\nbadge\nbag\nbalance\nbalcony\nball\nbamboo\nbanana\nbanner\nbar\nbarely\nbargain\nbarrel\nbase\nbasic\nbasket\nbattle\nbeach\nbean\nbeauty\nbecause\nbecome\nbeef\nbefore\nbegin\nbehave\nbehind\nbelieve\nbelow\nbelt\nbench\nbenefit\nbest\nbetray\nbetter\nbetween\nbeyond\nbicycle\nbid\nbike\nbind\nbiology\nbird\nbirth\nbitter\nblack\nblade\nblame\nblanket\nblast\nbleak\nbless\nblind\nblood\nblossom\nblouse\nblue\nblur\nblush\nboard\nboat\nbody\nboil\nbomb\nbone\nbonus\nbook\nboost\nborder\nboring\nborrow\nboss\nbottom\nbounce\nbox\nboy\nbracket\nbrain\nbrand\nbrass\nbrave\nbread\nbreeze\nbrick\nbridge\nbrief\nbright\nbring\nbrisk\nbroccoli\nbroken\nbronze\nbroom\nbrother\nbrown\nbrush\nbubble\nbuddy\nbudget\nbuffalo\nbuild\nbulb\nbulk\nbullet\nbundle\nbunker\nburden\nburger\nburst\nbus\nbusiness\nbusy\nbutter\nbuyer\nbuzz\ncabbage\ncabin\ncable\ncactus\ncage\ncake\ncall\ncalm\ncamera\ncamp\ncan\ncanal\ncancel\ncandy\ncannon\ncanoe\ncanvas\ncanyon\ncapable\ncapital\ncaptain\ncar\ncarbon\ncard\ncargo\ncarpet\ncarry\ncart\ncase\ncash\ncasino\ncastle\ncasual\ncat\ncatalog\ncatch\ncategory\ncattle\ncaught\ncause\ncaution\ncave\nceiling\ncelery\ncement\ncensus\ncentury\ncereal\ncertain\nchair\nchalk\nchampion\nchange\nchaos\nchapter\ncharge\nchase\nchat\ncheap\ncheck\ncheese\nchef\ncherry\nchest\nchicken\nchief\nchild\nchimney\nchoice\nchoose\nchronic\nchuckle\nchunk\nchurn\ncigar\ncinnamon\ncircle\ncitizen\ncity\ncivil\nclaim\nclap\nclarify\nclaw\nclay\nclean\nclerk\nclever\nclick\nclient\ncliff\nclimb\nclinic\nclip\nclock\nclog\nclose\ncloth\ncloud\nclown\nclub\nclump\ncluster\nclutch\ncoach\ncoast\ncoconut\ncode\ncoffee\ncoil\ncoin\ncollect\ncolor\ncolumn\ncombine\ncome\ncomfort\ncomic\ncommon\ncompany\nconcert\nconduct\nconfirm\ncongress\nconnect\nconsider\ncontrol\nconvince\ncook\ncool\ncopper\ncopy\ncoral\ncore\ncorn\ncorrect\ncost\ncotton\ncouch\ncountry\ncouple\ncourse\ncousin\ncover\ncoyote\ncrack\ncradle\ncraft\ncram\ncrane\ncrash\ncrater\ncrawl\ncrazy\ncream\ncredit\ncreek\ncrew\ncricket\ncrime\ncrisp\ncritic\ncrop\ncross\ncrouch\ncrowd\ncrucial\ncruel\ncruise\ncrumble\ncrunch\ncrush\ncry\ncrystal\ncube\nculture\ncup\ncupboard\ncurious\ncurrent\ncurtain\ncurve\ncushion\ncustom\ncute\ncycle\ndad\ndamage\ndamp\ndance\ndanger\ndaring\ndash\ndaughter\ndawn\nday\ndeal\ndebate\ndebris\ndecade\ndecember\ndecide\ndecline\ndecorate\ndecrease\ndeer\ndefense\ndefine\ndefy\ndegree\ndelay\ndeliver\ndemand\ndemise\ndenial\ndentist\ndeny\ndepart\ndepend\ndeposit\ndepth\ndeputy\nderive\ndescribe\ndesert\ndesign\ndesk\ndespair\ndestroy\ndetail\ndetect\ndevelop\ndevice\ndevote\ndiagram\ndial\ndiamond\ndiary\ndice\ndiesel\ndiet\ndiffer\ndigital\ndignity\ndilemma\ndinner\ndinosaur\ndirect\ndirt\ndisagree\ndiscover\ndisease\ndish\ndismiss\ndisorder\ndisplay\ndistance\ndivert\ndivide\ndivorce\ndizzy\ndoctor\ndocument\ndog\ndoll\ndolphin\ndomain\ndonate\ndonkey\ndonor\ndoor\ndose\ndouble\ndove\ndraft\ndragon\ndrama\ndrastic\ndraw\ndream\ndress\ndrift\ndrill\ndrink\ndrip\ndrive\ndrop\ndrum\ndry\nduck\ndumb\ndune\nduring\ndust\ndutch\nduty\ndwarf\ndynamic\neager\neagle\nearly\nearn\nearth\neasily\neast\neasy\necho\necology\neconomy\nedge\nedit\neducate\neffort\negg\neight\neither\nelbow\nelder\nelectric\nelegant\nelement\nelephant\nelevator\nelite\nelse\nembark\nembody\nembrace\nemerge\nemotion\nemploy\nempower\nempty\nenable\nenact\nend\nendless\nendorse\nenemy\nenergy\nenforce\nengage\nengine\nenhance\nenjoy\nenlist\nenough\nenrich\nenroll\nensure\nenter\nentire\nentry\nenvelope\nepisode\nequal\nequip\nera\nerase\nerode\nerosion\nerror\nerupt\nescape\nessay\nessence\nestate\neternal\nethics\nevidence\nevil\nevoke\nevolve\nexact\nexample\nexcess\nexchange\nexcite\nexclude\nexcuse\nexecute\nexercise\nexhaust\nexhibit\nexile\nexist\nexit\nexotic\nexpand\nexpect\nexpire\nexplain\nexpose\nexpress\nextend\nextra\neye\neyebrow\nfabric\nface\nfaculty\nfade\nfaint\nfaith\nfall\nfalse\nfame\nfamily\nfamous\nfan\nfancy\nfantasy\nfarm\nfashion\nfat\nfatal\nfather\nfatigue\nfault\nfavorite\nfeature\nfebruary\nfederal\nfee\nfeed\nfeel\nfemale\nfence\nfestival\nfetch\nfever\nfew\nfiber\nfiction\nfield\nfigure\nfile\nfilm\nfilter\nfinal\nfind\nfine\nfinger\nfinish\nfire\nfirm\nfirst\nfiscal\nfish\nfit\nfitness\nfix\nflag\nflame\nflash\nflat\nflavor\nflee\nflight\nflip\nfloat\nflock\nfloor\nflower\nfluid\nflush\nfly\nfoam\nfocus\nfog\nfoil\nfold\nfollow\nfood\nfoot\nforce\nforest\nforget\nfork\nfortune\nforum\nforward\nfossil\nfoster\nfound\nfox\nfragile\nframe\nfrequent\nfresh\nfriend\nfringe\nfrog\nfront\nfrost\nfrown\nfrozen\nfruit\nfuel\nfun\nfunny\nfurnace\nfury\nfuture\ngadget\ngain\ngalaxy\ngallery\ngame\ngap\ngarage\ngarbage\ngarden\ngarlic\ngarment\ngas\ngasp\ngate\ngather\ngauge\ngaze\ngeneral\ngenius\ngenre\ngentle\ngenuine\ngesture\nghost\ngiant\ngift\ngiggle\nginger\ngiraffe\ngirl\ngive\nglad\nglance\nglare\nglass\nglide\nglimpse\nglobe\ngloom\nglory\nglove\nglow\nglue\ngoat\ngoddess\ngold\ngood\ngoose\ngorilla\ngospel\ngossip\ngovern\ngown\ngrab\ngrace\ngrain\ngrant\ngrape\ngrass\ngravity\ngreat\ngreen\ngrid\ngrief\ngrit\ngrocery\ngroup\ngrow\ngrunt\nguard\nguess\nguide\nguilt\nguitar\ngun\ngym\nhabit\nhair\nhalf\nhammer\nhamster\nhand\nhappy\nharbor\nhard\nharsh\nharvest\nhat\nhave\nhawk\nhazard\nhead\nhealth\nheart\nheavy\nhedgehog\nheight\nhello\nhelmet\nhelp\nhen\nhero\nhidden\nhigh\nhill\nhint\nhip\nhire\nhistory\nhobby\nhockey\nhold\nhole\nholiday\nhollow\nhome\nhoney\nhood\nhope\nhorn\nhorror\nhorse\nhospital\nhost\nhotel\nhour\nhover\nhub\nhuge\nhuman\nhumble\nhumor\nhundred\nhungry\nhunt\nhurdle\nhurry\nhurt\nhusband\nhybrid\nice\nicon\nidea\nidentify\nidle\nignore\nill\nillegal\nillness\nimage\nimitate\nimmense\nimmune\nimpact\nimpose\nimprove\nimpulse\ninch\ninclude\nincome\nincrease\nindex\nindicate\nindoor\nindustry\ninfant\ninflict\ninform\ninhale\ninherit\ninitial\ninject\ninjury\ninmate\ninner\ninnocent\ninput\ninquiry\ninsane\ninsect\ninside\ninspire\ninstall\nintact\ninterest\ninto\ninvest\ninvite\ninvolve\niron\nisland\nisolate\nissue\nitem\nivory\njacket\njaguar\njar\njazz\njealous\njeans\njelly\njewel\njob\njoin\njoke\njourney\njoy\njudge\njuice\njump\njungle\njunior\njunk\njust\nkangaroo\nkeen\nkeep\nketchup\nkey\nkick\nkid\nkidney\nkind\nkingdom\nkiss\nkit\nkitchen\nkite\nkitten\nkiwi\nknee\nknife\nknock\nknow\nlab\nlabel\nlabor\nladder\nlady\nlake\nlamp\nlanguage\nlaptop\nlarge\nlater\nlatin\nlaugh\nlaundry\nlava\nlaw\nlawn\nlawsuit\nlayer\nlazy\nleader\nleaf\nlearn\nleave\nlecture\nleft\nleg\nlegal\nlegend\nleisure\nlemon\nlend\nlength\nlens\nleopard\nlesson\nletter\nlevel\nliar\nliberty\nlibrary\nlicense\nlife\nlift\nlight\nlike\nlimb\nlimit\nlink\nlion\nliquid\nlist\nlittle\nlive\nlizard\nload\nloan\nlobster\nlocal\nlock\nlogic\nlonely\nlong\nloop\nlottery\nloud\nlounge\nlove\nloyal\nlucky\nluggage\nlumber\nlunar\nlunch\nluxury\nlyrics\nmachine\nmad\nmagic\nmagnet\nmaid\nmail\nmain\nmajor\nmake\nmammal\nman\nmanage\nmandate\nmango\nmansion\nmanual\nmaple\nmarble\nmarch\nmargin\nmarine\nmarket\nmarriage\nmask\nmass\nmaster\nmatch\nmaterial\nmath\nmatrix\nmatter\nmaximum\nmaze\nmeadow\nmean\nmeasure\nmeat\nmechanic\nmedal\nmedia\nmelody\nmelt\nmember\nmemory\nmention\nmenu\nmercy\nmerge\nmerit\nmerry\nmesh\nmessage\nmetal\nmethod\nmiddle\nmidnight\nmilk\nmillion\nmimic\nmind\nminimum\nminor\nminute\nmiracle\nmirror\nmisery\nmiss\nmistake\nmix\nmixed\nmixture\nmobile\nmodel\nmodify\nmom\nmoment\nmonitor\nmonkey\nmonster\nmonth\nmoon\nmoral\nmore\nmorning\nmosquito\nmother\nmotion\nmotor\nmountain\nmouse\nmove\nmovie\nmuch\nmuffin\nmule\nmultiply\nmuscle\nmuseum\nmushroom\nmusic\nmust\nmutual\nmyself\nmystery\nmyth\nnaive\nname\nnapkin\nnarrow\nnasty\nnation\nnature\nnear\nneck\nneed\nnegative\nneglect\nneither\nnephew\nnerve\nnest\nnet\nnetwork\nneutral\nnever\nnews\nnext\nnice\nnight\nnoble\nnoise\nnominee\nnoodle\nnormal\nnorth\nnose\nnotable\nnote\nnothing\nnotice\nnovel\nnow\nnuclear\nnumber\nnurse\nnut\noak\nobey\nobject\noblige\nobscure\nobserve\nobtain\nobvious\noccur\nocean\noctober\nodor\noff\noffer\noffice\noften\noil\nokay\nold\nolive\nolympic\nomit\nonce\none\nonion\nonline\nonly\nopen\nopera\nopinion\noppose\noption\norange\norbit\norchard\norder\nordinary\norgan\norient\noriginal\norphan\nostrich\nother\noutdoor\nouter\noutput\noutside\noval\noven\nover\nown\nowner\noxygen\noyster\nozone\npact\npaddle\npage\npair\npalace\npalm\npanda\npanel\npanic\npanther\npaper\nparade\nparent\npark\nparrot\nparty\npass\npatch\npath\npatient\npatrol\npattern\npause\npave\npayment\npeace\npeanut\npear\npeasant\npelican\npen\npenalty\npencil\npeople\npepper\nperfect\npermit\nperson\npet\nphone\nphoto\nphrase\nphysical\npiano\npicnic\npicture\npiece\npig\npigeon\npill\npilot\npink\npioneer\npipe\npistol\npitch\npizza\nplace\nplanet\nplastic\nplate\nplay\nplease\npledge\npluck\nplug\nplunge\npoem\npoet\npoint\npolar\npole\npolice\npond\npony\npool\npopular\nportion\nposition\npossible\npost\npotato\npottery\npoverty\npowder\npower\npractice\npraise\npredict\nprefer\nprepare\npresent\npretty\nprevent\nprice\npride\nprimary\nprint\npriority\nprison\nprivate\nprize\nproblem\nprocess\nproduce\nprofit\nprogram\nproject\npromote\nproof\nproperty\nprosper\nprotect\nproud\nprovide\npublic\npudding\npull\npulp\npulse\npumpkin\npunch\npupil\npuppy\npurchase\npurity\npurpose\npurse\npush\nput\npuzzle\npyramid\nquality\nquantum\nquarter\nquestion\nquick\nquit\nquiz\nquote\nrabbit\nraccoon\nrace\nrack\nradar\nradio\nrail\nrain\nraise\nrally\nramp\nranch\nrandom\nrange\nrapid\nrare\nrate\nrather\nraven\nraw\nrazor\nready\nreal\nreason\nrebel\nrebuild\nrecall\nreceive\nrecipe\nrecord\nrecycle\nreduce\nreflect\nreform\nrefuse\nregion\nregret\nregular\nreject\nrelax\nrelease\nrelief\nrely\nremain\nremember\nremind\nremove\nrender\nrenew\nrent\nreopen\nrepair\nrepeat\nreplace\nreport\nrequire\nrescue\nresemble\nresist\nresource\nresponse\nresult\nretire\nretreat\nreturn\nreunion\nreveal\nreview\nreward\nrhythm\nrib\nribbon\nrice\nrich\nride\nridge\nrifle\nright\nrigid\nring\nriot\nripple\nrisk\nritual\nrival\nriver\nroad\nroast\nrobot\nrobust\nrocket\nromance\nroof\nrookie\nroom\nrose\nrotate\nrough\nround\nroute\nroyal\nrubber\nrude\nrug\nrule\nrun\nrunway\nrural\nsad\nsaddle\nsadness\nsafe\nsail\nsalad\nsalmon\nsalon\nsalt\nsalute\nsame\nsample\nsand\nsatisfy\nsatoshi\nsauce\nsausage\nsave\nsay\nscale\nscan\nscare\nscatter\nscene\nscheme\nschool\nscience\nscissors\nscorpion\nscout\nscrap\nscreen\nscript\nscrub\nsea\nsearch\nseason\nseat\nsecond\nsecret\nsection\nsecurity\nseed\nseek\nsegment\nselect\nsell\nseminar\nsenior\nsense\nsentence\nseries\nservice\nsession\nsettle\nsetup\nseven\nshadow\nshaft\nshallow\nshare\nshed\nshell\nsheriff\nshield\nshift\nshine\nship\nshiver\nshock\nshoe\nshoot\nshop\nshort\nshoulder\nshove\nshrimp\nshrug\nshuffle\nshy\nsibling\nsick\nside\nsiege\nsight\nsign\nsilent\nsilk\nsilly\nsilver\nsimilar\nsimple\nsince\nsing\nsiren\nsister\nsituate\nsix\nsize\nskate\nsketch\nski\nskill\nskin\nskirt\nskull\nslab\nslam\nsleep\nslender\nslice\nslide\nslight\nslim\nslogan\nslot\nslow\nslush\nsmall\nsmart\nsmile\nsmoke\nsmooth\nsnack\nsnake\nsnap\nsniff\nsnow\nsoap\nsoccer\nsocial\nsock\nsoda\nsoft\nsolar\nsoldier\nsolid\nsolution\nsolve\nsomeone\nsong\nsoon\nsorry\nsort\nsoul\nsound\nsoup\nsource\nsouth\nspace\nspare\nspatial\nspawn\nspeak\nspecial\nspeed\nspell\nspend\nsphere\nspice\nspider\nspike\nspin\nspirit\nsplit\nspoil\nsponsor\nspoon\nsport\nspot\nspray\nspread\nspring\nspy\nsquare\nsqueeze\nsquirrel\nstable\nstadium\nstaff\nstage\nstairs\nstamp\nstand\nstart\nstate\nstay\nsteak\nsteel\nstem\nstep\nstereo\nstick\nstill\nsting\nstock\nstomach\nstone\nstool\nstory\nstove\nstrategy\nstreet\nstrike\nstrong\nstruggle\nstudent\nstuff\nstumble\nstyle\nsubject\nsubmit\nsubway\nsuccess\nsuch\nsudden\nsuffer\nsugar\nsuggest\nsuit\nsummer\nsun\nsunny\nsunset\nsuper\nsupply\nsupreme\nsure\nsurface\nsurge\nsurprise\nsurround\nsurvey\nsuspect\nsustain\nswallow\nswamp\nswap\nswarm\nswear\nsweet\nswift\nswim\nswing\nswitch\nsword\nsymbol\nsymptom\nsyrup\nsystem\ntable\ntackle\ntag\ntail\ntalent\ntalk\ntank\ntape\ntarget\ntask\ntaste\ntattoo\ntaxi\nteach\nteam\ntell\nten\ntenant\ntennis\ntent\nterm\ntest\ntext\nthank\nthat\ntheme\nthen\ntheory\nthere\nthey\nthing\nthis\nthought\nthree\nthrive\nthrow\nthumb\nthunder\nticket\ntide\ntiger\ntilt\ntimber\ntime\ntiny\ntip\ntired\ntissue\ntitle\ntoast\ntobacco\ntoday\ntoddler\ntoe\ntogether\ntoilet\ntoken\ntomato\ntomorrow\ntone\ntongue\ntonight\ntool\ntooth\ntop\ntopic\ntopple\ntorch\ntornado\ntortoise\ntoss\ntotal\ntourist\ntoward\ntower\ntown\ntoy\ntrack\ntrade\ntraffic\ntragic\ntrain\ntransfer\ntrap\ntrash\ntravel\ntray\ntreat\ntree\ntrend\ntrial\ntribe\ntrick\ntrigger\ntrim\ntrip\ntrophy\ntrouble\ntruck\ntrue\ntruly\ntrumpet\ntrust\ntruth\ntry\ntube\ntuition\ntumble\ntuna\ntunnel\nturkey\nturn\nturtle\ntwelve\ntwenty\ntwice\ntwin\ntwist\ntwo\ntype\ntypical\nugly\numbrella\nunable\nunaware\nuncle\nuncover\nunder\nundo\nunfair\nunfold\nunhappy\nuniform\nunique\nunit\nuniverse\nunknown\nunlock\nuntil\nunusual\nunveil\nupdate\nupgrade\nuphold\nupon\nupper\nupset\nurban\nurge\nusage\nuse\nused\nuseful\nuseless\nusual\nutility\nvacant\nvacuum\nvague\nvalid\nvalley\nvalve\nvan\nvanish\nvapor\nvarious\nvast\nvault\nvehicle\nvelvet\nvendor\nventure\nvenue\nverb\nverify\nversion\nvery\nvessel\nveteran\nviable\nvibrant\nvicious\nvictory\nvideo\nview\nvillage\nvintage\nviolin\nvirtual\nvirus\nvisa\nvisit\nvisual\nvital\nvivid\nvocal\nvoice\nvoid\nvolcano\nvolume\nvote\nvoyage\nwage\nwagon\nwait\nwalk\nwall\nwalnut\nwant\nwarfare\nwarm\nwarrior\nwash\nwasp\nwaste\nwater\nwave\nway\nwealth\nweapon\nwear\nweasel\nweather\nweb\nwedding\nweekend\nweird\nwelcome\nwest\nwet\nwhale\nwhat\nwheat\nwheel\nwhen\nwhere\nwhip\nwhisper\nwide\nwidth\nwife\nwild\nwill\nwin\nwindow\nwine\nwing\nwink\nwinner\nwinter\nwire\nwisdom\nwise\nwish\nwitness\nwolf\nwoman\nwonder\nwood\nwool\nword\nwork\nworld\nworry\nworth\nwrap\nwreck\nwrestle\nwrist\nwrite\nwrong\nyard\nyear\nyellow\nyou\nyoung\nyouth\nzebra\nzero\nzone\nzoo".split("\n")},7466:function(De,J,M){var s;De.exports=(s=M(7585),M(8319),M(9493),M(7865),M(3057),function(){var i=s,c=i.lib.BlockCipher,B=i.algo,E=[],v=[],y=[],h=[],x=[],A=[],H=[],C=[],_=[],N=[];!function(){for(var p=[],m=0;m<256;m++)p[m]=m<128?m<<1:m<<1^283;var S=0,O=0;for(m=0;m<256;m++){var V=O^O<<1^O<<2^O<<3^O<<4;E[S]=V=V>>>8^255&V^99,v[V]=S;var D,G=p[S],k=p[G],P=p[k];y[S]=(D=257*p[V]^16843008*V)<<24|D>>>8,h[S]=D<<16|D>>>16,x[S]=D<<8|D>>>24,A[S]=D,H[V]=(D=16843009*P^65537*k^257*G^16843008*S)<<24|D>>>8,C[V]=D<<16|D>>>16,_[V]=D<<8|D>>>24,N[V]=D,S?(S=G^p[p[p[P^G]]],O^=p[p[O]]):S=O=1}}();var T=[0,1,2,4,8,16,32,64,128,27,54],I=B.AES=c.extend({_doReset:function(){if(!this._nRounds||this._keyPriorReset!==this._key){for(var m=this._keyPriorReset=this._key,S=m.words,O=m.sigBytes/4,G=4*((this._nRounds=O+6)+1),k=this._keySchedule=[],P=0;P<G;P++)P<O?k[P]=S[P]:(p=k[P-1],P%O?O>6&&P%O==4&&(p=E[p>>>24]<<24|E[p>>>16&255]<<16|E[p>>>8&255]<<8|E[255&p]):(p=E[(p=p<<8|p>>>24)>>>24]<<24|E[p>>>16&255]<<16|E[p>>>8&255]<<8|E[255&p],p^=T[P/O|0]<<24),k[P]=k[P-O]^p);for(var D=this._invKeySchedule=[],l=0;l<G;l++){if(P=G-l,l%4)var p=k[P];else p=k[P-4];D[l]=l<4||P<=4?p:H[E[p>>>24]]^C[E[p>>>16&255]]^_[E[p>>>8&255]]^N[E[255&p]]}}},encryptBlock:function(p,m){this._doCryptBlock(p,m,this._keySchedule,y,h,x,A,E)},decryptBlock:function(p,m){var S=p[m+1];p[m+1]=p[m+3],p[m+3]=S,this._doCryptBlock(p,m,this._invKeySchedule,H,C,_,N,v),S=p[m+1],p[m+1]=p[m+3],p[m+3]=S},_doCryptBlock:function(p,m,S,O,V,G,k,P){for(var D=this._nRounds,l=p[m]^S[0],F=p[m+1]^S[1],Y=p[m+2]^S[2],W=p[m+3]^S[3],ne=4,de=1;de<D;de++){var Ae=O[l>>>24]^V[F>>>16&255]^G[Y>>>8&255]^k[255&W]^S[ne++],Re=O[F>>>24]^V[Y>>>16&255]^G[W>>>8&255]^k[255&l]^S[ne++],Fe=O[Y>>>24]^V[W>>>16&255]^G[l>>>8&255]^k[255&F]^S[ne++],be=O[W>>>24]^V[l>>>16&255]^G[F>>>8&255]^k[255&Y]^S[ne++];l=Ae,F=Re,Y=Fe,W=be}Ae=(P[l>>>24]<<24|P[F>>>16&255]<<16|P[Y>>>8&255]<<8|P[255&W])^S[ne++],Re=(P[F>>>24]<<24|P[Y>>>16&255]<<16|P[W>>>8&255]<<8|P[255&l])^S[ne++],Fe=(P[Y>>>24]<<24|P[W>>>16&255]<<16|P[l>>>8&255]<<8|P[255&F])^S[ne++],be=(P[W>>>24]<<24|P[l>>>16&255]<<16|P[F>>>8&255]<<8|P[255&Y])^S[ne++],p[m]=Ae,p[m+1]=Re,p[m+2]=Fe,p[m+3]=be},keySize:8});i.AES=c._createHelper(I)}(),s.AES)},3057:function(De,J,M){var d,c,B,E,v,y,x,H,C,N,T,I,m,O,G,k,D,l,s;De.exports=(s=M(7585),M(7865),void(s.lib.Cipher||(d=s,c=d.lib,B=c.Base,E=c.WordArray,v=c.BufferedBlockAlgorithm,y=d.enc,x=y.Base64,H=d.algo.EvpKDF,C=c.Cipher=v.extend({cfg:B.extend(),createEncryptor:function(F,Y){return this.create(this._ENC_XFORM_MODE,F,Y)},createDecryptor:function(F,Y){return this.create(this._DEC_XFORM_MODE,F,Y)},init:function(F,Y,W){this.cfg=this.cfg.extend(W),this._xformMode=F,this._key=Y,this.reset()},reset:function(){v.reset.call(this),this._doReset()},process:function(F){return this._append(F),this._process()},finalize:function(F){return F&&this._append(F),this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(){function F(Y){return"string"==typeof Y?l:k}return function(Y){return{encrypt:function(W,ne,de){return F(ne).encrypt(Y,W,ne,de)},decrypt:function(W,ne,de){return F(ne).decrypt(Y,W,ne,de)}}}}()}),c.StreamCipher=C.extend({_doFinalize:function(){return this._process(!0)},blockSize:1}),N=d.mode={},T=c.BlockCipherMode=B.extend({createEncryptor:function(F,Y){return this.Encryptor.create(F,Y)},createDecryptor:function(F,Y){return this.Decryptor.create(F,Y)},init:function(F,Y){this._cipher=F,this._iv=Y}}),I=N.CBC=function(){var F=T.extend();function Y(W,ne,de){var Ae,Re=this._iv;Re?(Ae=Re,this._iv=undefined):Ae=this._prevBlock;for(var Fe=0;Fe<de;Fe++)W[ne+Fe]^=Ae[Fe]}return F.Encryptor=F.extend({processBlock:function(W,ne){var de=this._cipher,Ae=de.blockSize;Y.call(this,W,ne,Ae),de.encryptBlock(W,ne),this._prevBlock=W.slice(ne,ne+Ae)}}),F.Decryptor=F.extend({processBlock:function(W,ne){var de=this._cipher,Ae=de.blockSize,Re=W.slice(ne,ne+Ae);de.decryptBlock(W,ne),Y.call(this,W,ne,Ae),this._prevBlock=Re}}),F}(),m=(d.pad={}).Pkcs7={pad:function(F,Y){for(var W=4*Y,ne=W-F.sigBytes%W,de=ne<<24|ne<<16|ne<<8|ne,Ae=[],Re=0;Re<ne;Re+=4)Ae.push(de);var Fe=E.create(Ae,ne);F.concat(Fe)},unpad:function(F){F.sigBytes-=255&F.words[F.sigBytes-1>>>2]}},c.BlockCipher=C.extend({cfg:C.cfg.extend({mode:I,padding:m}),reset:function(){var F;C.reset.call(this);var Y=this.cfg,W=Y.iv,ne=Y.mode;this._xformMode==this._ENC_XFORM_MODE?F=ne.createEncryptor:(F=ne.createDecryptor,this._minBufferSize=1),this._mode&&this._mode.__creator==F?this._mode.init(this,W&&W.words):(this._mode=F.call(ne,this,W&&W.words),this._mode.__creator=F)},_doProcessBlock:function(F,Y){this._mode.processBlock(F,Y)},_doFinalize:function(){var F,Y=this.cfg.padding;return this._xformMode==this._ENC_XFORM_MODE?(Y.pad(this._data,this.blockSize),F=this._process(!0)):(F=this._process(!0),Y.unpad(F)),F},blockSize:4}),O=c.CipherParams=B.extend({init:function(F){this.mixIn(F)},toString:function(F){return(F||this.formatter).stringify(this)}}),G=(d.format={}).OpenSSL={stringify:function(F){var W=F.ciphertext,ne=F.salt;return(ne?E.create([1398893684,1701076831]).concat(ne).concat(W):W).toString(x)},parse:function(F){var Y,W=x.parse(F),ne=W.words;return 1398893684==ne[0]&&1701076831==ne[1]&&(Y=E.create(ne.slice(2,4)),ne.splice(0,4),W.sigBytes-=16),O.create({ciphertext:W,salt:Y})}},k=c.SerializableCipher=B.extend({cfg:B.extend({format:G}),encrypt:function(F,Y,W,ne){ne=this.cfg.extend(ne);var de=F.createEncryptor(W,ne),Ae=de.finalize(Y),Re=de.cfg;return O.create({ciphertext:Ae,key:W,iv:Re.iv,algorithm:F,mode:Re.mode,padding:Re.padding,blockSize:F.blockSize,formatter:ne.format})},decrypt:function(F,Y,W,ne){return ne=this.cfg.extend(ne),Y=this._parse(Y,ne.format),F.createDecryptor(W,ne).finalize(Y.ciphertext)},_parse:function(F,Y){return"string"==typeof F?Y.parse(F,this):F}}),D=(d.kdf={}).OpenSSL={execute:function(F,Y,W,ne){ne||(ne=E.random(8));var de=H.create({keySize:Y+W}).compute(F,ne),Ae=E.create(de.words.slice(Y),4*W);return de.sigBytes=4*Y,O.create({key:de,iv:Ae,salt:ne})}},l=c.PasswordBasedCipher=k.extend({cfg:k.cfg.extend({kdf:D}),encrypt:function(F,Y,W,ne){var de=(ne=this.cfg.extend(ne)).kdf.execute(W,F.keySize,F.ivSize);ne.iv=de.iv;var Ae=k.encrypt.call(this,F,Y,de.key,ne);return Ae.mixIn(de),Ae},decrypt:function(F,Y,W,ne){ne=this.cfg.extend(ne),Y=this._parse(Y,ne.format);var de=ne.kdf.execute(W,F.keySize,F.ivSize,Y.salt);return ne.iv=de.iv,k.decrypt.call(this,F,Y,de.key,ne)}}))))},7585:function(De,J,M){var s;De.exports=(s=s||function(i,d){var c;if(typeof window<"u"&&window.crypto&&(c=window.crypto),typeof self<"u"&&self.crypto&&(c=self.crypto),typeof globalThis<"u"&&globalThis.crypto&&(c=globalThis.crypto),!c&&typeof window<"u"&&window.msCrypto&&(c=window.msCrypto),!c&&typeof global<"u"&&global.crypto&&(c=global.crypto),!c)try{c=M(2480)}catch{}var B=function(){if(c){if("function"==typeof c.getRandomValues)try{return c.getRandomValues(new Uint32Array(1))[0]}catch{}if("function"==typeof c.randomBytes)try{return c.randomBytes(4).readInt32LE()}catch{}}throw new Error("Native crypto module could not be used to get secure random number.")},E=Object.create||function(){function p(){}return function(m){var S;return p.prototype=m,S=new p,p.prototype=null,S}}(),v={},y=v.lib={},h=y.Base={extend:function(p){var m=E(this);return p&&m.mixIn(p),(!m.hasOwnProperty("init")||this.init===m.init)&&(m.init=function(){m.$super.init.apply(this,arguments)}),m.init.prototype=m,m.$super=this,m},create:function(){var p=this.extend();return p.init.apply(p,arguments),p},init:function(){},mixIn:function(p){for(var m in p)p.hasOwnProperty(m)&&(this[m]=p[m]);p.hasOwnProperty("toString")&&(this.toString=p.toString)},clone:function(){return this.init.prototype.extend(this)}},x=y.WordArray=h.extend({init:function(p,m){p=this.words=p||[],this.sigBytes=null!=m?m:4*p.length},toString:function(p){return(p||H).stringify(this)},concat:function(p){var m=this.words,S=p.words,O=this.sigBytes,V=p.sigBytes;if(this.clamp(),O%4)for(var G=0;G<V;G++)m[O+G>>>2]|=(S[G>>>2]>>>24-G%4*8&255)<<24-(O+G)%4*8;else for(var P=0;P<V;P+=4)m[O+P>>>2]=S[P>>>2];return this.sigBytes+=V,this},clamp:function(){var p=this.words,m=this.sigBytes;p[m>>>2]&=4294967295<<32-m%4*8,p.length=i.ceil(m/4)},clone:function(){var p=h.clone.call(this);return p.words=this.words.slice(0),p},random:function(p){for(var m=[],S=0;S<p;S+=4)m.push(B());return new x.init(m,p)}}),A=v.enc={},H=A.Hex={stringify:function(p){for(var m=p.words,S=p.sigBytes,O=[],V=0;V<S;V++){var G=m[V>>>2]>>>24-V%4*8&255;O.push((G>>>4).toString(16)),O.push((15&G).toString(16))}return O.join("")},parse:function(p){for(var m=p.length,S=[],O=0;O<m;O+=2)S[O>>>3]|=parseInt(p.substr(O,2),16)<<24-O%8*4;return new x.init(S,m/2)}},C=A.Latin1={stringify:function(p){for(var m=p.words,S=p.sigBytes,O=[],V=0;V<S;V++)O.push(String.fromCharCode(m[V>>>2]>>>24-V%4*8&255));return O.join("")},parse:function(p){for(var m=p.length,S=[],O=0;O<m;O++)S[O>>>2]|=(255&p.charCodeAt(O))<<24-O%4*8;return new x.init(S,m)}},_=A.Utf8={stringify:function(p){try{return decodeURIComponent(escape(C.stringify(p)))}catch{throw new Error("Malformed UTF-8 data")}},parse:function(p){return C.parse(unescape(encodeURIComponent(p)))}},N=y.BufferedBlockAlgorithm=h.extend({reset:function(){this._data=new x.init,this._nDataBytes=0},_append:function(p){"string"==typeof p&&(p=_.parse(p)),this._data.concat(p),this._nDataBytes+=p.sigBytes},_process:function(p){var m,S=this._data,O=S.words,V=S.sigBytes,G=this.blockSize,P=V/(4*G),D=(P=p?i.ceil(P):i.max((0|P)-this._minBufferSize,0))*G,l=i.min(4*D,V);if(D){for(var F=0;F<D;F+=G)this._doProcessBlock(O,F);m=O.splice(0,D),S.sigBytes-=l}return new x.init(m,l)},clone:function(){var p=h.clone.call(this);return p._data=this._data.clone(),p},_minBufferSize:0}),I=(y.Hasher=N.extend({cfg:h.extend(),init:function(p){this.cfg=this.cfg.extend(p),this.reset()},reset:function(){N.reset.call(this),this._doReset()},update:function(p){return this._append(p),this._process(),this},finalize:function(p){return p&&this._append(p),this._doFinalize()},blockSize:16,_createHelper:function(p){return function(m,S){return new p.init(S).finalize(m)}},_createHmacHelper:function(p){return function(m,S){return new I.HMAC.init(p,S).finalize(m)}}}),v.algo={});return v}(Math),s)},8319:function(De,J,M){var s,c;De.exports=(s=M(7585),c=s.lib.WordArray,s.enc.Base64={stringify:function(y){var h=y.words,x=y.sigBytes,A=this._map;y.clamp();for(var H=[],C=0;C<x;C+=3)for(var I=(h[C>>>2]>>>24-C%4*8&255)<<16|(h[C+1>>>2]>>>24-(C+1)%4*8&255)<<8|h[C+2>>>2]>>>24-(C+2)%4*8&255,p=0;p<4&&C+.75*p<x;p++)H.push(A.charAt(I>>>6*(3-p)&63));var m=A.charAt(64);if(m)for(;H.length%4;)H.push(m);return H.join("")},parse:function(y){var h=y.length,x=this._map,A=this._reverseMap;if(!A){A=this._reverseMap=[];for(var H=0;H<x.length;H++)A[x.charCodeAt(H)]=H}var C=x.charAt(64);if(C){var _=y.indexOf(C);-1!==_&&(h=_)}return function v(y,h,x){for(var A=[],H=0,C=0;C<h;C++)if(C%4){var _=x[y.charCodeAt(C-1)]<<C%4*2,N=x[y.charCodeAt(C)]>>>6-C%4*2;A[H>>>2]|=(_|N)<<24-H%4*8,H++}return c.create(A,H)}(y,h,A)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="},s.enc.Base64)},4410:function(De,J,M){var s,c;De.exports=(s=M(7585),c=s.lib.WordArray,s.enc.Base64url={stringify:function(y,h=!0){var x=y.words,A=y.sigBytes,H=h?this._safe_map:this._map;y.clamp();for(var C=[],_=0;_<A;_+=3)for(var p=(x[_>>>2]>>>24-_%4*8&255)<<16|(x[_+1>>>2]>>>24-(_+1)%4*8&255)<<8|x[_+2>>>2]>>>24-(_+2)%4*8&255,m=0;m<4&&_+.75*m<A;m++)C.push(H.charAt(p>>>6*(3-m)&63));var S=H.charAt(64);if(S)for(;C.length%4;)C.push(S);return C.join("")},parse:function(y,h=!0){var x=y.length,A=h?this._safe_map:this._map,H=this._reverseMap;if(!H){H=this._reverseMap=[];for(var C=0;C<A.length;C++)H[A.charCodeAt(C)]=C}var _=A.charAt(64);if(_){var N=y.indexOf(_);-1!==N&&(x=N)}return function v(y,h,x){for(var A=[],H=0,C=0;C<h;C++)if(C%4){var _=x[y.charCodeAt(C-1)]<<C%4*2,N=x[y.charCodeAt(C)]>>>6-C%4*2;A[H>>>2]|=(_|N)<<24-H%4*8,H++}return c.create(A,H)}(y,x,H)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",_safe_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"},s.enc.Base64url)},9012:function(De,J,M){var s;De.exports=(s=M(7585),function(){var c=s.lib.WordArray,B=s.enc;function v(y){return y<<8&4278255360|y>>>8&16711935}B.Utf16=B.Utf16BE={stringify:function(y){for(var h=y.words,x=y.sigBytes,A=[],H=0;H<x;H+=2)A.push(String.fromCharCode(h[H>>>2]>>>16-H%4*8&65535));return A.join("")},parse:function(y){for(var h=y.length,x=[],A=0;A<h;A++)x[A>>>1]|=y.charCodeAt(A)<<16-A%2*16;return c.create(x,2*h)}},B.Utf16LE={stringify:function(y){for(var h=y.words,x=y.sigBytes,A=[],H=0;H<x;H+=2){var C=v(h[H>>>2]>>>16-H%4*8&65535);A.push(String.fromCharCode(C))}return A.join("")},parse:function(y){for(var h=y.length,x=[],A=0;A<h;A++)x[A>>>1]|=v(y.charCodeAt(A)<<16-A%2*16);return c.create(x,2*h)}}}(),s.enc.Utf16)},7865:function(De,J,M){var i,d,c,B,E,y,s;De.exports=(s=M(7585),M(5162),M(3764),B=(d=(i=s).lib).WordArray,y=(E=i.algo).EvpKDF=(c=d.Base).extend({cfg:c.extend({keySize:4,hasher:E.MD5,iterations:1}),init:function(h){this.cfg=this.cfg.extend(h)},compute:function(h,x){for(var A,H=this.cfg,C=H.hasher.create(),_=B.create(),N=_.words,T=H.keySize,I=H.iterations;N.length<T;){A&&C.update(A),A=C.update(h).finalize(x),C.reset();for(var p=1;p<I;p++)A=C.finalize(A),C.reset();_.concat(A)}return _.sigBytes=4*T,_}}),i.EvpKDF=function(h,x,A){return y.create(A).compute(h,x)},s.EvpKDF)},1847:function(De,J,M){var s,B,v;De.exports=(s=M(7585),M(3057),B=s.lib.CipherParams,v=s.enc.Hex,s.format.Hex={stringify:function(x){return x.ciphertext.toString(v)},parse:function(x){var A=v.parse(x);return B.create({ciphertext:A})}},s.format.Hex)},3764:function(De,J,M){var s,E;De.exports=(s=M(7585),E=s.enc.Utf8,void(s.algo.HMAC=s.lib.Base.extend({init:function(h,x){h=this._hasher=new h.init,"string"==typeof x&&(x=E.parse(x));var A=h.blockSize,H=4*A;x.sigBytes>H&&(x=h.finalize(x)),x.clamp();for(var C=this._oKey=x.clone(),_=this._iKey=x.clone(),N=C.words,T=_.words,I=0;I<A;I++)N[I]^=1549556828,T[I]^=909522486;C.sigBytes=_.sigBytes=H,this.reset()},reset:function(){var h=this._hasher;h.reset(),h.update(this._iKey)},update:function(h){return this._hasher.update(h),this},finalize:function(h){var x=this._hasher,A=x.finalize(h);return x.reset(),x.finalize(this._oKey.clone().concat(A))}})))},7206:function(De,J,M){var s;De.exports=(s=M(7585),M(401),M(7412),M(9012),M(8319),M(4410),M(9493),M(5162),M(1817),M(8769),M(3351),M(6787),M(1971),M(4973),M(3764),M(8812),M(7865),M(3057),M(4424),M(6635),M(3592),M(9354),M(7934),M(4413),M(4630),M(187),M(1691),M(3237),M(1847),M(7466),M(7243),M(486),M(8182),M(3544),s)},7412:function(De,J,M){var s;De.exports=(s=M(7585),function(){if("function"==typeof ArrayBuffer){var c=s.lib.WordArray,B=c.init,E=c.init=function(v){if(v instanceof ArrayBuffer&&(v=new Uint8Array(v)),(v instanceof Int8Array||typeof Uint8ClampedArray<"u"&&v instanceof Uint8ClampedArray||v instanceof Int16Array||v instanceof Uint16Array||v instanceof Int32Array||v instanceof Uint32Array||v instanceof Float32Array||v instanceof Float64Array)&&(v=new Uint8Array(v.buffer,v.byteOffset,v.byteLength)),v instanceof Uint8Array){for(var y=v.byteLength,h=[],x=0;x<y;x++)h[x>>>2]|=v[x]<<24-x%4*8;B.call(this,h,y)}else B.apply(this,arguments)};E.prototype=c}}(),s.lib.WordArray)},9493:function(De,J,M){var s;De.exports=(s=M(7585),function(i){var d=s,c=d.lib,B=c.WordArray,E=c.Hasher,v=d.algo,y=[];!function(){for(var _=0;_<64;_++)y[_]=4294967296*i.abs(i.sin(_+1))|0}();var h=v.MD5=E.extend({_doReset:function(){this._hash=new B.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(_,N){for(var T=0;T<16;T++){var I=N+T,p=_[I];_[I]=16711935&(p<<8|p>>>24)|4278255360&(p<<24|p>>>8)}var m=this._hash.words,S=_[N+0],O=_[N+1],V=_[N+2],G=_[N+3],k=_[N+4],P=_[N+5],D=_[N+6],l=_[N+7],F=_[N+8],Y=_[N+9],W=_[N+10],ne=_[N+11],de=_[N+12],Ae=_[N+13],Re=_[N+14],Fe=_[N+15],be=m[0],Pe=m[1],We=m[2],Ze=m[3];be=x(be,Pe,We,Ze,S,7,y[0]),Ze=x(Ze,be,Pe,We,O,12,y[1]),We=x(We,Ze,be,Pe,V,17,y[2]),Pe=x(Pe,We,Ze,be,G,22,y[3]),be=x(be,Pe,We,Ze,k,7,y[4]),Ze=x(Ze,be,Pe,We,P,12,y[5]),We=x(We,Ze,be,Pe,D,17,y[6]),Pe=x(Pe,We,Ze,be,l,22,y[7]),be=x(be,Pe,We,Ze,F,7,y[8]),Ze=x(Ze,be,Pe,We,Y,12,y[9]),We=x(We,Ze,be,Pe,W,17,y[10]),Pe=x(Pe,We,Ze,be,ne,22,y[11]),be=x(be,Pe,We,Ze,de,7,y[12]),Ze=x(Ze,be,Pe,We,Ae,12,y[13]),We=x(We,Ze,be,Pe,Re,17,y[14]),be=A(be,Pe=x(Pe,We,Ze,be,Fe,22,y[15]),We,Ze,O,5,y[16]),Ze=A(Ze,be,Pe,We,D,9,y[17]),We=A(We,Ze,be,Pe,ne,14,y[18]),Pe=A(Pe,We,Ze,be,S,20,y[19]),be=A(be,Pe,We,Ze,P,5,y[20]),Ze=A(Ze,be,Pe,We,W,9,y[21]),We=A(We,Ze,be,Pe,Fe,14,y[22]),Pe=A(Pe,We,Ze,be,k,20,y[23]),be=A(be,Pe,We,Ze,Y,5,y[24]),Ze=A(Ze,be,Pe,We,Re,9,y[25]),We=A(We,Ze,be,Pe,G,14,y[26]),Pe=A(Pe,We,Ze,be,F,20,y[27]),be=A(be,Pe,We,Ze,Ae,5,y[28]),Ze=A(Ze,be,Pe,We,V,9,y[29]),We=A(We,Ze,be,Pe,l,14,y[30]),be=H(be,Pe=A(Pe,We,Ze,be,de,20,y[31]),We,Ze,P,4,y[32]),Ze=H(Ze,be,Pe,We,F,11,y[33]),We=H(We,Ze,be,Pe,ne,16,y[34]),Pe=H(Pe,We,Ze,be,Re,23,y[35]),be=H(be,Pe,We,Ze,O,4,y[36]),Ze=H(Ze,be,Pe,We,k,11,y[37]),We=H(We,Ze,be,Pe,l,16,y[38]),Pe=H(Pe,We,Ze,be,W,23,y[39]),be=H(be,Pe,We,Ze,Ae,4,y[40]),Ze=H(Ze,be,Pe,We,S,11,y[41]),We=H(We,Ze,be,Pe,G,16,y[42]),Pe=H(Pe,We,Ze,be,D,23,y[43]),be=H(be,Pe,We,Ze,Y,4,y[44]),Ze=H(Ze,be,Pe,We,de,11,y[45]),We=H(We,Ze,be,Pe,Fe,16,y[46]),be=C(be,Pe=H(Pe,We,Ze,be,V,23,y[47]),We,Ze,S,6,y[48]),Ze=C(Ze,be,Pe,We,l,10,y[49]),We=C(We,Ze,be,Pe,Re,15,y[50]),Pe=C(Pe,We,Ze,be,P,21,y[51]),be=C(be,Pe,We,Ze,de,6,y[52]),Ze=C(Ze,be,Pe,We,G,10,y[53]),We=C(We,Ze,be,Pe,W,15,y[54]),Pe=C(Pe,We,Ze,be,O,21,y[55]),be=C(be,Pe,We,Ze,F,6,y[56]),Ze=C(Ze,be,Pe,We,Fe,10,y[57]),We=C(We,Ze,be,Pe,D,15,y[58]),Pe=C(Pe,We,Ze,be,Ae,21,y[59]),be=C(be,Pe,We,Ze,k,6,y[60]),Ze=C(Ze,be,Pe,We,ne,10,y[61]),We=C(We,Ze,be,Pe,V,15,y[62]),Pe=C(Pe,We,Ze,be,Y,21,y[63]),m[0]=m[0]+be|0,m[1]=m[1]+Pe|0,m[2]=m[2]+We|0,m[3]=m[3]+Ze|0},_doFinalize:function(){var _=this._data,N=_.words,T=8*this._nDataBytes,I=8*_.sigBytes;N[I>>>5]|=128<<24-I%32;var p=i.floor(T/4294967296),m=T;N[15+(I+64>>>9<<4)]=16711935&(p<<8|p>>>24)|4278255360&(p<<24|p>>>8),N[14+(I+64>>>9<<4)]=16711935&(m<<8|m>>>24)|4278255360&(m<<24|m>>>8),_.sigBytes=4*(N.length+1),this._process();for(var S=this._hash,O=S.words,V=0;V<4;V++){var G=O[V];O[V]=16711935&(G<<8|G>>>24)|4278255360&(G<<24|G>>>8)}return S},clone:function(){var _=E.clone.call(this);return _._hash=this._hash.clone(),_}});function x(_,N,T,I,p,m,S){var O=_+(N&T|~N&I)+p+S;return(O<<m|O>>>32-m)+N}function A(_,N,T,I,p,m,S){var O=_+(N&I|T&~I)+p+S;return(O<<m|O>>>32-m)+N}function H(_,N,T,I,p,m,S){var O=_+(N^T^I)+p+S;return(O<<m|O>>>32-m)+N}function C(_,N,T,I,p,m,S){var O=_+(T^(N|~I))+p+S;return(O<<m|O>>>32-m)+N}d.MD5=E._createHelper(h),d.HmacMD5=E._createHmacHelper(h)}(Math),s.MD5)},4424:function(De,J,M){var s;De.exports=(s=M(7585),M(3057),s.mode.CFB=function(){var i=s.lib.BlockCipherMode.extend();function d(c,B,E,v){var y,h=this._iv;h?(y=h.slice(0),this._iv=void 0):y=this._prevBlock,v.encryptBlock(y,0);for(var x=0;x<E;x++)c[B+x]^=y[x]}return i.Encryptor=i.extend({processBlock:function(c,B){var E=this._cipher,v=E.blockSize;d.call(this,c,B,v,E),this._prevBlock=c.slice(B,B+v)}}),i.Decryptor=i.extend({processBlock:function(c,B){var E=this._cipher,v=E.blockSize,y=c.slice(B,B+v);d.call(this,c,B,v,E),this._prevBlock=y}}),i}(),s.mode.CFB)},3592:function(De,J,M){var s;De.exports=(s=M(7585),M(3057),s.mode.CTRGladman=function(){var i=s.lib.BlockCipherMode.extend();function d(E){if(255==(E>>24&255)){var v=E>>16&255,y=E>>8&255,h=255&E;255===v?(v=0,255===y?(y=0,255===h?h=0:++h):++y):++v,E=0,E+=v<<16,E+=y<<8,E+=h}else E+=1<<24;return E}var B=i.Encryptor=i.extend({processBlock:function(E,v){var y=this._cipher,h=y.blockSize,x=this._iv,A=this._counter;x&&(A=this._counter=x.slice(0),this._iv=void 0),function c(E){return 0===(E[0]=d(E[0]))&&(E[1]=d(E[1])),E}(A);var H=A.slice(0);y.encryptBlock(H,0);for(var C=0;C<h;C++)E[v+C]^=H[C]}});return i.Decryptor=B,i}(),s.mode.CTRGladman)},6635:function(De,J,M){var i,d,s;De.exports=(s=M(7585),M(3057),s.mode.CTR=(d=(i=s.lib.BlockCipherMode.extend()).Encryptor=i.extend({processBlock:function(c,B){var E=this._cipher,v=E.blockSize,y=this._iv,h=this._counter;y&&(h=this._counter=y.slice(0),this._iv=void 0);var x=h.slice(0);E.encryptBlock(x,0),h[v-1]=h[v-1]+1|0;for(var A=0;A<v;A++)c[B+A]^=x[A]}}),i.Decryptor=d,i),s.mode.CTR)},7934:function(De,J,M){var i,s;De.exports=(s=M(7585),M(3057),s.mode.ECB=((i=s.lib.BlockCipherMode.extend()).Encryptor=i.extend({processBlock:function(d,c){this._cipher.encryptBlock(d,c)}}),i.Decryptor=i.extend({processBlock:function(d,c){this._cipher.decryptBlock(d,c)}}),i),s.mode.ECB)},9354:function(De,J,M){var i,d,s;De.exports=(s=M(7585),M(3057),s.mode.OFB=(d=(i=s.lib.BlockCipherMode.extend()).Encryptor=i.extend({processBlock:function(c,B){var E=this._cipher,v=E.blockSize,y=this._iv,h=this._keystream;y&&(h=this._keystream=y.slice(0),this._iv=void 0),E.encryptBlock(h,0);for(var x=0;x<v;x++)c[B+x]^=h[x]}}),i.Decryptor=d,i),s.mode.OFB)},4413:function(De,J,M){var s;De.exports=(s=M(7585),M(3057),s.pad.AnsiX923={pad:function(i,d){var c=i.sigBytes,B=4*d,E=B-c%B,v=c+E-1;i.clamp(),i.words[v>>>2]|=E<<24-v%4*8,i.sigBytes+=E},unpad:function(i){i.sigBytes-=255&i.words[i.sigBytes-1>>>2]}},s.pad.Ansix923)},4630:function(De,J,M){var s;De.exports=(s=M(7585),M(3057),s.pad.Iso10126={pad:function(i,d){var c=4*d,B=c-i.sigBytes%c;i.concat(s.lib.WordArray.random(B-1)).concat(s.lib.WordArray.create([B<<24],1))},unpad:function(i){i.sigBytes-=255&i.words[i.sigBytes-1>>>2]}},s.pad.Iso10126)},187:function(De,J,M){var s;De.exports=(s=M(7585),M(3057),s.pad.Iso97971={pad:function(i,d){i.concat(s.lib.WordArray.create([2147483648],1)),s.pad.ZeroPadding.pad(i,d)},unpad:function(i){s.pad.ZeroPadding.unpad(i),i.sigBytes--}},s.pad.Iso97971)},3237:function(De,J,M){var s;De.exports=(s=M(7585),M(3057),s.pad.NoPadding={pad:function(){},unpad:function(){}},s.pad.NoPadding)},1691:function(De,J,M){var s;De.exports=(s=M(7585),M(3057),s.pad.ZeroPadding={pad:function(i,d){var c=4*d;i.clamp(),i.sigBytes+=c-(i.sigBytes%c||c)},unpad:function(i){var d=i.words,c=i.sigBytes-1;for(c=i.sigBytes-1;c>=0;c--)if(d[c>>>2]>>>24-c%4*8&255){i.sigBytes=c+1;break}}},s.pad.ZeroPadding)},8812:function(De,J,M){var i,d,c,B,E,y,h,s;De.exports=(s=M(7585),M(5162),M(3764),B=(d=(i=s).lib).WordArray,y=(E=i.algo).HMAC,h=E.PBKDF2=(c=d.Base).extend({cfg:c.extend({keySize:4,hasher:E.SHA1,iterations:1}),init:function(x){this.cfg=this.cfg.extend(x)},compute:function(x,A){for(var H=this.cfg,C=y.create(H.hasher,x),_=B.create(),N=B.create([1]),T=_.words,I=N.words,p=H.keySize,m=H.iterations;T.length<p;){var S=C.update(A).finalize(N);C.reset();for(var O=S.words,V=O.length,G=S,k=1;k<m;k++){G=C.finalize(G),C.reset();for(var P=G.words,D=0;D<V;D++)O[D]^=P[D]}_.concat(S),I[0]++}return _.sigBytes=4*p,_}}),i.PBKDF2=function(x,A,H){return h.create(H).compute(x,A)},s.PBKDF2)},3544:function(De,J,M){var s;De.exports=(s=M(7585),M(8319),M(9493),M(7865),M(3057),function(){var i=s,c=i.lib.StreamCipher,E=[],v=[],y=[],h=i.algo.RabbitLegacy=c.extend({_doReset:function(){var A=this._key.words,H=this.cfg.iv,C=this._X=[A[0],A[3]<<16|A[2]>>>16,A[1],A[0]<<16|A[3]>>>16,A[2],A[1]<<16|A[0]>>>16,A[3],A[2]<<16|A[1]>>>16],_=this._C=[A[2]<<16|A[2]>>>16,4294901760&A[0]|65535&A[1],A[3]<<16|A[3]>>>16,4294901760&A[1]|65535&A[2],A[0]<<16|A[0]>>>16,4294901760&A[2]|65535&A[3],A[1]<<16|A[1]>>>16,4294901760&A[3]|65535&A[0]];this._b=0;for(var N=0;N<4;N++)x.call(this);for(N=0;N<8;N++)_[N]^=C[N+4&7];if(H){var T=H.words,I=T[0],p=T[1],m=16711935&(I<<8|I>>>24)|4278255360&(I<<24|I>>>8),S=16711935&(p<<8|p>>>24)|4278255360&(p<<24|p>>>8),O=m>>>16|4294901760&S,V=S<<16|65535&m;for(_[0]^=m,_[1]^=O,_[2]^=S,_[3]^=V,_[4]^=m,_[5]^=O,_[6]^=S,_[7]^=V,N=0;N<4;N++)x.call(this)}},_doProcessBlock:function(A,H){var C=this._X;x.call(this),E[0]=C[0]^C[5]>>>16^C[3]<<16,E[1]=C[2]^C[7]>>>16^C[5]<<16,E[2]=C[4]^C[1]>>>16^C[7]<<16,E[3]=C[6]^C[3]>>>16^C[1]<<16;for(var _=0;_<4;_++)E[_]=16711935&(E[_]<<8|E[_]>>>24)|4278255360&(E[_]<<24|E[_]>>>8),A[H+_]^=E[_]},blockSize:4,ivSize:2});function x(){for(var A=this._X,H=this._C,C=0;C<8;C++)v[C]=H[C];for(H[0]=H[0]+1295307597+this._b|0,H[1]=H[1]+3545052371+(H[0]>>>0<v[0]>>>0?1:0)|0,H[2]=H[2]+886263092+(H[1]>>>0<v[1]>>>0?1:0)|0,H[3]=H[3]+1295307597+(H[2]>>>0<v[2]>>>0?1:0)|0,H[4]=H[4]+3545052371+(H[3]>>>0<v[3]>>>0?1:0)|0,H[5]=H[5]+886263092+(H[4]>>>0<v[4]>>>0?1:0)|0,H[6]=H[6]+1295307597+(H[5]>>>0<v[5]>>>0?1:0)|0,H[7]=H[7]+3545052371+(H[6]>>>0<v[6]>>>0?1:0)|0,this._b=H[7]>>>0<v[7]>>>0?1:0,C=0;C<8;C++){var _=A[C]+H[C],N=65535&_,T=_>>>16;y[C]=((N*N>>>17)+N*T>>>15)+T*T^((4294901760&_)*_|0)+((65535&_)*_|0)}A[0]=y[0]+(y[7]<<16|y[7]>>>16)+(y[6]<<16|y[6]>>>16)|0,A[1]=y[1]+(y[0]<<8|y[0]>>>24)+y[7]|0,A[2]=y[2]+(y[1]<<16|y[1]>>>16)+(y[0]<<16|y[0]>>>16)|0,A[3]=y[3]+(y[2]<<8|y[2]>>>24)+y[1]|0,A[4]=y[4]+(y[3]<<16|y[3]>>>16)+(y[2]<<16|y[2]>>>16)|0,A[5]=y[5]+(y[4]<<8|y[4]>>>24)+y[3]|0,A[6]=y[6]+(y[5]<<16|y[5]>>>16)+(y[4]<<16|y[4]>>>16)|0,A[7]=y[7]+(y[6]<<8|y[6]>>>24)+y[5]|0}i.RabbitLegacy=c._createHelper(h)}(),s.RabbitLegacy)},8182:function(De,J,M){var s;De.exports=(s=M(7585),M(8319),M(9493),M(7865),M(3057),function(){var i=s,c=i.lib.StreamCipher,E=[],v=[],y=[],h=i.algo.Rabbit=c.extend({_doReset:function(){for(var A=this._key.words,H=this.cfg.iv,C=0;C<4;C++)A[C]=16711935&(A[C]<<8|A[C]>>>24)|4278255360&(A[C]<<24|A[C]>>>8);var _=this._X=[A[0],A[3]<<16|A[2]>>>16,A[1],A[0]<<16|A[3]>>>16,A[2],A[1]<<16|A[0]>>>16,A[3],A[2]<<16|A[1]>>>16],N=this._C=[A[2]<<16|A[2]>>>16,4294901760&A[0]|65535&A[1],A[3]<<16|A[3]>>>16,4294901760&A[1]|65535&A[2],A[0]<<16|A[0]>>>16,4294901760&A[2]|65535&A[3],A[1]<<16|A[1]>>>16,4294901760&A[3]|65535&A[0]];for(this._b=0,C=0;C<4;C++)x.call(this);for(C=0;C<8;C++)N[C]^=_[C+4&7];if(H){var T=H.words,I=T[0],p=T[1],m=16711935&(I<<8|I>>>24)|4278255360&(I<<24|I>>>8),S=16711935&(p<<8|p>>>24)|4278255360&(p<<24|p>>>8),O=m>>>16|4294901760&S,V=S<<16|65535&m;for(N[0]^=m,N[1]^=O,N[2]^=S,N[3]^=V,N[4]^=m,N[5]^=O,N[6]^=S,N[7]^=V,C=0;C<4;C++)x.call(this)}},_doProcessBlock:function(A,H){var C=this._X;x.call(this),E[0]=C[0]^C[5]>>>16^C[3]<<16,E[1]=C[2]^C[7]>>>16^C[5]<<16,E[2]=C[4]^C[1]>>>16^C[7]<<16,E[3]=C[6]^C[3]>>>16^C[1]<<16;for(var _=0;_<4;_++)E[_]=16711935&(E[_]<<8|E[_]>>>24)|4278255360&(E[_]<<24|E[_]>>>8),A[H+_]^=E[_]},blockSize:4,ivSize:2});function x(){for(var A=this._X,H=this._C,C=0;C<8;C++)v[C]=H[C];for(H[0]=H[0]+1295307597+this._b|0,H[1]=H[1]+3545052371+(H[0]>>>0<v[0]>>>0?1:0)|0,H[2]=H[2]+886263092+(H[1]>>>0<v[1]>>>0?1:0)|0,H[3]=H[3]+1295307597+(H[2]>>>0<v[2]>>>0?1:0)|0,H[4]=H[4]+3545052371+(H[3]>>>0<v[3]>>>0?1:0)|0,H[5]=H[5]+886263092+(H[4]>>>0<v[4]>>>0?1:0)|0,H[6]=H[6]+1295307597+(H[5]>>>0<v[5]>>>0?1:0)|0,H[7]=H[7]+3545052371+(H[6]>>>0<v[6]>>>0?1:0)|0,this._b=H[7]>>>0<v[7]>>>0?1:0,C=0;C<8;C++){var _=A[C]+H[C],N=65535&_,T=_>>>16;y[C]=((N*N>>>17)+N*T>>>15)+T*T^((4294901760&_)*_|0)+((65535&_)*_|0)}A[0]=y[0]+(y[7]<<16|y[7]>>>16)+(y[6]<<16|y[6]>>>16)|0,A[1]=y[1]+(y[0]<<8|y[0]>>>24)+y[7]|0,A[2]=y[2]+(y[1]<<16|y[1]>>>16)+(y[0]<<16|y[0]>>>16)|0,A[3]=y[3]+(y[2]<<8|y[2]>>>24)+y[1]|0,A[4]=y[4]+(y[3]<<16|y[3]>>>16)+(y[2]<<16|y[2]>>>16)|0,A[5]=y[5]+(y[4]<<8|y[4]>>>24)+y[3]|0,A[6]=y[6]+(y[5]<<16|y[5]>>>16)+(y[4]<<16|y[4]>>>16)|0,A[7]=y[7]+(y[6]<<8|y[6]>>>24)+y[5]|0}i.Rabbit=c._createHelper(h)}(),s.Rabbit)},486:function(De,J,M){var s;De.exports=(s=M(7585),M(8319),M(9493),M(7865),M(3057),function(){var i=s,c=i.lib.StreamCipher,B=i.algo,E=B.RC4=c.extend({_doReset:function(){for(var h=this._key,x=h.words,A=h.sigBytes,H=this._S=[],C=0;C<256;C++)H[C]=C;C=0;for(var _=0;C<256;C++){var N=C%A,I=H[C];H[C]=H[_=(_+H[C]+(x[N>>>2]>>>24-N%4*8&255))%256],H[_]=I}this._i=this._j=0},_doProcessBlock:function(h,x){h[x]^=v.call(this)},keySize:8,ivSize:0});function v(){for(var h=this._S,x=this._i,A=this._j,H=0,C=0;C<4;C++){var _=h[x=(x+1)%256];h[x]=h[A=(A+h[x])%256],h[A]=_,H|=h[(h[x]+h[A])%256]<<24-8*C}return this._i=x,this._j=A,H}i.RC4=c._createHelper(E);var y=B.RC4Drop=E.extend({cfg:E.cfg.extend({drop:192}),_doReset:function(){E._doReset.call(this);for(var h=this.cfg.drop;h>0;h--)v.call(this)}});i.RC4Drop=c._createHelper(y)}(),s.RC4)},4973:function(De,J,M){var s;De.exports=(s=M(7585),function(i){var d=s,c=d.lib,B=c.WordArray,E=c.Hasher,v=d.algo,y=B.create([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13]),h=B.create([5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11]),x=B.create([11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6]),A=B.create([8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]),H=B.create([0,1518500249,1859775393,2400959708,2840853838]),C=B.create([1352829926,1548603684,1836072691,2053994217,0]),_=v.RIPEMD160=E.extend({_doReset:function(){this._hash=B.create([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(O,V){for(var G=0;G<16;G++){var k=V+G,P=O[k];O[k]=16711935&(P<<8|P>>>24)|4278255360&(P<<24|P>>>8)}var Ae,Re,Fe,be,Pe,We,Ze,Ct,tt,Ht,ct,D=this._hash.words,l=H.words,F=C.words,Y=y.words,W=h.words,ne=x.words,de=A.words;for(We=Ae=D[0],Ze=Re=D[1],Ct=Fe=D[2],tt=be=D[3],Ht=Pe=D[4],G=0;G<80;G+=1)ct=Ae+O[V+Y[G]]|0,ct+=G<16?N(Re,Fe,be)+l[0]:G<32?T(Re,Fe,be)+l[1]:G<48?I(Re,Fe,be)+l[2]:G<64?p(Re,Fe,be)+l[3]:m(Re,Fe,be)+l[4],ct=(ct=S(ct|=0,ne[G]))+Pe|0,Ae=Pe,Pe=be,be=S(Fe,10),Fe=Re,Re=ct,ct=We+O[V+W[G]]|0,ct+=G<16?m(Ze,Ct,tt)+F[0]:G<32?p(Ze,Ct,tt)+F[1]:G<48?I(Ze,Ct,tt)+F[2]:G<64?T(Ze,Ct,tt)+F[3]:N(Ze,Ct,tt)+F[4],ct=(ct=S(ct|=0,de[G]))+Ht|0,We=Ht,Ht=tt,tt=S(Ct,10),Ct=Ze,Ze=ct;ct=D[1]+Fe+tt|0,D[1]=D[2]+be+Ht|0,D[2]=D[3]+Pe+We|0,D[3]=D[4]+Ae+Ze|0,D[4]=D[0]+Re+Ct|0,D[0]=ct},_doFinalize:function(){var O=this._data,V=O.words,G=8*this._nDataBytes,k=8*O.sigBytes;V[k>>>5]|=128<<24-k%32,V[14+(k+64>>>9<<4)]=16711935&(G<<8|G>>>24)|4278255360&(G<<24|G>>>8),O.sigBytes=4*(V.length+1),this._process();for(var P=this._hash,D=P.words,l=0;l<5;l++){var F=D[l];D[l]=16711935&(F<<8|F>>>24)|4278255360&(F<<24|F>>>8)}return P},clone:function(){var O=E.clone.call(this);return O._hash=this._hash.clone(),O}});function N(O,V,G){return O^V^G}function T(O,V,G){return O&V|~O&G}function I(O,V,G){return(O|~V)^G}function p(O,V,G){return O&G|V&~G}function m(O,V,G){return O^(V|~G)}function S(O,V){return O<<V|O>>>32-V}d.RIPEMD160=E._createHelper(_),d.HmacRIPEMD160=E._createHmacHelper(_)}(Math),s.RIPEMD160)},5162:function(De,J,M){var i,d,c,B,v,y,s;De.exports=(s=M(7585),c=(d=(i=s).lib).WordArray,v=[],y=i.algo.SHA1=(B=d.Hasher).extend({_doReset:function(){this._hash=new c.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(h,x){for(var A=this._hash.words,H=A[0],C=A[1],_=A[2],N=A[3],T=A[4],I=0;I<80;I++){if(I<16)v[I]=0|h[x+I];else{var p=v[I-3]^v[I-8]^v[I-14]^v[I-16];v[I]=p<<1|p>>>31}var m=(H<<5|H>>>27)+T+v[I];m+=I<20?1518500249+(C&_|~C&N):I<40?1859775393+(C^_^N):I<60?(C&_|C&N|_&N)-1894007588:(C^_^N)-899497514,T=N,N=_,_=C<<30|C>>>2,C=H,H=m}A[0]=A[0]+H|0,A[1]=A[1]+C|0,A[2]=A[2]+_|0,A[3]=A[3]+N|0,A[4]=A[4]+T|0},_doFinalize:function(){var h=this._data,x=h.words,A=8*this._nDataBytes,H=8*h.sigBytes;return x[H>>>5]|=128<<24-H%32,x[14+(H+64>>>9<<4)]=Math.floor(A/4294967296),x[15+(H+64>>>9<<4)]=A,h.sigBytes=4*x.length,this._process(),this._hash},clone:function(){var h=B.clone.call(this);return h._hash=this._hash.clone(),h}}),i.SHA1=B._createHelper(y),i.HmacSHA1=B._createHmacHelper(y),s.SHA1)},8769:function(De,J,M){var i,c,B,E,v,s;De.exports=(s=M(7585),M(1817),c=(i=s).lib.WordArray,v=(B=i.algo).SHA224=(E=B.SHA256).extend({_doReset:function(){this._hash=new c.init([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])},_doFinalize:function(){var y=E._doFinalize.call(this);return y.sigBytes-=4,y}}),i.SHA224=E._createHelper(v),i.HmacSHA224=E._createHmacHelper(v),s.SHA224)},1817:function(De,J,M){var s;De.exports=(s=M(7585),function(i){var d=s,c=d.lib,B=c.WordArray,E=c.Hasher,v=d.algo,y=[],h=[];!function(){function H(T){for(var I=i.sqrt(T),p=2;p<=I;p++)if(!(T%p))return!1;return!0}function C(T){return 4294967296*(T-(0|T))|0}for(var _=2,N=0;N<64;)H(_)&&(N<8&&(y[N]=C(i.pow(_,.5))),h[N]=C(i.pow(_,1/3)),N++),_++}();var x=[],A=v.SHA256=E.extend({_doReset:function(){this._hash=new B.init(y.slice(0))},_doProcessBlock:function(H,C){for(var _=this._hash.words,N=_[0],T=_[1],I=_[2],p=_[3],m=_[4],S=_[5],O=_[6],V=_[7],G=0;G<64;G++){if(G<16)x[G]=0|H[C+G];else{var k=x[G-15],D=x[G-2];x[G]=((k<<25|k>>>7)^(k<<14|k>>>18)^k>>>3)+x[G-7]+((D<<15|D>>>17)^(D<<13|D>>>19)^D>>>10)+x[G-16]}var Y=N&T^N&I^T&I,de=V+((m<<26|m>>>6)^(m<<21|m>>>11)^(m<<7|m>>>25))+(m&S^~m&O)+h[G]+x[G];V=O,O=S,S=m,m=p+de|0,p=I,I=T,T=N,N=de+(((N<<30|N>>>2)^(N<<19|N>>>13)^(N<<10|N>>>22))+Y)|0}_[0]=_[0]+N|0,_[1]=_[1]+T|0,_[2]=_[2]+I|0,_[3]=_[3]+p|0,_[4]=_[4]+m|0,_[5]=_[5]+S|0,_[6]=_[6]+O|0,_[7]=_[7]+V|0},_doFinalize:function(){var H=this._data,C=H.words,_=8*this._nDataBytes,N=8*H.sigBytes;return C[N>>>5]|=128<<24-N%32,C[14+(N+64>>>9<<4)]=i.floor(_/4294967296),C[15+(N+64>>>9<<4)]=_,H.sigBytes=4*C.length,this._process(),this._hash},clone:function(){var H=E.clone.call(this);return H._hash=this._hash.clone(),H}});d.SHA256=E._createHelper(A),d.HmacSHA256=E._createHmacHelper(A)}(Math),s.SHA256)},1971:function(De,J,M){var s;De.exports=(s=M(7585),M(401),function(i){var d=s,c=d.lib,B=c.WordArray,E=c.Hasher,y=d.x64.Word,h=d.algo,x=[],A=[],H=[];!function(){for(var N=1,T=0,I=0;I<24;I++){x[N+5*T]=(I+1)*(I+2)/2%64;var m=(2*N+3*T)%5;N=T%5,T=m}for(N=0;N<5;N++)for(T=0;T<5;T++)A[N+5*T]=T+(2*N+3*T)%5*5;for(var S=1,O=0;O<24;O++){for(var V=0,G=0,k=0;k<7;k++){if(1&S){var P=(1<<k)-1;P<32?G^=1<<P:V^=1<<P-32}128&S?S=S<<1^113:S<<=1}H[O]=y.create(V,G)}}();var C=[];!function(){for(var N=0;N<25;N++)C[N]=y.create()}();var _=h.SHA3=E.extend({cfg:E.cfg.extend({outputLength:512}),_doReset:function(){for(var N=this._state=[],T=0;T<25;T++)N[T]=new y.init;this.blockSize=(1600-2*this.cfg.outputLength)/32},_doProcessBlock:function(N,T){for(var I=this._state,p=this.blockSize/2,m=0;m<p;m++){var S=N[T+2*m],O=N[T+2*m+1];S=16711935&(S<<8|S>>>24)|4278255360&(S<<24|S>>>8),(V=I[m]).high^=O=16711935&(O<<8|O>>>24)|4278255360&(O<<24|O>>>8),V.low^=S}for(var G=0;G<24;G++){for(var k=0;k<5;k++){for(var P=0,D=0,l=0;l<5;l++)P^=(V=I[k+5*l]).high,D^=V.low;var F=C[k];F.high=P,F.low=D}for(k=0;k<5;k++){var Y=C[(k+4)%5],W=C[(k+1)%5],ne=W.high,de=W.low;for(P=Y.high^(ne<<1|de>>>31),D=Y.low^(de<<1|ne>>>31),l=0;l<5;l++)(V=I[k+5*l]).high^=P,V.low^=D}for(var Ae=1;Ae<25;Ae++){var Re=(V=I[Ae]).high,Fe=V.low,be=x[Ae];be<32?(P=Re<<be|Fe>>>32-be,D=Fe<<be|Re>>>32-be):(P=Fe<<be-32|Re>>>64-be,D=Re<<be-32|Fe>>>64-be);var Pe=C[A[Ae]];Pe.high=P,Pe.low=D}var We=C[0],Ze=I[0];for(We.high=Ze.high,We.low=Ze.low,k=0;k<5;k++)for(l=0;l<5;l++){var Ct=C[Ae=k+5*l],tt=C[(k+1)%5+5*l],Ht=C[(k+2)%5+5*l];(V=I[Ae]).high=Ct.high^~tt.high&Ht.high,V.low=Ct.low^~tt.low&Ht.low}var V,ct=H[G];(V=I[0]).high^=ct.high,V.low^=ct.low}},_doFinalize:function(){var N=this._data,T=N.words,p=8*N.sigBytes,m=32*this.blockSize;T[p>>>5]|=1<<24-p%32,T[(i.ceil((p+1)/m)*m>>>5)-1]|=128,N.sigBytes=4*T.length,this._process();for(var S=this._state,O=this.cfg.outputLength/8,V=O/8,G=[],k=0;k<V;k++){var P=S[k],D=P.high,l=P.low;D=16711935&(D<<8|D>>>24)|4278255360&(D<<24|D>>>8),G.push(l=16711935&(l<<8|l>>>24)|4278255360&(l<<24|l>>>8)),G.push(D)}return new B.init(G,O)},clone:function(){for(var N=E.clone.call(this),T=N._state=this._state.slice(0),I=0;I<25;I++)T[I]=T[I].clone();return N}});d.SHA3=E._createHelper(_),d.HmacSHA3=E._createHmacHelper(_)}(Math),s.SHA3)},6787:function(De,J,M){var i,d,c,B,E,v,y,s;De.exports=(s=M(7585),M(401),M(3351),c=(d=(i=s).x64).Word,B=d.WordArray,y=(E=i.algo).SHA384=(v=E.SHA512).extend({_doReset:function(){this._hash=new B.init([new c.init(3418070365,3238371032),new c.init(1654270250,914150663),new c.init(2438529370,812702999),new c.init(355462360,4144912697),new c.init(1731405415,4290775857),new c.init(2394180231,1750603025),new c.init(3675008525,1694076839),new c.init(1203062813,3204075428)])},_doFinalize:function(){var h=v._doFinalize.call(this);return h.sigBytes-=16,h}}),i.SHA384=v._createHelper(y),i.HmacSHA384=v._createHmacHelper(y),s.SHA384)},3351:function(De,J,M){var s;De.exports=(s=M(7585),M(401),function(){var i=s,c=i.lib.Hasher,B=i.x64,E=B.Word,v=B.WordArray,y=i.algo;function h(){return E.create.apply(E,arguments)}var x=[h(1116352408,3609767458),h(1899447441,602891725),h(3049323471,3964484399),h(3921009573,2173295548),h(961987163,4081628472),h(1508970993,3053834265),h(2453635748,2937671579),h(2870763221,3664609560),h(3624381080,2734883394),h(310598401,1164996542),h(607225278,1323610764),h(1426881987,3590304994),h(1925078388,4068182383),h(2162078206,991336113),h(2614888103,633803317),h(3248222580,3479774868),h(3835390401,2666613458),h(4022224774,944711139),h(264347078,2341262773),h(604807628,2007800933),h(770255983,1495990901),h(1249150122,1856431235),h(1555081692,3175218132),h(1996064986,2198950837),h(2554220882,3999719339),h(2821834349,766784016),h(2952996808,2566594879),h(3210313671,3203337956),h(3336571891,1034457026),h(3584528711,2466948901),h(113926993,3758326383),h(338241895,168717936),h(666307205,1188179964),h(773529912,1546045734),h(1294757372,1522805485),h(1396182291,2643833823),h(1695183700,2343527390),h(1986661051,1014477480),h(2177026350,1206759142),h(2456956037,344077627),h(2730485921,1290863460),h(2820302411,3158454273),h(3259730800,3505952657),h(3345764771,106217008),h(3516065817,3606008344),h(3600352804,1432725776),h(4094571909,1467031594),h(275423344,851169720),h(430227734,3100823752),h(506948616,1363258195),h(659060556,3750685593),h(883997877,3785050280),h(958139571,3318307427),h(1322822218,3812723403),h(1537002063,2003034995),h(1747873779,3602036899),h(1955562222,1575990012),h(2024104815,1125592928),h(2227730452,2716904306),h(2361852424,442776044),h(2428436474,593698344),h(2756734187,3733110249),h(3204031479,2999351573),h(3329325298,3815920427),h(3391569614,3928383900),h(3515267271,566280711),h(3940187606,3454069534),h(4118630271,4000239992),h(116418474,1914138554),h(174292421,2731055270),h(289380356,3203993006),h(460393269,320620315),h(685471733,587496836),h(852142971,1086792851),h(1017036298,365543100),h(1126000580,2618297676),h(1288033470,3409855158),h(1501505948,4234509866),h(1607167915,987167468),h(1816402316,1246189591)],A=[];!function(){for(var C=0;C<80;C++)A[C]=h()}();var H=y.SHA512=c.extend({_doReset:function(){this._hash=new v.init([new E.init(1779033703,4089235720),new E.init(3144134277,2227873595),new E.init(1013904242,4271175723),new E.init(2773480762,1595750129),new E.init(1359893119,2917565137),new E.init(2600822924,725511199),new E.init(528734635,4215389547),new E.init(1541459225,327033209)])},_doProcessBlock:function(C,_){for(var N=this._hash.words,T=N[0],I=N[1],p=N[2],m=N[3],S=N[4],O=N[5],V=N[6],G=N[7],k=T.high,P=T.low,D=I.high,l=I.low,F=p.high,Y=p.low,W=m.high,ne=m.low,de=S.high,Ae=S.low,Re=O.high,Fe=O.low,be=V.high,Pe=V.low,We=G.high,Ze=G.low,Ct=k,tt=P,Ht=D,ct=l,jt=F,Rt=Y,Le=W,Ge=ne,K=de,U=Ae,ee=Re,me=Fe,Ue=be,z=Pe,Ie=We,lt=Ze,Pt=0;Pt<80;Pt++){var kt,at,_t=A[Pt];if(Pt<16)at=_t.high=0|C[_+2*Pt],kt=_t.low=0|C[_+2*Pt+1];else{var Vt=A[Pt-15],Qt=Vt.high,Z=Vt.low,je=(Z>>>1|Qt<<31)^(Z>>>8|Qt<<24)^(Z>>>7|Qt<<25),mt=A[Pt-2],X=mt.high,ue=mt.low,et=(ue>>>19|X<<13)^(ue<<3|X>>>29)^(ue>>>6|X<<26),gt=A[Pt-7],qt=A[Pt-16],or=qt.low;_t.high=at=(at=(at=((Qt>>>1|Z<<31)^(Qt>>>8|Z<<24)^Qt>>>7)+gt.high+((kt=je+gt.low)>>>0<je>>>0?1:0))+((X>>>19|ue<<13)^(X<<3|ue>>>29)^X>>>6)+((kt+=et)>>>0<et>>>0?1:0))+qt.high+((kt+=or)>>>0<or>>>0?1:0),_t.low=kt}var ir,_r=K&ee^~K&Ue,Xt=U&me^~U&z,cr=Ct&Ht^Ct&jt^Ht&jt,Yr=(tt>>>28|Ct<<4)^(tt<<30|Ct>>>2)^(tt<<25|Ct>>>7),dr=x[Pt],Ur=dr.low,pr=Ie+((K>>>14|U<<18)^(K>>>18|U<<14)^(K<<23|U>>>9))+((ir=lt+((U>>>14|K<<18)^(U>>>18|K<<14)^(U<<23|K>>>9)))>>>0<lt>>>0?1:0),kr=Yr+(tt&ct^tt&Rt^ct&Rt);Ie=Ue,lt=z,Ue=ee,z=me,ee=K,me=U,K=Le+(pr=(pr=(pr=pr+_r+((ir+=Xt)>>>0<Xt>>>0?1:0))+dr.high+((ir+=Ur)>>>0<Ur>>>0?1:0))+at+((ir+=kt)>>>0<kt>>>0?1:0))+((U=Ge+ir|0)>>>0<Ge>>>0?1:0)|0,Le=jt,Ge=Rt,jt=Ht,Rt=ct,Ht=Ct,ct=tt,Ct=pr+(((Ct>>>28|tt<<4)^(Ct<<30|tt>>>2)^(Ct<<25|tt>>>7))+cr+(kr>>>0<Yr>>>0?1:0))+((tt=ir+kr|0)>>>0<ir>>>0?1:0)|0}P=T.low=P+tt,T.high=k+Ct+(P>>>0<tt>>>0?1:0),l=I.low=l+ct,I.high=D+Ht+(l>>>0<ct>>>0?1:0),Y=p.low=Y+Rt,p.high=F+jt+(Y>>>0<Rt>>>0?1:0),ne=m.low=ne+Ge,m.high=W+Le+(ne>>>0<Ge>>>0?1:0),Ae=S.low=Ae+U,S.high=de+K+(Ae>>>0<U>>>0?1:0),Fe=O.low=Fe+me,O.high=Re+ee+(Fe>>>0<me>>>0?1:0),Pe=V.low=Pe+z,V.high=be+Ue+(Pe>>>0<z>>>0?1:0),Ze=G.low=Ze+lt,G.high=We+Ie+(Ze>>>0<lt>>>0?1:0)},_doFinalize:function(){var C=this._data,_=C.words,N=8*this._nDataBytes,T=8*C.sigBytes;return _[T>>>5]|=128<<24-T%32,_[30+(T+128>>>10<<5)]=Math.floor(N/4294967296),_[31+(T+128>>>10<<5)]=N,C.sigBytes=4*_.length,this._process(),this._hash.toX32()},clone:function(){var C=c.clone.call(this);return C._hash=this._hash.clone(),C},blockSize:32});i.SHA512=c._createHelper(H),i.HmacSHA512=c._createHmacHelper(H)}(),s.SHA512)},7243:function(De,J,M){var s;De.exports=(s=M(7585),M(8319),M(9493),M(7865),M(3057),function(){var i=s,d=i.lib,c=d.WordArray,B=d.BlockCipher,E=i.algo,v=[57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,27,19,11,3,60,52,44,36,63,55,47,39,31,23,15,7,62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,28,20,12,4],y=[14,17,11,24,1,5,3,28,15,6,21,10,23,19,12,4,26,8,16,7,27,20,13,2,41,52,31,37,47,55,30,40,51,45,33,48,44,49,39,56,34,53,46,42,50,36,29,32],h=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],x=[{0:8421888,268435456:32768,536870912:8421378,805306368:2,1073741824:512,1342177280:8421890,1610612736:8389122,1879048192:8388608,2147483648:514,2415919104:8389120,2684354560:33280,2952790016:8421376,3221225472:32770,3489660928:8388610,3758096384:0,4026531840:33282,134217728:0,402653184:8421890,671088640:33282,939524096:32768,1207959552:8421888,1476395008:512,1744830464:8421378,2013265920:2,2281701376:8389120,2550136832:33280,2818572288:8421376,3087007744:8389122,3355443200:8388610,3623878656:32770,3892314112:514,4160749568:8388608,1:32768,268435457:2,536870913:8421888,805306369:8388608,1073741825:8421378,1342177281:33280,1610612737:512,1879048193:8389122,2147483649:8421890,2415919105:8421376,2684354561:8388610,2952790017:33282,3221225473:514,3489660929:8389120,3758096385:32770,4026531841:0,134217729:8421890,402653185:8421376,671088641:8388608,939524097:512,1207959553:32768,1476395009:8388610,1744830465:2,2013265921:33282,2281701377:32770,2550136833:8389122,2818572289:514,3087007745:8421888,3355443201:8389120,3623878657:0,3892314113:33280,4160749569:8421378},{0:1074282512,16777216:16384,33554432:524288,50331648:1074266128,67108864:1073741840,83886080:1074282496,100663296:1073758208,117440512:16,134217728:540672,150994944:1073758224,167772160:1073741824,184549376:540688,201326592:524304,218103808:0,234881024:16400,251658240:1074266112,8388608:1073758208,25165824:540688,41943040:16,58720256:1073758224,75497472:1074282512,92274688:1073741824,109051904:524288,125829120:1074266128,142606336:524304,159383552:0,176160768:16384,192937984:1074266112,209715200:1073741840,226492416:540672,243269632:1074282496,260046848:16400,268435456:0,285212672:1074266128,301989888:1073758224,318767104:1074282496,335544320:1074266112,352321536:16,369098752:540688,385875968:16384,402653184:16400,419430400:524288,436207616:524304,452984832:1073741840,469762048:540672,486539264:1073758208,503316480:1073741824,520093696:1074282512,276824064:540688,293601280:524288,310378496:1074266112,327155712:16384,343932928:1073758208,360710144:1074282512,377487360:16,394264576:1073741824,411041792:1074282496,427819008:1073741840,444596224:1073758224,461373440:524304,478150656:0,494927872:16400,511705088:1074266128,528482304:540672},{0:260,1048576:0,2097152:67109120,3145728:65796,4194304:65540,5242880:67108868,6291456:67174660,7340032:67174400,8388608:67108864,9437184:67174656,10485760:65792,11534336:67174404,12582912:67109124,13631488:65536,14680064:4,15728640:256,524288:67174656,1572864:67174404,2621440:0,3670016:67109120,4718592:67108868,5767168:65536,6815744:65540,7864320:260,8912896:4,9961472:256,11010048:67174400,12058624:65796,13107200:65792,14155776:67109124,15204352:67174660,16252928:67108864,16777216:67174656,17825792:65540,18874368:65536,19922944:67109120,20971520:256,22020096:67174660,23068672:67108868,24117248:0,25165824:67109124,26214400:67108864,27262976:4,28311552:65792,29360128:67174400,30408704:260,31457280:65796,32505856:67174404,17301504:67108864,18350080:260,19398656:67174656,20447232:0,21495808:65540,22544384:67109120,23592960:256,24641536:67174404,25690112:65536,26738688:67174660,27787264:65796,28835840:67108868,29884416:67109124,30932992:67174400,31981568:4,33030144:65792},{0:2151682048,65536:2147487808,131072:4198464,196608:2151677952,262144:0,327680:4198400,393216:2147483712,458752:4194368,524288:2147483648,589824:4194304,655360:64,720896:2147487744,786432:2151678016,851968:4160,917504:4096,983040:2151682112,32768:2147487808,98304:64,163840:2151678016,229376:2147487744,294912:4198400,360448:2151682112,425984:0,491520:2151677952,557056:4096,622592:2151682048,688128:4194304,753664:4160,819200:2147483648,884736:4194368,950272:4198464,1015808:2147483712,1048576:4194368,1114112:4198400,1179648:2147483712,1245184:0,1310720:4160,1376256:2151678016,1441792:2151682048,1507328:2147487808,1572864:2151682112,1638400:2147483648,1703936:2151677952,1769472:4198464,1835008:2147487744,1900544:4194304,1966080:64,2031616:4096,1081344:2151677952,1146880:2151682112,1212416:0,1277952:4198400,1343488:4194368,1409024:2147483648,1474560:2147487808,1540096:64,1605632:2147483712,1671168:4096,1736704:2147487744,1802240:2151678016,1867776:4160,1933312:2151682048,1998848:4194304,2064384:4198464},{0:128,4096:17039360,8192:262144,12288:536870912,16384:537133184,20480:16777344,24576:553648256,28672:262272,32768:16777216,36864:537133056,40960:536871040,45056:553910400,49152:553910272,53248:0,57344:17039488,61440:553648128,2048:17039488,6144:553648256,10240:128,14336:17039360,18432:262144,22528:537133184,26624:553910272,30720:536870912,34816:537133056,38912:0,43008:553910400,47104:16777344,51200:536871040,55296:553648128,59392:16777216,63488:262272,65536:262144,69632:128,73728:536870912,77824:553648256,81920:16777344,86016:553910272,90112:537133184,94208:16777216,98304:553910400,102400:553648128,106496:17039360,110592:537133056,114688:262272,118784:536871040,122880:0,126976:17039488,67584:553648256,71680:16777216,75776:17039360,79872:537133184,83968:536870912,88064:17039488,92160:128,96256:553910272,100352:262272,104448:553910400,108544:0,112640:553648128,116736:16777344,120832:262144,124928:537133056,129024:536871040},{0:268435464,256:8192,512:270532608,768:270540808,1024:268443648,1280:2097152,1536:2097160,1792:268435456,2048:0,2304:268443656,2560:2105344,2816:8,3072:270532616,3328:2105352,3584:8200,3840:270540800,128:270532608,384:270540808,640:8,896:2097152,1152:2105352,1408:268435464,1664:268443648,1920:8200,2176:2097160,2432:8192,2688:268443656,2944:270532616,3200:0,3456:270540800,3712:2105344,3968:268435456,4096:268443648,4352:270532616,4608:270540808,4864:8200,5120:2097152,5376:268435456,5632:268435464,5888:2105344,6144:2105352,6400:0,6656:8,6912:270532608,7168:8192,7424:268443656,7680:270540800,7936:2097160,4224:8,4480:2105344,4736:2097152,4992:268435464,5248:268443648,5504:8200,5760:270540808,6016:270532608,6272:270540800,6528:270532616,6784:8192,7040:2105352,7296:2097160,7552:0,7808:268435456,8064:268443656},{0:1048576,16:33555457,32:1024,48:1049601,64:34604033,80:0,96:1,112:34603009,128:33555456,144:1048577,160:33554433,176:34604032,192:34603008,208:1025,224:1049600,240:33554432,8:34603009,24:0,40:33555457,56:34604032,72:1048576,88:33554433,104:33554432,120:1025,136:1049601,152:33555456,168:34603008,184:1048577,200:1024,216:34604033,232:1,248:1049600,256:33554432,272:1048576,288:33555457,304:34603009,320:1048577,336:33555456,352:34604032,368:1049601,384:1025,400:34604033,416:1049600,432:1,448:0,464:34603008,480:33554433,496:1024,264:1049600,280:33555457,296:34603009,312:1,328:33554432,344:1048576,360:1025,376:34604032,392:33554433,408:34603008,424:0,440:34604033,456:1049601,472:1024,488:33555456,504:1048577},{0:134219808,1:131072,2:134217728,3:32,4:131104,5:134350880,6:134350848,7:2048,8:134348800,9:134219776,10:133120,11:134348832,12:2080,13:0,14:134217760,15:133152,2147483648:2048,2147483649:134350880,2147483650:134219808,2147483651:134217728,2147483652:134348800,2147483653:133120,2147483654:133152,2147483655:32,2147483656:134217760,2147483657:2080,2147483658:131104,2147483659:134350848,2147483660:0,2147483661:134348832,2147483662:134219776,2147483663:131072,16:133152,17:134350848,18:32,19:2048,20:134219776,21:134217760,22:134348832,23:131072,24:0,25:131104,26:134348800,27:134219808,28:134350880,29:133120,30:2080,31:134217728,2147483664:131072,2147483665:2048,2147483666:134348832,2147483667:133152,2147483668:32,2147483669:134348800,2147483670:134217728,2147483671:134219808,2147483672:134350880,2147483673:134217760,2147483674:134219776,2147483675:0,2147483676:133120,2147483677:2080,2147483678:131104,2147483679:134350848}],A=[4160749569,528482304,33030144,2064384,129024,8064,504,2147483679],H=E.DES=B.extend({_doReset:function(){for(var I=this._key.words,p=[],m=0;m<56;m++){var S=v[m]-1;p[m]=I[S>>>5]>>>31-S%32&1}for(var O=this._subKeys=[],V=0;V<16;V++){var G=O[V]=[],k=h[V];for(m=0;m<24;m++)G[m/6|0]|=p[(y[m]-1+k)%28]<<31-m%6,G[4+(m/6|0)]|=p[28+(y[m+24]-1+k)%28]<<31-m%6;for(G[0]=G[0]<<1|G[0]>>>31,m=1;m<7;m++)G[m]=G[m]>>>4*(m-1)+3;G[7]=G[7]<<5|G[7]>>>27}var P=this._invSubKeys=[];for(m=0;m<16;m++)P[m]=O[15-m]},encryptBlock:function(T,I){this._doCryptBlock(T,I,this._subKeys)},decryptBlock:function(T,I){this._doCryptBlock(T,I,this._invSubKeys)},_doCryptBlock:function(T,I,p){this._lBlock=T[I],this._rBlock=T[I+1],C.call(this,4,252645135),C.call(this,16,65535),_.call(this,2,858993459),_.call(this,8,16711935),C.call(this,1,1431655765);for(var m=0;m<16;m++){for(var S=p[m],O=this._lBlock,V=this._rBlock,G=0,k=0;k<8;k++)G|=x[k][((V^S[k])&A[k])>>>0];this._lBlock=V,this._rBlock=O^G}var P=this._lBlock;this._lBlock=this._rBlock,this._rBlock=P,C.call(this,1,1431655765),_.call(this,8,16711935),_.call(this,2,858993459),C.call(this,16,65535),C.call(this,4,252645135),T[I]=this._lBlock,T[I+1]=this._rBlock},keySize:2,ivSize:2,blockSize:2});function C(T,I){var p=(this._lBlock>>>T^this._rBlock)&I;this._rBlock^=p,this._lBlock^=p<<T}function _(T,I){var p=(this._rBlock>>>T^this._lBlock)&I;this._lBlock^=p,this._rBlock^=p<<T}i.DES=B._createHelper(H);var N=E.TripleDES=B.extend({_doReset:function(){var I=this._key.words;if(2!==I.length&&4!==I.length&&I.length<6)throw new Error("Invalid key length - 3DES requires the key length to be 64, 128, 192 or >192.");var p=I.slice(0,2),m=I.length<4?I.slice(0,2):I.slice(2,4),S=I.length<6?I.slice(0,2):I.slice(4,6);this._des1=H.createEncryptor(c.create(p)),this._des2=H.createEncryptor(c.create(m)),this._des3=H.createEncryptor(c.create(S))},encryptBlock:function(T,I){this._des1.encryptBlock(T,I),this._des2.decryptBlock(T,I),this._des3.encryptBlock(T,I)},decryptBlock:function(T,I){this._des3.decryptBlock(T,I),this._des2.encryptBlock(T,I),this._des1.decryptBlock(T,I)},keySize:6,ivSize:2,blockSize:2});i.TripleDES=B._createHelper(N)}(),s.TripleDES)},401:function(De,J,M){var c,B,E,v,s;De.exports=(s=M(7585),B=(c=s.lib).Base,E=c.WordArray,(v=s.x64={}).Word=B.extend({init:function(x,A){this.high=x,this.low=A}}),v.WordArray=B.extend({init:function(x,A){x=this.words=x||[],this.sigBytes=null!=A?A:8*x.length},toX32:function(){for(var x=this.words,A=x.length,H=[],C=0;C<A;C++){var _=x[C];H.push(_.high),H.push(_.low)}return E.create(H,this.sigBytes)},clone:function(){for(var x=B.clone.call(this),A=x.words=this.words.slice(0),H=A.length,C=0;C<H;C++)A[C]=A[C].clone();return x}}),s)},4901:De=>{"use strict";var J={single_source_shortest_paths:function(M,s,i){var d={},c={};c[s]=0;var E,v,y,h,x,H,B=J.PriorityQueue.make();for(B.push(s,0);!B.empty();)for(y in h=(E=B.pop()).cost,x=M[v=E.value]||{})x.hasOwnProperty(y)&&(H=h+x[y],(typeof c[y]>"u"||c[y]>H)&&(c[y]=H,B.push(y,H),d[y]=v));if(typeof i<"u"&&typeof c[i]>"u"){var N=["Could not find a path from ",s," to ",i,"."].join("");throw new Error(N)}return d},extract_shortest_path_from_predecessor_list:function(M,s){for(var i=[],d=s;d;)i.push(d),d=M[d];return i.reverse(),i},find_path:function(M,s,i){var d=J.single_source_shortest_paths(M,s,i);return J.extract_shortest_path_from_predecessor_list(d,i)},PriorityQueue:{make:function(M){var d,s=J.PriorityQueue,i={};for(d in M=M||{},s)s.hasOwnProperty(d)&&(i[d]=s[d]);return i.queue=[],i.sorter=M.sorter||s.default_sorter,i},default_sorter:function(M,s){return M.cost-s.cost},push:function(M,s){this.queue.push({value:M,cost:s}),this.queue.sort(this.sorter)},pop:function(){return this.queue.shift()},empty:function(){return 0===this.queue.length}}};De.exports=J},8419:De=>{"use strict";De.exports=function(M){for(var s=[],i=M.length,d=0;d<i;d++){var c=M.charCodeAt(d);if(c>=55296&&c<=56319&&i>d+1){var B=M.charCodeAt(d+1);B>=56320&&B<=57343&&(c=1024*(c-55296)+B-56320+65536,d+=1)}c<128?s.push(c):c<2048?(s.push(c>>6|192),s.push(63&c|128)):c<55296||c>=57344&&c<65536?(s.push(c>>12|224),s.push(c>>6&63|128),s.push(63&c|128)):c>=65536&&c<=1114111?(s.push(c>>18|240),s.push(c>>12&63|128),s.push(c>>6&63|128),s.push(63&c|128)):s.push(239,191,189)}return new Uint8Array(s).buffer}},4327:function(De,J){var i;void 0!==(i=function(){"use strict";function c(x,A,H){var C=new XMLHttpRequest;C.open("GET",x),C.responseType="blob",C.onload=function(){h(C.response,A,H)},C.onerror=function(){console.error("could not download file")},C.send()}function B(x){var A=new XMLHttpRequest;A.open("HEAD",x,!1);try{A.send()}catch{}return 200<=A.status&&299>=A.status}function E(x){try{x.dispatchEvent(new MouseEvent("click"))}catch{var A=document.createEvent("MouseEvents");A.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),x.dispatchEvent(A)}}var v="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof global&&global.global===global?global:void 0,y=v.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),h=v.saveAs||("object"!=typeof window||window!==v?function(){}:"download"in HTMLAnchorElement.prototype&&!y?function(x,A,H){var C=v.URL||v.webkitURL,_=document.createElement("a");_.download=A=A||x.name||"download",_.rel="noopener","string"==typeof x?(_.href=x,_.origin===location.origin?E(_):B(_.href)?c(x,A,H):E(_,_.target="_blank")):(_.href=C.createObjectURL(x),setTimeout(function(){C.revokeObjectURL(_.href)},4e4),setTimeout(function(){E(_)},0))}:"msSaveOrOpenBlob"in navigator?function(x,A,H){if(A=A||x.name||"download","string"!=typeof x)navigator.msSaveOrOpenBlob(function d(x,A){return typeof A>"u"?A={autoBom:!1}:"object"!=typeof A&&(console.warn("Deprecated: Expected third argument to be a object"),A={autoBom:!A}),A.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(x.type)?new Blob(["\ufeff",x],{type:x.type}):x}(x,H),A);else if(B(x))c(x,A,H);else{var C=document.createElement("a");C.href=x,C.target="_blank",setTimeout(function(){E(C)})}}:function(x,A,H,C){if((C=C||open("","_blank"))&&(C.document.title=C.document.body.innerText="downloading..."),"string"==typeof x)return c(x,A,H);var _="application/octet-stream"===x.type,N=/constructor/i.test(v.HTMLElement)||v.safari,T=/CriOS\/[\d]+/.test(navigator.userAgent);if((T||_&&N||y)&&typeof FileReader<"u"){var I=new FileReader;I.onloadend=function(){var S=I.result;S=T?S:S.replace(/^data:[^;]*;/,"data:attachment/file;"),C?C.location.href=S:location=S,C=null},I.readAsDataURL(x)}else{var p=v.URL||v.webkitURL,m=p.createObjectURL(x);C?C.location=m:location.href=m,C=null,setTimeout(function(){p.revokeObjectURL(m)},4e4)}});v.saveAs=h.saveAs=h,De.exports=h}.apply(J,[]))&&(De.exports=i)},1298:(De,J,M)=>{var s=M(8659);function i(_,N){s.cipher.registerAlgorithm(_,function(){return new s.aes.Algorithm(_,N)})}M(3311),M(3481),M(4747),De.exports=s.aes=s.aes||{},s.aes.startEncrypting=function(_,N,T,I){var p=C({key:_,output:T,decrypt:!1,mode:I});return p.start(N),p},s.aes.createEncryptionCipher=function(_,N){return C({key:_,output:null,decrypt:!1,mode:N})},s.aes.startDecrypting=function(_,N,T,I){var p=C({key:_,output:T,decrypt:!0,mode:I});return p.start(N),p},s.aes.createDecryptionCipher=function(_,N){return C({key:_,output:null,decrypt:!0,mode:N})},s.aes.Algorithm=function(_,N){d||x();var T=this;T.name=_,T.mode=new N({blockSize:16,cipher:{encrypt:function(I,p){return H(T._w,I,p,!1)},decrypt:function(I,p){return H(T._w,I,p,!0)}}}),T._init=!1},s.aes.Algorithm.prototype.initialize=function(_){if(!this._init){var T,N=_.key;if("string"!=typeof N||16!==N.length&&24!==N.length&&32!==N.length){if(s.util.isArray(N)&&(16===N.length||24===N.length||32===N.length)){T=N,N=s.util.createBuffer();for(var I=0;I<T.length;++I)N.putByte(T[I])}}else N=s.util.createBuffer(N);if(!s.util.isArray(N)){T=N,N=[];var p=T.length();if(16===p||24===p||32===p)for(p>>>=2,I=0;I<p;++I)N.push(T.getInt32())}if(!s.util.isArray(N)||4!==N.length&&6!==N.length&&8!==N.length)throw new Error("Invalid key parameter.");var S=-1!==["CFB","OFB","CTR","GCM"].indexOf(this.mode.name);this._w=A(N,_.decrypt&&!S),this._init=!0}},s.aes._expandKey=function(_,N){return d||x(),A(_,N)},s.aes._updateBlock=H,i("AES-ECB",s.cipher.modes.ecb),i("AES-CBC",s.cipher.modes.cbc),i("AES-CFB",s.cipher.modes.cfb),i("AES-OFB",s.cipher.modes.ofb),i("AES-CTR",s.cipher.modes.ctr),i("AES-GCM",s.cipher.modes.gcm);var B,E,v,y,h,d=!1;function x(){d=!0,v=[0,1,2,4,8,16,32,64,128,27,54];for(var _=new Array(256),N=0;N<128;++N)_[N]=N<<1,_[N+128]=N+128<<1^283;for(B=new Array(256),E=new Array(256),y=new Array(4),h=new Array(4),N=0;N<4;++N)y[N]=new Array(256),h[N]=new Array(256);var p,m,S,O,V,G,k,T=0,I=0;for(N=0;N<256;++N){B[T]=O=(O=I^I<<1^I<<2^I<<3^I<<4)>>8^255&O^99,E[O]=T,G=(V=_[O])<<24^O<<16^O<<8^O^V,k=((p=_[T])^(m=_[p])^(S=_[m]))<<24^(T^S)<<16^(T^m^S)<<8^T^p^S;for(var P=0;P<4;++P)y[P][T]=G,h[P][O]=k,G=G<<24|G>>>8,k=k<<24|k>>>8;0===T?T=I=1:(T=p^_[_[_[p^S]]],I^=_[_[I]])}}function A(_,N){for(var I,T=_.slice(0),p=1,m=T.length,O=4*(m+6+1),V=m;V<O;++V)I=T[V-1],V%m==0?(I=B[I>>>16&255]<<24^B[I>>>8&255]<<16^B[255&I]<<8^B[I>>>24]^v[p]<<24,p++):m>6&&V%m==4&&(I=B[I>>>24]<<24^B[I>>>16&255]<<16^B[I>>>8&255]<<8^B[255&I]),T[V]=T[V-m]^I;if(N){for(var G,k=h[0],P=h[1],D=h[2],l=h[3],F=T.slice(0),Y=(V=0,(O=T.length)-4);V<O;V+=4,Y-=4)if(0===V||V===O-4)F[V]=T[Y],F[V+1]=T[Y+3],F[V+2]=T[Y+2],F[V+3]=T[Y+1];else for(var W=0;W<4;++W)F[V+(3&-W)]=k[B[(G=T[Y+W])>>>24]]^P[B[G>>>16&255]]^D[B[G>>>8&255]]^l[B[255&G]];T=F}return T}function H(_,N,T,I){var m,S,O,V,G,k,P,D,l,F,Y,W,p=_.length/4-1;I?(m=h[0],S=h[1],O=h[2],V=h[3],G=E):(m=y[0],S=y[1],O=y[2],V=y[3],G=B),k=N[0]^_[0],P=N[I?3:1]^_[1],D=N[2]^_[2],l=N[I?1:3]^_[3];for(var ne=3,de=1;de<p;++de)F=m[k>>>24]^S[P>>>16&255]^O[D>>>8&255]^V[255&l]^_[++ne],Y=m[P>>>24]^S[D>>>16&255]^O[l>>>8&255]^V[255&k]^_[++ne],W=m[D>>>24]^S[l>>>16&255]^O[k>>>8&255]^V[255&P]^_[++ne],l=m[l>>>24]^S[k>>>16&255]^O[P>>>8&255]^V[255&D]^_[++ne],k=F,P=Y,D=W;T[0]=G[k>>>24]<<24^G[P>>>16&255]<<16^G[D>>>8&255]<<8^G[255&l]^_[++ne],T[I?3:1]=G[P>>>24]<<24^G[D>>>16&255]<<16^G[l>>>8&255]<<8^G[255&k]^_[++ne],T[2]=G[D>>>24]<<24^G[l>>>16&255]<<16^G[k>>>8&255]<<8^G[255&P]^_[++ne],T[I?1:3]=G[l>>>24]<<24^G[k>>>16&255]<<16^G[P>>>8&255]<<8^G[255&D]^_[++ne]}function C(_){var I,T="AES-"+((_=_||{}).mode||"CBC").toUpperCase(),p=(I=_.decrypt?s.cipher.createDecipher(T,_.key):s.cipher.createCipher(T,_.key)).start;return I.start=function(m,S){var O=null;S instanceof s.util.ByteBuffer&&(O=S,S={}),(S=S||{}).output=O,S.iv=m,p.call(I,S)},I}},6683:(De,J,M)=>{var s=M(8659);M(1298),M(2266);var i=De.exports=s.tls;function d(h,x,A){var H=x.entity===s.tls.ConnectionEnd.client;h.read.cipherState={init:!1,cipher:s.cipher.createDecipher("AES-CBC",H?A.keys.server_write_key:A.keys.client_write_key),iv:H?A.keys.server_write_IV:A.keys.client_write_IV},h.write.cipherState={init:!1,cipher:s.cipher.createCipher("AES-CBC",H?A.keys.client_write_key:A.keys.server_write_key),iv:H?A.keys.client_write_IV:A.keys.server_write_IV},h.read.cipherFunction=v,h.write.cipherFunction=c,h.read.macLength=h.write.macLength=A.mac_length,h.read.macFunction=h.write.macFunction=i.hmac_sha1}function c(h,x){var C,A=!1,H=x.macFunction(x.macKey,x.sequenceNumber,h);h.fragment.putBytes(H),x.updateSequenceNumber(),C=h.version.minor===i.Versions.TLS_1_0.minor?x.cipherState.init?null:x.cipherState.iv:s.random.getBytesSync(16),x.cipherState.init=!0;var _=x.cipherState.cipher;return _.start({iv:C}),h.version.minor>=i.Versions.TLS_1_1.minor&&_.output.putBytes(C),_.update(h.fragment),_.finish(B)&&(h.fragment=_.output,h.length=h.fragment.length(),A=!0),A}function B(h,x,A){if(!A){var H=h-x.length()%h;x.fillWithByte(H-1,H)}return!0}function E(h,x,A){var H=!0;if(A){for(var C=x.length(),_=x.last(),N=C-1-_;N<C-1;++N)H=H&&x.at(N)==_;H&&x.truncate(_+1)}return H}function v(h,x){var H,A=!1;H=h.version.minor===i.Versions.TLS_1_0.minor?x.cipherState.init?null:x.cipherState.iv:h.fragment.getBytes(16),x.cipherState.init=!0;var C=x.cipherState.cipher;C.start({iv:H}),C.update(h.fragment),A=C.finish(E);var _=x.macLength,N=s.random.getBytesSync(_),T=C.output.length();T>=_?(h.fragment=C.output.getBytes(T-_),N=C.output.getBytes(_)):h.fragment=C.output.getBytes(),h.fragment=s.util.createBuffer(h.fragment),h.length=h.fragment.length();var I=x.macFunction(x.macKey,x.sequenceNumber,h);return x.updateSequenceNumber(),A=function y(h,x,A){var H=s.hmac.create();return H.start("SHA1",h),H.update(x),x=H.digest().getBytes(),H.start(null,null),H.update(A),x===(A=H.digest().getBytes())}(x.macKey,N,I)&&A,A}i.CipherSuites.TLS_RSA_WITH_AES_128_CBC_SHA={id:[0,47],name:"TLS_RSA_WITH_AES_128_CBC_SHA",initSecurityParameters:function(h){h.bulk_cipher_algorithm=i.BulkCipherAlgorithm.aes,h.cipher_type=i.CipherType.block,h.enc_key_length=16,h.block_length=16,h.fixed_iv_length=16,h.record_iv_length=16,h.mac_algorithm=i.MACAlgorithm.hmac_sha1,h.mac_length=20,h.mac_key_length=20},initConnectionState:d},i.CipherSuites.TLS_RSA_WITH_AES_256_CBC_SHA={id:[0,53],name:"TLS_RSA_WITH_AES_256_CBC_SHA",initSecurityParameters:function(h){h.bulk_cipher_algorithm=i.BulkCipherAlgorithm.aes,h.cipher_type=i.CipherType.block,h.enc_key_length=32,h.block_length=16,h.fixed_iv_length=16,h.record_iv_length=16,h.mac_algorithm=i.MACAlgorithm.hmac_sha1,h.mac_length=20,h.mac_key_length=20},initConnectionState:d}},8877:(De,J,M)=>{var s=M(8659);M(7791);var i=s.asn1;J.privateKeyValidator={name:"PrivateKeyInfo",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:i.Class.UNIVERSAL,type:i.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:i.Class.UNIVERSAL,type:i.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]},J.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{tagClass:i.Class.UNIVERSAL,type:i.Type.BITSTRING,constructed:!1,composed:!0,captureBitStringValue:"ed25519PublicKey"}]}},7791:(De,J,M)=>{var s=M(8659);M(4747),M(6078);var i=De.exports=s.asn1=s.asn1||{};function d(v,y,h){if(h>y){var x=new Error("Too few bytes to parse DER.");throw x.available=v.length(),x.remaining=y,x.requested=h,x}}function B(v,y,h,x){var A;d(v,y,2);var H=v.getByte();y--;var C=192&H,_=31&H;A=v.length();var N=function(v,y){var h=v.getByte();if(y--,128!==h){var x;if(128&h){var H=127&h;d(v,y,H),x=v.getInt(H<<3)}else x=h;if(x<0)throw new Error("Negative length: "+x);return x}}(v,y);if(y-=A-v.length(),void 0!==N&&N>y){if(x.strict){var T=new Error("Too few bytes to read ASN.1 value.");throw T.available=v.length(),T.remaining=y,T.requested=N,T}N=y}var I,p,m=32==(32&H);if(m)if(I=[],void 0===N)for(;;){if(d(v,y,2),v.bytes(2)===String.fromCharCode(0,0)){v.getBytes(2),y-=2;break}A=v.length(),I.push(B(v,y,h+1,x)),y-=A-v.length()}else for(;N>0;)A=v.length(),I.push(B(v,N,h+1,x)),y-=A-v.length(),N-=A-v.length();if(void 0===I&&C===i.Class.UNIVERSAL&&_===i.Type.BITSTRING&&(p=v.bytes(N)),void 0===I&&x.decodeBitStrings&&C===i.Class.UNIVERSAL&&_===i.Type.BITSTRING&&N>1){var S=v.read,O=y,V=0;if(_===i.Type.BITSTRING&&(d(v,y,1),V=v.getByte(),y--),0===V)try{A=v.length();var k=B(v,y,h+1,{strict:!0,decodeBitStrings:!0}),P=A-v.length();y-=P,_==i.Type.BITSTRING&&P++;var D=k.tagClass;P===N&&(D===i.Class.UNIVERSAL||D===i.Class.CONTEXT_SPECIFIC)&&(I=[k])}catch{}void 0===I&&(v.read=S,y=O)}if(void 0===I){if(void 0===N){if(x.strict)throw new Error("Non-constructed ASN.1 object of indefinite length.");N=y}if(_===i.Type.BMPSTRING)for(I="";N>0;N-=2)d(v,y,2),I+=String.fromCharCode(v.getInt16()),y-=2;else I=v.getBytes(N),y-=N}return i.create(C,_,m,I,void 0===p?null:{bitStringContents:p})}i.Class={UNIVERSAL:0,APPLICATION:64,CONTEXT_SPECIFIC:128,PRIVATE:192},i.Type={NONE:0,BOOLEAN:1,INTEGER:2,BITSTRING:3,OCTETSTRING:4,NULL:5,OID:6,ODESC:7,EXTERNAL:8,REAL:9,ENUMERATED:10,EMBEDDED:11,UTF8:12,ROID:13,SEQUENCE:16,SET:17,PRINTABLESTRING:19,IA5STRING:22,UTCTIME:23,GENERALIZEDTIME:24,BMPSTRING:30},i.create=function(v,y,h,x,A){if(s.util.isArray(x)){for(var H=[],C=0;C<x.length;++C)void 0!==x[C]&&H.push(x[C]);x=H}var _={tagClass:v,type:y,constructed:h,composed:h||s.util.isArray(x),value:x};return A&&"bitStringContents"in A&&(_.bitStringContents=A.bitStringContents,_.original=i.copy(_)),_},i.copy=function(v,y){var h;if(s.util.isArray(v)){h=[];for(var x=0;x<v.length;++x)h.push(i.copy(v[x],y));return h}return"string"==typeof v?v:(h={tagClass:v.tagClass,type:v.type,constructed:v.constructed,composed:v.composed,value:i.copy(v.value,y)},y&&!y.excludeBitStringContents&&(h.bitStringContents=v.bitStringContents),h)},i.equals=function(v,y,h){if(s.util.isArray(v)){if(!s.util.isArray(y)||v.length!==y.length)return!1;for(var x=0;x<v.length;++x)if(!i.equals(v[x],y[x]))return!1;return!0}if(typeof v!=typeof y)return!1;if("string"==typeof v)return v===y;var A=v.tagClass===y.tagClass&&v.type===y.type&&v.constructed===y.constructed&&v.composed===y.composed&&i.equals(v.value,y.value);return h&&h.includeBitStringContents&&(A=A&&v.bitStringContents===y.bitStringContents),A},i.getBerValueLength=function(v){var y=v.getByte();if(128!==y)return 128&y?v.getInt((127&y)<<3):y},i.fromDer=function(v,y){void 0===y&&(y={strict:!0,parseAllBytes:!0,decodeBitStrings:!0}),"boolean"==typeof y&&(y={strict:y,parseAllBytes:!0,decodeBitStrings:!0}),"strict"in y||(y.strict=!0),"parseAllBytes"in y||(y.parseAllBytes=!0),"decodeBitStrings"in y||(y.decodeBitStrings=!0),"string"==typeof v&&(v=s.util.createBuffer(v));var h=v.length(),x=B(v,v.length(),0,y);if(y.parseAllBytes&&0!==v.length()){var A=new Error("Unparsed DER bytes remain after ASN.1 parsing.");throw A.byteCount=h,A.remaining=v.length(),A}return x},i.toDer=function(v){var y=s.util.createBuffer(),h=v.tagClass|v.type,x=s.util.createBuffer(),A=!1;if("bitStringContents"in v&&(A=!0,v.original&&(A=i.equals(v,v.original))),A)x.putBytes(v.bitStringContents);else if(v.composed){v.constructed?h|=32:x.putByte(0);for(var H=0;H<v.value.length;++H)void 0!==v.value[H]&&x.putBuffer(i.toDer(v.value[H]))}else if(v.type===i.Type.BMPSTRING)for(H=0;H<v.value.length;++H)x.putInt16(v.value.charCodeAt(H));else v.type===i.Type.INTEGER&&v.value.length>1&&(0===v.value.charCodeAt(0)&&0==(128&v.value.charCodeAt(1))||255===v.value.charCodeAt(0)&&128==(128&v.value.charCodeAt(1)))?x.putBytes(v.value.substr(1)):x.putBytes(v.value);if(y.putByte(h),x.length()<=127)y.putByte(127&x.length());else{var C=x.length(),_="";do{_+=String.fromCharCode(255&C),C>>>=8}while(C>0);for(y.putByte(128|_.length),H=_.length-1;H>=0;--H)y.putByte(_.charCodeAt(H))}return y.putBuffer(x),y},i.oidToDer=function(v){var y=v.split("."),h=s.util.createBuffer();h.putByte(40*parseInt(y[0],10)+parseInt(y[1],10));for(var x,A,H,C,_=2;_<y.length;++_){x=!0,A=[],H=parseInt(y[_],10);do{C=127&H,H>>>=7,x||(C|=128),A.push(C),x=!1}while(H>0);for(var N=A.length-1;N>=0;--N)h.putByte(A[N])}return h},i.derToOid=function(v){var y;"string"==typeof v&&(v=s.util.createBuffer(v));var h=v.getByte();y=Math.floor(h/40)+"."+h%40;for(var x=0;v.length()>0;)x<<=7,128&(h=v.getByte())?x+=127&h:(y+="."+(x+h),x=0);return y},i.utcTimeToDate=function(v){var y=new Date,h=parseInt(v.substr(0,2),10);h=h>=50?1900+h:2e3+h;var x=parseInt(v.substr(2,2),10)-1,A=parseInt(v.substr(4,2),10),H=parseInt(v.substr(6,2),10),C=parseInt(v.substr(8,2),10),_=0;if(v.length>11){var N=v.charAt(10),T=10;"+"!==N&&"-"!==N&&(_=parseInt(v.substr(10,2),10),T+=2)}if(y.setUTCFullYear(h,x,A),y.setUTCHours(H,C,_,0),T&&("+"===(N=v.charAt(T))||"-"===N)){var m=60*parseInt(v.substr(T+1,2),10)+parseInt(v.substr(T+4,2),10);m*=6e4,y.setTime("+"===N?+y-m:+y+m)}return y},i.generalizedTimeToDate=function(v){var y=new Date,h=parseInt(v.substr(0,4),10),x=parseInt(v.substr(4,2),10)-1,A=parseInt(v.substr(6,2),10),H=parseInt(v.substr(8,2),10),C=parseInt(v.substr(10,2),10),_=parseInt(v.substr(12,2),10),N=0,T=0,I=!1;"Z"===v.charAt(v.length-1)&&(I=!0);var p=v.length-5,m=v.charAt(p);return"+"!==m&&"-"!==m||(T=60*parseInt(v.substr(p+1,2),10)+parseInt(v.substr(p+4,2),10),T*=6e4,"+"===m&&(T*=-1),I=!0),"."===v.charAt(14)&&(N=1e3*parseFloat(v.substr(14),10)),I?(y.setUTCFullYear(h,x,A),y.setUTCHours(H,C,_,N),y.setTime(+y+T)):(y.setFullYear(h,x,A),y.setHours(H,C,_,N)),y},i.dateToUtcTime=function(v){if("string"==typeof v)return v;var y="",h=[];h.push((""+v.getUTCFullYear()).substr(2)),h.push(""+(v.getUTCMonth()+1)),h.push(""+v.getUTCDate()),h.push(""+v.getUTCHours()),h.push(""+v.getUTCMinutes()),h.push(""+v.getUTCSeconds());for(var x=0;x<h.length;++x)h[x].length<2&&(y+="0"),y+=h[x];return y+"Z"},i.dateToGeneralizedTime=function(v){if("string"==typeof v)return v;var y="",h=[];h.push(""+v.getUTCFullYear()),h.push(""+(v.getUTCMonth()+1)),h.push(""+v.getUTCDate()),h.push(""+v.getUTCHours()),h.push(""+v.getUTCMinutes()),h.push(""+v.getUTCSeconds());for(var x=0;x<h.length;++x)h[x].length<2&&(y+="0"),y+=h[x];return y+"Z"},i.integerToDer=function(v){var y=s.util.createBuffer();if(v>=-128&&v<128)return y.putSignedInt(v,8);if(v>=-32768&&v<32768)return y.putSignedInt(v,16);if(v>=-8388608&&v<8388608)return y.putSignedInt(v,24);if(v>=-2147483648&&v<2147483648)return y.putSignedInt(v,32);var h=new Error("Integer too large; max is 32-bits.");throw h.integer=v,h},i.derToInteger=function(v){"string"==typeof v&&(v=s.util.createBuffer(v));var y=8*v.length();if(y>32)throw new Error("Integer too large; max is 32-bits.");return v.getSignedInt(y)},i.validate=function(v,y,h,x){var A=!1;if((v.tagClass===y.tagClass||typeof y.tagClass>"u")&&(v.type===y.type||typeof y.type>"u"))if(v.constructed===y.constructed||typeof y.constructed>"u"){if(A=!0,y.value&&s.util.isArray(y.value))for(var H=0,C=0;A&&C<y.value.length;++C)A=y.value[C].optional||!1,v.value[H]&&((A=i.validate(v.value[H],y.value[C],h,x))?++H:y.value[C].optional&&(A=!0)),!A&&x&&x.push("["+y.name+'] Tag class "'+y.tagClass+'", type "'+y.type+'" expected value length "'+y.value.length+'", got "'+v.value.length+'"');if(A&&h&&(y.capture&&(h[y.capture]=v.value),y.captureAsn1&&(h[y.captureAsn1]=v),y.captureBitStringContents&&"bitStringContents"in v&&(h[y.captureBitStringContents]=v.bitStringContents),y.captureBitStringValue&&"bitStringContents"in v))if(v.bitStringContents.length<2)h[y.captureBitStringValue]="";else{if(0!==v.bitStringContents.charCodeAt(0))throw new Error("captureBitStringValue only supported for zero unused bits");h[y.captureBitStringValue]=v.bitStringContents.slice(1)}}else x&&x.push("["+y.name+'] Expected constructed "'+y.constructed+'", got "'+v.constructed+'"');else x&&(v.tagClass!==y.tagClass&&x.push("["+y.name+'] Expected tag class "'+y.tagClass+'", got "'+v.tagClass+'"'),v.type!==y.type&&x.push("["+y.name+'] Expected type "'+y.type+'", got "'+v.type+'"'));return A};var E=/[^\\u0000-\\u00ff]/;i.prettyPrint=function(v,y,h){var x="";h=h||2,(y=y||0)>0&&(x+="\n");for(var A="",H=0;H<y*h;++H)A+=" ";switch(x+=A+"Tag: ",v.tagClass){case i.Class.UNIVERSAL:x+="Universal:";break;case i.Class.APPLICATION:x+="Application:";break;case i.Class.CONTEXT_SPECIFIC:x+="Context-Specific:";break;case i.Class.PRIVATE:x+="Private:"}if(v.tagClass===i.Class.UNIVERSAL)switch(x+=v.type,v.type){case i.Type.NONE:x+=" (None)";break;case i.Type.BOOLEAN:x+=" (Boolean)";break;case i.Type.INTEGER:x+=" (Integer)";break;case i.Type.BITSTRING:x+=" (Bit string)";break;case i.Type.OCTETSTRING:x+=" (Octet string)";break;case i.Type.NULL:x+=" (Null)";break;case i.Type.OID:x+=" (Object Identifier)";break;case i.Type.ODESC:x+=" (Object Descriptor)";break;case i.Type.EXTERNAL:x+=" (External or Instance of)";break;case i.Type.REAL:x+=" (Real)";break;case i.Type.ENUMERATED:x+=" (Enumerated)";break;case i.Type.EMBEDDED:x+=" (Embedded PDV)";break;case i.Type.UTF8:x+=" (UTF8)";break;case i.Type.ROID:x+=" (Relative Object Identifier)";break;case i.Type.SEQUENCE:x+=" (Sequence)";break;case i.Type.SET:x+=" (Set)";break;case i.Type.PRINTABLESTRING:x+=" (Printable String)";break;case i.Type.IA5String:x+=" (IA5String (ASCII))";break;case i.Type.UTCTIME:x+=" (UTC time)";break;case i.Type.GENERALIZEDTIME:x+=" (Generalized time)";break;case i.Type.BMPSTRING:x+=" (BMP String)"}else x+=v.type;if(x+="\n",x+=A+"Constructed: "+v.constructed+"\n",v.composed){var C=0,_="";for(H=0;H<v.value.length;++H)void 0!==v.value[H]&&(C+=1,_+=i.prettyPrint(v.value[H],y+1,h),H+1<v.value.length&&(_+=","));x+=A+"Sub values: "+C+_}else{if(x+=A+"Value: ",v.type===i.Type.OID){var N=i.derToOid(v.value);x+=N,s.pki&&s.pki.oids&&N in s.pki.oids&&(x+=" ("+s.pki.oids[N]+") ")}if(v.type===i.Type.INTEGER)try{x+=i.derToInteger(v.value)}catch{x+="0x"+s.util.bytesToHex(v.value)}else if(v.type===i.Type.BITSTRING){if(x+=v.value.length>1?"0x"+s.util.bytesToHex(v.value.slice(1)):"(none)",v.value.length>0){var T=v.value.charCodeAt(0);1==T?x+=" (1 unused bit shown)":T>1&&(x+=" ("+T+" unused bits shown)")}}else if(v.type===i.Type.OCTETSTRING)E.test(v.value)||(x+="("+v.value+") "),x+="0x"+s.util.bytesToHex(v.value);else if(v.type===i.Type.UTF8)try{x+=s.util.decodeUtf8(v.value)}catch(I){if("URI malformed"!==I.message)throw I;x+="0x"+s.util.bytesToHex(v.value)+" (malformed UTF8)"}else v.type===i.Type.PRINTABLESTRING||v.type===i.Type.IA5String?x+=v.value:E.test(v.value)?x+="0x"+s.util.bytesToHex(v.value):x+=0===v.value.length?"[null]":v.value}return x}},2020:De=>{var J={};De.exports=J;var M={};J.encode=function(i,d,c){if("string"!=typeof d)throw new TypeError('"alphabet" must be a string.');if(void 0!==c&&"number"!=typeof c)throw new TypeError('"maxline" must be a number.');var B="";if(i instanceof Uint8Array){var E=0,v=d.length,y=d.charAt(0),h=[0];for(E=0;E<i.length;++E){for(var x=0,A=i[E];x<h.length;++x)h[x]=(A+=h[x]<<8)%v,A=A/v|0;for(;A>0;)h.push(A%v),A=A/v|0}for(E=0;0===i[E]&&E<i.length-1;++E)B+=y;for(E=h.length-1;E>=0;--E)B+=d[h[E]]}else B=function s(i,d){var c=0,B=d.length,E=d.charAt(0),v=[0];for(c=0;c<i.length();++c){for(var y=0,h=i.at(c);y<v.length;++y)v[y]=(h+=v[y]<<8)%B,h=h/B|0;for(;h>0;)v.push(h%B),h=h/B|0}var x="";for(c=0;0===i.at(c)&&c<i.length()-1;++c)x+=E;for(c=v.length-1;c>=0;--c)x+=d[v[c]];return x}(i,d);if(c){var H=new RegExp(".{1,"+c+"}","g");B=B.match(H).join("\r\n")}return B},J.decode=function(i,d){if("string"!=typeof i)throw new TypeError('"input" must be a string.');if("string"!=typeof d)throw new TypeError('"alphabet" must be a string.');var c=M[d];if(!c){c=M[d]=[];for(var B=0;B<d.length;++B)c[d.charCodeAt(B)]=B}i=i.replace(/\s/g,"");var E=d.length,v=d.charAt(0),y=[0];for(B=0;B<i.length;B++){var h=c[i.charCodeAt(B)];if(void 0===h)return;for(var x=0,A=h;x<y.length;++x)y[x]=255&(A+=y[x]*E),A>>=8;for(;A>0;)y.push(255&A),A>>=8}for(var H=0;i[H]===v&&H<i.length-1;++H)y.push(0);return typeof Buffer<"u"?Buffer.from(y.reverse()):new Uint8Array(y.reverse())}},3311:(De,J,M)=>{var s=M(8659);M(4747),De.exports=s.cipher=s.cipher||{},s.cipher.algorithms=s.cipher.algorithms||{},s.cipher.createCipher=function(d,c){var B=d;if("string"==typeof B&&(B=s.cipher.getAlgorithm(B))&&(B=B()),!B)throw new Error("Unsupported algorithm: "+d);return new s.cipher.BlockCipher({algorithm:B,key:c,decrypt:!1})},s.cipher.createDecipher=function(d,c){var B=d;if("string"==typeof B&&(B=s.cipher.getAlgorithm(B))&&(B=B()),!B)throw new Error("Unsupported algorithm: "+d);return new s.cipher.BlockCipher({algorithm:B,key:c,decrypt:!0})},s.cipher.registerAlgorithm=function(d,c){d=d.toUpperCase(),s.cipher.algorithms[d]=c},s.cipher.getAlgorithm=function(d){return(d=d.toUpperCase())in s.cipher.algorithms?s.cipher.algorithms[d]:null};var i=s.cipher.BlockCipher=function(d){this.algorithm=d.algorithm,this.mode=this.algorithm.mode,this.blockSize=this.mode.blockSize,this._finish=!1,this._input=null,this.output=null,this._op=d.decrypt?this.mode.decrypt:this.mode.encrypt,this._decrypt=d.decrypt,this.algorithm.initialize(d)};i.prototype.start=function(d){d=d||{};var c={};for(var B in d)c[B]=d[B];c.decrypt=this._decrypt,this._finish=!1,this._input=s.util.createBuffer(),this.output=d.output||s.util.createBuffer(),this.mode.start(c)},i.prototype.update=function(d){for(d&&this._input.putBuffer(d);!this._op.call(this.mode,this._input,this.output,this._finish)&&!this._finish;);this._input.compact()},i.prototype.finish=function(d){d&&("ECB"===this.mode.name||"CBC"===this.mode.name)&&(this.mode.pad=function(B){return d(this.blockSize,B,!1)},this.mode.unpad=function(B){return d(this.blockSize,B,!0)});var c={};return c.decrypt=this._decrypt,c.overflow=this._input.length()%this.blockSize,!(!this._decrypt&&this.mode.pad&&!this.mode.pad(this._input,c)||(this._finish=!0,this.update(),this._decrypt&&this.mode.unpad&&!this.mode.unpad(this.output,c))||this.mode.afterFinish&&!this.mode.afterFinish(this.output,c))}},3481:(De,J,M)=>{var s=M(8659);M(4747),s.cipher=s.cipher||{};var i=De.exports=s.cipher.modes=s.cipher.modes||{};function d(E,v){if("string"==typeof E&&(E=s.util.createBuffer(E)),s.util.isArray(E)&&E.length>4){var y=E;E=s.util.createBuffer();for(var h=0;h<y.length;++h)E.putByte(y[h])}if(E.length()<v)throw new Error("Invalid IV length; got "+E.length()+" bytes and expected "+v+" bytes.");if(!s.util.isArray(E)){var x=[],A=v/4;for(h=0;h<A;++h)x.push(E.getInt32());E=x}return E}function c(E){E[E.length-1]=E[E.length-1]+1&4294967295}function B(E){return[E/4294967296|0,4294967295&E]}i.ecb=function(E){E=E||{},this.name="ECB",this.cipher=E.cipher,this.blockSize=E.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)},i.ecb.prototype.start=function(E){},i.ecb.prototype.encrypt=function(E,v,y){if(E.length()<this.blockSize&&!(y&&E.length()>0))return!0;for(var h=0;h<this._ints;++h)this._inBlock[h]=E.getInt32();for(this.cipher.encrypt(this._inBlock,this._outBlock),h=0;h<this._ints;++h)v.putInt32(this._outBlock[h])},i.ecb.prototype.decrypt=function(E,v,y){if(E.length()<this.blockSize&&!(y&&E.length()>0))return!0;for(var h=0;h<this._ints;++h)this._inBlock[h]=E.getInt32();for(this.cipher.decrypt(this._inBlock,this._outBlock),h=0;h<this._ints;++h)v.putInt32(this._outBlock[h])},i.ecb.prototype.pad=function(E,v){var y=E.length()===this.blockSize?this.blockSize:this.blockSize-E.length();return E.fillWithByte(y,y),!0},i.ecb.prototype.unpad=function(E,v){if(v.overflow>0)return!1;var y=E.length(),h=E.at(y-1);return!(h>this.blockSize<<2||(E.truncate(h),0))},i.cbc=function(E){E=E||{},this.name="CBC",this.cipher=E.cipher,this.blockSize=E.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)},i.cbc.prototype.start=function(E){if(null===E.iv){if(!this._prev)throw new Error("Invalid IV parameter.");this._iv=this._prev.slice(0)}else{if(!("iv"in E))throw new Error("Invalid IV parameter.");this._iv=d(E.iv,this.blockSize),this._prev=this._iv.slice(0)}},i.cbc.prototype.encrypt=function(E,v,y){if(E.length()<this.blockSize&&!(y&&E.length()>0))return!0;for(var h=0;h<this._ints;++h)this._inBlock[h]=this._prev[h]^E.getInt32();for(this.cipher.encrypt(this._inBlock,this._outBlock),h=0;h<this._ints;++h)v.putInt32(this._outBlock[h]);this._prev=this._outBlock},i.cbc.prototype.decrypt=function(E,v,y){if(E.length()<this.blockSize&&!(y&&E.length()>0))return!0;for(var h=0;h<this._ints;++h)this._inBlock[h]=E.getInt32();for(this.cipher.decrypt(this._inBlock,this._outBlock),h=0;h<this._ints;++h)v.putInt32(this._prev[h]^this._outBlock[h]);this._prev=this._inBlock.slice(0)},i.cbc.prototype.pad=function(E,v){var y=E.length()===this.blockSize?this.blockSize:this.blockSize-E.length();return E.fillWithByte(y,y),!0},i.cbc.prototype.unpad=function(E,v){if(v.overflow>0)return!1;var y=E.length(),h=E.at(y-1);return!(h>this.blockSize<<2||(E.truncate(h),0))},i.cfb=function(E){E=E||{},this.name="CFB",this.cipher=E.cipher,this.blockSize=E.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialBlock=new Array(this._ints),this._partialOutput=s.util.createBuffer(),this._partialBytes=0},i.cfb.prototype.start=function(E){if(!("iv"in E))throw new Error("Invalid IV parameter.");this._iv=d(E.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0},i.cfb.prototype.encrypt=function(E,v,y){var h=E.length();if(0===h)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),0===this._partialBytes&&h>=this.blockSize)for(var x=0;x<this._ints;++x)this._inBlock[x]=E.getInt32()^this._outBlock[x],v.putInt32(this._inBlock[x]);else{var A=(this.blockSize-h)%this.blockSize;for(A>0&&(A=this.blockSize-A),this._partialOutput.clear(),x=0;x<this._ints;++x)this._partialBlock[x]=E.getInt32()^this._outBlock[x],this._partialOutput.putInt32(this._partialBlock[x]);if(A>0)E.read-=this.blockSize;else for(x=0;x<this._ints;++x)this._inBlock[x]=this._partialBlock[x];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),A>0&&!y)return v.putBytes(this._partialOutput.getBytes(A-this._partialBytes)),this._partialBytes=A,!0;v.putBytes(this._partialOutput.getBytes(h-this._partialBytes)),this._partialBytes=0}},i.cfb.prototype.decrypt=function(E,v,y){var h=E.length();if(0===h)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),0===this._partialBytes&&h>=this.blockSize)for(var x=0;x<this._ints;++x)this._inBlock[x]=E.getInt32(),v.putInt32(this._inBlock[x]^this._outBlock[x]);else{var A=(this.blockSize-h)%this.blockSize;for(A>0&&(A=this.blockSize-A),this._partialOutput.clear(),x=0;x<this._ints;++x)this._partialBlock[x]=E.getInt32(),this._partialOutput.putInt32(this._partialBlock[x]^this._outBlock[x]);if(A>0)E.read-=this.blockSize;else for(x=0;x<this._ints;++x)this._inBlock[x]=this._partialBlock[x];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),A>0&&!y)return v.putBytes(this._partialOutput.getBytes(A-this._partialBytes)),this._partialBytes=A,!0;v.putBytes(this._partialOutput.getBytes(h-this._partialBytes)),this._partialBytes=0}},i.ofb=function(E){E=E||{},this.name="OFB",this.cipher=E.cipher,this.blockSize=E.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=s.util.createBuffer(),this._partialBytes=0},i.ofb.prototype.start=function(E){if(!("iv"in E))throw new Error("Invalid IV parameter.");this._iv=d(E.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0},i.ofb.prototype.encrypt=function(E,v,y){var h=E.length();if(0===E.length())return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),0===this._partialBytes&&h>=this.blockSize)for(var x=0;x<this._ints;++x)v.putInt32(E.getInt32()^this._outBlock[x]),this._inBlock[x]=this._outBlock[x];else{var A=(this.blockSize-h)%this.blockSize;for(A>0&&(A=this.blockSize-A),this._partialOutput.clear(),x=0;x<this._ints;++x)this._partialOutput.putInt32(E.getInt32()^this._outBlock[x]);if(A>0)E.read-=this.blockSize;else for(x=0;x<this._ints;++x)this._inBlock[x]=this._outBlock[x];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),A>0&&!y)return v.putBytes(this._partialOutput.getBytes(A-this._partialBytes)),this._partialBytes=A,!0;v.putBytes(this._partialOutput.getBytes(h-this._partialBytes)),this._partialBytes=0}},i.ofb.prototype.decrypt=i.ofb.prototype.encrypt,i.ctr=function(E){E=E||{},this.name="CTR",this.cipher=E.cipher,this.blockSize=E.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=s.util.createBuffer(),this._partialBytes=0},i.ctr.prototype.start=function(E){if(!("iv"in E))throw new Error("Invalid IV parameter.");this._iv=d(E.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0},i.ctr.prototype.encrypt=function(E,v,y){var h=E.length();if(0===h)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),0===this._partialBytes&&h>=this.blockSize)for(var x=0;x<this._ints;++x)v.putInt32(E.getInt32()^this._outBlock[x]);else{var A=(this.blockSize-h)%this.blockSize;for(A>0&&(A=this.blockSize-A),this._partialOutput.clear(),x=0;x<this._ints;++x)this._partialOutput.putInt32(E.getInt32()^this._outBlock[x]);if(A>0&&(E.read-=this.blockSize),this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),A>0&&!y)return v.putBytes(this._partialOutput.getBytes(A-this._partialBytes)),this._partialBytes=A,!0;v.putBytes(this._partialOutput.getBytes(h-this._partialBytes)),this._partialBytes=0}c(this._inBlock)},i.ctr.prototype.decrypt=i.ctr.prototype.encrypt,i.gcm=function(E){E=E||{},this.name="GCM",this.cipher=E.cipher,this.blockSize=E.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints),this._partialOutput=s.util.createBuffer(),this._partialBytes=0,this._R=3774873600},i.gcm.prototype.start=function(E){if(!("iv"in E))throw new Error("Invalid IV parameter.");var y,v=s.util.createBuffer(E.iv);if(this._cipherLength=0,y="additionalData"in E?s.util.createBuffer(E.additionalData):s.util.createBuffer(),this._tagLength="tagLength"in E?E.tagLength:128,this._tag=null,E.decrypt&&(this._tag=s.util.createBuffer(E.tag).getBytes(),this._tag.length!==this._tagLength/8))throw new Error("Authentication tag does not match tag length.");this._hashBlock=new Array(this._ints),this.tag=null,this._hashSubkey=new Array(this._ints),this.cipher.encrypt([0,0,0,0],this._hashSubkey),this.componentBits=4,this._m=this.generateHashTable(this._hashSubkey,this.componentBits);var h=v.length();if(12===h)this._j0=[v.getInt32(),v.getInt32(),v.getInt32(),1];else{for(this._j0=[0,0,0,0];v.length()>0;)this._j0=this.ghash(this._hashSubkey,this._j0,[v.getInt32(),v.getInt32(),v.getInt32(),v.getInt32()]);this._j0=this.ghash(this._hashSubkey,this._j0,[0,0].concat(B(8*h)))}this._inBlock=this._j0.slice(0),c(this._inBlock),this._partialBytes=0,y=s.util.createBuffer(y),this._aDataLength=B(8*y.length());var x=y.length()%this.blockSize;for(x&&y.fillWithByte(0,this.blockSize-x),this._s=[0,0,0,0];y.length()>0;)this._s=this.ghash(this._hashSubkey,this._s,[y.getInt32(),y.getInt32(),y.getInt32(),y.getInt32()])},i.gcm.prototype.encrypt=function(E,v,y){var h=E.length();if(0===h)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),0===this._partialBytes&&h>=this.blockSize){for(var x=0;x<this._ints;++x)v.putInt32(this._outBlock[x]^=E.getInt32());this._cipherLength+=this.blockSize}else{var A=(this.blockSize-h)%this.blockSize;for(A>0&&(A=this.blockSize-A),this._partialOutput.clear(),x=0;x<this._ints;++x)this._partialOutput.putInt32(E.getInt32()^this._outBlock[x]);if(A<=0||y){if(y){var H=h%this.blockSize;this._cipherLength+=H,this._partialOutput.truncate(this.blockSize-H)}else this._cipherLength+=this.blockSize;for(x=0;x<this._ints;++x)this._outBlock[x]=this._partialOutput.getInt32();this._partialOutput.read-=this.blockSize}if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),A>0&&!y)return E.read-=this.blockSize,v.putBytes(this._partialOutput.getBytes(A-this._partialBytes)),this._partialBytes=A,!0;v.putBytes(this._partialOutput.getBytes(h-this._partialBytes)),this._partialBytes=0}this._s=this.ghash(this._hashSubkey,this._s,this._outBlock),c(this._inBlock)},i.gcm.prototype.decrypt=function(E,v,y){var h=E.length();if(h<this.blockSize&&!(y&&h>0))return!0;this.cipher.encrypt(this._inBlock,this._outBlock),c(this._inBlock),this._hashBlock[0]=E.getInt32(),this._hashBlock[1]=E.getInt32(),this._hashBlock[2]=E.getInt32(),this._hashBlock[3]=E.getInt32(),this._s=this.ghash(this._hashSubkey,this._s,this._hashBlock);for(var x=0;x<this._ints;++x)v.putInt32(this._outBlock[x]^this._hashBlock[x]);this._cipherLength+=h<this.blockSize?h%this.blockSize:this.blockSize},i.gcm.prototype.afterFinish=function(E,v){var y=!0;v.decrypt&&v.overflow&&E.truncate(this.blockSize-v.overflow),this.tag=s.util.createBuffer();var h=this._aDataLength.concat(B(8*this._cipherLength));this._s=this.ghash(this._hashSubkey,this._s,h);var x=[];this.cipher.encrypt(this._j0,x);for(var A=0;A<this._ints;++A)this.tag.putInt32(this._s[A]^x[A]);return this.tag.truncate(this.tag.length()%(this._tagLength/8)),v.decrypt&&this.tag.bytes()!==this._tag&&(y=!1),y},i.gcm.prototype.multiply=function(E,v){for(var y=[0,0,0,0],h=v.slice(0),x=0;x<128;++x)E[x/32|0]&1<<31-x%32&&(y[0]^=h[0],y[1]^=h[1],y[2]^=h[2],y[3]^=h[3]),this.pow(h,h);return y},i.gcm.prototype.pow=function(E,v){for(var y=1&E[3],h=3;h>0;--h)v[h]=E[h]>>>1|(1&E[h-1])<<31;v[0]=E[0]>>>1,y&&(v[0]^=this._R)},i.gcm.prototype.tableMultiply=function(E){for(var v=[0,0,0,0],y=0;y<32;++y){var A=this._m[y][E[y/8|0]>>>4*(7-y%8)&15];v[0]^=A[0],v[1]^=A[1],v[2]^=A[2],v[3]^=A[3]}return v},i.gcm.prototype.ghash=function(E,v,y){return v[0]^=y[0],v[1]^=y[1],v[2]^=y[2],v[3]^=y[3],this.tableMultiply(v)},i.gcm.prototype.generateHashTable=function(E,v){for(var y=8/v,h=4*y,x=16*y,A=new Array(x),H=0;H<x;++H){var C=[0,0,0,0];C[H/h|0]=1<<v-1<<(h-1-H%h)*v,A[H]=this.generateSubHashTable(this.multiply(C,E),v)}return A},i.gcm.prototype.generateSubHashTable=function(E,v){var y=1<<v,h=y>>>1,x=new Array(y);x[h]=E.slice(0);for(var A=h>>>1;A>0;)this.pow(x[2*A],x[A]=[]),A>>=1;for(A=2;A<h;){for(var H=1;H<A;++H){var C=x[A],_=x[H];x[A+H]=[C[0]^_[0],C[1]^_[1],C[2]^_[2],C[3]^_[3]]}A*=2}for(x[0]=[0,0,0,0],A=h+1;A<y;++A){var N=x[A^h];x[A]=[E[0]^N[0],E[1]^N[1],E[2]^N[2],E[3]^N[3]]}return x}},279:(De,J,M)=>{var s=M(8659);function i(_,N){s.cipher.registerAlgorithm(_,function(){return new s.des.Algorithm(_,N)})}M(3311),M(3481),M(4747),De.exports=s.des=s.des||{},s.des.startEncrypting=function(_,N,T,I){var p=C({key:_,output:T,decrypt:!1,mode:I||(null===N?"ECB":"CBC")});return p.start(N),p},s.des.createEncryptionCipher=function(_,N){return C({key:_,output:null,decrypt:!1,mode:N})},s.des.startDecrypting=function(_,N,T,I){var p=C({key:_,output:T,decrypt:!0,mode:I||(null===N?"ECB":"CBC")});return p.start(N),p},s.des.createDecryptionCipher=function(_,N){return C({key:_,output:null,decrypt:!0,mode:N})},s.des.Algorithm=function(_,N){var T=this;T.name=_,T.mode=new N({blockSize:8,cipher:{encrypt:function(I,p){return H(T._keys,I,p,!1)},decrypt:function(I,p){return H(T._keys,I,p,!0)}}}),T._init=!1},s.des.Algorithm.prototype.initialize=function(_){if(!this._init){var N=s.util.createBuffer(_.key);if(0===this.name.indexOf("3DES")&&24!==N.length())throw new Error("Invalid Triple-DES key size: "+8*N.length());this._keys=function A(_){for(var Ae,N=[0,4,536870912,536870916,65536,65540,536936448,536936452,512,516,536871424,536871428,66048,66052,536936960,536936964],T=[0,1,1048576,1048577,67108864,67108865,68157440,68157441,256,257,1048832,1048833,67109120,67109121,68157696,68157697],I=[0,8,2048,2056,16777216,16777224,16779264,16779272,0,8,2048,2056,16777216,16777224,16779264,16779272],p=[0,2097152,134217728,136314880,8192,2105344,134225920,136323072,131072,2228224,134348800,136445952,139264,2236416,134356992,136454144],m=[0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256],S=[0,1024,32,1056,0,1024,32,1056,33554432,33555456,33554464,33555488,33554432,33555456,33554464,33555488],O=[0,268435456,524288,268959744,2,268435458,524290,268959746,0,268435456,524288,268959744,2,268435458,524290,268959746],V=[0,65536,2048,67584,536870912,536936448,536872960,536938496,131072,196608,133120,198656,537001984,537067520,537004032,537069568],G=[0,262144,0,262144,2,262146,2,262146,33554432,33816576,33554432,33816576,33554434,33816578,33554434,33816578],k=[0,268435456,8,268435464,0,268435456,8,268435464,1024,268436480,1032,268436488,1024,268436480,1032,268436488],P=[0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800],D=[0,16777216,512,16777728,2097152,18874368,2097664,18874880,67108864,83886080,67109376,83886592,69206016,85983232,69206528,85983744],l=[0,4096,134217728,134221824,524288,528384,134742016,134746112,16,4112,134217744,134221840,524304,528400,134742032,134746128],F=[0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261],Y=_.length()>8?3:1,W=[],ne=[0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0],de=0,Re=0;Re<Y;Re++){var Fe=_.getInt32(),be=_.getInt32();Fe^=(Ae=252645135&(Fe>>>4^be))<<4,Fe^=Ae=65535&((be^=Ae)>>>-16^Fe),Fe^=(Ae=858993459&(Fe>>>2^(be^=Ae<<-16)))<<2,Fe^=Ae=65535&((be^=Ae)>>>-16^Fe),Fe^=(Ae=1431655765&(Fe>>>1^(be^=Ae<<-16)))<<1,Fe^=Ae=16711935&((be^=Ae)>>>8^Fe),Ae=(Fe^=(Ae=1431655765&(Fe>>>1^(be^=Ae<<8)))<<1)<<8|(be^=Ae)>>>20&240,Fe=be<<24|be<<8&16711680|be>>>8&65280|be>>>24&240,be=Ae;for(var Pe=0;Pe<ne.length;++Pe){ne[Pe]?(Fe=Fe<<2|Fe>>>26,be=be<<2|be>>>26):(Fe=Fe<<1|Fe>>>27,be=be<<1|be>>>27);var We=N[(Fe&=-15)>>>28]|T[Fe>>>24&15]|I[Fe>>>20&15]|p[Fe>>>16&15]|m[Fe>>>12&15]|S[Fe>>>8&15]|O[Fe>>>4&15],Ze=V[(be&=-15)>>>28]|G[be>>>24&15]|k[be>>>20&15]|P[be>>>16&15]|D[be>>>12&15]|l[be>>>8&15]|F[be>>>4&15];W[de++]=We^(Ae=65535&(Ze>>>16^We)),W[de++]=Ze^Ae<<16}}return W}(N),this._init=!0}},i("DES-ECB",s.cipher.modes.ecb),i("DES-CBC",s.cipher.modes.cbc),i("DES-CFB",s.cipher.modes.cfb),i("DES-OFB",s.cipher.modes.ofb),i("DES-CTR",s.cipher.modes.ctr),i("3DES-ECB",s.cipher.modes.ecb),i("3DES-CBC",s.cipher.modes.cbc),i("3DES-CFB",s.cipher.modes.cfb),i("3DES-OFB",s.cipher.modes.ofb),i("3DES-CTR",s.cipher.modes.ctr);var d=[16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756],c=[-2146402272,-2147450880,32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,-2147450848,-2147483616,1048608,1081344,0,-2147450880,32800,-2147483648,-2146435040,-2146402272,1081344],B=[520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584],E=[8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928],v=[256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080],y=[536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312],h=[2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154],x=[268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696];function H(_,N,T,I){var m,p=32===_.length?3:9;m=3===p?I?[30,-2,-2]:[0,32,2]:I?[94,62,-2,32,64,2,30,-2,-2]:[0,32,2,62,30,-2,64,96,2];var S,O=N[0],V=N[1];O^=(S=252645135&(O>>>4^V))<<4,O^=(S=65535&(O>>>16^(V^=S)))<<16,O^=S=858993459&((V^=S)>>>2^O),O^=S=16711935&((V^=S<<2)>>>8^O),O=(O^=(S=1431655765&(O>>>1^(V^=S<<8)))<<1)<<1|O>>>31,V=(V^=S)<<1|V>>>31;for(var G=0;G<p;G+=3){for(var k=m[G+1],P=m[G+2],D=m[G];D!=k;D+=P){var l=V^_[D],F=(V>>>4|V<<28)^_[D+1];S=O,O=V,V=S^(c[l>>>24&63]|E[l>>>16&63]|y[l>>>8&63]|x[63&l]|d[F>>>24&63]|B[F>>>16&63]|v[F>>>8&63]|h[63&F])}S=O,O=V,V=S}V=V>>>1|V<<31,V^=S=1431655765&((O=O>>>1|O<<31)>>>1^V),V^=(S=16711935&(V>>>8^(O^=S<<1)))<<8,V^=(S=858993459&(V>>>2^(O^=S)))<<2,V^=S=65535&((O^=S)>>>16^V),V^=S=252645135&((O^=S<<16)>>>4^V),T[0]=O^=S<<4,T[1]=V}function C(_){var I,T="DES-"+((_=_||{}).mode||"CBC").toUpperCase(),p=(I=_.decrypt?s.cipher.createDecipher(T,_.key):s.cipher.createCipher(T,_.key)).start;return I.start=function(m,S){var O=null;S instanceof s.util.ByteBuffer&&(O=S,S={}),(S=S||{}).output=O,S.iv=m,p.call(I,S)},I}},4187:(De,J,M)=>{var s=M(8659);M(730),M(8365),M(8985),M(4747);var i=M(8877),d=i.publicKeyValidator,c=i.privateKeyValidator;if(typeof B>"u")var B=s.jsbn.BigInteger;var E=s.util.ByteBuffer,v=typeof Buffer>"u"?Uint8Array:Buffer;s.pki=s.pki||{},De.exports=s.pki.ed25519=s.ed25519=s.ed25519||{};var y=s.ed25519;function h(Le){var Ge=Le.message;if(Ge instanceof Uint8Array||Ge instanceof v)return Ge;var K=Le.encoding;if(void 0===Ge){if(!Le.md)throw new TypeError('"options.message" or "options.md" not specified.');Ge=Le.md.digest().getBytes(),K="binary"}if("string"==typeof Ge&&!K)throw new TypeError('"options.encoding" must be "binary" or "utf8".');if("string"==typeof Ge){if(typeof Buffer<"u")return Buffer.from(Ge,K);Ge=new E(Ge,K)}else if(!(Ge instanceof E))throw new TypeError('"options.message" must be a node.js Buffer, a Uint8Array, a forge ByteBuffer, or a string with "options.encoding" specifying its encoding.');for(var U=new v(Ge.length()),ee=0;ee<U.length;++ee)U[ee]=Ge.at(ee);return U}y.constants={},y.constants.PUBLIC_KEY_BYTE_LENGTH=32,y.constants.PRIVATE_KEY_BYTE_LENGTH=64,y.constants.SEED_BYTE_LENGTH=32,y.constants.SIGN_BYTE_LENGTH=64,y.constants.HASH_BYTE_LENGTH=64,y.generateKeyPair=function(Le){var Ge=(Le=Le||{}).seed;if(void 0===Ge)Ge=s.random.getBytesSync(y.constants.SEED_BYTE_LENGTH);else if("string"==typeof Ge){if(Ge.length!==y.constants.SEED_BYTE_LENGTH)throw new TypeError('"seed" must be '+y.constants.SEED_BYTE_LENGTH+" bytes in length.")}else if(!(Ge instanceof Uint8Array))throw new TypeError('"seed" must be a node.js Buffer, Uint8Array, or a binary string.');Ge=h({message:Ge,encoding:"binary"});for(var K=new v(y.constants.PUBLIC_KEY_BYTE_LENGTH),U=new v(y.constants.PRIVATE_KEY_BYTE_LENGTH),ee=0;ee<32;++ee)U[ee]=Ge[ee];return function m(Le,Ge){var U,K=[tt(),tt(),tt(),tt()],ee=p(Ge,32);for(ee[0]&=248,ee[31]&=127,ee[31]|=64,be(K,ee),D(Le,K),U=0;U<32;++U)Ge[U+32]=Le[U]}(K,U),{publicKey:K,privateKey:U}},y.privateKeyFromAsn1=function(Le){var Ge={},K=[];if(!s.asn1.validate(Le,c,Ge,K)){var ee=new Error("Invalid Key.");throw ee.errors=K,ee}var me=s.asn1.derToOid(Ge.privateKeyOid),Ue=s.oids.EdDSA25519;if(me!==Ue)throw new Error('Invalid OID "'+me+'"; OID must be "'+Ue+'".');return{privateKeyBytes:h({message:s.asn1.fromDer(Ge.privateKey).value,encoding:"binary"})}},y.publicKeyFromAsn1=function(Le){var Ge={},K=[];if(!s.asn1.validate(Le,d,Ge,K)){var ee=new Error("Invalid Key.");throw ee.errors=K,ee}var me=s.asn1.derToOid(Ge.publicKeyOid),Ue=s.oids.EdDSA25519;if(me!==Ue)throw new Error('Invalid OID "'+me+'"; OID must be "'+Ue+'".');var z=Ge.ed25519PublicKey;if(z.length!==y.constants.PUBLIC_KEY_BYTE_LENGTH)throw new Error("Key length is invalid.");return h({message:z,encoding:"binary"})},y.publicKeyFromPrivateKey=function(Le){var Ge=h({message:(Le=Le||{}).privateKey,encoding:"binary"});if(Ge.length!==y.constants.PRIVATE_KEY_BYTE_LENGTH)throw new TypeError('"options.privateKey" must have a byte length of '+y.constants.PRIVATE_KEY_BYTE_LENGTH);for(var K=new v(y.constants.PUBLIC_KEY_BYTE_LENGTH),U=0;U<K.length;++U)K[U]=Ge[32+U];return K},y.sign=function(Le){var Ge=h(Le=Le||{}),K=h({message:Le.privateKey,encoding:"binary"});if(K.length===y.constants.SEED_BYTE_LENGTH)K=y.generateKeyPair({seed:K}).privateKey;else if(K.length!==y.constants.PRIVATE_KEY_BYTE_LENGTH)throw new TypeError('"options.privateKey" must have a byte length of '+y.constants.SEED_BYTE_LENGTH+" or "+y.constants.PRIVATE_KEY_BYTE_LENGTH);var ee=new v(y.constants.SIGN_BYTE_LENGTH+Ge.length);!function S(Le,Ge,K,U){var ee,me,Ue=new Float64Array(64),z=[tt(),tt(),tt(),tt()],Ie=p(U,32);Ie[0]&=248,Ie[31]&=127,Ie[31]|=64;var lt=K+64;for(ee=0;ee<K;++ee)Le[64+ee]=Ge[ee];for(ee=0;ee<32;++ee)Le[32+ee]=Ie[32+ee];var Pt=p(Le.subarray(32),K+32);for(G(Pt),be(z,Pt),D(Le,z),ee=32;ee<64;++ee)Le[ee]=U[ee];var kt=p(Le,K+64);for(G(kt),ee=32;ee<64;++ee)Ue[ee]=0;for(ee=0;ee<32;++ee)Ue[ee]=Pt[ee];for(ee=0;ee<32;++ee)for(me=0;me<32;me++)Ue[ee+me]+=kt[ee]*Ie[me];V(Le.subarray(32),Ue)}(ee,Ge,Ge.length,K);for(var me=new v(y.constants.SIGN_BYTE_LENGTH),Ue=0;Ue<me.length;++Ue)me[Ue]=ee[Ue];return me},y.verify=function(Le){var Ge=h(Le=Le||{});if(void 0===Le.signature)throw new TypeError('"options.signature" must be a node.js Buffer, a Uint8Array, a forge ByteBuffer, or a binary string.');var K=h({message:Le.signature,encoding:"binary"});if(K.length!==y.constants.SIGN_BYTE_LENGTH)throw new TypeError('"options.signature" must have a byte length of '+y.constants.SIGN_BYTE_LENGTH);var U=h({message:Le.publicKey,encoding:"binary"});if(U.length!==y.constants.PUBLIC_KEY_BYTE_LENGTH)throw new TypeError('"options.publicKey" must have a byte length of '+y.constants.PUBLIC_KEY_BYTE_LENGTH);var Ue,ee=new v(y.constants.SIGN_BYTE_LENGTH+Ge.length),me=new v(y.constants.SIGN_BYTE_LENGTH+Ge.length);for(Ue=0;Ue<y.constants.SIGN_BYTE_LENGTH;++Ue)ee[Ue]=K[Ue];for(Ue=0;Ue<Ge.length;++Ue)ee[Ue+y.constants.SIGN_BYTE_LENGTH]=Ge[Ue];return function O(Le,Ge,K,U){var ee,Ue=new v(32),z=[tt(),tt(),tt(),tt()],Ie=[tt(),tt(),tt(),tt()];if(K<64||function F(Le,Ge){var K=tt(),U=tt(),ee=tt(),me=tt(),Ue=tt(),z=tt(),Ie=tt();return Pe(Le[2],A),function Y(Le,Ge){var K;for(K=0;K<16;++K)Le[K]=Ge[2*K]+(Ge[2*K+1]<<8);Le[15]&=32767}(Le[1],Ge),jt(ee,Le[1]),Rt(me,ee,H),ct(ee,ee,Le[2]),Ht(me,Le[2],me),jt(Ue,me),jt(z,Ue),Rt(Ie,z,Ue),Rt(K,Ie,ee),Rt(K,K,me),function W(Le,Ge){var U,K=tt();for(U=0;U<16;++U)K[U]=Ge[U];for(U=250;U>=0;--U)jt(K,K),1!==U&&Rt(K,K,Ge);for(U=0;U<16;++U)Le[U]=K[U]}(K,K),Rt(K,K,ee),Rt(K,K,me),Rt(K,K,me),Rt(Le[0],K,me),jt(U,Le[0]),Rt(U,U,me),ne(U,ee)&&Rt(Le[0],Le[0],I),jt(U,Le[0]),Rt(U,U,me),ne(U,ee)?-1:(Re(Le[0])===Ge[31]>>7&&ct(Le[0],x,Le[0]),Rt(Le[3],Le[0],Le[1]),0)}(Ie,U))return-1;for(ee=0;ee<K;++ee)Le[ee]=Ge[ee];for(ee=0;ee<32;++ee)Le[ee+32]=U[ee];var lt=p(Le,K);if(G(lt),Fe(z,Ie,lt),be(Ie,Ge.subarray(32)),k(z,Ie),D(Ue,z),K-=64,de(Ge,0,Ue,0)){for(ee=0;ee<K;++ee)Le[ee]=0;return-1}for(ee=0;ee<K;++ee)Le[ee]=Ge[ee+64];return K}(me,ee,ee.length,U)>=0};var x=tt(),A=tt([1]),H=tt([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),C=tt([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),_=tt([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),N=tt([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),T=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]),I=tt([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function p(Le,Ge){var K=s.md.sha512.create(),U=new E(Le);K.update(U.getBytes(Ge),"binary");var ee=K.digest().getBytes();if(typeof Buffer<"u")return Buffer.from(ee,"binary");for(var me=new v(y.constants.HASH_BYTE_LENGTH),Ue=0;Ue<64;++Ue)me[Ue]=ee.charCodeAt(Ue);return me}function V(Le,Ge){var K,U,ee,me;for(U=63;U>=32;--U){for(K=0,ee=U-32,me=U-12;ee<me;++ee)Ge[ee]+=K-16*Ge[U]*T[ee-(U-32)],Ge[ee]-=256*(K=Ge[ee]+128>>8);Ge[ee]+=K,Ge[U]=0}for(K=0,ee=0;ee<32;++ee)Ge[ee]+=K-(Ge[31]>>4)*T[ee],K=Ge[ee]>>8,Ge[ee]&=255;for(ee=0;ee<32;++ee)Ge[ee]-=K*T[ee];for(U=0;U<32;++U)Ge[U+1]+=Ge[U]>>8,Le[U]=255&Ge[U]}function G(Le){for(var Ge=new Float64Array(64),K=0;K<64;++K)Ge[K]=Le[K],Le[K]=0;V(Le,Ge)}function k(Le,Ge){var K=tt(),U=tt(),ee=tt(),me=tt(),Ue=tt(),z=tt(),Ie=tt(),lt=tt(),Pt=tt();ct(K,Le[1],Le[0]),ct(Pt,Ge[1],Ge[0]),Rt(K,K,Pt),Ht(U,Le[0],Le[1]),Ht(Pt,Ge[0],Ge[1]),Rt(U,U,Pt),Rt(ee,Le[3],Ge[3]),Rt(ee,ee,C),Rt(me,Le[2],Ge[2]),Ht(me,me,me),ct(Ue,U,K),ct(z,me,ee),Ht(Ie,me,ee),Ht(lt,U,K),Rt(Le[0],Ue,z),Rt(Le[1],lt,Ie),Rt(Le[2],Ie,z),Rt(Le[3],Ue,lt)}function P(Le,Ge,K){for(var U=0;U<4;++U)Ct(Le[U],Ge[U],K)}function D(Le,Ge){var K=tt(),U=tt(),ee=tt();(function We(Le,Ge){var U,K=tt();for(U=0;U<16;++U)K[U]=Ge[U];for(U=253;U>=0;--U)jt(K,K),2!==U&&4!==U&&Rt(K,K,Ge);for(U=0;U<16;++U)Le[U]=K[U]})(ee,Ge[2]),Rt(K,Ge[0],ee),Rt(U,Ge[1],ee),l(Le,U),Le[31]^=Re(K)<<7}function l(Le,Ge){var K,U,ee,me=tt(),Ue=tt();for(K=0;K<16;++K)Ue[K]=Ge[K];for(Ze(Ue),Ze(Ue),Ze(Ue),U=0;U<2;++U){for(me[0]=Ue[0]-65517,K=1;K<15;++K)me[K]=Ue[K]-65535-(me[K-1]>>16&1),me[K-1]&=65535;me[15]=Ue[15]-32767-(me[14]>>16&1),ee=me[15]>>16&1,me[14]&=65535,Ct(Ue,me,1-ee)}for(K=0;K<16;K++)Le[2*K]=255&Ue[K],Le[2*K+1]=Ue[K]>>8}function ne(Le,Ge){var K=new v(32),U=new v(32);return l(K,Le),l(U,Ge),de(K,0,U,0)}function de(Le,Ge,K,U){return function Ae(Le,Ge,K,U,ee){var me,Ue=0;for(me=0;me<ee;++me)Ue|=Le[Ge+me]^K[U+me];return(1&Ue-1>>>8)-1}(Le,Ge,K,U,32)}function Re(Le){var Ge=new v(32);return l(Ge,Le),1&Ge[0]}function Fe(Le,Ge,K){var U,ee;for(Pe(Le[0],x),Pe(Le[1],A),Pe(Le[2],A),Pe(Le[3],x),ee=255;ee>=0;--ee)P(Le,Ge,U=K[ee/8|0]>>(7&ee)&1),k(Ge,Le),k(Le,Le),P(Le,Ge,U)}function be(Le,Ge){var K=[tt(),tt(),tt(),tt()];Pe(K[0],_),Pe(K[1],N),Pe(K[2],A),Rt(K[3],_,N),Fe(Le,K,Ge)}function Pe(Le,Ge){var K;for(K=0;K<16;K++)Le[K]=0|Ge[K]}function Ze(Le){var Ge,K,U=1;for(Ge=0;Ge<16;++Ge)K=Le[Ge]+U+65535,U=Math.floor(K/65536),Le[Ge]=K-65536*U;Le[0]+=U-1+37*(U-1)}function Ct(Le,Ge,K){for(var U,ee=~(K-1),me=0;me<16;++me)Le[me]^=U=ee&(Le[me]^Ge[me]),Ge[me]^=U}function tt(Le){var Ge,K=new Float64Array(16);if(Le)for(Ge=0;Ge<Le.length;++Ge)K[Ge]=Le[Ge];return K}function Ht(Le,Ge,K){for(var U=0;U<16;++U)Le[U]=Ge[U]+K[U]}function ct(Le,Ge,K){for(var U=0;U<16;++U)Le[U]=Ge[U]-K[U]}function jt(Le,Ge){Rt(Le,Ge,Ge)}function Rt(Le,Ge,K){var U,ee,me=0,Ue=0,z=0,Ie=0,lt=0,Pt=0,kt=0,at=0,_t=0,Vt=0,Qt=0,Z=0,ut=0,je=0,mt=0,X=0,ue=0,Me=0,et=0,gt=0,Tt=0,$t=0,qt=0,Lt=0,or=0,_r=0,Xt=0,cr=0,$r=0,Hr=0,Yr=0,yr=K[0],Cr=K[1],dr=K[2],lr=K[3],Ur=K[4],ir=K[5],pr=K[6],kr=K[7],zr=K[8],Mr=K[9],mr=K[10],wr=K[11],Ar=K[12],Tr=K[13],Ft=K[14],Dr=K[15];me+=(U=Ge[0])*yr,Ue+=U*Cr,z+=U*dr,Ie+=U*lr,lt+=U*Ur,Pt+=U*ir,kt+=U*pr,at+=U*kr,_t+=U*zr,Vt+=U*Mr,Qt+=U*mr,Z+=U*wr,ut+=U*Ar,je+=U*Tr,mt+=U*Ft,X+=U*Dr,Ue+=(U=Ge[1])*yr,z+=U*Cr,Ie+=U*dr,lt+=U*lr,Pt+=U*Ur,kt+=U*ir,at+=U*pr,_t+=U*kr,Vt+=U*zr,Qt+=U*Mr,Z+=U*mr,ut+=U*wr,je+=U*Ar,mt+=U*Tr,X+=U*Ft,ue+=U*Dr,z+=(U=Ge[2])*yr,Ie+=U*Cr,lt+=U*dr,Pt+=U*lr,kt+=U*Ur,at+=U*ir,_t+=U*pr,Vt+=U*kr,Qt+=U*zr,Z+=U*Mr,ut+=U*mr,je+=U*wr,mt+=U*Ar,X+=U*Tr,ue+=U*Ft,Me+=U*Dr,Ie+=(U=Ge[3])*yr,lt+=U*Cr,Pt+=U*dr,kt+=U*lr,at+=U*Ur,_t+=U*ir,Vt+=U*pr,Qt+=U*kr,Z+=U*zr,ut+=U*Mr,je+=U*mr,mt+=U*wr,X+=U*Ar,ue+=U*Tr,Me+=U*Ft,et+=U*Dr,lt+=(U=Ge[4])*yr,Pt+=U*Cr,kt+=U*dr,at+=U*lr,_t+=U*Ur,Vt+=U*ir,Qt+=U*pr,Z+=U*kr,ut+=U*zr,je+=U*Mr,mt+=U*mr,X+=U*wr,ue+=U*Ar,Me+=U*Tr,et+=U*Ft,gt+=U*Dr,Pt+=(U=Ge[5])*yr,kt+=U*Cr,at+=U*dr,_t+=U*lr,Vt+=U*Ur,Qt+=U*ir,Z+=U*pr,ut+=U*kr,je+=U*zr,mt+=U*Mr,X+=U*mr,ue+=U*wr,Me+=U*Ar,et+=U*Tr,gt+=U*Ft,Tt+=U*Dr,kt+=(U=Ge[6])*yr,at+=U*Cr,_t+=U*dr,Vt+=U*lr,Qt+=U*Ur,Z+=U*ir,ut+=U*pr,je+=U*kr,mt+=U*zr,X+=U*Mr,ue+=U*mr,Me+=U*wr,et+=U*Ar,gt+=U*Tr,Tt+=U*Ft,$t+=U*Dr,at+=(U=Ge[7])*yr,_t+=U*Cr,Vt+=U*dr,Qt+=U*lr,Z+=U*Ur,ut+=U*ir,je+=U*pr,mt+=U*kr,X+=U*zr,ue+=U*Mr,Me+=U*mr,et+=U*wr,gt+=U*Ar,Tt+=U*Tr,$t+=U*Ft,qt+=U*Dr,_t+=(U=Ge[8])*yr,Vt+=U*Cr,Qt+=U*dr,Z+=U*lr,ut+=U*Ur,je+=U*ir,mt+=U*pr,X+=U*kr,ue+=U*zr,Me+=U*Mr,et+=U*mr,gt+=U*wr,Tt+=U*Ar,$t+=U*Tr,qt+=U*Ft,Lt+=U*Dr,Vt+=(U=Ge[9])*yr,Qt+=U*Cr,Z+=U*dr,ut+=U*lr,je+=U*Ur,mt+=U*ir,X+=U*pr,ue+=U*kr,Me+=U*zr,et+=U*Mr,gt+=U*mr,Tt+=U*wr,$t+=U*Ar,qt+=U*Tr,Lt+=U*Ft,or+=U*Dr,Qt+=(U=Ge[10])*yr,Z+=U*Cr,ut+=U*dr,je+=U*lr,mt+=U*Ur,X+=U*ir,ue+=U*pr,Me+=U*kr,et+=U*zr,gt+=U*Mr,Tt+=U*mr,$t+=U*wr,qt+=U*Ar,Lt+=U*Tr,or+=U*Ft,_r+=U*Dr,Z+=(U=Ge[11])*yr,ut+=U*Cr,je+=U*dr,mt+=U*lr,X+=U*Ur,ue+=U*ir,Me+=U*pr,et+=U*kr,gt+=U*zr,Tt+=U*Mr,$t+=U*mr,qt+=U*wr,Lt+=U*Ar,or+=U*Tr,_r+=U*Ft,Xt+=U*Dr,ut+=(U=Ge[12])*yr,je+=U*Cr,mt+=U*dr,X+=U*lr,ue+=U*Ur,Me+=U*ir,et+=U*pr,gt+=U*kr,Tt+=U*zr,$t+=U*Mr,qt+=U*mr,Lt+=U*wr,or+=U*Ar,_r+=U*Tr,Xt+=U*Ft,cr+=U*Dr,je+=(U=Ge[13])*yr,mt+=U*Cr,X+=U*dr,ue+=U*lr,Me+=U*Ur,et+=U*ir,gt+=U*pr,Tt+=U*kr,$t+=U*zr,qt+=U*Mr,Lt+=U*mr,or+=U*wr,_r+=U*Ar,Xt+=U*Tr,cr+=U*Ft,$r+=U*Dr,mt+=(U=Ge[14])*yr,X+=U*Cr,ue+=U*dr,Me+=U*lr,et+=U*Ur,gt+=U*ir,Tt+=U*pr,$t+=U*kr,qt+=U*zr,Lt+=U*Mr,or+=U*mr,_r+=U*wr,Xt+=U*Ar,cr+=U*Tr,$r+=U*Ft,Hr+=U*Dr,X+=(U=Ge[15])*yr,Ue+=38*(Me+=U*dr),z+=38*(et+=U*lr),Ie+=38*(gt+=U*Ur),lt+=38*(Tt+=U*ir),Pt+=38*($t+=U*pr),kt+=38*(qt+=U*kr),at+=38*(Lt+=U*zr),_t+=38*(or+=U*Mr),Vt+=38*(_r+=U*mr),Qt+=38*(Xt+=U*wr),Z+=38*(cr+=U*Ar),ut+=38*($r+=U*Tr),je+=38*(Hr+=U*Ft),mt+=38*(Yr+=U*Dr),me=(U=(me+=38*(ue+=U*Cr))+(ee=1)+65535)-65536*(ee=Math.floor(U/65536)),Ue=(U=Ue+ee+65535)-65536*(ee=Math.floor(U/65536)),z=(U=z+ee+65535)-65536*(ee=Math.floor(U/65536)),Ie=(U=Ie+ee+65535)-65536*(ee=Math.floor(U/65536)),lt=(U=lt+ee+65535)-65536*(ee=Math.floor(U/65536)),Pt=(U=Pt+ee+65535)-65536*(ee=Math.floor(U/65536)),kt=(U=kt+ee+65535)-65536*(ee=Math.floor(U/65536)),at=(U=at+ee+65535)-65536*(ee=Math.floor(U/65536)),_t=(U=_t+ee+65535)-65536*(ee=Math.floor(U/65536)),Vt=(U=Vt+ee+65535)-65536*(ee=Math.floor(U/65536)),Qt=(U=Qt+ee+65535)-65536*(ee=Math.floor(U/65536)),Z=(U=Z+ee+65535)-65536*(ee=Math.floor(U/65536)),ut=(U=ut+ee+65535)-65536*(ee=Math.floor(U/65536)),je=(U=je+ee+65535)-65536*(ee=Math.floor(U/65536)),mt=(U=mt+ee+65535)-65536*(ee=Math.floor(U/65536)),X=(U=X+ee+65535)-65536*(ee=Math.floor(U/65536)),me=(U=(me+=ee-1+37*(ee-1))+(ee=1)+65535)-65536*(ee=Math.floor(U/65536)),Ue=(U=Ue+ee+65535)-65536*(ee=Math.floor(U/65536)),z=(U=z+ee+65535)-65536*(ee=Math.floor(U/65536)),Ie=(U=Ie+ee+65535)-65536*(ee=Math.floor(U/65536)),lt=(U=lt+ee+65535)-65536*(ee=Math.floor(U/65536)),Pt=(U=Pt+ee+65535)-65536*(ee=Math.floor(U/65536)),kt=(U=kt+ee+65535)-65536*(ee=Math.floor(U/65536)),at=(U=at+ee+65535)-65536*(ee=Math.floor(U/65536)),_t=(U=_t+ee+65535)-65536*(ee=Math.floor(U/65536)),Vt=(U=Vt+ee+65535)-65536*(ee=Math.floor(U/65536)),Qt=(U=Qt+ee+65535)-65536*(ee=Math.floor(U/65536)),Z=(U=Z+ee+65535)-65536*(ee=Math.floor(U/65536)),ut=(U=ut+ee+65535)-65536*(ee=Math.floor(U/65536)),je=(U=je+ee+65535)-65536*(ee=Math.floor(U/65536)),mt=(U=mt+ee+65535)-65536*(ee=Math.floor(U/65536)),X=(U=X+ee+65535)-65536*(ee=Math.floor(U/65536)),Le[0]=me+=ee-1+37*(ee-1),Le[1]=Ue,Le[2]=z,Le[3]=Ie,Le[4]=lt,Le[5]=Pt,Le[6]=kt,Le[7]=at,Le[8]=_t,Le[9]=Vt,Le[10]=Qt,Le[11]=Z,Le[12]=ut,Le[13]=je,Le[14]=mt,Le[15]=X}},8659:De=>{De.exports={options:{usePureJavaScript:!1}}},9032:(De,J,M)=>{var s=M(8659);M(979),M(4747),(De.exports=s.hmac=s.hmac||{}).create=function(){var d=null,c=null,B=null,E=null,v={start:function(y,h){if(null!==y)if("string"==typeof y){if(!((y=y.toLowerCase())in s.md.algorithms))throw new Error('Unknown hash algorithm "'+y+'"');c=s.md.algorithms[y].create()}else c=y;if(null===h)h=d;else{if("string"==typeof h)h=s.util.createBuffer(h);else if(s.util.isArray(h)){var x=h;h=s.util.createBuffer();for(var A=0;A<x.length;++A)h.putByte(x[A])}var H=h.length();for(H>c.blockLength&&(c.start(),c.update(h.bytes()),h=c.digest()),B=s.util.createBuffer(),E=s.util.createBuffer(),H=h.length(),A=0;A<H;++A)x=h.at(A),B.putByte(54^x),E.putByte(92^x);if(H<c.blockLength)for(x=c.blockLength-H,A=0;A<x;++A)B.putByte(54),E.putByte(92);d=h,B=B.bytes(),E=E.bytes()}c.start(),c.update(B)},update:function(y){c.update(y)},getMac:function(){var y=c.digest().bytes();return c.start(),c.update(E),c.update(y),c.digest()}};return v.digest=v.getMac,v}},592:(De,J,M)=>{De.exports=M(8659),M(1298),M(6683),M(7791),M(3311),M(279),M(4187),M(9032),M(7196),M(6113),M(4752),M(8449),M(7949),M(8604),M(7246),M(562),M(422),M(1965),M(9709),M(4473),M(7256),M(8365),M(209),M(1015),M(2266),M(4747)},730:(De,J,M)=>{var i,s=M(8659);function B(re,ce,fe){this.data=[],null!=re&&("number"==typeof re?this.fromNumber(re,ce,fe):this.fromString(re,null==ce&&"string"!=typeof re?256:ce))}function E(){return new B(null)}function h(re,ce,fe,Ve,ft,ht){for(var Bt=16383&ce,Dt=ce>>14;--ht>=0;){var br=16383&this.data[re],Zr=this.data[re++]>>14,Wr=Dt*br+Zr*Bt;ft=((br=Bt*br+((16383&Wr)<<14)+fe.data[Ve]+ft)>>28)+(Wr>>14)+Dt*Zr,fe.data[Ve++]=268435455&br}return ft}De.exports=s.jsbn=s.jsbn||{},s.jsbn.BigInteger=B,typeof navigator>"u"?(B.prototype.am=h,i=28):"Microsoft Internet Explorer"==navigator.appName?(B.prototype.am=function y(re,ce,fe,Ve,ft,ht){for(var Bt=32767&ce,Dt=ce>>15;--ht>=0;){var br=32767&this.data[re],Zr=this.data[re++]>>15,Wr=Dt*br+Zr*Bt;ft=((br=Bt*br+((32767&Wr)<<15)+fe.data[Ve]+(1073741823&ft))>>>30)+(Wr>>>15)+Dt*Zr+(ft>>>30),fe.data[Ve++]=1073741823&br}return ft},i=30):"Netscape"!=navigator.appName?(B.prototype.am=function v(re,ce,fe,Ve,ft,ht){for(;--ht>=0;){var Bt=ce*this.data[re++]+fe.data[Ve]+ft;ft=Math.floor(Bt/67108864),fe.data[Ve++]=67108863&Bt}return ft},i=26):(B.prototype.am=h,i=28),B.prototype.DB=i,B.prototype.DM=(1<<i)-1,B.prototype.DV=1<<i,B.prototype.FV=Math.pow(2,52),B.prototype.F1=52-i,B.prototype.F2=2*i-52;var C,_,H=new Array;for(C="0".charCodeAt(0),_=0;_<=9;++_)H[C++]=_;for(C="a".charCodeAt(0),_=10;_<36;++_)H[C++]=_;for(C="A".charCodeAt(0),_=10;_<36;++_)H[C++]=_;function N(re){return"0123456789abcdefghijklmnopqrstuvwxyz".charAt(re)}function T(re,ce){return H[re.charCodeAt(ce)]??-1}function m(re){var ce=E();return ce.fromInt(re),ce}function D(re){var fe,ce=1;return 0!=(fe=re>>>16)&&(re=fe,ce+=16),0!=(fe=re>>8)&&(re=fe,ce+=8),0!=(fe=re>>4)&&(re=fe,ce+=4),0!=(fe=re>>2)&&(re=fe,ce+=2),0!=(fe=re>>1)&&(re=fe,ce+=1),ce}function Pe(re){this.m=re}function jt(re){this.m=re,this.mp=re.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<re.DB-15)-1,this.mt2=2*re.t}function ue(re,ce){return re&ce}function et(re,ce){return re|ce}function Tt(re,ce){return re^ce}function qt(re,ce){return re&~ce}function cr(re){if(0==re)return-1;var ce=0;return 0==(65535&re)&&(re>>=16,ce+=16),0==(255&re)&&(re>>=8,ce+=8),0==(15&re)&&(re>>=4,ce+=4),0==(3&re)&&(re>>=2,ce+=2),0==(1&re)&&++ce,ce}function Hr(re){for(var ce=0;0!=re;)re&=re-1,++ce;return ce}function Ft(){}function Dr(re){return re}function cn(re){this.r2=E(),this.q3=E(),B.ONE.dlShiftTo(2*re.t,this.r2),this.mu=this.r2.divide(re),this.m=re}Pe.prototype.convert=function We(re){return re.s<0||re.compareTo(this.m)>=0?re.mod(this.m):re},Pe.prototype.revert=function Ze(re){return re},Pe.prototype.reduce=function Ct(re){re.divRemTo(this.m,null,re)},Pe.prototype.mulTo=function tt(re,ce,fe){re.multiplyTo(ce,fe),this.reduce(fe)},Pe.prototype.sqrTo=function Ht(re,ce){re.squareTo(ce),this.reduce(ce)},jt.prototype.convert=function Rt(re){var ce=E();return re.abs().dlShiftTo(this.m.t,ce),ce.divRemTo(this.m,null,ce),re.s<0&&ce.compareTo(B.ZERO)>0&&this.m.subTo(ce,ce),ce},jt.prototype.revert=function Le(re){var ce=E();return re.copyTo(ce),this.reduce(ce),ce},jt.prototype.reduce=function Ge(re){for(;re.t<=this.mt2;)re.data[re.t++]=0;for(var ce=0;ce<this.m.t;++ce){var fe=32767&re.data[ce],Ve=fe*this.mpl+((fe*this.mph+(re.data[ce]>>15)*this.mpl&this.um)<<15)&re.DM;for(re.data[fe=ce+this.m.t]+=this.m.am(0,Ve,re,ce,0,this.m.t);re.data[fe]>=re.DV;)re.data[fe]-=re.DV,re.data[++fe]++}re.clamp(),re.drShiftTo(this.m.t,re),re.compareTo(this.m)>=0&&re.subTo(this.m,re)},jt.prototype.mulTo=function U(re,ce,fe){re.multiplyTo(ce,fe),this.reduce(fe)},jt.prototype.sqrTo=function K(re,ce){re.squareTo(ce),this.reduce(ce)},B.prototype.copyTo=function I(re){for(var ce=this.t-1;ce>=0;--ce)re.data[ce]=this.data[ce];re.t=this.t,re.s=this.s},B.prototype.fromInt=function p(re){this.t=1,this.s=re<0?-1:0,re>0?this.data[0]=re:re<-1?this.data[0]=re+this.DV:this.t=0},B.prototype.fromString=function S(re,ce){var fe;if(16==ce)fe=4;else if(8==ce)fe=3;else if(256==ce)fe=8;else if(2==ce)fe=1;else if(32==ce)fe=5;else{if(4!=ce)return void this.fromRadix(re,ce);fe=2}this.t=0,this.s=0;for(var Ve=re.length,ft=!1,ht=0;--Ve>=0;){var Bt=8==fe?255&re[Ve]:T(re,Ve);Bt<0?"-"==re.charAt(Ve)&&(ft=!0):(ft=!1,0==ht?this.data[this.t++]=Bt:ht+fe>this.DB?(this.data[this.t-1]|=(Bt&(1<<this.DB-ht)-1)<<ht,this.data[this.t++]=Bt>>this.DB-ht):this.data[this.t-1]|=Bt<<ht,(ht+=fe)>=this.DB&&(ht-=this.DB))}8==fe&&0!=(128&re[0])&&(this.s=-1,ht>0&&(this.data[this.t-1]|=(1<<this.DB-ht)-1<<ht)),this.clamp(),ft&&B.ZERO.subTo(this,this)},B.prototype.clamp=function O(){for(var re=this.s&this.DM;this.t>0&&this.data[this.t-1]==re;)--this.t},B.prototype.dlShiftTo=function F(re,ce){var fe;for(fe=this.t-1;fe>=0;--fe)ce.data[fe+re]=this.data[fe];for(fe=re-1;fe>=0;--fe)ce.data[fe]=0;ce.t=this.t+re,ce.s=this.s},B.prototype.drShiftTo=function Y(re,ce){for(var fe=re;fe<this.t;++fe)ce.data[fe-re]=this.data[fe];ce.t=Math.max(this.t-re,0),ce.s=this.s},B.prototype.lShiftTo=function W(re,ce){var Dt,fe=re%this.DB,Ve=this.DB-fe,ft=(1<<Ve)-1,ht=Math.floor(re/this.DB),Bt=this.s<<fe&this.DM;for(Dt=this.t-1;Dt>=0;--Dt)ce.data[Dt+ht+1]=this.data[Dt]>>Ve|Bt,Bt=(this.data[Dt]&ft)<<fe;for(Dt=ht-1;Dt>=0;--Dt)ce.data[Dt]=0;ce.data[ht]=Bt,ce.t=this.t+ht+1,ce.s=this.s,ce.clamp()},B.prototype.rShiftTo=function ne(re,ce){ce.s=this.s;var fe=Math.floor(re/this.DB);if(fe>=this.t)ce.t=0;else{var Ve=re%this.DB,ft=this.DB-Ve,ht=(1<<Ve)-1;ce.data[0]=this.data[fe]>>Ve;for(var Bt=fe+1;Bt<this.t;++Bt)ce.data[Bt-fe-1]|=(this.data[Bt]&ht)<<ft,ce.data[Bt-fe]=this.data[Bt]>>Ve;Ve>0&&(ce.data[this.t-fe-1]|=(this.s&ht)<<ft),ce.t=this.t-fe,ce.clamp()}},B.prototype.subTo=function de(re,ce){for(var fe=0,Ve=0,ft=Math.min(re.t,this.t);fe<ft;)Ve+=this.data[fe]-re.data[fe],ce.data[fe++]=Ve&this.DM,Ve>>=this.DB;if(re.t<this.t){for(Ve-=re.s;fe<this.t;)Ve+=this.data[fe],ce.data[fe++]=Ve&this.DM,Ve>>=this.DB;Ve+=this.s}else{for(Ve+=this.s;fe<re.t;)Ve-=re.data[fe],ce.data[fe++]=Ve&this.DM,Ve>>=this.DB;Ve-=re.s}ce.s=Ve<0?-1:0,Ve<-1?ce.data[fe++]=this.DV+Ve:Ve>0&&(ce.data[fe++]=Ve),ce.t=fe,ce.clamp()},B.prototype.multiplyTo=function Ae(re,ce){var fe=this.abs(),Ve=re.abs(),ft=fe.t;for(ce.t=ft+Ve.t;--ft>=0;)ce.data[ft]=0;for(ft=0;ft<Ve.t;++ft)ce.data[ft+fe.t]=fe.am(0,Ve.data[ft],ce,ft,0,fe.t);ce.s=0,ce.clamp(),this.s!=re.s&&B.ZERO.subTo(ce,ce)},B.prototype.squareTo=function Re(re){for(var ce=this.abs(),fe=re.t=2*ce.t;--fe>=0;)re.data[fe]=0;for(fe=0;fe<ce.t-1;++fe){var Ve=ce.am(fe,ce.data[fe],re,2*fe,0,1);(re.data[fe+ce.t]+=ce.am(fe+1,2*ce.data[fe],re,2*fe+1,Ve,ce.t-fe-1))>=ce.DV&&(re.data[fe+ce.t]-=ce.DV,re.data[fe+ce.t+1]=1)}re.t>0&&(re.data[re.t-1]+=ce.am(fe,ce.data[fe],re,2*fe,0,1)),re.s=0,re.clamp()},B.prototype.divRemTo=function Fe(re,ce,fe){var Ve=re.abs();if(!(Ve.t<=0)){var ft=this.abs();if(ft.t<Ve.t)return ce?.fromInt(0),void(null!=fe&&this.copyTo(fe));null==fe&&(fe=E());var ht=E(),Bt=this.s,Dt=re.s,br=this.DB-D(Ve.data[Ve.t-1]);br>0?(Ve.lShiftTo(br,ht),ft.lShiftTo(br,fe)):(Ve.copyTo(ht),ft.copyTo(fe));var Zr=ht.t,Wr=ht.data[Zr-1];if(0!=Wr){var Rr=Wr*(1<<this.F1)+(Zr>1?ht.data[Zr-2]>>this.F2:0),vn=this.FV/Rr,vi=(1<<this.F1)/Rr,dn=1<<this.F2,pn=fe.t,mi=pn-Zr,Sn=ce??E();for(ht.dlShiftTo(mi,Sn),fe.compareTo(Sn)>=0&&(fe.data[fe.t++]=1,fe.subTo(Sn,fe)),B.ONE.dlShiftTo(Zr,Sn),Sn.subTo(ht,ht);ht.t<Zr;)ht.data[ht.t++]=0;for(;--mi>=0;){var Vi=fe.data[--pn]==Wr?this.DM:Math.floor(fe.data[pn]*vn+(fe.data[pn-1]+dn)*vi);if((fe.data[pn]+=ht.am(0,Vi,fe,mi,0,Zr))<Vi)for(ht.dlShiftTo(mi,Sn),fe.subTo(Sn,fe);fe.data[pn]<--Vi;)fe.subTo(Sn,fe)}null!=ce&&(fe.drShiftTo(Zr,ce),Bt!=Dt&&B.ZERO.subTo(ce,ce)),fe.t=Zr,fe.clamp(),br>0&&fe.rShiftTo(br,fe),Bt<0&&B.ZERO.subTo(fe,fe)}}},B.prototype.invDigit=function ct(){if(this.t<1)return 0;var re=this.data[0];if(0==(1&re))return 0;var ce=3&re;return(ce=(ce=(ce=(ce=ce*(2-(15&re)*ce)&15)*(2-(255&re)*ce)&255)*(2-((65535&re)*ce&65535))&65535)*(2-re*ce%this.DV)%this.DV)>0?this.DV-ce:-ce},B.prototype.isEven=function ee(){return 0==(this.t>0?1&this.data[0]:this.s)},B.prototype.exp=function me(re,ce){if(re>4294967295||re<1)return B.ONE;var fe=E(),Ve=E(),ft=ce.convert(this),ht=D(re)-1;for(ft.copyTo(fe);--ht>=0;)if(ce.sqrTo(fe,Ve),(re&1<<ht)>0)ce.mulTo(Ve,ft,fe);else{var Bt=fe;fe=Ve,Ve=Bt}return ce.revert(fe)},B.prototype.toString=function V(re){if(this.s<0)return"-"+this.negate().toString(re);var ce;if(16==re)ce=4;else if(8==re)ce=3;else if(2==re)ce=1;else if(32==re)ce=5;else{if(4!=re)return this.toRadix(re);ce=2}var Ve,fe=(1<<ce)-1,ft=!1,ht="",Bt=this.t,Dt=this.DB-Bt*this.DB%ce;if(Bt-- >0)for(Dt<this.DB&&(Ve=this.data[Bt]>>Dt)>0&&(ft=!0,ht=N(Ve));Bt>=0;)Dt<ce?(Ve=(this.data[Bt]&(1<<Dt)-1)<<ce-Dt,Ve|=this.data[--Bt]>>(Dt+=this.DB-ce)):(Ve=this.data[Bt]>>(Dt-=ce)&fe,Dt<=0&&(Dt+=this.DB,--Bt)),Ve>0&&(ft=!0),ft&&(ht+=N(Ve));return ft?ht:"0"},B.prototype.negate=function G(){var re=E();return B.ZERO.subTo(this,re),re},B.prototype.abs=function k(){return this.s<0?this.negate():this},B.prototype.compareTo=function P(re){var ce=this.s-re.s;if(0!=ce)return ce;var fe=this.t;if(0!=(ce=fe-re.t))return this.s<0?-ce:ce;for(;--fe>=0;)if(0!=(ce=this.data[fe]-re.data[fe]))return ce;return 0},B.prototype.bitLength=function l(){return this.t<=0?0:this.DB*(this.t-1)+D(this.data[this.t-1]^this.s&this.DM)},B.prototype.mod=function be(re){var ce=E();return this.abs().divRemTo(re,null,ce),this.s<0&&ce.compareTo(B.ZERO)>0&&re.subTo(ce,ce),ce},B.prototype.modPowInt=function Ue(re,ce){var fe;return fe=re<256||ce.isEven()?new Pe(ce):new jt(ce),this.exp(re,fe)},B.ZERO=m(0),B.ONE=m(1),Ft.prototype.convert=Dr,Ft.prototype.revert=Dr,Ft.prototype.mulTo=function hn(re,ce,fe){re.multiplyTo(ce,fe)},Ft.prototype.sqrTo=function si(re,ce){re.squareTo(ce)},cn.prototype.convert=function ha(re){if(re.s<0||re.t>2*this.m.t)return re.mod(this.m);if(re.compareTo(this.m)<0)return re;var ce=E();return re.copyTo(ce),this.reduce(ce),ce},cn.prototype.revert=function da(re){return re},cn.prototype.reduce=function pa(re){for(re.drShiftTo(this.m.t-1,this.r2),re.t>this.m.t+1&&(re.t=this.m.t+1,re.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);re.compareTo(this.r2)<0;)re.dAddOffset(1,this.m.t+1);for(re.subTo(this.r2,re);re.compareTo(this.m)>=0;)re.subTo(this.m,re)},cn.prototype.mulTo=function Hn(re,ce,fe){re.multiplyTo(ce,fe),this.reduce(fe)},cn.prototype.sqrTo=function ya(re,ce){re.squareTo(ce),this.reduce(ce)};var un=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509],hs=(1<<26)/un[un.length-1];B.prototype.chunkSize=function kt(re){return Math.floor(Math.LN2*this.DB/Math.log(re))},B.prototype.toRadix=function _t(re){if(null==re&&(re=10),0==this.signum()||re<2||re>36)return"0";var ce=this.chunkSize(re),fe=Math.pow(re,ce),Ve=m(fe),ft=E(),ht=E(),Bt="";for(this.divRemTo(Ve,ft,ht);ft.signum()>0;)Bt=(fe+ht.intValue()).toString(re).substr(1)+Bt,ft.divRemTo(Ve,ft,ht);return ht.intValue().toString(re)+Bt},B.prototype.fromRadix=function Vt(re,ce){this.fromInt(0),null==ce&&(ce=10);for(var fe=this.chunkSize(ce),Ve=Math.pow(ce,fe),ft=!1,ht=0,Bt=0,Dt=0;Dt<re.length;++Dt){var br=T(re,Dt);br<0?"-"==re.charAt(Dt)&&0==this.signum()&&(ft=!0):(Bt=ce*Bt+br,++ht>=fe&&(this.dMultiply(Ve),this.dAddOffset(Bt,0),ht=0,Bt=0))}ht>0&&(this.dMultiply(Math.pow(ce,ht)),this.dAddOffset(Bt,0)),ft&&B.ZERO.subTo(this,this)},B.prototype.fromNumber=function Qt(re,ce,fe){if("number"==typeof ce)if(re<2)this.fromInt(1);else for(this.fromNumber(re,fe),this.testBit(re-1)||this.bitwiseTo(B.ONE.shiftLeft(re-1),et,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(ce);)this.dAddOffset(2,0),this.bitLength()>re&&this.subTo(B.ONE.shiftLeft(re-1),this);else{var Ve=new Array,ft=7&re;Ve.length=1+(re>>3),ce.nextBytes(Ve),ft>0?Ve[0]&=(1<<ft)-1:Ve[0]=0,this.fromString(Ve,256)}},B.prototype.bitwiseTo=function X(re,ce,fe){var Ve,ft,ht=Math.min(re.t,this.t);for(Ve=0;Ve<ht;++Ve)fe.data[Ve]=ce(this.data[Ve],re.data[Ve]);if(re.t<this.t){for(ft=re.s&this.DM,Ve=ht;Ve<this.t;++Ve)fe.data[Ve]=ce(this.data[Ve],ft);fe.t=this.t}else{for(ft=this.s&this.DM,Ve=ht;Ve<re.t;++Ve)fe.data[Ve]=ce(ft,re.data[Ve]);fe.t=re.t}fe.s=ce(this.s,re.s),fe.clamp()},B.prototype.changeBit=function Cr(re,ce){var fe=B.ONE.shiftLeft(re);return this.bitwiseTo(fe,ce,fe),fe},B.prototype.addTo=function ir(re,ce){for(var fe=0,Ve=0,ft=Math.min(re.t,this.t);fe<ft;)Ve+=this.data[fe]+re.data[fe],ce.data[fe++]=Ve&this.DM,Ve>>=this.DB;if(re.t<this.t){for(Ve+=re.s;fe<this.t;)Ve+=this.data[fe],ce.data[fe++]=Ve&this.DM,Ve>>=this.DB;Ve+=this.s}else{for(Ve+=this.s;fe<re.t;)Ve+=re.data[fe],ce.data[fe++]=Ve&this.DM,Ve>>=this.DB;Ve+=re.s}ce.s=Ve<0?-1:0,Ve>0?ce.data[fe++]=Ve:Ve<-1&&(ce.data[fe++]=this.DV+Ve),ce.t=fe,ce.clamp()},B.prototype.dMultiply=function Ar(re){this.data[this.t]=this.am(0,re-1,this,0,0,this.t),++this.t,this.clamp()},B.prototype.dAddOffset=function Tr(re,ce){if(0!=re){for(;this.t<=ce;)this.data[this.t++]=0;for(this.data[ce]+=re;this.data[ce]>=this.DV;)this.data[ce]-=this.DV,++ce>=this.t&&(this.data[this.t++]=0),++this.data[ce]}},B.prototype.multiplyLowerTo=function us(re,ce,fe){var ft,Ve=Math.min(this.t+re.t,ce);for(fe.s=0,fe.t=Ve;Ve>0;)fe.data[--Ve]=0;for(ft=fe.t-this.t;Ve<ft;++Ve)fe.data[Ve+this.t]=this.am(0,re.data[Ve],fe,Ve,0,this.t);for(ft=Math.min(re.t,ce);Ve<ft;++Ve)this.am(0,re.data[Ve],fe,Ve,0,ce-Ve);fe.clamp()},B.prototype.multiplyUpperTo=function ls(re,ce,fe){--ce;var Ve=fe.t=this.t+re.t-ce;for(fe.s=0;--Ve>=0;)fe.data[Ve]=0;for(Ve=Math.max(ce-this.t,0);Ve<re.t;++Ve)fe.data[this.t+Ve-ce]=this.am(ce-Ve,re.data[Ve],fe,0,0,this.t+Ve-ce);fe.clamp(),fe.drShiftTo(1,fe)},B.prototype.modInt=function fs(re){if(re<=0)return 0;var ce=this.DV%re,fe=this.s<0?re-1:0;if(this.t>0)if(0==ce)fe=this.data[0]%re;else for(var Ve=this.t-1;Ve>=0;--Ve)fe=(ce*fe+this.data[Ve])%re;return fe},B.prototype.millerRabin=function ma(re){var ce=this.subtract(B.ONE),fe=ce.getLowestSetBit();if(fe<=0)return!1;for(var ht,Ve=ce.shiftRight(fe),ft=function xa(){return{nextBytes:function(re){for(var ce=0;ce<re.length;++ce)re[ce]=Math.floor(256*Math.random())}}}(),Bt=0;Bt<re;++Bt){do{ht=new B(this.bitLength(),ft)}while(ht.compareTo(B.ONE)<=0||ht.compareTo(ce)>=0);var Dt=ht.modPow(Ve,this);if(0!=Dt.compareTo(B.ONE)&&0!=Dt.compareTo(ce)){for(var br=1;br++<fe&&0!=Dt.compareTo(ce);)if(0==(Dt=Dt.modPowInt(2,this)).compareTo(B.ONE))return!1;if(0!=Dt.compareTo(ce))return!1}}return!0},B.prototype.clone=function z(){var re=E();return this.copyTo(re),re},B.prototype.intValue=function Ie(){if(this.s<0){if(1==this.t)return this.data[0]-this.DV;if(0==this.t)return-1}else{if(1==this.t)return this.data[0];if(0==this.t)return 0}return(this.data[1]&(1<<32-this.DB)-1)<<this.DB|this.data[0]},B.prototype.byteValue=function lt(){return 0==this.t?this.s:this.data[0]<<24>>24},B.prototype.shortValue=function Pt(){return 0==this.t?this.s:this.data[0]<<16>>16},B.prototype.signum=function at(){return this.s<0?-1:this.t<=0||1==this.t&&this.data[0]<=0?0:1},B.prototype.toByteArray=function Z(){var re=this.t,ce=new Array;ce[0]=this.s;var Ve,fe=this.DB-re*this.DB%8,ft=0;if(re-- >0)for(fe<this.DB&&(Ve=this.data[re]>>fe)!=(this.s&this.DM)>>fe&&(ce[ft++]=Ve|this.s<<this.DB-fe);re>=0;)fe<8?(Ve=(this.data[re]&(1<<fe)-1)<<8-fe,Ve|=this.data[--re]>>(fe+=this.DB-8)):(Ve=this.data[re]>>(fe-=8)&255,fe<=0&&(fe+=this.DB,--re)),0!=(128&Ve)&&(Ve|=-256),0==ft&&(128&this.s)!=(128&Ve)&&++ft,(ft>0||Ve!=this.s)&&(ce[ft++]=Ve);return ce},B.prototype.equals=function ut(re){return 0==this.compareTo(re)},B.prototype.min=function je(re){return this.compareTo(re)<0?this:re},B.prototype.max=function mt(re){return this.compareTo(re)>0?this:re},B.prototype.and=function Me(re){var ce=E();return this.bitwiseTo(re,ue,ce),ce},B.prototype.or=function gt(re){var ce=E();return this.bitwiseTo(re,et,ce),ce},B.prototype.xor=function $t(re){var ce=E();return this.bitwiseTo(re,Tt,ce),ce},B.prototype.andNot=function Lt(re){var ce=E();return this.bitwiseTo(re,qt,ce),ce},B.prototype.not=function or(){for(var re=E(),ce=0;ce<this.t;++ce)re.data[ce]=this.DM&~this.data[ce];return re.t=this.t,re.s=~this.s,re},B.prototype.shiftLeft=function _r(re){var ce=E();return re<0?this.rShiftTo(-re,ce):this.lShiftTo(re,ce),ce},B.prototype.shiftRight=function Xt(re){var ce=E();return re<0?this.lShiftTo(-re,ce):this.rShiftTo(re,ce),ce},B.prototype.getLowestSetBit=function $r(){for(var re=0;re<this.t;++re)if(0!=this.data[re])return re*this.DB+cr(this.data[re]);return this.s<0?this.t*this.DB:-1},B.prototype.bitCount=function Yr(){for(var re=0,ce=this.s&this.DM,fe=0;fe<this.t;++fe)re+=Hr(this.data[fe]^ce);return re},B.prototype.testBit=function yr(re){var ce=Math.floor(re/this.DB);return ce>=this.t?0!=this.s:0!=(this.data[ce]&1<<re%this.DB)},B.prototype.setBit=function dr(re){return this.changeBit(re,et)},B.prototype.clearBit=function lr(re){return this.changeBit(re,qt)},B.prototype.flipBit=function Ur(re){return this.changeBit(re,Tt)},B.prototype.add=function pr(re){var ce=E();return this.addTo(re,ce),ce},B.prototype.subtract=function kr(re){var ce=E();return this.subTo(re,ce),ce},B.prototype.multiply=function zr(re){var ce=E();return this.multiplyTo(re,ce),ce},B.prototype.divide=function Mr(re){var ce=E();return this.divRemTo(re,ce,null),ce},B.prototype.remainder=function mr(re){var ce=E();return this.divRemTo(re,null,ce),ce},B.prototype.divideAndRemainder=function wr(re){var ce=E(),fe=E();return this.divRemTo(re,ce,fe),new Array(ce,fe)},B.prototype.modPow=function ga(re,ce){var Ve,ht,fe=re.bitLength(),ft=m(1);if(fe<=0)return ft;Ve=fe<18?1:fe<48?3:fe<144?4:fe<768?5:6,ht=fe<8?new Pe(ce):ce.isEven()?new cn(ce):new jt(ce);var Bt=new Array,Dt=3,br=Ve-1,Zr=(1<<Ve)-1;if(Bt[1]=ht.convert(this),Ve>1){var Wr=E();for(ht.sqrTo(Bt[1],Wr);Dt<=Zr;)Bt[Dt]=E(),ht.mulTo(Wr,Bt[Dt-2],Bt[Dt]),Dt+=2}var vn,pn,Rr=re.t-1,vi=!0,dn=E();for(fe=D(re.data[Rr])-1;Rr>=0;){for(fe>=br?vn=re.data[Rr]>>fe-br&Zr:(vn=(re.data[Rr]&(1<<fe+1)-1)<<br-fe,Rr>0&&(vn|=re.data[Rr-1]>>this.DB+fe-br)),Dt=Ve;0==(1&vn);)vn>>=1,--Dt;if((fe-=Dt)<0&&(fe+=this.DB,--Rr),vi)Bt[vn].copyTo(ft),vi=!1;else{for(;Dt>1;)ht.sqrTo(ft,dn),ht.sqrTo(dn,ft),Dt-=2;Dt>0?ht.sqrTo(ft,dn):(pn=ft,ft=dn,dn=pn),ht.mulTo(dn,Bt[vn],ft)}for(;Rr>=0&&0==(re.data[Rr]&1<<fe);)ht.sqrTo(ft,dn),pn=ft,ft=dn,dn=pn,--fe<0&&(fe=this.DB-1,--Rr)}return ht.revert(ft)},B.prototype.modInverse=function oi(re){var ce=re.isEven();if(this.isEven()&&ce||0==re.signum())return B.ZERO;for(var fe=re.clone(),Ve=this.clone(),ft=m(1),ht=m(0),Bt=m(0),Dt=m(1);0!=fe.signum();){for(;fe.isEven();)fe.rShiftTo(1,fe),ce?((!ft.isEven()||!ht.isEven())&&(ft.addTo(this,ft),ht.subTo(re,ht)),ft.rShiftTo(1,ft)):ht.isEven()||ht.subTo(re,ht),ht.rShiftTo(1,ht);for(;Ve.isEven();)Ve.rShiftTo(1,Ve),ce?((!Bt.isEven()||!Dt.isEven())&&(Bt.addTo(this,Bt),Dt.subTo(re,Dt)),Bt.rShiftTo(1,Bt)):Dt.isEven()||Dt.subTo(re,Dt),Dt.rShiftTo(1,Dt);fe.compareTo(Ve)>=0?(fe.subTo(Ve,fe),ce&&ft.subTo(Bt,ft),ht.subTo(Dt,ht)):(Ve.subTo(fe,Ve),ce&&Bt.subTo(ft,Bt),Dt.subTo(ht,Dt))}return 0!=Ve.compareTo(B.ONE)?B.ZERO:Dt.compareTo(re)>=0?Dt.subtract(re):Dt.signum()<0?(Dt.addTo(re,Dt),Dt.signum()<0?Dt.add(re):Dt):Dt},B.prototype.pow=function cs(re){return this.exp(re,new Ft)},B.prototype.gcd=function va(re){var ce=this.s<0?this.negate():this.clone(),fe=re.s<0?re.negate():re.clone();if(ce.compareTo(fe)<0){var Ve=ce;ce=fe,fe=Ve}var ft=ce.getLowestSetBit(),ht=fe.getLowestSetBit();if(ht<0)return ce;for(ft<ht&&(ht=ft),ht>0&&(ce.rShiftTo(ht,ce),fe.rShiftTo(ht,fe));ce.signum()>0;)(ft=ce.getLowestSetBit())>0&&ce.rShiftTo(ft,ce),(ft=fe.getLowestSetBit())>0&&fe.rShiftTo(ft,fe),ce.compareTo(fe)>=0?(ce.subTo(fe,ce),ce.rShiftTo(1,ce)):(fe.subTo(ce,fe),fe.rShiftTo(1,fe));return ht>0&&fe.lShiftTo(ht,fe),fe},B.prototype.isProbablePrime=function gi(re){var ce,fe=this.abs();if(1==fe.t&&fe.data[0]<=un[un.length-1]){for(ce=0;ce<un.length;++ce)if(fe.data[0]==un[ce])return!0;return!1}if(fe.isEven())return!1;for(ce=1;ce<un.length;){for(var Ve=un[ce],ft=ce+1;ft<un.length&&Ve<hs;)Ve*=un[ft++];for(Ve=fe.modInt(Ve);ce<ft;)if(Ve%un[ce++]==0)return!1}return fe.millerRabin(re)}},7196:(De,J,M)=>{var s=M(8659);M(4747),M(8365),M(730),De.exports=s.kem=s.kem||{};var i=s.jsbn.BigInteger;function d(c,B,E,v){c.generate=function(y,h){for(var x=new s.util.ByteBuffer,A=Math.ceil(h/v)+E,H=new s.util.ByteBuffer,C=E;C<A;++C){H.putInt32(C),B.start(),B.update(y+H.getBytes());var _=B.digest();x.putBytes(_.getBytes(v))}return x.truncate(x.length()-h),x.getBytes()}}s.kem.rsa={},s.kem.rsa.create=function(c,B){var E=(B=B||{}).prng||s.random;return{encrypt:function(y,h){var A,x=Math.ceil(y.n.bitLength()/8);do{A=new i(s.util.bytesToHex(E.getBytesSync(x)),16).mod(y.n)}while(A.compareTo(i.ONE)<=0);var H=x-(A=s.util.hexToBytes(A.toString(16))).length;return H>0&&(A=s.util.fillString(String.fromCharCode(0),H)+A),{encapsulation:y.encrypt(A,"NONE"),key:c.generate(A,h)}},decrypt:function(y,h,x){var A=y.decrypt(h,"NONE");return c.generate(A,x)}}},s.kem.kdf1=function(c,B){d(this,c,0,B||c.digestLength)},s.kem.kdf2=function(c,B){d(this,c,1,B||c.digestLength)}},6113:(De,J,M)=>{var s=M(8659);M(4747),De.exports=s.log=s.log||{},s.log.levels=["none","error","warning","info","debug","verbose","max"];var i={},d=[],c=null;s.log.LEVEL_LOCKED=2,s.log.NO_LEVEL_CHECK=4,s.log.INTERPOLATE=8;for(var B=0;B<s.log.levels.length;++B){var E=s.log.levels[B];i[E]={index:B,name:E.toUpperCase()}}s.log.logMessage=function(C){for(var _=i[C.level].index,N=0;N<d.length;++N){var T=d[N];T.flags&s.log.NO_LEVEL_CHECK?T.f(C):_<=i[T.level].index&&T.f(T,C)}},s.log.prepareStandard=function(C){"standard"in C||(C.standard=i[C.level].name+" ["+C.category+"] "+C.message)},s.log.prepareFull=function(C){if(!("full"in C)){var _=[C.message];_=_.concat([]),C.full=s.util.format.apply(this,_)}},s.log.prepareStandardFull=function(C){"standardFull"in C||(s.log.prepareStandard(C),C.standardFull=C.standard)};var v=["error","warning","info","debug","verbose"];for(B=0;B<v.length;++B)!function(_){s.log[_]=function(N,T){var I=Array.prototype.slice.call(arguments).slice(2),p={timestamp:new Date,level:_,category:N,message:T,arguments:I};s.log.logMessage(p)}}(v[B]);if(s.log.makeLogger=function(C){var _={flags:0,f:C};return s.log.setLevel(_,"none"),_},s.log.setLevel=function(C,_){var N=!1;if(C&&!(C.flags&s.log.LEVEL_LOCKED))for(var T=0;T<s.log.levels.length;++T)if(_==s.log.levels[T]){C.level=_,N=!0;break}return N},s.log.lock=function(C,_){typeof _>"u"||_?C.flags|=s.log.LEVEL_LOCKED:C.flags&=~s.log.LEVEL_LOCKED},s.log.addLogger=function(C){d.push(C)},typeof console<"u"&&"log"in console){var y;if(console.error&&console.warn&&console.info&&console.debug){var h={error:console.error,warning:console.warn,info:console.info,debug:console.debug,verbose:console.debug},x=function(C,_){s.log.prepareStandard(_);var N=h[_.level],T=[_.standard];T=T.concat(_.arguments.slice()),N.apply(console,T)};y=s.log.makeLogger(x)}else x=function(_,N){s.log.prepareStandardFull(N),console.log(N.standardFull)},y=s.log.makeLogger(x);s.log.setLevel(y,"debug"),s.log.addLogger(y),c=y}else console={log:function(){}};if(null!==c&&typeof window<"u"&&window.location){var A=new URL(window.location.href).searchParams;A.has("console.level")&&s.log.setLevel(c,A.get("console.level").slice(-1)[0]),A.has("console.lock")&&"true"==A.get("console.lock").slice(-1)[0]&&s.log.lock(c)}s.log.consoleLogger=c},4752:(De,J,M)=>{De.exports=M(979),M(2687),M(7690),M(1594),M(8985)},979:(De,J,M)=>{var s=M(8659);De.exports=s.md=s.md||{},s.md.algorithms=s.md.algorithms||{}},2687:(De,J,M)=>{var s=M(8659);M(979),M(4747);var i=De.exports=s.md5=s.md5||{};s.md.md5=s.md.algorithms.md5=i,i.create=function(){v||function y(){d=String.fromCharCode(128),d+=s.util.fillString(String.fromCharCode(0),64),c=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,1,6,11,0,5,10,15,4,9,14,3,8,13,2,7,12,5,8,11,14,1,4,7,10,13,0,3,6,9,12,15,2,0,7,14,5,12,3,10,1,8,15,6,13,4,11,2,9],B=[7,12,17,22,7,12,17,22,7,12,17,22,7,12,17,22,5,9,14,20,5,9,14,20,5,9,14,20,5,9,14,20,4,11,16,23,4,11,16,23,4,11,16,23,4,11,16,23,6,10,15,21,6,10,15,21,6,10,15,21,6,10,15,21],E=new Array(64);for(var x=0;x<64;++x)E[x]=Math.floor(4294967296*Math.abs(Math.sin(x+1)));v=!0}();var x=null,A=s.util.createBuffer(),H=new Array(16),C={algorithm:"md5",blockLength:64,digestLength:16,messageLength:0,fullMessageLength:null,messageLengthSize:8,start:function(){C.messageLength=0,C.fullMessageLength=C.messageLength64=[];for(var _=C.messageLengthSize/4,N=0;N<_;++N)C.fullMessageLength.push(0);return A=s.util.createBuffer(),x={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878},C}};return C.start(),C.update=function(_,N){"utf8"===N&&(_=s.util.encodeUtf8(_));var T=_.length;C.messageLength+=T,T=[T/4294967296>>>0,T>>>0];for(var I=C.fullMessageLength.length-1;I>=0;--I)C.fullMessageLength[I]+=T[1],T[1]=T[0]+(C.fullMessageLength[I]/4294967296>>>0),C.fullMessageLength[I]=C.fullMessageLength[I]>>>0,T[0]=T[1]/4294967296>>>0;return A.putBytes(_),h(x,H,A),(A.read>2048||0===A.length())&&A.compact(),C},C.digest=function(){var _=s.util.createBuffer();_.putBytes(A.bytes()),_.putBytes(d.substr(0,C.blockLength-(C.fullMessageLength[C.fullMessageLength.length-1]+C.messageLengthSize&C.blockLength-1)));for(var I,p=0,m=C.fullMessageLength.length-1;m>=0;--m)p=(I=8*C.fullMessageLength[m]+p)/4294967296>>>0,_.putInt32Le(I>>>0);var S={h0:x.h0,h1:x.h1,h2:x.h2,h3:x.h3};h(S,H,_);var O=s.util.createBuffer();return O.putInt32Le(S.h0),O.putInt32Le(S.h1),O.putInt32Le(S.h2),O.putInt32Le(S.h3),O},C};var d=null,c=null,B=null,E=null,v=!1;function h(x,A,H){for(var C,_,N,T,I,m,S,O=H.length();O>=64;){for(_=x.h0,N=x.h1,T=x.h2,I=x.h3,S=0;S<16;++S)A[S]=H.getInt32Le(),C=_+(I^N&(T^I))+E[S]+A[S],_=I,I=T,T=N,N+=C<<(m=B[S])|C>>>32-m;for(;S<32;++S)C=_+(T^I&(N^T))+E[S]+A[c[S]],_=I,I=T,T=N,N+=C<<(m=B[S])|C>>>32-m;for(;S<48;++S)C=_+(N^T^I)+E[S]+A[c[S]],_=I,I=T,T=N,N+=C<<(m=B[S])|C>>>32-m;for(;S<64;++S)C=_+(T^(N|~I))+E[S]+A[c[S]],_=I,I=T,T=N,N+=C<<(m=B[S])|C>>>32-m;x.h0=x.h0+_|0,x.h1=x.h1+N|0,x.h2=x.h2+T|0,x.h3=x.h3+I|0,O-=64}}},9386:(De,J,M)=>{var s=M(8659);M(8449),De.exports=s.mgf=s.mgf||{},s.mgf.mgf1=s.mgf1},8449:(De,J,M)=>{var s=M(8659);M(4747),s.mgf=s.mgf||{},(De.exports=s.mgf.mgf1=s.mgf1=s.mgf1||{}).create=function(d){return{generate:function(B,E){for(var v=new s.util.ByteBuffer,y=Math.ceil(E/d.digestLength),h=0;h<y;h++){var x=new s.util.ByteBuffer;x.putInt32(h),d.start(),d.update(B+x.getBytes()),v.putBuffer(d.digest())}return v.truncate(v.length()-E),v.getBytes()}}}},6078:(De,J,M)=>{var s=M(8659);s.pki=s.pki||{};var i=De.exports=s.pki.oids=s.oids=s.oids||{};function d(B,E){i[B]=E,i[E]=B}function c(B,E){i[B]=E}d("1.2.840.113549.1.1.1","rsaEncryption"),d("1.2.840.113549.1.1.4","md5WithRSAEncryption"),d("1.2.840.113549.1.1.5","sha1WithRSAEncryption"),d("1.2.840.113549.1.1.7","RSAES-OAEP"),d("1.2.840.113549.1.1.8","mgf1"),d("1.2.840.113549.1.1.9","pSpecified"),d("1.2.840.113549.1.1.10","RSASSA-PSS"),d("1.2.840.113549.1.1.11","sha256WithRSAEncryption"),d("1.2.840.113549.1.1.12","sha384WithRSAEncryption"),d("1.2.840.113549.1.1.13","sha512WithRSAEncryption"),d("1.3.101.112","EdDSA25519"),d("1.2.840.10040.4.3","dsa-with-sha1"),d("1.3.14.3.2.7","desCBC"),d("1.3.14.3.2.26","sha1"),d("1.3.14.3.2.29","sha1WithRSASignature"),d("2.16.840.1.101.3.4.2.1","sha256"),d("2.16.840.1.101.3.4.2.2","sha384"),d("2.16.840.1.101.3.4.2.3","sha512"),d("2.16.840.1.101.3.4.2.4","sha224"),d("2.16.840.1.101.3.4.2.5","sha512-224"),d("2.16.840.1.101.3.4.2.6","sha512-256"),d("1.2.840.113549.2.2","md2"),d("1.2.840.113549.2.5","md5"),d("1.2.840.113549.1.7.1","data"),d("1.2.840.113549.1.7.2","signedData"),d("1.2.840.113549.1.7.3","envelopedData"),d("1.2.840.113549.1.7.4","signedAndEnvelopedData"),d("1.2.840.113549.1.7.5","digestedData"),d("1.2.840.113549.1.7.6","encryptedData"),d("1.2.840.113549.1.9.1","emailAddress"),d("1.2.840.113549.1.9.2","unstructuredName"),d("1.2.840.113549.1.9.3","contentType"),d("1.2.840.113549.1.9.4","messageDigest"),d("1.2.840.113549.1.9.5","signingTime"),d("1.2.840.113549.1.9.6","counterSignature"),d("1.2.840.113549.1.9.7","challengePassword"),d("1.2.840.113549.1.9.8","unstructuredAddress"),d("1.2.840.113549.1.9.14","extensionRequest"),d("1.2.840.113549.1.9.20","friendlyName"),d("1.2.840.113549.1.9.21","localKeyId"),d("1.2.840.113549.1.9.22.1","x509Certificate"),d("1.2.840.113549.1.12.10.1.1","keyBag"),d("1.2.840.113549.1.12.10.1.2","pkcs8ShroudedKeyBag"),d("1.2.840.113549.1.12.10.1.3","certBag"),d("1.2.840.113549.1.12.10.1.4","crlBag"),d("1.2.840.113549.1.12.10.1.5","secretBag"),d("1.2.840.113549.1.12.10.1.6","safeContentsBag"),d("1.2.840.113549.1.5.13","pkcs5PBES2"),d("1.2.840.113549.1.5.12","pkcs5PBKDF2"),d("1.2.840.113549.1.12.1.1","pbeWithSHAAnd128BitRC4"),d("1.2.840.113549.1.12.1.2","pbeWithSHAAnd40BitRC4"),d("1.2.840.113549.1.12.1.3","pbeWithSHAAnd3-KeyTripleDES-CBC"),d("1.2.840.113549.1.12.1.4","pbeWithSHAAnd2-KeyTripleDES-CBC"),d("1.2.840.113549.1.12.1.5","pbeWithSHAAnd128BitRC2-CBC"),d("1.2.840.113549.1.12.1.6","pbewithSHAAnd40BitRC2-CBC"),d("1.2.840.113549.2.7","hmacWithSHA1"),d("1.2.840.113549.2.8","hmacWithSHA224"),d("1.2.840.113549.2.9","hmacWithSHA256"),d("1.2.840.113549.2.10","hmacWithSHA384"),d("1.2.840.113549.2.11","hmacWithSHA512"),d("1.2.840.113549.3.7","des-EDE3-CBC"),d("2.16.840.1.101.3.4.1.2","aes128-CBC"),d("2.16.840.1.101.3.4.1.22","aes192-CBC"),d("2.16.840.1.101.3.4.1.42","aes256-CBC"),d("2.5.4.3","commonName"),d("2.5.4.4","surname"),d("2.5.4.5","serialNumber"),d("2.5.4.6","countryName"),d("2.5.4.7","localityName"),d("2.5.4.8","stateOrProvinceName"),d("2.5.4.9","streetAddress"),d("2.5.4.10","organizationName"),d("2.5.4.11","organizationalUnitName"),d("2.5.4.12","title"),d("2.5.4.13","description"),d("2.5.4.15","businessCategory"),d("2.5.4.17","postalCode"),d("2.5.4.42","givenName"),d("1.3.6.1.4.1.311.60.2.1.2","jurisdictionOfIncorporationStateOrProvinceName"),d("1.3.6.1.4.1.311.60.2.1.3","jurisdictionOfIncorporationCountryName"),d("2.16.840.1.113730.1.1","nsCertType"),d("2.16.840.1.113730.1.13","nsComment"),c("2.5.29.1","authorityKeyIdentifier"),c("2.5.29.2","keyAttributes"),c("2.5.29.3","certificatePolicies"),c("2.5.29.4","keyUsageRestriction"),c("2.5.29.5","policyMapping"),c("2.5.29.6","subtreesConstraint"),c("2.5.29.7","subjectAltName"),c("2.5.29.8","issuerAltName"),c("2.5.29.9","subjectDirectoryAttributes"),c("2.5.29.10","basicConstraints"),c("2.5.29.11","nameConstraints"),c("2.5.29.12","policyConstraints"),c("2.5.29.13","basicConstraints"),d("2.5.29.14","subjectKeyIdentifier"),d("2.5.29.15","keyUsage"),c("2.5.29.16","privateKeyUsagePeriod"),d("2.5.29.17","subjectAltName"),d("2.5.29.18","issuerAltName"),d("2.5.29.19","basicConstraints"),c("2.5.29.20","cRLNumber"),c("2.5.29.21","cRLReason"),c("2.5.29.22","expirationDate"),c("2.5.29.23","instructionCode"),c("2.5.29.24","invalidityDate"),c("2.5.29.25","cRLDistributionPoints"),c("2.5.29.26","issuingDistributionPoint"),c("2.5.29.27","deltaCRLIndicator"),c("2.5.29.28","issuingDistributionPoint"),c("2.5.29.29","certificateIssuer"),c("2.5.29.30","nameConstraints"),d("2.5.29.31","cRLDistributionPoints"),d("2.5.29.32","certificatePolicies"),c("2.5.29.33","policyMappings"),c("2.5.29.34","policyConstraints"),d("2.5.29.35","authorityKeyIdentifier"),c("2.5.29.36","policyConstraints"),d("2.5.29.37","extKeyUsage"),c("2.5.29.46","freshestCRL"),c("2.5.29.54","inhibitAnyPolicy"),d("1.3.6.1.4.1.11129.2.4.2","timestampList"),d("1.3.6.1.5.5.7.1.1","authorityInfoAccess"),d("1.3.6.1.5.5.7.3.1","serverAuth"),d("1.3.6.1.5.5.7.3.2","clientAuth"),d("1.3.6.1.5.5.7.3.3","codeSigning"),d("1.3.6.1.5.5.7.3.4","emailProtection"),d("1.3.6.1.5.5.7.3.8","timeStamping")},2158:(De,J,M)=>{var s=M(8659);if(M(1298),M(7791),M(279),M(979),M(6078),M(7949),M(8604),M(8365),M(209),M(5517),M(4747),typeof i>"u")var i=s.jsbn.BigInteger;var d=s.asn1,c=s.pki=s.pki||{};De.exports=c.pbe=s.pbe=s.pbe||{};var B=c.oids,E={name:"EncryptedPrivateKeyInfo",tagClass:d.Class.UNIVERSAL,type:d.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedPrivateKeyInfo.encryptionAlgorithm",tagClass:d.Class.UNIVERSAL,type:d.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:d.Class.UNIVERSAL,type:d.Type.OID,constructed:!1,capture:"encryptionOid"},{name:"AlgorithmIdentifier.parameters",tagClass:d.Class.UNIVERSAL,type:d.Type.SEQUENCE,constructed:!0,captureAsn1:"encryptionParams"}]},{name:"EncryptedPrivateKeyInfo.encryptedData",tagClass:d.Class.UNIVERSAL,type:d.Type.OCTETSTRING,constructed:!1,capture:"encryptedData"}]},v={name:"PBES2Algorithms",tagClass:d.Class.UNIVERSAL,type:d.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc",tagClass:d.Class.UNIVERSAL,type:d.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc.oid",tagClass:d.Class.UNIVERSAL,type:d.Type.OID,constructed:!1,capture:"kdfOid"},{name:"PBES2Algorithms.params",tagClass:d.Class.UNIVERSAL,type:d.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.params.salt",tagClass:d.Class.UNIVERSAL,type:d.Type.OCTETSTRING,constructed:!1,capture:"kdfSalt"},{name:"PBES2Algorithms.params.iterationCount",tagClass:d.Class.UNIVERSAL,type:d.Type.INTEGER,constructed:!1,capture:"kdfIterationCount"},{name:"PBES2Algorithms.params.keyLength",tagClass:d.Class.UNIVERSAL,type:d.Type.INTEGER,constructed:!1,optional:!0,capture:"keyLength"},{name:"PBES2Algorithms.params.prf",tagClass:d.Class.UNIVERSAL,type:d.Type.SEQUENCE,constructed:!0,optional:!0,value:[{name:"PBES2Algorithms.params.prf.algorithm",tagClass:d.Class.UNIVERSAL,type:d.Type.OID,constructed:!1,capture:"prfOid"}]}]}]},{name:"PBES2Algorithms.encryptionScheme",tagClass:d.Class.UNIVERSAL,type:d.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.encryptionScheme.oid",tagClass:d.Class.UNIVERSAL,type:d.Type.OID,constructed:!1,capture:"encOid"},{name:"PBES2Algorithms.encryptionScheme.iv",tagClass:d.Class.UNIVERSAL,type:d.Type.OCTETSTRING,constructed:!1,capture:"encIv"}]}]},y={name:"pkcs-12PbeParams",tagClass:d.Class.UNIVERSAL,type:d.Type.SEQUENCE,constructed:!0,value:[{name:"pkcs-12PbeParams.salt",tagClass:d.Class.UNIVERSAL,type:d.Type.OCTETSTRING,constructed:!1,capture:"salt"},{name:"pkcs-12PbeParams.iterations",tagClass:d.Class.UNIVERSAL,type:d.Type.INTEGER,constructed:!1,capture:"iterations"}]};function h(C,_){return C.start().update(_).digest().getBytes()}function x(C){var _;if(C){if(!(_=c.oids[d.derToOid(C)])){var N=new Error("Unsupported PRF OID.");throw N.oid=C,N.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],N}}else _="hmacWithSHA1";return A(_)}function A(C){var _=s.md;switch(C){case"hmacWithSHA224":_=s.md.sha512;case"hmacWithSHA1":case"hmacWithSHA256":case"hmacWithSHA384":case"hmacWithSHA512":C=C.substr(8).toLowerCase();break;default:var N=new Error("Unsupported PRF algorithm.");throw N.algorithm=C,N.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],N}if(!_||!(C in _))throw new Error("Unknown hash algorithm: "+C);return _[C].create()}c.encryptPrivateKeyInfo=function(C,_,N){(N=N||{}).saltSize=N.saltSize||8,N.count=N.count||2048,N.algorithm=N.algorithm||"aes128",N.prfAlgorithm=N.prfAlgorithm||"sha1";var m,S,O,T=s.random.getBytesSync(N.saltSize),I=N.count,p=d.integerToDer(I);if(0===N.algorithm.indexOf("aes")||"des"===N.algorithm){var V,G,k;switch(N.algorithm){case"aes128":m=16,V=16,G=B["aes128-CBC"],k=s.aes.createEncryptionCipher;break;case"aes192":m=24,V=16,G=B["aes192-CBC"],k=s.aes.createEncryptionCipher;break;case"aes256":m=32,V=16,G=B["aes256-CBC"],k=s.aes.createEncryptionCipher;break;case"des":m=8,V=8,G=B.desCBC,k=s.des.createEncryptionCipher;break;default:throw(P=new Error("Cannot encrypt private key. Unknown encryption algorithm.")).algorithm=N.algorithm,P}var D="hmacWith"+N.prfAlgorithm.toUpperCase(),l=A(D),F=s.pkcs5.pbkdf2(_,T,I,m,l),Y=s.random.getBytesSync(V);(W=k(F)).start(Y),W.update(d.toDer(C)),W.finish(),O=W.output.getBytes();var ne=function H(C,_,N,T){var I=d.create(d.Class.UNIVERSAL,d.Type.SEQUENCE,!0,[d.create(d.Class.UNIVERSAL,d.Type.OCTETSTRING,!1,C),d.create(d.Class.UNIVERSAL,d.Type.INTEGER,!1,_.getBytes())]);return"hmacWithSHA1"!==T&&I.value.push(d.create(d.Class.UNIVERSAL,d.Type.INTEGER,!1,s.util.hexToBytes(N.toString(16))),d.create(d.Class.UNIVERSAL,d.Type.SEQUENCE,!0,[d.create(d.Class.UNIVERSAL,d.Type.OID,!1,d.oidToDer(c.oids[T]).getBytes()),d.create(d.Class.UNIVERSAL,d.Type.NULL,!1,"")])),I}(T,p,m,D);S=d.create(d.Class.UNIVERSAL,d.Type.SEQUENCE,!0,[d.create(d.Class.UNIVERSAL,d.Type.OID,!1,d.oidToDer(B.pkcs5PBES2).getBytes()),d.create(d.Class.UNIVERSAL,d.Type.SEQUENCE,!0,[d.create(d.Class.UNIVERSAL,d.Type.SEQUENCE,!0,[d.create(d.Class.UNIVERSAL,d.Type.OID,!1,d.oidToDer(B.pkcs5PBKDF2).getBytes()),ne]),d.create(d.Class.UNIVERSAL,d.Type.SEQUENCE,!0,[d.create(d.Class.UNIVERSAL,d.Type.OID,!1,d.oidToDer(G).getBytes()),d.create(d.Class.UNIVERSAL,d.Type.OCTETSTRING,!1,Y)])])])}else{var P;if("3des"!==N.algorithm)throw(P=new Error("Cannot encrypt private key. Unknown encryption algorithm.")).algorithm=N.algorithm,P;m=24;var W,de=new s.util.ByteBuffer(T);F=c.pbe.generatePkcs12Key(_,de,1,I,m),Y=c.pbe.generatePkcs12Key(_,de,2,I,m),(W=s.des.createEncryptionCipher(F)).start(Y),W.update(d.toDer(C)),W.finish(),O=W.output.getBytes(),S=d.create(d.Class.UNIVERSAL,d.Type.SEQUENCE,!0,[d.create(d.Class.UNIVERSAL,d.Type.OID,!1,d.oidToDer(B["pbeWithSHAAnd3-KeyTripleDES-CBC"]).getBytes()),d.create(d.Class.UNIVERSAL,d.Type.SEQUENCE,!0,[d.create(d.Class.UNIVERSAL,d.Type.OCTETSTRING,!1,T),d.create(d.Class.UNIVERSAL,d.Type.INTEGER,!1,p.getBytes())])])}return d.create(d.Class.UNIVERSAL,d.Type.SEQUENCE,!0,[S,d.create(d.Class.UNIVERSAL,d.Type.OCTETSTRING,!1,O)])},c.decryptPrivateKeyInfo=function(C,_){var N=null,T={},I=[];if(!d.validate(C,E,T,I)){var p=new Error("Cannot read encrypted private key. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw p.errors=I,p}var m=d.derToOid(T.encryptionOid),S=c.pbe.getCipher(m,T.encryptionParams,_),O=s.util.createBuffer(T.encryptedData);return S.update(O),S.finish()&&(N=d.fromDer(S.output)),N},c.encryptedPrivateKeyToPem=function(C,_){var N={type:"ENCRYPTED PRIVATE KEY",body:d.toDer(C).getBytes()};return s.pem.encode(N,{maxline:_})},c.encryptedPrivateKeyFromPem=function(C){var _=s.pem.decode(C)[0];if("ENCRYPTED PRIVATE KEY"!==_.type){var N=new Error('Could not convert encrypted private key from PEM; PEM header type is "ENCRYPTED PRIVATE KEY".');throw N.headerType=_.type,N}if(_.procType&&"ENCRYPTED"===_.procType.type)throw new Error("Could not convert encrypted private key from PEM; PEM is encrypted.");return d.fromDer(_.body)},c.encryptRsaPrivateKey=function(C,_,N){if(!(N=N||{}).legacy){var T=c.wrapRsaPrivateKey(c.privateKeyToAsn1(C));return T=c.encryptPrivateKeyInfo(T,_,N),c.encryptedPrivateKeyToPem(T)}var I,p,m,S;switch(N.algorithm){case"aes128":I="AES-128-CBC",m=16,p=s.random.getBytesSync(16),S=s.aes.createEncryptionCipher;break;case"aes192":I="AES-192-CBC",m=24,p=s.random.getBytesSync(16),S=s.aes.createEncryptionCipher;break;case"aes256":I="AES-256-CBC",m=32,p=s.random.getBytesSync(16),S=s.aes.createEncryptionCipher;break;case"3des":I="DES-EDE3-CBC",m=24,p=s.random.getBytesSync(8),S=s.des.createEncryptionCipher;break;case"des":I="DES-CBC",m=8,p=s.random.getBytesSync(8),S=s.des.createEncryptionCipher;break;default:var O=new Error('Could not encrypt RSA private key; unsupported encryption algorithm "'+N.algorithm+'".');throw O.algorithm=N.algorithm,O}var G=S(s.pbe.opensslDeriveBytes(_,p.substr(0,8),m));G.start(p),G.update(d.toDer(c.privateKeyToAsn1(C))),G.finish();var k={type:"RSA PRIVATE KEY",procType:{version:"4",type:"ENCRYPTED"},dekInfo:{algorithm:I,parameters:s.util.bytesToHex(p).toUpperCase()},body:G.output.getBytes()};return s.pem.encode(k)},c.decryptRsaPrivateKey=function(C,_){var N=null,T=s.pem.decode(C)[0];if("ENCRYPTED PRIVATE KEY"!==T.type&&"PRIVATE KEY"!==T.type&&"RSA PRIVATE KEY"!==T.type)throw(I=new Error('Could not convert private key from PEM; PEM header type is not "ENCRYPTED PRIVATE KEY", "PRIVATE KEY", or "RSA PRIVATE KEY".')).headerType=I,I;if(T.procType&&"ENCRYPTED"===T.procType.type){var p,m;switch(T.dekInfo.algorithm){case"DES-CBC":p=8,m=s.des.createDecryptionCipher;break;case"DES-EDE3-CBC":p=24,m=s.des.createDecryptionCipher;break;case"AES-128-CBC":p=16,m=s.aes.createDecryptionCipher;break;case"AES-192-CBC":p=24,m=s.aes.createDecryptionCipher;break;case"AES-256-CBC":p=32,m=s.aes.createDecryptionCipher;break;case"RC2-40-CBC":p=5,m=function(k){return s.rc2.createDecryptionCipher(k,40)};break;case"RC2-64-CBC":p=8,m=function(k){return s.rc2.createDecryptionCipher(k,64)};break;case"RC2-128-CBC":p=16,m=function(k){return s.rc2.createDecryptionCipher(k,128)};break;default:var I;throw(I=new Error('Could not decrypt private key; unsupported encryption algorithm "'+T.dekInfo.algorithm+'".')).algorithm=T.dekInfo.algorithm,I}var S=s.util.hexToBytes(T.dekInfo.parameters),V=m(s.pbe.opensslDeriveBytes(_,S.substr(0,8),p));if(V.start(S),V.update(s.util.createBuffer(T.body)),!V.finish())return N;N=V.output.getBytes()}else N=T.body;return null!==(N="ENCRYPTED PRIVATE KEY"===T.type?c.decryptPrivateKeyInfo(d.fromDer(N),_):d.fromDer(N))&&(N=c.privateKeyFromAsn1(N)),N},c.pbe.generatePkcs12Key=function(C,_,N,T,I,p){var m,S;if(typeof p>"u"||null===p){if(!("sha1"in s.md))throw new Error('"sha1" hash algorithm unavailable.');p=s.md.sha1.create()}var O=p.digestLength,V=p.blockLength,G=new s.util.ByteBuffer,k=new s.util.ByteBuffer;if(null!=C){for(S=0;S<C.length;S++)k.putInt16(C.charCodeAt(S));k.putInt16(0)}var P=k.length(),D=_.length(),l=new s.util.ByteBuffer;l.fillWithByte(N,V);var F=V*Math.ceil(D/V),Y=new s.util.ByteBuffer;for(S=0;S<F;S++)Y.putByte(_.at(S%D));var W=V*Math.ceil(P/V),ne=new s.util.ByteBuffer;for(S=0;S<W;S++)ne.putByte(k.at(S%P));var de=Y;de.putBuffer(ne);for(var Ae=Math.ceil(I/O),Re=1;Re<=Ae;Re++){var Fe=new s.util.ByteBuffer;Fe.putBytes(l.bytes()),Fe.putBytes(de.bytes());for(var be=0;be<T;be++)p.start(),p.update(Fe.getBytes()),Fe=p.digest();var Pe=new s.util.ByteBuffer;for(S=0;S<V;S++)Pe.putByte(Fe.at(S%O));var We=Math.ceil(D/V)+Math.ceil(P/V),Ze=new s.util.ByteBuffer;for(m=0;m<We;m++){var Ct=new s.util.ByteBuffer(de.getBytes(V)),tt=511;for(S=Pe.length()-1;S>=0;S--)tt>>=8,tt+=Pe.at(S)+Ct.at(S),Ct.setAt(S,255&tt);Ze.putBuffer(Ct)}de=Ze,G.putBuffer(Fe)}return G.truncate(G.length()-I),G},c.pbe.getCipher=function(C,_,N){switch(C){case c.oids.pkcs5PBES2:return c.pbe.getCipherForPBES2(C,_,N);case c.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:case c.oids["pbewithSHAAnd40BitRC2-CBC"]:return c.pbe.getCipherForPKCS12PBE(C,_,N);default:var T=new Error("Cannot read encrypted PBE data block. Unsupported OID.");throw T.oid=C,T.supportedOids=["pkcs5PBES2","pbeWithSHAAnd3-KeyTripleDES-CBC","pbewithSHAAnd40BitRC2-CBC"],T}},c.pbe.getCipherForPBES2=function(C,_,N){var p,T={},I=[];if(!d.validate(_,v,T,I))throw(p=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.")).errors=I,p;if((C=d.derToOid(T.kdfOid))!==c.oids.pkcs5PBKDF2)throw(p=new Error("Cannot read encrypted private key. Unsupported key derivation function OID.")).oid=C,p.supportedOids=["pkcs5PBKDF2"],p;if((C=d.derToOid(T.encOid))!==c.oids["aes128-CBC"]&&C!==c.oids["aes192-CBC"]&&C!==c.oids["aes256-CBC"]&&C!==c.oids["des-EDE3-CBC"]&&C!==c.oids.desCBC)throw(p=new Error("Cannot read encrypted private key. Unsupported encryption scheme OID.")).oid=C,p.supportedOids=["aes128-CBC","aes192-CBC","aes256-CBC","des-EDE3-CBC","desCBC"],p;var O,V,m=T.kdfSalt,S=s.util.createBuffer(T.kdfIterationCount);switch(S=S.getInt(S.length()<<3),c.oids[C]){case"aes128-CBC":O=16,V=s.aes.createDecryptionCipher;break;case"aes192-CBC":O=24,V=s.aes.createDecryptionCipher;break;case"aes256-CBC":O=32,V=s.aes.createDecryptionCipher;break;case"des-EDE3-CBC":O=24,V=s.des.createDecryptionCipher;break;case"desCBC":O=8,V=s.des.createDecryptionCipher}var G=x(T.prfOid),k=s.pkcs5.pbkdf2(N,m,S,O,G),P=T.encIv,D=V(k);return D.start(P),D},c.pbe.getCipherForPKCS12PBE=function(C,_,N){var T={},I=[];if(!d.validate(_,y,T,I))throw(p=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.")).errors=I,p;var O,V,G,m=s.util.createBuffer(T.salt),S=s.util.createBuffer(T.iterations);switch(S=S.getInt(S.length()<<3),C){case c.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:O=24,V=8,G=s.des.startDecrypting;break;case c.oids["pbewithSHAAnd40BitRC2-CBC"]:O=5,V=8,G=function(F,Y){var W=s.rc2.createDecryptionCipher(F,40);return W.start(Y,null),W};break;default:var p;throw(p=new Error("Cannot read PKCS #12 PBE data block. Unsupported OID.")).oid=C,p}var k=x(T.prfOid),P=c.pbe.generatePkcs12Key(N,m,1,S,O,k);return k.start(),G(P,c.pbe.generatePkcs12Key(N,m,2,S,V,k))},c.pbe.opensslDeriveBytes=function(C,_,N,T){if(typeof T>"u"||null===T){if(!("md5"in s.md))throw new Error('"md5" hash algorithm unavailable.');T=s.md.md5.create()}null===_&&(_="");for(var I=[h(T,C+_)],p=16,m=1;p<N;++m,p+=16)I.push(h(T,I[m-1]+C+_));return I.join("").substr(0,N)}},7949:(De,J,M)=>{var s=M(8659);M(9032),M(979),M(4747);var d,i=s.pkcs5=s.pkcs5||{};s.util.isNodejs&&!s.options.usePureJavaScript&&(d=M(5819)),De.exports=s.pbkdf2=i.pbkdf2=function(c,B,E,v,y,h){if("function"==typeof y&&(h=y,y=null),s.util.isNodejs&&!s.options.usePureJavaScript&&d.pbkdf2&&(null===y||"object"!=typeof y)&&(d.pbkdf2Sync.length>4||!y||"sha1"===y))return"string"!=typeof y&&(y="sha1"),c=Buffer.from(c,"binary"),B=Buffer.from(B,"binary"),h?4===d.pbkdf2Sync.length?d.pbkdf2(c,B,E,v,function(G,k){if(G)return h(G);h(null,k.toString("binary"))}):d.pbkdf2(c,B,E,v,y,function(G,k){if(G)return h(G);h(null,k.toString("binary"))}):4===d.pbkdf2Sync.length?d.pbkdf2Sync(c,B,E,v).toString("binary"):d.pbkdf2Sync(c,B,E,v,y).toString("binary");if((typeof y>"u"||null===y)&&(y="sha1"),"string"==typeof y){if(!(y in s.md.algorithms))throw new Error("Unknown hash algorithm: "+y);y=s.md[y].create()}var x=y.digestLength;if(v>4294967295*x){var A=new Error("Derived key is too long.");if(h)return h(A);throw A}var H=Math.ceil(v/x),C=v-(H-1)*x,_=s.hmac.create();_.start(y,c);var T,I,p,N="";if(!h){for(var m=1;m<=H;++m){_.start(null,null),_.update(B),_.update(s.util.int32ToBytes(m)),T=p=_.digest().getBytes();for(var S=2;S<=E;++S)_.start(null,null),_.update(p),I=_.digest().getBytes(),T=s.util.xorBytes(T,I,x),p=I;N+=m<H?T:T.substr(0,C)}return N}function O(){if(m>H)return h(null,N);_.start(null,null),_.update(B),_.update(s.util.int32ToBytes(m)),T=p=_.digest().getBytes(),S=2,V()}function V(){if(S<=E)return _.start(null,null),_.update(p),I=_.digest().getBytes(),T=s.util.xorBytes(T,I,x),p=I,++S,s.util.setImmediate(V);N+=m<H?T:T.substr(0,C),++m,O()}m=1,O()}},8604:(De,J,M)=>{var s=M(8659);M(4747);var i=De.exports=s.pem=s.pem||{};function d(B){for(var E=B.name+": ",v=[],y=function(C,_){return" "+_},h=0;h<B.values.length;++h)v.push(B.values[h].replace(/^(\S+\r\n)/,y));E+=v.join(",")+"\r\n";var x=0,A=-1;for(h=0;h<E.length;++h,++x)if(x>65&&-1!==A){var H=E[A];","===H?(++A,E=E.substr(0,A)+"\r\n "+E.substr(A)):E=E.substr(0,A)+"\r\n"+H+E.substr(A+1),x=h-A-1,A=-1,++h}else(" "===E[h]||"\t"===E[h]||","===E[h])&&(A=h);return E}function c(B){return B.replace(/^\s+/,"")}i.encode=function(B,E){E=E||{};var y,v="-----BEGIN "+B.type+"-----\r\n";if(B.procType&&(v+=d(y={name:"Proc-Type",values:[String(B.procType.version),B.procType.type]})),B.contentDomain&&(v+=d(y={name:"Content-Domain",values:[B.contentDomain]})),B.dekInfo&&(y={name:"DEK-Info",values:[B.dekInfo.algorithm]},B.dekInfo.parameters&&y.values.push(B.dekInfo.parameters),v+=d(y)),B.headers)for(var h=0;h<B.headers.length;++h)v+=d(B.headers[h]);return B.procType&&(v+="\r\n"),(v+=s.util.encode64(B.body,E.maxline||64)+"\r\n")+"-----END "+B.type+"-----\r\n"},i.decode=function(B){for(var x,E=[],v=/\s*-----BEGIN ([A-Z0-9- ]+)-----\r?\n?([\x21-\x7e\s]+?(?:\r?\n\r?\n))?([:A-Za-z0-9+\/=\s]+?)-----END \1-----/g,y=/([\x21-\x7e]+):\s*([\x21-\x7e\s^:]+)/,h=/\r?\n/;x=v.exec(B);){var A=x[1];"NEW CERTIFICATE REQUEST"===A&&(A="CERTIFICATE REQUEST");var H={type:A,procType:null,contentDomain:null,dekInfo:null,headers:[],body:s.util.decode64(x[3])};if(E.push(H),x[2]){for(var C=x[2].split(h),_=0;x&&_<C.length;){for(var N=C[_].replace(/\s+$/,""),T=_+1;T<C.length;++T){var I=C[T];if(!/\s/.test(I[0]))break;N+=I,_=T}if(x=N.match(y)){for(var p={name:x[1],values:[]},m=x[2].split(","),S=0;S<m.length;++S)p.values.push(c(m[S]));if(H.procType)if(H.contentDomain||"Content-Domain"!==p.name)if(H.dekInfo||"DEK-Info"!==p.name)H.headers.push(p);else{if(0===p.values.length)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must have at least one subfield.');H.dekInfo={algorithm:m[0],parameters:m[1]||null}}else H.contentDomain=m[0]||"";else{if("Proc-Type"!==p.name)throw new Error('Invalid PEM formatted message. The first encapsulated header must be "Proc-Type".');if(2!==p.values.length)throw new Error('Invalid PEM formatted message. The "Proc-Type" header must have two subfields.');H.procType={version:m[0],type:m[1]}}}++_}if("ENCRYPTED"===H.procType&&!H.dekInfo)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must be present if "Proc-Type" is "ENCRYPTED".')}}if(0===E.length)throw new Error("Invalid PEM formatted message.");return E}},7246:(De,J,M)=>{var s=M(8659);M(4747),M(8365),M(7690);var i=De.exports=s.pkcs1=s.pkcs1||{};function d(c,B,E){E||(E=s.md.sha1.create());for(var v="",y=Math.ceil(B/E.digestLength),h=0;h<y;++h){var x=String.fromCharCode(h>>24&255,h>>16&255,h>>8&255,255&h);E.start(),E.update(c+x),v+=E.digest().getBytes()}return v.substring(0,B)}i.encode_rsa_oaep=function(c,B,E){var v,y,h,x;"string"==typeof E?(v=E,y=arguments[3]||void 0,h=arguments[4]||void 0):E&&(v=E.label||void 0,y=E.seed||void 0,h=E.md||void 0,E.mgf1&&E.mgf1.md&&(x=E.mgf1.md)),h?h.start():h=s.md.sha1.create(),x||(x=h);var A=Math.ceil(c.n.bitLength()/8),H=A-2*h.digestLength-2;if(B.length>H)throw(C=new Error("RSAES-OAEP input message length is too long.")).length=B.length,C.maxLength=H,C;v||(v=""),h.update(v,"raw");for(var _=h.digest(),N="",T=H-B.length,I=0;I<T;I++)N+="\0";var p=_.getBytes()+N+"\x01"+B;if(y){if(y.length!==h.digestLength){var C;throw(C=new Error("Invalid RSAES-OAEP seed. The seed length must match the digest length.")).seedLength=y.length,C.digestLength=h.digestLength,C}}else y=s.random.getBytes(h.digestLength);var m=d(y,A-h.digestLength-1,x),S=s.util.xorBytes(p,m,p.length),O=d(S,h.digestLength,x),V=s.util.xorBytes(y,O,y.length);return"\0"+V+S},i.decode_rsa_oaep=function(c,B,E){var v,y,h;"string"==typeof E?(v=E,y=arguments[3]||void 0):E&&(v=E.label||void 0,y=E.md||void 0,E.mgf1&&E.mgf1.md&&(h=E.mgf1.md));var x=Math.ceil(c.n.bitLength()/8);if(B.length!==x)throw(S=new Error("RSAES-OAEP encoded message length is invalid.")).length=B.length,S.expectedLength=x,S;if(void 0===y?y=s.md.sha1.create():y.start(),h||(h=y),x<2*y.digestLength+2)throw new Error("RSAES-OAEP key is too short for the hash function.");v||(v=""),y.update(v,"raw");for(var A=y.digest().getBytes(),H=B.charAt(0),C=B.substring(1,y.digestLength+1),_=B.substring(1+y.digestLength),N=d(_,y.digestLength,h),T=s.util.xorBytes(C,N,C.length),I=d(T,x-y.digestLength-1,h),p=s.util.xorBytes(_,I,_.length),m=p.substring(0,y.digestLength),S="\0"!==H,O=0;O<y.digestLength;++O)S|=A.charAt(O)!==m.charAt(O);for(var V=1,G=y.digestLength,k=y.digestLength;k<p.length;k++){var P=p.charCodeAt(k),D=1&P^1,l=V?65534:0;S|=P&l,G+=V&=D}if(S||1!==p.charCodeAt(G))throw new Error("Invalid RSAES-OAEP padding.");return p.substring(G+1)}},562:(De,J,M)=>{var s=M(8659);M(7791),M(9032),M(6078),M(4957),M(2158),M(8365),M(5517),M(7690),M(4747),M(5911);var i=s.asn1,d=s.pki,c=De.exports=s.pkcs12=s.pkcs12||{},B={name:"ContentInfo",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"ContentInfo.contentType",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:!1,capture:"contentType"},{name:"ContentInfo.content",tagClass:i.Class.CONTEXT_SPECIFIC,constructed:!0,captureAsn1:"content"}]},E={name:"PFX",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.version",tagClass:i.Class.UNIVERSAL,type:i.Type.INTEGER,constructed:!1,capture:"version"},B,{name:"PFX.macData",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"mac",value:[{name:"PFX.macData.mac",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.macData.mac.digestAlgorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.macData.mac.digestAlgorithm.algorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:!1,capture:"macAlgorithm"},{name:"PFX.macData.mac.digestAlgorithm.parameters",tagClass:i.Class.UNIVERSAL,captureAsn1:"macAlgorithmParameters"}]},{name:"PFX.macData.mac.digest",tagClass:i.Class.UNIVERSAL,type:i.Type.OCTETSTRING,constructed:!1,capture:"macDigest"}]},{name:"PFX.macData.macSalt",tagClass:i.Class.UNIVERSAL,type:i.Type.OCTETSTRING,constructed:!1,capture:"macSalt"},{name:"PFX.macData.iterations",tagClass:i.Class.UNIVERSAL,type:i.Type.INTEGER,constructed:!1,optional:!0,capture:"macIterations"}]}]},v={name:"SafeBag",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"SafeBag.bagId",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:!1,capture:"bagId"},{name:"SafeBag.bagValue",tagClass:i.Class.CONTEXT_SPECIFIC,constructed:!0,captureAsn1:"bagValue"},{name:"SafeBag.bagAttributes",tagClass:i.Class.UNIVERSAL,type:i.Type.SET,constructed:!0,optional:!0,capture:"bagAttributes"}]},y={name:"Attribute",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"Attribute.attrId",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:!1,capture:"oid"},{name:"Attribute.attrValues",tagClass:i.Class.UNIVERSAL,type:i.Type.SET,constructed:!0,capture:"values"}]},h={name:"CertBag",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"CertBag.certId",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:!1,capture:"certId"},{name:"CertBag.certValue",tagClass:i.Class.CONTEXT_SPECIFIC,constructed:!0,value:[{name:"CertBag.certValue[0]",tagClass:i.Class.UNIVERSAL,type:i.Class.OCTETSTRING,constructed:!1,capture:"cert"}]}]};function x(T,I,p,m){for(var S=[],O=0;O<T.length;O++)for(var V=0;V<T[O].safeBags.length;V++){var G=T[O].safeBags[V];if(void 0===m||G.type===m){if(null===I){S.push(G);continue}void 0!==G.attributes[I]&&G.attributes[I].indexOf(p)>=0&&S.push(G)}}return S}function A(T){if(T.composed||T.constructed){for(var I=s.util.createBuffer(),p=0;p<T.value.length;++p)I.putBytes(T.value[p].value);T.composed=T.constructed=!1,T.value=I.getBytes()}return T}function C(T,I){var p={},m=[];if(!i.validate(T,s.pkcs7.asn1.encryptedDataValidator,p,m))throw(S=new Error("Cannot read EncryptedContentInfo.")).errors=m,S;var S,O=i.derToOid(p.contentType);if(O!==d.oids.data)throw(S=new Error("PKCS#12 EncryptedContentInfo ContentType is not Data.")).oid=O,S;O=i.derToOid(p.encAlgorithm);var V=d.pbe.getCipher(O,p.encParameter,I),G=A(p.encryptedContentAsn1),k=s.util.createBuffer(G.value);if(V.update(k),!V.finish())throw new Error("Failed to decrypt PKCS#12 SafeContents.");return V.output.getBytes()}function _(T,I,p){if(!I&&0===T.length)return[];if((T=i.fromDer(T,I)).tagClass!==i.Class.UNIVERSAL||T.type!==i.Type.SEQUENCE||!0!==T.constructed)throw new Error("PKCS#12 SafeContents expected to be a SEQUENCE OF SafeBag.");for(var m=[],S=0;S<T.value.length;S++){var V={},G=[];if(!i.validate(T.value[S],v,V,G))throw(k=new Error("Cannot read SafeBag.")).errors=G,k;var P={type:i.derToOid(V.bagId),attributes:N(V.bagAttributes)};m.push(P);var D,l,F=V.bagValue.value[0];switch(P.type){case d.oids.pkcs8ShroudedKeyBag:if(null===(F=d.decryptPrivateKeyInfo(F,p)))throw new Error("Unable to decrypt PKCS#8 ShroudedKeyBag, wrong password?");case d.oids.keyBag:try{P.key=d.privateKeyFromAsn1(F)}catch{P.key=null,P.asn1=F}continue;case d.oids.certBag:D=h,l=function(){if(i.derToOid(V.certId)!==d.oids.x509Certificate){var W=new Error("Unsupported certificate type, only X.509 supported.");throw W.oid=i.derToOid(V.certId),W}var ne=i.fromDer(V.cert,I);try{P.cert=d.certificateFromAsn1(ne,!0)}catch{P.cert=null,P.asn1=ne}};break;default:var k;throw(k=new Error("Unsupported PKCS#12 SafeBag type.")).oid=P.type,k}if(void 0!==D&&!i.validate(F,D,V,G))throw(k=new Error("Cannot read PKCS#12 "+D.name)).errors=G,k;l()}return m}function N(T){var I={};if(void 0!==T)for(var p=0;p<T.length;++p){var m={},S=[];if(!i.validate(T[p],y,m,S)){var O=new Error("Cannot read PKCS#12 BagAttribute.");throw O.errors=S,O}var V=i.derToOid(m.oid);if(void 0!==d.oids[V]){I[d.oids[V]]=[];for(var G=0;G<m.values.length;++G)I[d.oids[V]].push(m.values[G].value)}}return I}c.pkcs12FromAsn1=function(T,I,p){"string"==typeof I?(p=I,I=!0):void 0===I&&(I=!0);var m={};if(!i.validate(T,E,m,[]))throw(O=new Error("Cannot read PKCS#12 PFX. ASN.1 object is not an PKCS#12 PFX.")).errors=O,O;var O,V={version:m.version.charCodeAt(0),safeContents:[],getBags:function(de){var Re,Ae={};return"localKeyId"in de?Re=de.localKeyId:"localKeyIdHex"in de&&(Re=s.util.hexToBytes(de.localKeyIdHex)),void 0===Re&&!("friendlyName"in de)&&"bagType"in de&&(Ae[de.bagType]=x(V.safeContents,null,null,de.bagType)),void 0!==Re&&(Ae.localKeyId=x(V.safeContents,"localKeyId",Re,de.bagType)),"friendlyName"in de&&(Ae.friendlyName=x(V.safeContents,"friendlyName",de.friendlyName,de.bagType)),Ae},getBagsByFriendlyName:function(de,Ae){return x(V.safeContents,"friendlyName",de,Ae)},getBagsByLocalKeyId:function(de,Ae){return x(V.safeContents,"localKeyId",de,Ae)}};if(3!==m.version.charCodeAt(0))throw(O=new Error("PKCS#12 PFX of version other than 3 not supported.")).version=m.version.charCodeAt(0),O;if(i.derToOid(m.contentType)!==d.oids.data)throw(O=new Error("Only PKCS#12 PFX in password integrity mode supported.")).oid=i.derToOid(m.contentType),O;var G=m.content.value[0];if(G.tagClass!==i.Class.UNIVERSAL||G.type!==i.Type.OCTETSTRING)throw new Error("PKCS#12 authSafe content data is not an OCTET STRING.");if(G=A(G),m.mac){var k=null,P=0,D=i.derToOid(m.macAlgorithm);switch(D){case d.oids.sha1:k=s.md.sha1.create(),P=20;break;case d.oids.sha256:k=s.md.sha256.create(),P=32;break;case d.oids.sha384:k=s.md.sha384.create(),P=48;break;case d.oids.sha512:k=s.md.sha512.create(),P=64;break;case d.oids.md5:k=s.md.md5.create(),P=16}if(null===k)throw new Error("PKCS#12 uses unsupported MAC algorithm: "+D);var l=new s.util.ByteBuffer(m.macSalt),F="macIterations"in m?parseInt(s.util.bytesToHex(m.macIterations),16):1,Y=c.generateKey(p,l,3,F,P,k),W=s.hmac.create();if(W.start(k,Y),W.update(G.value),W.getMac().getBytes()!==m.macDigest)throw new Error("PKCS#12 MAC could not be verified. Invalid password?")}return function H(T,I,p,m){if((I=i.fromDer(I,p)).tagClass!==i.Class.UNIVERSAL||I.type!==i.Type.SEQUENCE||!0!==I.constructed)throw new Error("PKCS#12 AuthenticatedSafe expected to be a SEQUENCE OF ContentInfo");for(var S=0;S<I.value.length;S++){var V={},G=[];if(!i.validate(I.value[S],B,V,G))throw(k=new Error("Cannot read ContentInfo.")).errors=G,k;var P={encrypted:!1},D=null,l=V.content.value[0];switch(i.derToOid(V.contentType)){case d.oids.data:if(l.tagClass!==i.Class.UNIVERSAL||l.type!==i.Type.OCTETSTRING)throw new Error("PKCS#12 SafeContents Data is not an OCTET STRING.");D=A(l).value;break;case d.oids.encryptedData:D=C(l,m),P.encrypted=!0;break;default:var k;throw(k=new Error("Unsupported PKCS#12 contentType.")).contentType=i.derToOid(V.contentType),k}P.safeBags=_(D,p,m),T.safeContents.push(P)}}(V,G.value,I,p),V},c.toPkcs12Asn1=function(T,I,p,m){(m=m||{}).saltSize=m.saltSize||8,m.count=m.count||2048,m.algorithm=m.algorithm||m.encAlgorithm||"aes128","useMac"in m||(m.useMac=!0),"localKeyId"in m||(m.localKeyId=null),"generateLocalKeyId"in m||(m.generateLocalKeyId=!0);var O,S=m.localKeyId;if(null!==S)S=s.util.hexToBytes(S);else if(m.generateLocalKeyId)if(I){var V=s.util.isArray(I)?I[0]:I;"string"==typeof V&&(V=d.certificateFromPem(V)),(G=s.md.sha1.create()).update(i.toDer(d.certificateToAsn1(V)).getBytes()),S=G.digest().getBytes()}else S=s.random.getBytes(20);var k=[];null!==S&&k.push(i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(d.oids.localKeyId).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.SET,!0,[i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,!1,S)])])),"friendlyName"in m&&k.push(i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(d.oids.friendlyName).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.SET,!0,[i.create(i.Class.UNIVERSAL,i.Type.BMPSTRING,!1,m.friendlyName)])])),k.length>0&&(O=i.create(i.Class.UNIVERSAL,i.Type.SET,!0,k));var P=[],D=[];null!==I&&(D=s.util.isArray(I)?I:[I]);for(var l=[],F=0;F<D.length;++F){"string"==typeof(I=D[F])&&(I=d.certificateFromPem(I));var Y=0===F?O:void 0,W=d.certificateToAsn1(I),ne=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(d.oids.certBag).getBytes()),i.create(i.Class.CONTEXT_SPECIFIC,0,!0,[i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(d.oids.x509Certificate).getBytes()),i.create(i.Class.CONTEXT_SPECIFIC,0,!0,[i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,!1,i.toDer(W).getBytes())])])]),Y]);l.push(ne)}if(l.length>0){var de=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,l),Ae=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(d.oids.data).getBytes()),i.create(i.Class.CONTEXT_SPECIFIC,0,!0,[i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,!1,i.toDer(de).getBytes())])]);P.push(Ae)}var Re=null;if(null!==T){var Fe=d.wrapRsaPrivateKey(d.privateKeyToAsn1(T));Re=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,null===p?[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(d.oids.keyBag).getBytes()),i.create(i.Class.CONTEXT_SPECIFIC,0,!0,[Fe]),O]:[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(d.oids.pkcs8ShroudedKeyBag).getBytes()),i.create(i.Class.CONTEXT_SPECIFIC,0,!0,[d.encryptPrivateKeyInfo(Fe,p,m)]),O]);var be=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[Re]),Pe=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(d.oids.data).getBytes()),i.create(i.Class.CONTEXT_SPECIFIC,0,!0,[i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,!1,i.toDer(be).getBytes())])]);P.push(Pe)}var Ze,We=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,P);if(m.useMac){var G=s.md.sha1.create(),Ct=new s.util.ByteBuffer(s.random.getBytes(m.saltSize)),tt=m.count,Ht=(T=c.generateKey(p,Ct,3,tt,20),s.hmac.create());Ht.start(G,T),Ht.update(i.toDer(We).getBytes());var ct=Ht.getMac();Ze=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(d.oids.sha1).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.NULL,!1,"")]),i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,!1,ct.getBytes())]),i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,!1,Ct.getBytes()),i.create(i.Class.UNIVERSAL,i.Type.INTEGER,!1,i.integerToDer(tt).getBytes())])}return i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.INTEGER,!1,i.integerToDer(3).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(d.oids.data).getBytes()),i.create(i.Class.CONTEXT_SPECIFIC,0,!0,[i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,!1,i.toDer(We).getBytes())])]),Ze])},c.generateKey=s.pbe.generatePkcs12Key},422:(De,J,M)=>{var s=M(8659);M(1298),M(7791),M(279),M(6078),M(8604),M(4957),M(8365),M(4747),M(5911);var i=s.asn1,d=De.exports=s.pkcs7=s.pkcs7||{};function c(T){var I={},p=[];if(!i.validate(T,d.asn1.recipientInfoValidator,I,p)){var m=new Error("Cannot read PKCS#7 RecipientInfo. ASN.1 object is not an PKCS#7 RecipientInfo.");throw m.errors=p,m}return{version:I.version.charCodeAt(0),issuer:s.pki.RDNAttributesAsArray(I.issuer),serialNumber:s.util.createBuffer(I.serial).toHex(),encryptedContent:{algorithm:i.derToOid(I.encAlgorithm),parameter:I.encParameter?I.encParameter.value:void 0,content:I.encKey}}}function B(T){return i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.INTEGER,!1,i.integerToDer(T.version).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[s.pki.distinguishedNameToAsn1({attributes:T.issuer}),i.create(i.Class.UNIVERSAL,i.Type.INTEGER,!1,s.util.hexToBytes(T.serialNumber))]),i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(T.encryptedContent.algorithm).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.NULL,!1,"")]),i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,!1,T.encryptedContent.content)])}function v(T){for(var I=[],p=0;p<T.length;++p)I.push(B(T[p]));return I}function h(T){var I=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.INTEGER,!1,i.integerToDer(T.version).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[s.pki.distinguishedNameToAsn1({attributes:T.issuer}),i.create(i.Class.UNIVERSAL,i.Type.INTEGER,!1,s.util.hexToBytes(T.serialNumber))]),i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(T.digestAlgorithm).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.NULL,!1,"")])]);if(T.authenticatedAttributesAsn1&&I.value.push(T.authenticatedAttributesAsn1),I.value.push(i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(T.signatureAlgorithm).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.NULL,!1,"")])),I.value.push(i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,!1,T.signature)),T.unauthenticatedAttributes.length>0){for(var p=i.create(i.Class.CONTEXT_SPECIFIC,1,!0,[]),m=0;m<T.unauthenticatedAttributes.length;++m)p.values.push(H(T.unauthenticatedAttributes[m]));I.value.push(p)}return I}function H(T){var I;if(T.type===s.pki.oids.contentType)I=i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(T.value).getBytes());else if(T.type===s.pki.oids.messageDigest)I=i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,!1,T.value.bytes());else if(T.type===s.pki.oids.signingTime){var p=new Date("1950-01-01T00:00:00Z"),m=new Date("2050-01-01T00:00:00Z"),S=T.value;if("string"==typeof S){var O=Date.parse(S);S=isNaN(O)?13===S.length?i.utcTimeToDate(S):i.generalizedTimeToDate(S):new Date(O)}I=S>=p&&S<m?i.create(i.Class.UNIVERSAL,i.Type.UTCTIME,!1,i.dateToUtcTime(S)):i.create(i.Class.UNIVERSAL,i.Type.GENERALIZEDTIME,!1,i.dateToGeneralizedTime(S))}return i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(T.type).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.SET,!0,[I])])}function C(T){return[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(s.pki.oids.data).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(T.algorithm).getBytes()),T.parameter?i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,!1,T.parameter.getBytes()):void 0]),i.create(i.Class.CONTEXT_SPECIFIC,0,!0,[i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,!1,T.content.getBytes())])]}function _(T,I,p){var m={};if(!i.validate(I,p,m,[])){var O=new Error("Cannot read PKCS#7 message. ASN.1 object is not a supported PKCS#7 message.");throw O.errors=O,O}if(i.derToOid(m.contentType)!==s.pki.oids.data)throw new Error("Unsupported PKCS#7 message. Only wrapped ContentType Data supported.");if(m.encryptedContent){var G="";if(s.util.isArray(m.encryptedContent))for(var k=0;k<m.encryptedContent.length;++k){if(m.encryptedContent[k].type!==i.Type.OCTETSTRING)throw new Error("Malformed PKCS#7 message, expecting encrypted content constructed of only OCTET STRING objects.");G+=m.encryptedContent[k].value}else G=m.encryptedContent;T.encryptedContent={algorithm:i.derToOid(m.encAlgorithm),parameter:s.util.createBuffer(m.encParameter.value),content:s.util.createBuffer(G)}}if(m.content){if(G="",s.util.isArray(m.content))for(k=0;k<m.content.length;++k){if(m.content[k].type!==i.Type.OCTETSTRING)throw new Error("Malformed PKCS#7 message, expecting content constructed of only OCTET STRING objects.");G+=m.content[k].value}else G=m.content;T.content=s.util.createBuffer(G)}return T.version=m.version.charCodeAt(0),T.rawCapture=m,m}function N(T){if(void 0===T.encryptedContent.key)throw new Error("Symmetric key not available.");if(void 0===T.content){var I;switch(T.encryptedContent.algorithm){case s.pki.oids["aes128-CBC"]:case s.pki.oids["aes192-CBC"]:case s.pki.oids["aes256-CBC"]:I=s.aes.createDecryptionCipher(T.encryptedContent.key);break;case s.pki.oids.desCBC:case s.pki.oids["des-EDE3-CBC"]:I=s.des.createDecryptionCipher(T.encryptedContent.key);break;default:throw new Error("Unsupported symmetric cipher, OID "+T.encryptedContent.algorithm)}if(I.start(T.encryptedContent.parameter),I.update(T.encryptedContent.content),!I.finish())throw new Error("Symmetric decryption failed.");T.content=I.output}}d.messageFromPem=function(T){var I=s.pem.decode(T)[0];if("PKCS7"!==I.type){var p=new Error('Could not convert PKCS#7 message from PEM; PEM header type is not "PKCS#7".');throw p.headerType=I.type,p}if(I.procType&&"ENCRYPTED"===I.procType.type)throw new Error("Could not convert PKCS#7 message from PEM; PEM is encrypted.");var m=i.fromDer(I.body);return d.messageFromAsn1(m)},d.messageToPem=function(T,I){var p={type:"PKCS7",body:i.toDer(T.toAsn1()).getBytes()};return s.pem.encode(p,{maxline:I})},d.messageFromAsn1=function(T){var I={},p=[];if(!i.validate(T,d.asn1.contentInfoValidator,I,p)){var m=new Error("Cannot read PKCS#7 message. ASN.1 object is not an PKCS#7 ContentInfo.");throw m.errors=p,m}var O,S=i.derToOid(I.contentType);switch(S){case s.pki.oids.envelopedData:O=d.createEnvelopedData();break;case s.pki.oids.encryptedData:O=d.createEncryptedData();break;case s.pki.oids.signedData:O=d.createSignedData();break;default:throw new Error("Cannot read PKCS#7 message. ContentType with OID "+S+" is not (yet) supported.")}return O.fromAsn1(I.content.value[0]),O},d.createSignedData=function(){var T=null;return T={type:s.pki.oids.signedData,version:1,certificates:[],crls:[],signers:[],digestAlgorithmIdentifiers:[],contentInfo:null,signerInfos:[],fromAsn1:function(m){if(_(T,m,d.asn1.signedDataValidator),T.certificates=[],T.crls=[],T.digestAlgorithmIdentifiers=[],T.contentInfo=null,T.signerInfos=[],T.rawCapture.certificates)for(var S=T.rawCapture.certificates.value,O=0;O<S.length;++O)T.certificates.push(s.pki.certificateFromAsn1(S[O]))},toAsn1:function(){T.contentInfo||T.sign();for(var m=[],S=0;S<T.certificates.length;++S)m.push(s.pki.certificateToAsn1(T.certificates[S]));var O=[],V=i.create(i.Class.CONTEXT_SPECIFIC,0,!0,[i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.INTEGER,!1,i.integerToDer(T.version).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.SET,!0,T.digestAlgorithmIdentifiers),T.contentInfo])]);return m.length>0&&V.value[0].value.push(i.create(i.Class.CONTEXT_SPECIFIC,0,!0,m)),O.length>0&&V.value[0].value.push(i.create(i.Class.CONTEXT_SPECIFIC,1,!0,O)),V.value[0].value.push(i.create(i.Class.UNIVERSAL,i.Type.SET,!0,T.signerInfos)),i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(T.type).getBytes()),V])},addSigner:function(m){var S=m.issuer,O=m.serialNumber;if(m.certificate){var V=m.certificate;"string"==typeof V&&(V=s.pki.certificateFromPem(V)),S=V.issuer.attributes,O=V.serialNumber}var G=m.key;if(!G)throw new Error("Could not add PKCS#7 signer; no private key specified.");"string"==typeof G&&(G=s.pki.privateKeyFromPem(G));var k=m.digestAlgorithm||s.pki.oids.sha1;switch(k){case s.pki.oids.sha1:case s.pki.oids.sha256:case s.pki.oids.sha384:case s.pki.oids.sha512:case s.pki.oids.md5:break;default:throw new Error("Could not add PKCS#7 signer; unknown message digest algorithm: "+k)}var P=m.authenticatedAttributes||[];if(P.length>0){for(var D=!1,l=!1,F=0;F<P.length;++F){var Y=P[F];if(D||Y.type!==s.pki.oids.contentType){if(l||Y.type!==s.pki.oids.messageDigest);else if(l=!0,D)break}else if(D=!0,l)break}if(!D||!l)throw new Error("Invalid signer.authenticatedAttributes. If signer.authenticatedAttributes is specified, then it must contain at least two attributes, PKCS #9 content-type and PKCS #9 message-digest.")}T.signers.push({key:G,version:1,issuer:S,serialNumber:O,digestAlgorithm:k,signatureAlgorithm:s.pki.oids.rsaEncryption,signature:null,authenticatedAttributes:P,unauthenticatedAttributes:[]})},sign:function(m){var S;if(m=m||{},"object"==typeof T.content&&null!==T.contentInfo||(T.contentInfo=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(s.pki.oids.data).getBytes())]),!("content"in T))||(T.content instanceof s.util.ByteBuffer?S=T.content.bytes():"string"==typeof T.content&&(S=s.util.encodeUtf8(T.content)),m.detached?T.detachedContent=i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,!1,S):T.contentInfo.value.push(i.create(i.Class.CONTEXT_SPECIFIC,0,!0,[i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,!1,S)]))),0!==T.signers.length){var O=function I(){for(var m={},S=0;S<T.signers.length;++S){var O=T.signers[S];(V=O.digestAlgorithm)in m||(m[V]=s.md[s.pki.oids[V]].create()),O.md=0===O.authenticatedAttributes.length?m[V]:s.md[s.pki.oids[V]].create()}for(var V in T.digestAlgorithmIdentifiers=[],m)T.digestAlgorithmIdentifiers.push(i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(V).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.NULL,!1,"")]));return m}();!function p(m){var S;if(!(S=T.detachedContent?T.detachedContent:(S=T.contentInfo.value[1]).value[0]))throw new Error("Could not sign PKCS#7 message; there is no content to sign.");var O=i.derToOid(T.contentInfo.value[0].value),V=i.toDer(S);for(var G in V.getByte(),i.getBerValueLength(V),V=V.getBytes(),m)m[G].start().update(V);for(var k=new Date,P=0;P<T.signers.length;++P){var D=T.signers[P];if(0===D.authenticatedAttributes.length){if(O!==s.pki.oids.data)throw new Error("Invalid signer; authenticatedAttributes must be present when the ContentInfo content type is not PKCS#7 Data.")}else{D.authenticatedAttributesAsn1=i.create(i.Class.CONTEXT_SPECIFIC,0,!0,[]);for(var l=i.create(i.Class.UNIVERSAL,i.Type.SET,!0,[]),F=0;F<D.authenticatedAttributes.length;++F){var Y=D.authenticatedAttributes[F];Y.type===s.pki.oids.messageDigest?Y.value=m[D.digestAlgorithm].digest():Y.type===s.pki.oids.signingTime&&(Y.value||(Y.value=k)),l.value.push(H(Y)),D.authenticatedAttributesAsn1.value.push(H(Y))}V=i.toDer(l).getBytes(),D.md.start().update(V)}D.signature=D.key.sign(D.md,"RSASSA-PKCS1-V1_5")}T.signerInfos=function A(T){for(var I=[],p=0;p<T.length;++p)I.push(h(T[p]));return I}(T.signers)}(O)}},verify:function(){throw new Error("PKCS#7 signature verification not yet implemented.")},addCertificate:function(m){"string"==typeof m&&(m=s.pki.certificateFromPem(m)),T.certificates.push(m)},addCertificateRevokationList:function(m){throw new Error("PKCS#7 CRL support not yet implemented.")}}},d.createEncryptedData=function(){var T=null;return T={type:s.pki.oids.encryptedData,version:0,encryptedContent:{algorithm:s.pki.oids["aes256-CBC"]},fromAsn1:function(I){_(T,I,d.asn1.encryptedDataValidator)},decrypt:function(I){void 0!==I&&(T.encryptedContent.key=I),N(T)}}},d.createEnvelopedData=function(){var T=null;return T={type:s.pki.oids.envelopedData,version:0,recipients:[],encryptedContent:{algorithm:s.pki.oids["aes256-CBC"]},fromAsn1:function(I){var p=_(T,I,d.asn1.envelopedDataValidator);T.recipients=function E(T){for(var I=[],p=0;p<T.length;++p)I.push(c(T[p]));return I}(p.recipientInfos.value)},toAsn1:function(){return i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(T.type).getBytes()),i.create(i.Class.CONTEXT_SPECIFIC,0,!0,[i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.INTEGER,!1,i.integerToDer(T.version).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.SET,!0,v(T.recipients)),i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,C(T.encryptedContent))])])])},findRecipient:function(I){for(var p=I.issuer.attributes,m=0;m<T.recipients.length;++m){var S=T.recipients[m],O=S.issuer;if(S.serialNumber===I.serialNumber&&O.length===p.length){for(var V=!0,G=0;G<p.length;++G)if(O[G].type!==p[G].type||O[G].value!==p[G].value){V=!1;break}if(V)return S}}return null},decrypt:function(I,p){if(void 0===T.encryptedContent.key&&void 0!==I&&void 0!==p)switch(I.encryptedContent.algorithm){case s.pki.oids.rsaEncryption:case s.pki.oids.desCBC:var m=p.decrypt(I.encryptedContent.content);T.encryptedContent.key=s.util.createBuffer(m);break;default:throw new Error("Unsupported asymmetric cipher, OID "+I.encryptedContent.algorithm)}N(T)},addRecipient:function(I){T.recipients.push({version:0,issuer:I.issuer.attributes,serialNumber:I.serialNumber,encryptedContent:{algorithm:s.pki.oids.rsaEncryption,key:I.publicKey}})},encrypt:function(I,p){if(void 0===T.encryptedContent.content){var m,S,O;switch(I=I||T.encryptedContent.key,p=p||T.encryptedContent.algorithm){case s.pki.oids["aes128-CBC"]:m=16,S=16,O=s.aes.createEncryptionCipher;break;case s.pki.oids["aes192-CBC"]:m=24,S=16,O=s.aes.createEncryptionCipher;break;case s.pki.oids["aes256-CBC"]:m=32,S=16,O=s.aes.createEncryptionCipher;break;case s.pki.oids["des-EDE3-CBC"]:m=24,S=8,O=s.des.createEncryptionCipher;break;default:throw new Error("Unsupported symmetric cipher, OID "+p)}if(void 0===I)I=s.util.createBuffer(s.random.getBytes(m));else if(I.length()!=m)throw new Error("Symmetric key has wrong length; got "+I.length()+" bytes, expected "+m+".");T.encryptedContent.algorithm=p,T.encryptedContent.key=I,T.encryptedContent.parameter=s.util.createBuffer(s.random.getBytes(S));var V=O(I);if(V.start(T.encryptedContent.parameter.copy()),V.update(T.content),!V.finish())throw new Error("Symmetric encryption failed.");T.encryptedContent.content=V.output}for(var G=0;G<T.recipients.length;++G){var k=T.recipients[G];if(void 0===k.encryptedContent.content){if(k.encryptedContent.algorithm!==s.pki.oids.rsaEncryption)throw new Error("Unsupported asymmetric cipher, OID "+k.encryptedContent.algorithm);k.encryptedContent.content=k.encryptedContent.key.encrypt(T.encryptedContent.key.data)}}}}}},4957:(De,J,M)=>{var s=M(8659);M(7791),M(4747);var i=s.asn1,d=De.exports=s.pkcs7asn1=s.pkcs7asn1||{};s.pkcs7=s.pkcs7||{},s.pkcs7.asn1=d;var c={name:"ContentInfo",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"ContentInfo.ContentType",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:!1,capture:"contentType"},{name:"ContentInfo.content",tagClass:i.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,captureAsn1:"content"}]};d.contentInfoValidator=c;var B={name:"EncryptedContentInfo",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentType",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:!1,capture:"contentType"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentEncryptionAlgorithm.algorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm.parameter",tagClass:i.Class.UNIVERSAL,captureAsn1:"encParameter"}]},{name:"EncryptedContentInfo.encryptedContent",tagClass:i.Class.CONTEXT_SPECIFIC,type:0,capture:"encryptedContent",captureAsn1:"encryptedContentAsn1"}]};d.envelopedDataValidator={name:"EnvelopedData",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"EnvelopedData.Version",tagClass:i.Class.UNIVERSAL,type:i.Type.INTEGER,constructed:!1,capture:"version"},{name:"EnvelopedData.RecipientInfos",tagClass:i.Class.UNIVERSAL,type:i.Type.SET,constructed:!0,captureAsn1:"recipientInfos"}].concat(B)},d.encryptedDataValidator={name:"EncryptedData",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedData.Version",tagClass:i.Class.UNIVERSAL,type:i.Type.INTEGER,constructed:!1,capture:"version"}].concat(B)},d.signedDataValidator={name:"SignedData",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"SignedData.Version",tagClass:i.Class.UNIVERSAL,type:i.Type.INTEGER,constructed:!1,capture:"version"},{name:"SignedData.DigestAlgorithms",tagClass:i.Class.UNIVERSAL,type:i.Type.SET,constructed:!0,captureAsn1:"digestAlgorithms"},c,{name:"SignedData.Certificates",tagClass:i.Class.CONTEXT_SPECIFIC,type:0,optional:!0,captureAsn1:"certificates"},{name:"SignedData.CertificateRevocationLists",tagClass:i.Class.CONTEXT_SPECIFIC,type:1,optional:!0,captureAsn1:"crls"},{name:"SignedData.SignerInfos",tagClass:i.Class.UNIVERSAL,type:i.Type.SET,capture:"signerInfos",optional:!0,value:[{name:"SignerInfo",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.version",tagClass:i.Class.UNIVERSAL,type:i.Type.INTEGER,constructed:!1},{name:"SignerInfo.issuerAndSerialNumber",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.issuerAndSerialNumber.issuer",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"SignerInfo.issuerAndSerialNumber.serialNumber",tagClass:i.Class.UNIVERSAL,type:i.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"SignerInfo.digestAlgorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.digestAlgorithm.algorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:!1,capture:"digestAlgorithm"},{name:"SignerInfo.digestAlgorithm.parameter",tagClass:i.Class.UNIVERSAL,constructed:!1,captureAsn1:"digestParameter",optional:!0}]},{name:"SignerInfo.authenticatedAttributes",tagClass:i.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"authenticatedAttributes"},{name:"SignerInfo.digestEncryptionAlgorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,capture:"signatureAlgorithm"},{name:"SignerInfo.encryptedDigest",tagClass:i.Class.UNIVERSAL,type:i.Type.OCTETSTRING,constructed:!1,capture:"signature"},{name:"SignerInfo.unauthenticatedAttributes",tagClass:i.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,capture:"unauthenticatedAttributes"}]}]}]},d.recipientInfoValidator={name:"RecipientInfo",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.version",tagClass:i.Class.UNIVERSAL,type:i.Type.INTEGER,constructed:!1,capture:"version"},{name:"RecipientInfo.issuerAndSerial",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.issuerAndSerial.issuer",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"RecipientInfo.issuerAndSerial.serialNumber",tagClass:i.Class.UNIVERSAL,type:i.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"RecipientInfo.keyEncryptionAlgorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.keyEncryptionAlgorithm.algorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"RecipientInfo.keyEncryptionAlgorithm.parameter",tagClass:i.Class.UNIVERSAL,constructed:!1,captureAsn1:"encParameter",optional:!0}]},{name:"RecipientInfo.encryptedKey",tagClass:i.Class.UNIVERSAL,type:i.Type.OCTETSTRING,constructed:!1,capture:"encKey"}]}},1965:(De,J,M)=>{var s=M(8659);M(7791),M(6078),M(2158),M(8604),M(7949),M(562),M(7256),M(5517),M(4747),M(5911);var i=s.asn1,d=De.exports=s.pki=s.pki||{};d.pemToDer=function(c){var B=s.pem.decode(c)[0];if(B.procType&&"ENCRYPTED"===B.procType.type)throw new Error("Could not convert PEM to DER; PEM is encrypted.");return s.util.createBuffer(B.body)},d.privateKeyFromPem=function(c){var B=s.pem.decode(c)[0];if("PRIVATE KEY"!==B.type&&"RSA PRIVATE KEY"!==B.type){var E=new Error('Could not convert private key from PEM; PEM header type is not "PRIVATE KEY" or "RSA PRIVATE KEY".');throw E.headerType=B.type,E}if(B.procType&&"ENCRYPTED"===B.procType.type)throw new Error("Could not convert private key from PEM; PEM is encrypted.");var v=i.fromDer(B.body);return d.privateKeyFromAsn1(v)},d.privateKeyToPem=function(c,B){var E={type:"RSA PRIVATE KEY",body:i.toDer(d.privateKeyToAsn1(c)).getBytes()};return s.pem.encode(E,{maxline:B})},d.privateKeyInfoToPem=function(c,B){var E={type:"PRIVATE KEY",body:i.toDer(c).getBytes()};return s.pem.encode(E,{maxline:B})}},9709:(De,J,M)=>{var s=M(8659);M(4747),M(730),M(8365),function(){if(s.prime)De.exports=s.prime;else{var i=De.exports=s.prime=s.prime||{},d=s.jsbn.BigInteger,c=[6,4,2,4,2,4,6,2],B=new d(null);B.fromInt(30);var E=function(C,_){return C|_};i.generateProbablePrime=function(C,_,N){"function"==typeof _&&(N=_,_={});var T=(_=_||{}).algorithm||"PRIMEINC";"string"==typeof T&&(T={name:T}),T.options=T.options||{};var I=_.prng||s.random;if("PRIMEINC"===T.name)return function v(C,_,N,T){return"workers"in N?function x(C,_,N,T){if(typeof Worker>"u")return y(C,_,N,T);var I=A(C,_),p=N.workers,m=N.workLoad||100,S=30*m/8,O=N.workerScript||"forge/prime.worker.js";if(-1===p)return s.util.estimateCores(function(G,k){G&&(k=2),p=k-1,V()});function V(){p=Math.max(1,p);for(var G=[],k=0;k<p;++k)G[k]=new Worker(O);for(k=0;k<p;++k)G[k].addEventListener("message",l);var D=!1;function l(F){if(!D){var Y=F.data;if(Y.found){for(var W=0;W<G.length;++W)G[W].terminate();return D=!0,T(null,new d(Y.prime,16))}I.bitLength()>C&&(I=A(C,_));var ne=I.toString(16);F.target.postMessage({hex:ne,workLoad:m}),I.dAddOffset(S,0)}}}V()}(C,_,N,T):y(C,_,N,T)}(C,{nextBytes:function(m){for(var S=I.getBytesSync(m.length),O=0;O<m.length;++O)m[O]=S.charCodeAt(O)}},T.options,N);throw new Error("Invalid prime generation algorithm: "+T.name)}}function y(C,_,N,T){var I=A(C,_),m=function H(C){return C<=100?27:C<=150?18:C<=200?15:C<=250?12:C<=300?9:C<=350?8:C<=400?7:C<=500?6:C<=600?5:C<=800?4:C<=1250?3:2}(I.bitLength());"millerRabinTests"in N&&(m=N.millerRabinTests);var S=10;"maxBlockTime"in N&&(S=N.maxBlockTime),h(I,C,_,0,m,S,T)}function h(C,_,N,T,I,p,m){var S=+new Date;do{if(C.bitLength()>_&&(C=A(_,N)),C.isProbablePrime(I))return m(null,C);C.dAddOffset(c[T++%8],0)}while(p<0||+new Date-S<p);s.util.setImmediate(function(){h(C,_,N,T,I,p,m)})}function A(C,_){var N=new d(C,_),T=C-1;return N.testBit(T)||N.bitwiseTo(d.ONE.shiftLeft(T),E,N),N.dAddOffset(31-N.mod(B).byteValue(),0),N}}()},4473:(De,J,M)=>{var s=M(8659);M(4747);var i=null;s.util.isNodejs&&!s.options.usePureJavaScript&&!process.versions["node-webkit"]&&(i=M(5819)),(De.exports=s.prng=s.prng||{}).create=function(c){for(var B={plugin:c,key:null,seed:null,time:null,reseeds:0,generated:0,keyBytes:""},E=c.md,v=new Array(32),y=0;y<32;++y)v[y]=E.create();function x(){if(B.pools[0].messageLength>=32)return A();B.collect(B.seedFileSync(32-B.pools[0].messageLength<<5)),A()}function A(){B.reseeds=4294967295===B.reseeds?0:B.reseeds+1;var C=B.plugin.md.create();C.update(B.keyBytes);for(var _=1,N=0;N<32;++N)B.reseeds%_==0&&(C.update(B.pools[N].digest().getBytes()),B.pools[N].start()),_<<=1;B.keyBytes=C.digest().getBytes(),C.start(),C.update(B.keyBytes);var T=C.digest().getBytes();B.key=B.plugin.formatKey(B.keyBytes),B.seed=B.plugin.formatSeed(T),B.generated=0}function H(C){var _=null,N=s.util.globalScope,T=N.crypto||N.msCrypto;T&&T.getRandomValues&&(_=function(P){return T.getRandomValues(P)});var I=s.util.createBuffer();if(_)for(;I.length()<C;){var p=Math.max(1,Math.min(C-I.length(),65536)/4),m=new Uint32Array(Math.floor(p));try{_(m);for(var S=0;S<m.length;++S)I.putInt32(m[S])}catch(P){if(!(typeof QuotaExceededError<"u"&&P instanceof QuotaExceededError))throw P}}if(I.length()<C)for(var O,V,G,k=Math.floor(65536*Math.random());I.length()<C;)for(V=16807*(65535&k),V+=(32767&(O=16807*(k>>16)))<<16,k=4294967295&(V=(2147483647&(V+=O>>15))+(V>>31)),S=0;S<3;++S)G=k>>>(S<<3),G^=Math.floor(256*Math.random()),I.putByte(255&G);return I.getBytes(C)}return B.pools=v,B.pool=0,B.generate=function(C,_){if(!_)return B.generateSync(C);var N=B.plugin.cipher,T=B.plugin.increment,I=B.plugin.formatKey,p=B.plugin.formatSeed,m=s.util.createBuffer();B.key=null,function S(O){if(O)return _(O);if(m.length()>=C)return _(null,m.getBytes(C));if(B.generated>1048575&&(B.key=null),null===B.key)return s.util.nextTick(function(){!function h(C){if(B.pools[0].messageLength>=32)return A(),C();B.seedFile(32-B.pools[0].messageLength<<5,function(N,T){if(N)return C(N);B.collect(T),A(),C()})}(S)});var V=N(B.key,B.seed);B.generated+=V.length,m.putBytes(V),B.key=I(N(B.key,T(B.seed))),B.seed=p(N(B.key,B.seed)),s.util.setImmediate(S)}()},B.generateSync=function(C){var _=B.plugin.cipher,N=B.plugin.increment,T=B.plugin.formatKey,I=B.plugin.formatSeed;B.key=null;for(var p=s.util.createBuffer();p.length()<C;){B.generated>1048575&&(B.key=null),null===B.key&&x();var m=_(B.key,B.seed);B.generated+=m.length,p.putBytes(m),B.key=T(_(B.key,N(B.seed))),B.seed=I(_(B.key,B.seed))}return p.getBytes(C)},i?(B.seedFile=function(C,_){i.randomBytes(C,function(N,T){if(N)return _(N);_(null,T.toString())})},B.seedFileSync=function(C){return i.randomBytes(C).toString()}):(B.seedFile=function(C,_){try{_(null,H(C))}catch(N){_(N)}},B.seedFileSync=H),B.collect=function(C){for(var _=C.length,N=0;N<_;++N)B.pools[B.pool].update(C.substr(N,1)),B.pool=31===B.pool?0:B.pool+1},B.collectInt=function(C,_){for(var N="",T=0;T<_;T+=8)N+=String.fromCharCode(C>>T&255);B.collect(N)},B.registerWorker=function(C){C===self?B.seedFile=function(N,T){self.addEventListener("message",function I(p){var m=p.data;m.forge&&m.forge.prng&&(self.removeEventListener("message",I),T(m.forge.prng.err,m.forge.prng.bytes))}),self.postMessage({forge:{prng:{needed:N}}})}:C.addEventListener("message",function(N){var T=N.data;T.forge&&T.forge.prng&&B.seedFile(T.forge.prng.needed,function(I,p){C.postMessage({forge:{prng:{err:I,bytes:p}}})})})},B}},7256:(De,J,M)=>{var s=M(8659);M(8365),M(4747),(De.exports=s.pss=s.pss||{}).create=function(d){3===arguments.length&&(d={md:arguments[0],mgf:arguments[1],saltLength:arguments[2]});var y,c=d.md,B=d.mgf,E=c.digestLength,v=d.salt||null;if("string"==typeof v&&(v=s.util.createBuffer(v)),"saltLength"in d)y=d.saltLength;else{if(null===v)throw new Error("Salt length not specified or specific salt not given.");y=v.length()}if(null!==v&&v.length()!==y)throw new Error("Given salt length does not match length of given salt.");var h=d.prng||s.random,x={encode:function(A,H){var C,I,_=H-1,N=Math.ceil(_/8),T=A.digest().getBytes();if(N<E+y+2)throw new Error("Message is too long to encrypt.");I=null===v?h.getBytesSync(y):v.bytes();var p=new s.util.ByteBuffer;p.fillWithByte(0,8),p.putBytes(T),p.putBytes(I),c.start(),c.update(p.getBytes());var m=c.digest().getBytes(),S=new s.util.ByteBuffer;S.fillWithByte(0,N-y-E-2),S.putByte(1),S.putBytes(I);var O=S.getBytes(),V=N-E-1,G=B.generate(m,V),k="";for(C=0;C<V;C++)k+=String.fromCharCode(O.charCodeAt(C)^G.charCodeAt(C));var P=65280>>8*N-_&255;return(k=String.fromCharCode(k.charCodeAt(0)&~P)+k.substr(1))+m+String.fromCharCode(188)},verify:function(A,H,C){var _,N=C-1,T=Math.ceil(N/8);if(H=H.substr(-T),T<E+y+2)throw new Error("Inconsistent parameters to PSS signature verification.");if(188!==H.charCodeAt(T-1))throw new Error("Encoded message does not end in 0xBC.");var I=T-E-1,p=H.substr(0,I),m=H.substr(I,E),S=65280>>8*T-N&255;if(0!=(p.charCodeAt(0)&S))throw new Error("Bits beyond keysize not zero as expected.");var O=B.generate(m,I),V="";for(_=0;_<I;_++)V+=String.fromCharCode(p.charCodeAt(_)^O.charCodeAt(_));V=String.fromCharCode(V.charCodeAt(0)&~S)+V.substr(1);var G=T-E-y-2;for(_=0;_<G;_++)if(0!==V.charCodeAt(_))throw new Error("Leftmost octets not zero as expected");if(1!==V.charCodeAt(G))throw new Error("Inconsistent PSS signature, 0x01 marker not found");var k=V.substr(-y),P=new s.util.ByteBuffer;return P.fillWithByte(0,8),P.putBytes(A),P.putBytes(k),c.start(),c.update(P.getBytes()),m===c.digest().getBytes()}};return x}},8365:(De,J,M)=>{var s=M(8659);M(1298),M(1594),M(4473),M(4747),s.random&&s.random.getBytes?De.exports=s.random:function(i){var d={},c=new Array(4),B=s.util.createBuffer();function E(){var C=s.prng.create(d);return C.getBytes=function(_,N){return C.generate(_,N)},C.getBytesSync=function(_){return C.generate(_)},C}d.formatKey=function(C){var _=s.util.createBuffer(C);return(C=new Array(4))[0]=_.getInt32(),C[1]=_.getInt32(),C[2]=_.getInt32(),C[3]=_.getInt32(),s.aes._expandKey(C,!1)},d.formatSeed=function(C){var _=s.util.createBuffer(C);return(C=new Array(4))[0]=_.getInt32(),C[1]=_.getInt32(),C[2]=_.getInt32(),C[3]=_.getInt32(),C},d.cipher=function(C,_){return s.aes._updateBlock(C,_,c,!1),B.putInt32(c[0]),B.putInt32(c[1]),B.putInt32(c[2]),B.putInt32(c[3]),B.getBytes()},d.increment=function(C){return++C[3],C},d.md=s.md.sha256;var v=E(),y=null,h=s.util.globalScope,x=h.crypto||h.msCrypto;if(x&&x.getRandomValues&&(y=function(C){return x.getRandomValues(C)}),s.options.usePureJavaScript||!s.util.isNodejs&&!y){if(typeof window>"u"||window,v.collectInt(+new Date,32),typeof navigator<"u"){var A="";for(var H in navigator)try{"string"==typeof navigator[H]&&(A+=navigator[H])}catch{}v.collect(A),A=null}i&&(i().mousemove(function(C){v.collectInt(C.clientX,16),v.collectInt(C.clientY,16)}),i().keypress(function(C){v.collectInt(C.charCode,8)}))}if(s.random)for(var H in v)s.random[H]=v[H];else s.random=v;s.random.createInstance=E,De.exports=s.random}(typeof jQuery<"u"?jQuery:null)},209:(De,J,M)=>{var s=M(8659);M(4747);var i=[217,120,249,196,25,221,181,237,40,233,253,121,74,160,216,157,198,126,55,131,43,118,83,142,98,76,100,136,68,139,251,162,23,154,89,245,135,179,79,19,97,69,109,141,9,129,125,50,189,143,64,235,134,183,123,11,240,149,33,34,92,107,78,130,84,214,101,147,206,96,178,28,115,86,192,20,167,140,241,220,18,117,202,31,59,190,228,209,66,61,212,48,163,60,182,38,111,191,14,218,70,105,7,87,39,242,29,155,188,148,67,3,248,17,199,246,144,239,62,231,6,195,213,47,200,102,30,215,8,232,234,222,128,82,238,247,132,170,114,172,53,77,106,42,150,26,210,113,90,21,73,116,75,159,208,94,4,24,164,236,194,224,65,110,15,81,203,204,36,145,175,80,161,244,112,57,153,124,58,133,35,184,180,122,252,2,54,91,37,85,151,49,45,93,250,152,227,138,146,174,5,223,41,16,103,108,186,201,211,0,230,207,225,158,168,44,99,22,1,63,88,226,137,169,13,56,52,27,171,51,255,176,187,72,12,95,185,177,205,46,197,243,219,71,229,165,156,119,10,166,32,104,254,127,193,173],d=[1,2,3,5],c=function(v,y){return v<<y&65535|(65535&v)>>16-y},B=function(v,y){return(65535&v)>>y|v<<16-y&65535};De.exports=s.rc2=s.rc2||{},s.rc2.expandKey=function(v,y){"string"==typeof v&&(v=s.util.createBuffer(v)),y=y||128;var _,h=v,x=v.length(),A=y,H=Math.ceil(A/8),C=255>>(7&A);for(_=x;_<128;_++)h.putByte(i[h.at(_-1)+h.at(_-x)&255]);for(h.setAt(128-H,i[h.at(128-H)&C]),_=127-H;_>=0;_--)h.setAt(_,i[h.at(_+1)^h.at(_+H)]);return h};var E=function(v,y,h){var _,N,T,I,x=!1,A=null,H=null,C=null,p=[];for(v=s.rc2.expandKey(v,y),T=0;T<64;T++)p.push(v.getInt16Le());h?(_=function(O){for(T=0;T<4;T++)O[T]+=p[I]+(O[(T+3)%4]&O[(T+2)%4])+(~O[(T+3)%4]&O[(T+1)%4]),O[T]=c(O[T],d[T]),I++},N=function(O){for(T=0;T<4;T++)O[T]+=p[63&O[(T+3)%4]]}):(_=function(O){for(T=3;T>=0;T--)O[T]=B(O[T],d[T]),O[T]-=p[I]+(O[(T+3)%4]&O[(T+2)%4])+(~O[(T+3)%4]&O[(T+1)%4]),I--},N=function(O){for(T=3;T>=0;T--)O[T]-=p[63&O[(T+3)%4]]});var m=function(O){var V=[];for(T=0;T<4;T++){var G=A.getInt16Le();null!==C&&(h?G^=C.getInt16Le():C.putInt16Le(G)),V.push(65535&G)}I=h?0:63;for(var k=0;k<O.length;k++)for(var P=0;P<O[k][0];P++)O[k][1](V);for(T=0;T<4;T++)null!==C&&(h?C.putInt16Le(V[T]):V[T]^=C.getInt16Le()),H.putInt16Le(V[T])},S=null;return S={start:function(O,V){O&&"string"==typeof O&&(O=s.util.createBuffer(O)),x=!1,A=s.util.createBuffer(),H=V||new s.util.createBuffer,C=O,S.output=H},update:function(O){for(x||A.putBuffer(O);A.length()>=8;)m([[5,_],[1,N],[6,_],[1,N],[5,_]])},finish:function(O){var V=!0;if(h)if(O)V=O(8,A,!h);else{var G=8===A.length()?8:8-A.length();A.fillWithByte(G,G)}if(V&&(x=!0,S.update()),!h&&(V=0===A.length()))if(O)V=O(8,H,!h);else{var k=H.length(),P=H.at(k-1);P>k?V=!1:H.truncate(P)}return V}}};s.rc2.startEncrypting=function(v,y,h){var x=s.rc2.createEncryptionCipher(v,128);return x.start(y,h),x},s.rc2.createEncryptionCipher=function(v,y){return E(v,y,!0)},s.rc2.startDecrypting=function(v,y,h){var x=s.rc2.createDecryptionCipher(v,128);return x.start(y,h),x},s.rc2.createDecryptionCipher=function(v,y){return E(v,y,!1)}},5517:(De,J,M)=>{var s=M(8659);if(M(7791),M(730),M(6078),M(7246),M(9709),M(8365),M(4747),typeof i>"u")var i=s.jsbn.BigInteger;var d=s.util.isNodejs?M(5819):null,c=s.asn1,B=s.util;s.pki=s.pki||{},De.exports=s.pki.rsa=s.rsa=s.rsa||{};var E=s.pki,v=[6,4,2,4,2,4,6,2],y={name:"PrivateKeyInfo",tagClass:c.Class.UNIVERSAL,type:c.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:c.Class.UNIVERSAL,type:c.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:c.Class.UNIVERSAL,type:c.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:c.Class.UNIVERSAL,type:c.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:c.Class.UNIVERSAL,type:c.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]},h={name:"RSAPrivateKey",tagClass:c.Class.UNIVERSAL,type:c.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPrivateKey.version",tagClass:c.Class.UNIVERSAL,type:c.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"RSAPrivateKey.modulus",tagClass:c.Class.UNIVERSAL,type:c.Type.INTEGER,constructed:!1,capture:"privateKeyModulus"},{name:"RSAPrivateKey.publicExponent",tagClass:c.Class.UNIVERSAL,type:c.Type.INTEGER,constructed:!1,capture:"privateKeyPublicExponent"},{name:"RSAPrivateKey.privateExponent",tagClass:c.Class.UNIVERSAL,type:c.Type.INTEGER,constructed:!1,capture:"privateKeyPrivateExponent"},{name:"RSAPrivateKey.prime1",tagClass:c.Class.UNIVERSAL,type:c.Type.INTEGER,constructed:!1,capture:"privateKeyPrime1"},{name:"RSAPrivateKey.prime2",tagClass:c.Class.UNIVERSAL,type:c.Type.INTEGER,constructed:!1,capture:"privateKeyPrime2"},{name:"RSAPrivateKey.exponent1",tagClass:c.Class.UNIVERSAL,type:c.Type.INTEGER,constructed:!1,capture:"privateKeyExponent1"},{name:"RSAPrivateKey.exponent2",tagClass:c.Class.UNIVERSAL,type:c.Type.INTEGER,constructed:!1,capture:"privateKeyExponent2"},{name:"RSAPrivateKey.coefficient",tagClass:c.Class.UNIVERSAL,type:c.Type.INTEGER,constructed:!1,capture:"privateKeyCoefficient"}]},x={name:"RSAPublicKey",tagClass:c.Class.UNIVERSAL,type:c.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPublicKey.modulus",tagClass:c.Class.UNIVERSAL,type:c.Type.INTEGER,constructed:!1,capture:"publicKeyModulus"},{name:"RSAPublicKey.exponent",tagClass:c.Class.UNIVERSAL,type:c.Type.INTEGER,constructed:!1,capture:"publicKeyExponent"}]},A=s.pki.rsa.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:c.Class.UNIVERSAL,type:c.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:c.Class.UNIVERSAL,type:c.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:c.Class.UNIVERSAL,type:c.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{name:"SubjectPublicKeyInfo.subjectPublicKey",tagClass:c.Class.UNIVERSAL,type:c.Type.BITSTRING,constructed:!1,value:[{name:"SubjectPublicKeyInfo.subjectPublicKey.RSAPublicKey",tagClass:c.Class.UNIVERSAL,type:c.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"rsaPublicKey"}]}]},H={name:"DigestInfo",tagClass:c.Class.UNIVERSAL,type:c.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm",tagClass:c.Class.UNIVERSAL,type:c.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm.algorithmIdentifier",tagClass:c.Class.UNIVERSAL,type:c.Type.OID,constructed:!1,capture:"algorithmIdentifier"},{name:"DigestInfo.DigestAlgorithm.parameters",tagClass:c.Class.UNIVERSAL,type:c.Type.NULL,capture:"parameters",optional:!0,constructed:!1}]},{name:"DigestInfo.digest",tagClass:c.Class.UNIVERSAL,type:c.Type.OCTETSTRING,constructed:!1,capture:"digest"}]},C=function(l){if(!(l.algorithm in E.oids)){var Y=new Error("Unknown message digest algorithm.");throw Y.algorithm=l.algorithm,Y}var W=c.oidToDer(E.oids[l.algorithm]).getBytes(),ne=c.create(c.Class.UNIVERSAL,c.Type.SEQUENCE,!0,[]),de=c.create(c.Class.UNIVERSAL,c.Type.SEQUENCE,!0,[]);de.value.push(c.create(c.Class.UNIVERSAL,c.Type.OID,!1,W)),de.value.push(c.create(c.Class.UNIVERSAL,c.Type.NULL,!1,""));var Ae=c.create(c.Class.UNIVERSAL,c.Type.OCTETSTRING,!1,l.digest().getBytes());return ne.value.push(de),ne.value.push(Ae),c.toDer(ne).getBytes()},_=function(l,F,Y){if(Y)return l.modPow(F.e,F.n);if(!F.p||!F.q)return l.modPow(F.d,F.n);var W;F.dP||(F.dP=F.d.mod(F.p.subtract(i.ONE))),F.dQ||(F.dQ=F.d.mod(F.q.subtract(i.ONE))),F.qInv||(F.qInv=F.q.modInverse(F.p));do{W=new i(s.util.bytesToHex(s.random.getBytes(F.n.bitLength()/8)),16)}while(W.compareTo(F.n)>=0||!W.gcd(F.n).equals(i.ONE));for(var ne=(l=l.multiply(W.modPow(F.e,F.n)).mod(F.n)).mod(F.p).modPow(F.dP,F.p),de=l.mod(F.q).modPow(F.dQ,F.q);ne.compareTo(de)<0;)ne=ne.add(F.p);var Ae=ne.subtract(de).multiply(F.qInv).mod(F.p).multiply(F.q).add(de);return Ae.multiply(W.modInverse(F.n)).mod(F.n)};function N(l,F,Y){var W=s.util.createBuffer(),ne=Math.ceil(F.n.bitLength()/8);if(l.length>ne-11){var de=new Error("Message is too long for PKCS#1 v1.5 padding.");throw de.length=l.length,de.max=ne-11,de}W.putByte(0),W.putByte(Y);var Re,Ae=ne-3-l.length;if(0===Y||1===Y){Re=0===Y?0:255;for(var Fe=0;Fe<Ae;++Fe)W.putByte(Re)}else for(;Ae>0;){var be=0,Pe=s.random.getBytes(Ae);for(Fe=0;Fe<Ae;++Fe)0===(Re=Pe.charCodeAt(Fe))?++be:W.putByte(Re);Ae=be}return W.putByte(0),W.putBytes(l),W}function T(l,F,Y,W){var ne=Math.ceil(F.n.bitLength()/8),de=s.util.createBuffer(l),Ae=de.getByte(),Re=de.getByte();if(0!==Ae||Y&&0!==Re&&1!==Re||!Y&&2!=Re||Y&&0===Re&&typeof W>"u")throw new Error("Encryption block is invalid.");var Fe=0;if(0===Re){Fe=ne-3-W;for(var be=0;be<Fe;++be)if(0!==de.getByte())throw new Error("Encryption block is invalid.")}else if(1===Re)for(Fe=0;de.length()>1;){if(255!==de.getByte()){--de.read;break}++Fe}else if(2===Re)for(Fe=0;de.length()>1;){if(0===de.getByte()){--de.read;break}++Fe}if(0!==de.getByte()||Fe!==ne-3-de.length())throw new Error("Encryption block is invalid.");return de.getBytes()}function I(l,F,Y){"function"==typeof F&&(Y=F,F={});var W={algorithm:{name:(F=F||{}).algorithm||"PRIMEINC",options:{workers:F.workers||2,workLoad:F.workLoad||100,workerScript:F.workerScript}}};function ne(){de(l.pBits,function(Re,Fe){return Re?Y(Re):(l.p=Fe,null!==l.q?Ae(Re,l.q):void de(l.qBits,Ae))})}function de(Re,Fe){s.prime.generateProbablePrime(Re,W,Fe)}function Ae(Re,Fe){if(Re)return Y(Re);if(l.q=Fe,l.p.compareTo(l.q)<0){var be=l.p;l.p=l.q,l.q=be}if(0!==l.p.subtract(i.ONE).gcd(l.e).compareTo(i.ONE))return l.p=null,void ne();if(0!==l.q.subtract(i.ONE).gcd(l.e).compareTo(i.ONE))return l.q=null,void de(l.qBits,Ae);if(l.p1=l.p.subtract(i.ONE),l.q1=l.q.subtract(i.ONE),l.phi=l.p1.multiply(l.q1),0!==l.phi.gcd(l.e).compareTo(i.ONE))return l.p=l.q=null,void ne();if(l.n=l.p.multiply(l.q),l.n.bitLength()!==l.bits)return l.q=null,void de(l.qBits,Ae);var Pe=l.e.modInverse(l.phi);l.keys={privateKey:E.rsa.setPrivateKey(l.n,l.e,Pe,l.p,l.q,Pe.mod(l.p1),Pe.mod(l.q1),l.q.modInverse(l.p)),publicKey:E.rsa.setPublicKey(l.n,l.e)},Y(null,l.keys)}"prng"in F&&(W.prng=F.prng),ne()}function p(l){var F=l.toString(16);F[0]>="8"&&(F="00"+F);var Y=s.util.hexToBytes(F);return Y.length>1&&(0===Y.charCodeAt(0)&&0==(128&Y.charCodeAt(1))||255===Y.charCodeAt(0)&&128==(128&Y.charCodeAt(1)))?Y.substr(1):Y}function m(l){return l<=100?27:l<=150?18:l<=200?15:l<=250?12:l<=300?9:l<=350?8:l<=400?7:l<=500?6:l<=600?5:l<=800?4:l<=1250?3:2}function S(l){return s.util.isNodejs&&"function"==typeof d[l]}function O(l){return typeof B.globalScope<"u"&&"object"==typeof B.globalScope.crypto&&"object"==typeof B.globalScope.crypto.subtle&&"function"==typeof B.globalScope.crypto.subtle[l]}function V(l){return typeof B.globalScope<"u"&&"object"==typeof B.globalScope.msCrypto&&"object"==typeof B.globalScope.msCrypto.subtle&&"function"==typeof B.globalScope.msCrypto.subtle[l]}function G(l){for(var F=s.util.hexToBytes(l.toString(16)),Y=new Uint8Array(F.length),W=0;W<F.length;++W)Y[W]=F.charCodeAt(W);return Y}E.rsa.encrypt=function(l,F,Y){var ne,W=Y,de=Math.ceil(F.n.bitLength()/8);!1!==Y&&!0!==Y?(W=2===Y,ne=N(l,F,Y)):(ne=s.util.createBuffer()).putBytes(l);for(var Ae=new i(ne.toHex(),16),Fe=_(Ae,F,W).toString(16),be=s.util.createBuffer(),Pe=de-Math.ceil(Fe.length/2);Pe>0;)be.putByte(0),--Pe;return be.putBytes(s.util.hexToBytes(Fe)),be.getBytes()},E.rsa.decrypt=function(l,F,Y,W){var ne=Math.ceil(F.n.bitLength()/8);if(l.length!==ne){var de=new Error("Encrypted message length is invalid.");throw de.length=l.length,de.expected=ne,de}var Ae=new i(s.util.createBuffer(l).toHex(),16);if(Ae.compareTo(F.n)>=0)throw new Error("Encrypted message is invalid.");for(var Fe=_(Ae,F,Y).toString(16),be=s.util.createBuffer(),Pe=ne-Math.ceil(Fe.length/2);Pe>0;)be.putByte(0),--Pe;return be.putBytes(s.util.hexToBytes(Fe)),!1!==W?T(be.getBytes(),F,Y):be.getBytes()},E.rsa.createKeyPairGenerationState=function(l,F,Y){"string"==typeof l&&(l=parseInt(l,10)),l=l||2048;var Ae,W=(Y=Y||{}).prng||s.random,ne={nextBytes:function(Re){for(var Fe=W.getBytesSync(Re.length),be=0;be<Re.length;++be)Re[be]=Fe.charCodeAt(be)}},de=Y.algorithm||"PRIMEINC";if("PRIMEINC"!==de)throw new Error("Invalid key generation algorithm: "+de);return(Ae={algorithm:de,state:0,bits:l,rng:ne,eInt:F||65537,e:new i(null),p:null,q:null,qBits:l>>1,pBits:l-(l>>1),pqState:0,num:null,keys:null}).e.fromInt(Ae.eInt),Ae},E.rsa.stepKeyPairGenerationState=function(l,F){"algorithm"in l||(l.algorithm="PRIMEINC");var Y=new i(null);Y.fromInt(30);for(var Ae,W=0,ne=function(We,Ze){return We|Ze},de=+new Date,Re=0;null===l.keys&&(F<=0||Re<F);){if(0===l.state){var Fe=null===l.p?l.pBits:l.qBits,be=Fe-1;0===l.pqState?(l.num=new i(Fe,l.rng),l.num.testBit(be)||l.num.bitwiseTo(i.ONE.shiftLeft(be),ne,l.num),l.num.dAddOffset(31-l.num.mod(Y).byteValue(),0),W=0,++l.pqState):1===l.pqState?l.num.bitLength()>Fe?l.pqState=0:l.num.isProbablePrime(m(l.num.bitLength()))?++l.pqState:l.num.dAddOffset(v[W++%8],0):2===l.pqState?l.pqState=0===l.num.subtract(i.ONE).gcd(l.e).compareTo(i.ONE)?3:0:3===l.pqState&&(l.pqState=0,null===l.p?l.p=l.num:l.q=l.num,null!==l.p&&null!==l.q&&++l.state,l.num=null)}else if(1===l.state)l.p.compareTo(l.q)<0&&(l.num=l.p,l.p=l.q,l.q=l.num),++l.state;else if(2===l.state)l.p1=l.p.subtract(i.ONE),l.q1=l.q.subtract(i.ONE),l.phi=l.p1.multiply(l.q1),++l.state;else if(3===l.state)0===l.phi.gcd(l.e).compareTo(i.ONE)?++l.state:(l.p=null,l.q=null,l.state=0);else if(4===l.state)l.n=l.p.multiply(l.q),l.n.bitLength()===l.bits?++l.state:(l.q=null,l.state=0);else if(5===l.state){var Pe=l.e.modInverse(l.phi);l.keys={privateKey:E.rsa.setPrivateKey(l.n,l.e,Pe,l.p,l.q,Pe.mod(l.p1),Pe.mod(l.q1),l.q.modInverse(l.p)),publicKey:E.rsa.setPublicKey(l.n,l.e)}}Re+=(Ae=+new Date)-de,de=Ae}return null!==l.keys},E.rsa.generateKeyPair=function(l,F,Y,W){if(1===arguments.length?"object"==typeof l?(Y=l,l=void 0):"function"==typeof l&&(W=l,l=void 0):2===arguments.length?"number"==typeof l?"function"==typeof F?(W=F,F=void 0):"number"!=typeof F&&(Y=F,F=void 0):(Y=l,W=F,l=void 0,F=void 0):3===arguments.length&&("number"==typeof F?"function"==typeof Y&&(W=Y,Y=void 0):(W=Y,Y=F,F=void 0)),Y=Y||{},void 0===l&&(l=Y.bits||2048),void 0===F&&(F=Y.e||65537),!s.options.usePureJavaScript&&!Y.prng&&l>=256&&l<=16384&&(65537===F||3===F))if(W){if(S("generateKeyPair"))return d.generateKeyPair("rsa",{modulusLength:l,publicExponent:F,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}},function(Re,Fe,be){if(Re)return W(Re);W(null,{privateKey:E.privateKeyFromPem(be),publicKey:E.publicKeyFromPem(Fe)})});if(O("generateKey")&&O("exportKey"))return B.globalScope.crypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:l,publicExponent:G(F),hash:{name:"SHA-256"}},!0,["sign","verify"]).then(function(Re){return B.globalScope.crypto.subtle.exportKey("pkcs8",Re.privateKey)}).then(void 0,function(Re){W(Re)}).then(function(Re){if(Re){var Fe=E.privateKeyFromAsn1(c.fromDer(s.util.createBuffer(Re)));W(null,{privateKey:Fe,publicKey:E.setRsaPublicKey(Fe.n,Fe.e)})}});if(V("generateKey")&&V("exportKey")){var ne=B.globalScope.msCrypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:l,publicExponent:G(F),hash:{name:"SHA-256"}},!0,["sign","verify"]);return ne.oncomplete=function(Re){var be=B.globalScope.msCrypto.subtle.exportKey("pkcs8",Re.target.result.privateKey);be.oncomplete=function(Pe){var Ze=E.privateKeyFromAsn1(c.fromDer(s.util.createBuffer(Pe.target.result)));W(null,{privateKey:Ze,publicKey:E.setRsaPublicKey(Ze.n,Ze.e)})},be.onerror=function(Pe){W(Pe)}},void(ne.onerror=function(Re){W(Re)})}}else if(S("generateKeyPairSync")){var de=d.generateKeyPairSync("rsa",{modulusLength:l,publicExponent:F,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}});return{privateKey:E.privateKeyFromPem(de.privateKey),publicKey:E.publicKeyFromPem(de.publicKey)}}var Ae=E.rsa.createKeyPairGenerationState(l,F,Y);if(!W)return E.rsa.stepKeyPairGenerationState(Ae,0),Ae.keys;I(Ae,Y,W)},E.setRsaPublicKey=E.rsa.setPublicKey=function(l,F){var Y={n:l,e:F,encrypt:function(W,ne,de){if("string"==typeof ne?ne=ne.toUpperCase():void 0===ne&&(ne="RSAES-PKCS1-V1_5"),"RSAES-PKCS1-V1_5"===ne)ne={encode:function(Re,Fe,be){return N(Re,Fe,2).getBytes()}};else if("RSA-OAEP"===ne||"RSAES-OAEP"===ne)ne={encode:function(Re,Fe){return s.pkcs1.encode_rsa_oaep(Fe,Re,de)}};else if(-1!==["RAW","NONE","NULL",null].indexOf(ne))ne={encode:function(Re){return Re}};else if("string"==typeof ne)throw new Error('Unsupported encryption scheme: "'+ne+'".');var Ae=ne.encode(W,Y,!0);return E.rsa.encrypt(Ae,Y,!0)},verify:function(W,ne,de,Ae){"string"==typeof de?de=de.toUpperCase():void 0===de&&(de="RSASSA-PKCS1-V1_5"),void 0===Ae&&(Ae={_parseAllDigestBytes:!0}),"_parseAllDigestBytes"in Ae||(Ae._parseAllDigestBytes=!0),"RSASSA-PKCS1-V1_5"===de?de={verify:function(Fe,be){be=T(be,Y,!0);var Pe=c.fromDer(be,{parseAllBytes:Ae._parseAllDigestBytes}),We={},Ze=[];if(!c.validate(Pe,H,We,Ze))throw(Ct=new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value.")).errors=Ze,Ct;var Ct,tt=c.derToOid(We.algorithmIdentifier);if(tt!==s.oids.md2&&tt!==s.oids.md5&&tt!==s.oids.sha1&&tt!==s.oids.sha224&&tt!==s.oids.sha256&&tt!==s.oids.sha384&&tt!==s.oids.sha512&&tt!==s.oids["sha512-224"]&&tt!==s.oids["sha512-256"])throw(Ct=new Error("Unknown RSASSA-PKCS1-v1_5 DigestAlgorithm identifier.")).oid=tt,Ct;if((tt===s.oids.md2||tt===s.oids.md5)&&!("parameters"in We))throw new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value. Missing algorithm identifer NULL parameters.");return Fe===We.digest}}:("NONE"===de||"NULL"===de||null===de)&&(de={verify:function(Fe,be){return Fe===T(be,Y,!0)}});var Re=E.rsa.decrypt(ne,Y,!0,!1);return de.verify(W,Re,Y.n.bitLength())}};return Y},E.setRsaPrivateKey=E.rsa.setPrivateKey=function(l,F,Y,W,ne,de,Ae,Re){var Fe={n:l,e:F,d:Y,p:W,q:ne,dP:de,dQ:Ae,qInv:Re,decrypt:function(be,Pe,We){"string"==typeof Pe?Pe=Pe.toUpperCase():void 0===Pe&&(Pe="RSAES-PKCS1-V1_5");var Ze=E.rsa.decrypt(be,Fe,!1,!1);if("RSAES-PKCS1-V1_5"===Pe)Pe={decode:T};else if("RSA-OAEP"===Pe||"RSAES-OAEP"===Pe)Pe={decode:function(Ct,tt){return s.pkcs1.decode_rsa_oaep(tt,Ct,We)}};else{if(-1===["RAW","NONE","NULL",null].indexOf(Pe))throw new Error('Unsupported encryption scheme: "'+Pe+'".');Pe={decode:function(Ct){return Ct}}}return Pe.decode(Ze,Fe,!1)},sign:function(be,Pe){var We=!1;"string"==typeof Pe&&(Pe=Pe.toUpperCase()),void 0===Pe||"RSASSA-PKCS1-V1_5"===Pe?(Pe={encode:C},We=1):("NONE"===Pe||"NULL"===Pe||null===Pe)&&(Pe={encode:function(){return be}},We=1);var Ze=Pe.encode(be,Fe.n.bitLength());return E.rsa.encrypt(Ze,Fe,We)}};return Fe},E.wrapRsaPrivateKey=function(l){return c.create(c.Class.UNIVERSAL,c.Type.SEQUENCE,!0,[c.create(c.Class.UNIVERSAL,c.Type.INTEGER,!1,c.integerToDer(0).getBytes()),c.create(c.Class.UNIVERSAL,c.Type.SEQUENCE,!0,[c.create(c.Class.UNIVERSAL,c.Type.OID,!1,c.oidToDer(E.oids.rsaEncryption).getBytes()),c.create(c.Class.UNIVERSAL,c.Type.NULL,!1,"")]),c.create(c.Class.UNIVERSAL,c.Type.OCTETSTRING,!1,c.toDer(l).getBytes())])},E.privateKeyFromAsn1=function(l){var ne,de,Ae,Re,Fe,be,Pe,We,F={},Y=[];if(c.validate(l,y,F,Y)&&(l=c.fromDer(s.util.createBuffer(F.privateKey))),!c.validate(l,h,F={},Y=[])){var W=new Error("Cannot read private key. ASN.1 object does not contain an RSAPrivateKey.");throw W.errors=Y,W}return ne=s.util.createBuffer(F.privateKeyModulus).toHex(),de=s.util.createBuffer(F.privateKeyPublicExponent).toHex(),Ae=s.util.createBuffer(F.privateKeyPrivateExponent).toHex(),Re=s.util.createBuffer(F.privateKeyPrime1).toHex(),Fe=s.util.createBuffer(F.privateKeyPrime2).toHex(),be=s.util.createBuffer(F.privateKeyExponent1).toHex(),Pe=s.util.createBuffer(F.privateKeyExponent2).toHex(),We=s.util.createBuffer(F.privateKeyCoefficient).toHex(),E.setRsaPrivateKey(new i(ne,16),new i(de,16),new i(Ae,16),new i(Re,16),new i(Fe,16),new i(be,16),new i(Pe,16),new i(We,16))},E.privateKeyToAsn1=E.privateKeyToRSAPrivateKey=function(l){return c.create(c.Class.UNIVERSAL,c.Type.SEQUENCE,!0,[c.create(c.Class.UNIVERSAL,c.Type.INTEGER,!1,c.integerToDer(0).getBytes()),c.create(c.Class.UNIVERSAL,c.Type.INTEGER,!1,p(l.n)),c.create(c.Class.UNIVERSAL,c.Type.INTEGER,!1,p(l.e)),c.create(c.Class.UNIVERSAL,c.Type.INTEGER,!1,p(l.d)),c.create(c.Class.UNIVERSAL,c.Type.INTEGER,!1,p(l.p)),c.create(c.Class.UNIVERSAL,c.Type.INTEGER,!1,p(l.q)),c.create(c.Class.UNIVERSAL,c.Type.INTEGER,!1,p(l.dP)),c.create(c.Class.UNIVERSAL,c.Type.INTEGER,!1,p(l.dQ)),c.create(c.Class.UNIVERSAL,c.Type.INTEGER,!1,p(l.qInv))])},E.publicKeyFromAsn1=function(l){var F={},Y=[];if(c.validate(l,A,F,Y)){var ne,W=c.derToOid(F.publicKeyOid);if(W!==E.oids.rsaEncryption)throw(ne=new Error("Cannot read public key. Unknown OID.")).oid=W,ne;l=F.rsaPublicKey}if(!c.validate(l,x,F,Y=[]))throw(ne=new Error("Cannot read public key. ASN.1 object does not contain an RSAPublicKey.")).errors=Y,ne;var de=s.util.createBuffer(F.publicKeyModulus).toHex(),Ae=s.util.createBuffer(F.publicKeyExponent).toHex();return E.setRsaPublicKey(new i(de,16),new i(Ae,16))},E.publicKeyToAsn1=E.publicKeyToSubjectPublicKeyInfo=function(l){return c.create(c.Class.UNIVERSAL,c.Type.SEQUENCE,!0,[c.create(c.Class.UNIVERSAL,c.Type.SEQUENCE,!0,[c.create(c.Class.UNIVERSAL,c.Type.OID,!1,c.oidToDer(E.oids.rsaEncryption).getBytes()),c.create(c.Class.UNIVERSAL,c.Type.NULL,!1,"")]),c.create(c.Class.UNIVERSAL,c.Type.BITSTRING,!1,[E.publicKeyToRSAPublicKey(l)])])},E.publicKeyToRSAPublicKey=function(l){return c.create(c.Class.UNIVERSAL,c.Type.SEQUENCE,!0,[c.create(c.Class.UNIVERSAL,c.Type.INTEGER,!1,p(l.n)),c.create(c.Class.UNIVERSAL,c.Type.INTEGER,!1,p(l.e))])}},7690:(De,J,M)=>{var s=M(8659);M(979),M(4747);var i=De.exports=s.sha1=s.sha1||{};s.md.sha1=s.md.algorithms.sha1=i,i.create=function(){c||function B(){d=String.fromCharCode(128),d+=s.util.fillString(String.fromCharCode(0),64),c=!0}();var v=null,y=s.util.createBuffer(),h=new Array(80),x={algorithm:"sha1",blockLength:64,digestLength:20,messageLength:0,fullMessageLength:null,messageLengthSize:8,start:function(){x.messageLength=0,x.fullMessageLength=x.messageLength64=[];for(var A=x.messageLengthSize/4,H=0;H<A;++H)x.fullMessageLength.push(0);return y=s.util.createBuffer(),v={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878,h4:3285377520},x}};return x.start(),x.update=function(A,H){"utf8"===H&&(A=s.util.encodeUtf8(A));var C=A.length;x.messageLength+=C,C=[C/4294967296>>>0,C>>>0];for(var _=x.fullMessageLength.length-1;_>=0;--_)x.fullMessageLength[_]+=C[1],C[1]=C[0]+(x.fullMessageLength[_]/4294967296>>>0),x.fullMessageLength[_]=x.fullMessageLength[_]>>>0,C[0]=C[1]/4294967296>>>0;return y.putBytes(A),E(v,h,y),(y.read>2048||0===y.length())&&y.compact(),x},x.digest=function(){var A=s.util.createBuffer();A.putBytes(y.bytes()),A.putBytes(d.substr(0,x.blockLength-(x.fullMessageLength[x.fullMessageLength.length-1]+x.messageLengthSize&x.blockLength-1)));for(var _,T=8*x.fullMessageLength[0],I=0;I<x.fullMessageLength.length-1;++I)A.putInt32((T+=(_=8*x.fullMessageLength[I+1])/4294967296>>>0)>>>0),T=_>>>0;A.putInt32(T);var p={h0:v.h0,h1:v.h1,h2:v.h2,h3:v.h3,h4:v.h4};E(p,h,A);var m=s.util.createBuffer();return m.putInt32(p.h0),m.putInt32(p.h1),m.putInt32(p.h2),m.putInt32(p.h3),m.putInt32(p.h4),m},x};var d=null,c=!1;function E(v,y,h){for(var x,A,H,C,_,N,I,p=h.length();p>=64;){for(A=v.h0,H=v.h1,C=v.h2,_=v.h3,N=v.h4,I=0;I<16;++I)x=h.getInt32(),y[I]=x,x=(A<<5|A>>>27)+(_^H&(C^_))+N+1518500249+x,N=_,_=C,C=(H<<30|H>>>2)>>>0,H=A,A=x;for(;I<20;++I)y[I]=x=(x=y[I-3]^y[I-8]^y[I-14]^y[I-16])<<1|x>>>31,x=(A<<5|A>>>27)+(_^H&(C^_))+N+1518500249+x,N=_,_=C,C=(H<<30|H>>>2)>>>0,H=A,A=x;for(;I<32;++I)y[I]=x=(x=y[I-3]^y[I-8]^y[I-14]^y[I-16])<<1|x>>>31,x=(A<<5|A>>>27)+(H^C^_)+N+1859775393+x,N=_,_=C,C=(H<<30|H>>>2)>>>0,H=A,A=x;for(;I<40;++I)y[I]=x=(x=y[I-6]^y[I-16]^y[I-28]^y[I-32])<<2|x>>>30,x=(A<<5|A>>>27)+(H^C^_)+N+1859775393+x,N=_,_=C,C=(H<<30|H>>>2)>>>0,H=A,A=x;for(;I<60;++I)y[I]=x=(x=y[I-6]^y[I-16]^y[I-28]^y[I-32])<<2|x>>>30,x=(A<<5|A>>>27)+(H&C|_&(H^C))+N+2400959708+x,N=_,_=C,C=(H<<30|H>>>2)>>>0,H=A,A=x;for(;I<80;++I)y[I]=x=(x=y[I-6]^y[I-16]^y[I-28]^y[I-32])<<2|x>>>30,x=(A<<5|A>>>27)+(H^C^_)+N+3395469782+x,N=_,_=C,C=(H<<30|H>>>2)>>>0,H=A,A=x;v.h0=v.h0+A|0,v.h1=v.h1+H|0,v.h2=v.h2+C|0,v.h3=v.h3+_|0,v.h4=v.h4+N|0,p-=64}}},1594:(De,J,M)=>{var s=M(8659);M(979),M(4747);var i=De.exports=s.sha256=s.sha256||{};s.md.sha256=s.md.algorithms.sha256=i,i.create=function(){c||function E(){d=String.fromCharCode(128),d+=s.util.fillString(String.fromCharCode(0),64),B=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],c=!0}();var y=null,h=s.util.createBuffer(),x=new Array(64),A={algorithm:"sha256",blockLength:64,digestLength:32,messageLength:0,fullMessageLength:null,messageLengthSize:8,start:function(){A.messageLength=0,A.fullMessageLength=A.messageLength64=[];for(var H=A.messageLengthSize/4,C=0;C<H;++C)A.fullMessageLength.push(0);return h=s.util.createBuffer(),y={h0:1779033703,h1:3144134277,h2:1013904242,h3:2773480762,h4:1359893119,h5:2600822924,h6:528734635,h7:1541459225},A}};return A.start(),A.update=function(H,C){"utf8"===C&&(H=s.util.encodeUtf8(H));var _=H.length;A.messageLength+=_,_=[_/4294967296>>>0,_>>>0];for(var N=A.fullMessageLength.length-1;N>=0;--N)A.fullMessageLength[N]+=_[1],_[1]=_[0]+(A.fullMessageLength[N]/4294967296>>>0),A.fullMessageLength[N]=A.fullMessageLength[N]>>>0,_[0]=_[1]/4294967296>>>0;return h.putBytes(H),v(y,x,h),(h.read>2048||0===h.length())&&h.compact(),A},A.digest=function(){var H=s.util.createBuffer();H.putBytes(h.bytes()),H.putBytes(d.substr(0,A.blockLength-(A.fullMessageLength[A.fullMessageLength.length-1]+A.messageLengthSize&A.blockLength-1)));for(var N,I=8*A.fullMessageLength[0],p=0;p<A.fullMessageLength.length-1;++p)H.putInt32((I+=(N=8*A.fullMessageLength[p+1])/4294967296>>>0)>>>0),I=N>>>0;H.putInt32(I);var m={h0:y.h0,h1:y.h1,h2:y.h2,h3:y.h3,h4:y.h4,h5:y.h5,h6:y.h6,h7:y.h7};v(m,x,H);var S=s.util.createBuffer();return S.putInt32(m.h0),S.putInt32(m.h1),S.putInt32(m.h2),S.putInt32(m.h3),S.putInt32(m.h4),S.putInt32(m.h5),S.putInt32(m.h6),S.putInt32(m.h7),S},A};var d=null,c=!1,B=null;function v(y,h,x){for(var A,H,T,I,p,m,S,O,V,G,k,P,D=x.length();D>=64;){for(I=0;I<16;++I)h[I]=x.getInt32();for(;I<64;++I)h[I]=(A=((A=h[I-2])>>>17|A<<15)^(A>>>19|A<<13)^A>>>10)+h[I-7]+(H=((H=h[I-15])>>>7|H<<25)^(H>>>18|H<<14)^H>>>3)+h[I-16]|0;for(p=y.h0,m=y.h1,S=y.h2,O=y.h3,V=y.h4,G=y.h5,k=y.h6,P=y.h7,I=0;I<64;++I)T=p&m|S&(p^m),A=P+((V>>>6|V<<26)^(V>>>11|V<<21)^(V>>>25|V<<7))+(k^V&(G^k))+B[I]+h[I],P=k,k=G,G=V,V=O+A>>>0,O=S,S=m,m=p,p=A+(H=((p>>>2|p<<30)^(p>>>13|p<<19)^(p>>>22|p<<10))+T)>>>0;y.h0=y.h0+p|0,y.h1=y.h1+m|0,y.h2=y.h2+S|0,y.h3=y.h3+O|0,y.h4=y.h4+V|0,y.h5=y.h5+G|0,y.h6=y.h6+k|0,y.h7=y.h7+P|0,D-=64}}},8985:(De,J,M)=>{var s=M(8659);M(979),M(4747);var i=De.exports=s.sha512=s.sha512||{};s.md.sha512=s.md.algorithms.sha512=i;var d=s.sha384=s.sha512.sha384=s.sha512.sha384||{};d.create=function(){return i.create("SHA-384")},s.md.sha384=s.md.algorithms.sha384=d,s.sha512.sha256=s.sha512.sha256||{create:function(){return i.create("SHA-512/256")}},s.md["sha512/256"]=s.md.algorithms["sha512/256"]=s.sha512.sha256,s.sha512.sha224=s.sha512.sha224||{create:function(){return i.create("SHA-512/224")}},s.md["sha512/224"]=s.md.algorithms["sha512/224"]=s.sha512.sha224,i.create=function(x){if(B||function y(){c=String.fromCharCode(128),c+=s.util.fillString(String.fromCharCode(0),128),E=[[1116352408,3609767458],[1899447441,602891725],[3049323471,3964484399],[3921009573,2173295548],[961987163,4081628472],[1508970993,3053834265],[2453635748,2937671579],[2870763221,3664609560],[3624381080,2734883394],[310598401,1164996542],[607225278,1323610764],[1426881987,3590304994],[1925078388,4068182383],[2162078206,991336113],[2614888103,633803317],[3248222580,3479774868],[3835390401,2666613458],[4022224774,944711139],[264347078,2341262773],[604807628,2007800933],[770255983,1495990901],[1249150122,1856431235],[1555081692,3175218132],[1996064986,2198950837],[2554220882,3999719339],[2821834349,766784016],[2952996808,2566594879],[3210313671,3203337956],[3336571891,1034457026],[3584528711,2466948901],[113926993,3758326383],[338241895,168717936],[666307205,1188179964],[773529912,1546045734],[1294757372,1522805485],[1396182291,2643833823],[1695183700,2343527390],[1986661051,1014477480],[2177026350,1206759142],[2456956037,344077627],[2730485921,1290863460],[2820302411,3158454273],[3259730800,3505952657],[3345764771,106217008],[3516065817,3606008344],[3600352804,1432725776],[4094571909,1467031594],[275423344,851169720],[430227734,3100823752],[506948616,1363258195],[659060556,3750685593],[883997877,3785050280],[958139571,3318307427],[1322822218,3812723403],[1537002063,2003034995],[1747873779,3602036899],[1955562222,1575990012],[2024104815,1125592928],[2227730452,2716904306],[2361852424,442776044],[2428436474,593698344],[2756734187,3733110249],[3204031479,2999351573],[3329325298,3815920427],[3391569614,3928383900],[3515267271,566280711],[3940187606,3454069534],[4118630271,4000239992],[116418474,1914138554],[174292421,2731055270],[289380356,3203993006],[460393269,320620315],[685471733,587496836],[852142971,1086792851],[1017036298,365543100],[1126000580,2618297676],[1288033470,3409855158],[1501505948,4234509866],[1607167915,987167468],[1816402316,1246189591]],(v={})["SHA-512"]=[[1779033703,4089235720],[3144134277,2227873595],[1013904242,4271175723],[2773480762,1595750129],[1359893119,2917565137],[2600822924,725511199],[528734635,4215389547],[1541459225,327033209]],v["SHA-384"]=[[3418070365,3238371032],[1654270250,914150663],[2438529370,812702999],[355462360,4144912697],[1731405415,4290775857],[2394180231,1750603025],[3675008525,1694076839],[1203062813,3204075428]],v["SHA-512/256"]=[[573645204,4230739756],[2673172387,3360449730],[596883563,1867755857],[2520282905,1497426621],[2519219938,2827943907],[3193839141,1401305490],[721525244,746961066],[246885852,2177182882]],v["SHA-512/224"]=[[2352822216,424955298],[1944164710,2312950998],[502970286,855612546],[1738396948,1479516111],[258812777,2077511080],[2011393907,79989058],[1067287976,1780299464],[286451373,2446758561]],B=!0}(),typeof x>"u"&&(x="SHA-512"),!(x in v))throw new Error("Invalid SHA-512 algorithm: "+x);for(var A=v[x],H=null,C=s.util.createBuffer(),_=new Array(80),N=0;N<80;++N)_[N]=new Array(2);var T=64;switch(x){case"SHA-384":T=48;break;case"SHA-512/256":T=32;break;case"SHA-512/224":T=28}var I={algorithm:x.replace("-","").toLowerCase(),blockLength:128,digestLength:T,messageLength:0,fullMessageLength:null,messageLengthSize:16,start:function(){I.messageLength=0,I.fullMessageLength=I.messageLength128=[];for(var p=I.messageLengthSize/4,m=0;m<p;++m)I.fullMessageLength.push(0);for(C=s.util.createBuffer(),H=new Array(A.length),m=0;m<A.length;++m)H[m]=A[m].slice(0);return I}};return I.start(),I.update=function(p,m){"utf8"===m&&(p=s.util.encodeUtf8(p));var S=p.length;I.messageLength+=S,S=[S/4294967296>>>0,S>>>0];for(var O=I.fullMessageLength.length-1;O>=0;--O)I.fullMessageLength[O]+=S[1],S[1]=S[0]+(I.fullMessageLength[O]/4294967296>>>0),I.fullMessageLength[O]=I.fullMessageLength[O]>>>0,S[0]=S[1]/4294967296>>>0;return C.putBytes(p),h(H,_,C),(C.read>2048||0===C.length())&&C.compact(),I},I.digest=function(){var p=s.util.createBuffer();p.putBytes(C.bytes()),p.putBytes(c.substr(0,I.blockLength-(I.fullMessageLength[I.fullMessageLength.length-1]+I.messageLengthSize&I.blockLength-1)));for(var O,G=8*I.fullMessageLength[0],k=0;k<I.fullMessageLength.length-1;++k)p.putInt32((G+=(O=8*I.fullMessageLength[k+1])/4294967296>>>0)>>>0),G=O>>>0;p.putInt32(G);var P=new Array(H.length);for(k=0;k<H.length;++k)P[k]=H[k].slice(0);h(P,_,p);var l,D=s.util.createBuffer();for(l="SHA-512"===x?P.length:"SHA-384"===x?P.length-2:P.length-4,k=0;k<l;++k)D.putInt32(P[k][0]),(k!==l-1||"SHA-512/224"!==x)&&D.putInt32(P[k][1]);return D},I};var c=null,B=!1,E=null,v=null;function h(x,A,H){for(var C,_,N,T,P,D,l,F,Y,W,ne,de,Ae,Re,Fe,be,Pe,We,Ze,Ct,tt,Ht,ct,jt,Rt,Le,Ge,K=H.length();K>=128;){for(tt=0;tt<16;++tt)A[tt][0]=H.getInt32()>>>0,A[tt][1]=H.getInt32()>>>0;for(;tt<80;++tt)_=(((Ht=(jt=A[tt-2])[0])<<13|(ct=jt[1])>>>19)^(ct<<3|Ht>>>29)^(Ht<<26|ct>>>6))>>>0,A[tt][0]=(C=((Ht>>>19|ct<<13)^(ct>>>29|Ht<<3)^Ht>>>6)>>>0)+(Rt=A[tt-7])[0]+(N=(((Ht=(Le=A[tt-15])[0])>>>1|(ct=Le[1])<<31)^(Ht>>>8|ct<<24)^Ht>>>7)>>>0)+(Ge=A[tt-16])[0]+((ct=_+Rt[1]+(T=((Ht<<31|ct>>>1)^(Ht<<24|ct>>>8)^(Ht<<25|ct>>>7))>>>0)+Ge[1])/4294967296>>>0)>>>0,A[tt][1]=ct>>>0;for(P=x[0][0],D=x[0][1],l=x[1][0],F=x[1][1],Y=x[2][0],W=x[2][1],ne=x[3][0],de=x[3][1],Ae=x[4][0],Re=x[4][1],Fe=x[5][0],be=x[5][1],Pe=x[6][0],We=x[6][1],Ze=x[7][0],Ct=x[7][1],tt=0;tt<80;++tt)C=Ze+(((Ae>>>14|Re<<18)^(Ae>>>18|Re<<14)^(Re>>>9|Ae<<23))>>>0)+((Pe^Ae&(Fe^Pe))>>>0)+E[tt][0]+A[tt][0]+((ct=Ct+(((Ae<<18|Re>>>14)^(Ae<<14|Re>>>18)^(Re<<23|Ae>>>9))>>>0)+((We^Re&(be^We))>>>0)+E[tt][1]+A[tt][1])/4294967296>>>0)>>>0,_=ct>>>0,N=(((P>>>28|D<<4)^(D>>>2|P<<30)^(D>>>7|P<<25))>>>0)+((P&l|Y&(P^l))>>>0)+((ct=(((P<<4|D>>>28)^(D<<30|P>>>2)^(D<<25|P>>>7))>>>0)+((D&F|W&(D^F))>>>0))/4294967296>>>0)>>>0,T=ct>>>0,Ze=Pe,Ct=We,Pe=Fe,We=be,Fe=Ae,be=Re,Ae=ne+C+((ct=de+_)/4294967296>>>0)>>>0,Re=ct>>>0,ne=Y,de=W,Y=l,W=F,l=P,F=D,P=C+N+((ct=_+T)/4294967296>>>0)>>>0,D=ct>>>0;x[0][0]=x[0][0]+P+((ct=x[0][1]+D)/4294967296>>>0)>>>0,x[0][1]=ct>>>0,x[1][0]=x[1][0]+l+((ct=x[1][1]+F)/4294967296>>>0)>>>0,x[1][1]=ct>>>0,x[2][0]=x[2][0]+Y+((ct=x[2][1]+W)/4294967296>>>0)>>>0,x[2][1]=ct>>>0,x[3][0]=x[3][0]+ne+((ct=x[3][1]+de)/4294967296>>>0)>>>0,x[3][1]=ct>>>0,x[4][0]=x[4][0]+Ae+((ct=x[4][1]+Re)/4294967296>>>0)>>>0,x[4][1]=ct>>>0,x[5][0]=x[5][0]+Fe+((ct=x[5][1]+be)/4294967296>>>0)>>>0,x[5][1]=ct>>>0,x[6][0]=x[6][0]+Pe+((ct=x[6][1]+We)/4294967296>>>0)>>>0,x[6][1]=ct>>>0,x[7][0]=x[7][0]+Ze+((ct=x[7][1]+Ct)/4294967296>>>0)>>>0,x[7][1]=ct>>>0,K-=128}}},1015:(De,J,M)=>{var s=M(8659);M(1298),M(9032),M(2687),M(7690),M(4747);var i=De.exports=s.ssh=s.ssh||{};function d(E,v){var y=v.toString(16);y[0]>="8"&&(y="00"+y);var h=s.util.hexToBytes(y);E.putInt32(h.length),E.putBytes(h)}function c(E,v){E.putInt32(v.length),E.putString(v)}function B(){for(var E=s.md.sha1.create(),v=arguments.length,y=0;y<v;++y)E.update(arguments[y]);return E.digest()}i.privateKeyToPutty=function(E,v,y){var h="ssh-rsa",x=""===(v=v||"")?"none":"aes256-cbc",A="PuTTY-User-Key-File-2: "+h+"\r\n";A+="Encryption: "+x+"\r\n",A+="Comment: "+(y=y||"")+"\r\n";var H=s.util.createBuffer();c(H,h),d(H,E.e),d(H,E.n);var C=s.util.encode64(H.bytes(),64),_=Math.floor(C.length/66)+1;A+="Public-Lines: "+_+"\r\n",A+=C;var T,N=s.util.createBuffer();if(d(N,E.d),d(N,E.p),d(N,E.q),d(N,E.qInv),v){var I=N.length()+16-1;I-=I%16;var p=B(N.bytes());p.truncate(p.length()-I+N.length()),N.putBuffer(p);var m=s.util.createBuffer();m.putBuffer(B("\0\0\0\0",v)),m.putBuffer(B("\0\0\0\x01",v));var S=s.aes.createEncryptionCipher(m.truncate(8),"CBC");S.start(s.util.createBuffer().fillWithByte(0,16)),S.update(N.copy()),S.finish();var O=S.output;O.truncate(16),T=s.util.encode64(O.bytes(),64)}else T=s.util.encode64(N.bytes(),64);A+="\r\nPrivate-Lines: "+(_=Math.floor(T.length/66)+1)+"\r\n",A+=T;var V=B("putty-private-key-file-mac-key",v),G=s.util.createBuffer();c(G,h),c(G,x),c(G,y),G.putInt32(H.length()),G.putBuffer(H),G.putInt32(N.length()),G.putBuffer(N);var k=s.hmac.create();return k.start("sha1",V),k.update(G.bytes()),A+"\r\nPrivate-MAC: "+k.digest().toHex()+"\r\n"},i.publicKeyToOpenSSH=function(E,v){var y="ssh-rsa";v=v||"";var h=s.util.createBuffer();return c(h,y),d(h,E.e),d(h,E.n),y+" "+s.util.encode64(h.bytes())+" "+v},i.privateKeyToOpenSSH=function(E,v){return v?s.pki.encryptRsaPrivateKey(E,v,{legacy:!0,algorithm:"aes128"}):s.pki.privateKeyToPem(E)},i.getPublicKeyFingerprint=function(E,v){var y=(v=v||{}).md||s.md.md5.create(),x=s.util.createBuffer();c(x,"ssh-rsa"),d(x,E.e),d(x,E.n),y.start(),y.update(x.getBytes());var A=y.digest();if("hex"===v.encoding){var H=A.toHex();return v.delimiter?H.match(/.{2}/g).join(v.delimiter):H}if("binary"===v.encoding)return A.getBytes();if(v.encoding)throw new Error('Unknown encoding "'+v.encoding+'".');return A}},2266:(De,J,M)=>{var s=M(8659);M(7791),M(9032),M(2687),M(8604),M(1965),M(8365),M(7690),M(4747);var i=function(K,U,ee,me){var Ue=s.util.createBuffer(),z=K.length>>1,Ie=z+(1&K.length),lt=K.substr(0,Ie),Pt=K.substr(z,Ie),kt=s.util.createBuffer(),at=s.hmac.create();ee=U+ee;var _t=Math.ceil(me/16),Vt=Math.ceil(me/20);at.start("MD5",lt);var Qt=s.util.createBuffer();kt.putBytes(ee);for(var Z=0;Z<_t;++Z)at.start(null,null),at.update(kt.getBytes()),kt.putBuffer(at.digest()),at.start(null,null),at.update(kt.bytes()+ee),Qt.putBuffer(at.digest());at.start("SHA1",Pt);var ut=s.util.createBuffer();for(kt.clear(),kt.putBytes(ee),Z=0;Z<Vt;++Z)at.start(null,null),at.update(kt.getBytes()),kt.putBuffer(at.digest()),at.start(null,null),at.update(kt.bytes()+ee),ut.putBuffer(at.digest());return Ue.putBytes(s.util.xorBytes(Qt.getBytes(),ut.getBytes(),me)),Ue},B=function(K,U,ee){var me=!1;try{var Ue=K.deflate(U.fragment.getBytes());U.fragment=s.util.createBuffer(Ue),U.length=Ue.length,me=!0}catch{}return me},E=function(K,U,ee){var me=!1;try{var Ue=K.inflate(U.fragment.getBytes());U.fragment=s.util.createBuffer(Ue),U.length=Ue.length,me=!0}catch{}return me},v=function(K,U){var ee=0;switch(U){case 1:ee=K.getByte();break;case 2:ee=K.getInt16();break;case 3:ee=K.getInt24();break;case 4:ee=K.getInt32()}return s.util.createBuffer(K.getBytes(ee))},y=function(K,U,ee){K.putInt(ee.length(),U<<3),K.putBuffer(ee)},h={Versions:{TLS_1_0:{major:3,minor:1},TLS_1_1:{major:3,minor:2},TLS_1_2:{major:3,minor:3}}};h.SupportedVersions=[h.Versions.TLS_1_1,h.Versions.TLS_1_0],h.Version=h.SupportedVersions[0],h.MaxFragment=15360,h.ConnectionEnd={server:0,client:1},h.PRFAlgorithm={tls_prf_sha256:0},h.BulkCipherAlgorithm={none:null,rc4:0,des3:1,aes:2},h.CipherType={stream:0,block:1,aead:2},h.MACAlgorithm={none:null,hmac_md5:0,hmac_sha1:1,hmac_sha256:2,hmac_sha384:3,hmac_sha512:4},h.CompressionMethod={none:0,deflate:1},h.ContentType={change_cipher_spec:20,alert:21,handshake:22,application_data:23,heartbeat:24},h.HandshakeType={hello_request:0,client_hello:1,server_hello:2,certificate:11,server_key_exchange:12,certificate_request:13,server_hello_done:14,certificate_verify:15,client_key_exchange:16,finished:20},h.Alert={},h.Alert.Level={warning:1,fatal:2},h.Alert.Description={close_notify:0,unexpected_message:10,bad_record_mac:20,decryption_failed:21,record_overflow:22,decompression_failure:30,handshake_failure:40,bad_certificate:42,unsupported_certificate:43,certificate_revoked:44,certificate_expired:45,certificate_unknown:46,illegal_parameter:47,unknown_ca:48,access_denied:49,decode_error:50,decrypt_error:51,export_restriction:60,protocol_version:70,insufficient_security:71,internal_error:80,user_canceled:90,no_renegotiation:100},h.HeartbeatMessageType={heartbeat_request:1,heartbeat_response:2},h.CipherSuites={},h.getCipherSuite=function(K){var U=null;for(var ee in h.CipherSuites){var me=h.CipherSuites[ee];if(me.id[0]===K.charCodeAt(0)&&me.id[1]===K.charCodeAt(1)){U=me;break}}return U},h.handleUnexpected=function(K,U){!K.open&&K.entity===h.ConnectionEnd.client||K.error(K,{message:"Unexpected message. Received TLS record out of order.",send:!0,alert:{level:h.Alert.Level.fatal,description:h.Alert.Description.unexpected_message}})},h.handleHelloRequest=function(K,U,ee){!K.handshaking&&K.handshakes>0&&(h.queue(K,h.createAlert(K,{level:h.Alert.Level.warning,description:h.Alert.Description.no_renegotiation})),h.flush(K)),K.process()},h.parseHelloMessage=function(K,U,ee){var me=null,Ue=K.entity===h.ConnectionEnd.client;if(ee<38)K.error(K,{message:Ue?"Invalid ServerHello message. Message too short.":"Invalid ClientHello message. Message too short.",send:!0,alert:{level:h.Alert.Level.fatal,description:h.Alert.Description.illegal_parameter}});else{var z=U.fragment,Ie=z.length();if(me={version:{major:z.getByte(),minor:z.getByte()},random:s.util.createBuffer(z.getBytes(32)),session_id:v(z,1),extensions:[]},Ue?(me.cipher_suite=z.getBytes(2),me.compression_method=z.getByte()):(me.cipher_suites=v(z,2),me.compression_methods=v(z,1)),(Ie=ee-(Ie-z.length()))>0){for(var lt=v(z,2);lt.length()>0;)me.extensions.push({type:[lt.getByte(),lt.getByte()],data:v(lt,2)});if(!Ue)for(var Pt=0;Pt<me.extensions.length;++Pt){var kt=me.extensions[Pt];if(0===kt.type[0]&&0===kt.type[1])for(var at=v(kt.data,2);at.length()>0&&0===at.getByte();)K.session.extensions.server_name.serverNameList.push(v(at,2).getBytes())}}if(K.session.version&&(me.version.major!==K.session.version.major||me.version.minor!==K.session.version.minor))return K.error(K,{message:"TLS version change is disallowed during renegotiation.",send:!0,alert:{level:h.Alert.Level.fatal,description:h.Alert.Description.protocol_version}});if(Ue)K.session.cipherSuite=h.getCipherSuite(me.cipher_suite);else for(var Vt=s.util.createBuffer(me.cipher_suites.bytes());Vt.length()>0&&(K.session.cipherSuite=h.getCipherSuite(Vt.getBytes(2)),null===K.session.cipherSuite););if(null===K.session.cipherSuite)return K.error(K,{message:"No cipher suites in common.",send:!0,alert:{level:h.Alert.Level.fatal,description:h.Alert.Description.handshake_failure},cipherSuite:s.util.bytesToHex(me.cipher_suite)});K.session.compressionMethod=Ue?me.compression_method:h.CompressionMethod.none}return me},h.createSecurityParameters=function(K,U){var ee=K.entity===h.ConnectionEnd.client,me=U.random.bytes(),Ue=ee?K.session.sp.client_random:me,z=ee?me:h.createRandom().getBytes();K.session.sp={entity:K.entity,prf_algorithm:h.PRFAlgorithm.tls_prf_sha256,bulk_cipher_algorithm:null,cipher_type:null,enc_key_length:null,block_length:null,fixed_iv_length:null,record_iv_length:null,mac_algorithm:null,mac_length:null,mac_key_length:null,compression_algorithm:K.session.compressionMethod,pre_master_secret:null,master_secret:null,client_random:Ue,server_random:z}},h.handleServerHello=function(K,U,ee){var me=h.parseHelloMessage(K,U,ee);if(!K.fail){if(!(me.version.minor<=K.version.minor))return K.error(K,{message:"Incompatible TLS version.",send:!0,alert:{level:h.Alert.Level.fatal,description:h.Alert.Description.protocol_version}});K.version.minor=me.version.minor,K.session.version=K.version;var Ue=me.session_id.bytes();Ue.length>0&&Ue===K.session.id?(K.expect=N,K.session.resuming=!0,K.session.sp.server_random=me.random.bytes()):(K.expect=A,K.session.resuming=!1,h.createSecurityParameters(K,me)),K.session.id=Ue,K.process()}},h.handleClientHello=function(K,U,ee){var me=h.parseHelloMessage(K,U,ee);if(!K.fail){var Ue=me.session_id.bytes(),z=null;if(K.sessionCache&&(null===(z=K.sessionCache.getSession(Ue))?Ue="":(z.version.major!==me.version.major||z.version.minor>me.version.minor)&&(z=null,Ue="")),0===Ue.length&&(Ue=s.random.getBytes(32)),K.session.id=Ue,K.session.clientHelloVersion=me.version,K.session.sp={},z)K.version=K.session.version=z.version,K.session.sp=z.sp;else{for(var Ie,lt=1;lt<h.SupportedVersions.length&&!((Ie=h.SupportedVersions[lt]).minor<=me.version.minor);++lt);K.version={major:Ie.major,minor:Ie.minor},K.session.version=K.version}null!==z?(K.expect=G,K.session.resuming=!0,K.session.sp.client_random=me.random.bytes()):(K.expect=!1!==K.verifyClient?S:O,K.session.resuming=!1,h.createSecurityParameters(K,me)),K.open=!0,h.queue(K,h.createRecord(K,{type:h.ContentType.handshake,data:h.createServerHello(K)})),K.session.resuming?(h.queue(K,h.createRecord(K,{type:h.ContentType.change_cipher_spec,data:h.createChangeCipherSpec()})),K.state.pending=h.createConnectionState(K),K.state.current.write=K.state.pending.write,h.queue(K,h.createRecord(K,{type:h.ContentType.handshake,data:h.createFinished(K)}))):(h.queue(K,h.createRecord(K,{type:h.ContentType.handshake,data:h.createCertificate(K)})),K.fail||(h.queue(K,h.createRecord(K,{type:h.ContentType.handshake,data:h.createServerKeyExchange(K)})),!1!==K.verifyClient&&h.queue(K,h.createRecord(K,{type:h.ContentType.handshake,data:h.createCertificateRequest(K)})),h.queue(K,h.createRecord(K,{type:h.ContentType.handshake,data:h.createServerHelloDone(K)})))),h.flush(K),K.process()}},h.handleCertificate=function(K,U,ee){if(ee<3)return K.error(K,{message:"Invalid Certificate message. Message too short.",send:!0,alert:{level:h.Alert.Level.fatal,description:h.Alert.Description.illegal_parameter}});var z,Ie,Ue={certificate_list:v(U.fragment,3)},lt=[];try{for(;Ue.certificate_list.length()>0;)z=v(Ue.certificate_list,3),Ie=s.asn1.fromDer(z),z=s.pki.certificateFromAsn1(Ie,!0),lt.push(z)}catch(kt){return K.error(K,{message:"Could not parse certificate list.",cause:kt,send:!0,alert:{level:h.Alert.Level.fatal,description:h.Alert.Description.bad_certificate}})}var Pt=K.entity===h.ConnectionEnd.client;!Pt&&!0!==K.verifyClient||0!==lt.length?0===lt.length?K.expect=Pt?H:O:(Pt?K.session.serverCertificate=lt[0]:K.session.clientCertificate=lt[0],h.verifyCertificateChain(K,lt)&&(K.expect=Pt?H:O)):K.error(K,{message:Pt?"No server certificate provided.":"No client certificate provided.",send:!0,alert:{level:h.Alert.Level.fatal,description:h.Alert.Description.illegal_parameter}}),K.process()},h.handleServerKeyExchange=function(K,U,ee){if(ee>0)return K.error(K,{message:"Invalid key parameters. Only RSA is supported.",send:!0,alert:{level:h.Alert.Level.fatal,description:h.Alert.Description.unsupported_certificate}});K.expect=C,K.process()},h.handleClientKeyExchange=function(K,U,ee){if(ee<48)return K.error(K,{message:"Invalid key parameters. Only RSA is supported.",send:!0,alert:{level:h.Alert.Level.fatal,description:h.Alert.Description.unsupported_certificate}});var Ue={enc_pre_master_secret:v(U.fragment,2).getBytes()},z=null;if(K.getPrivateKey)try{z=K.getPrivateKey(K,K.session.serverCertificate),z=s.pki.privateKeyFromPem(z)}catch(Pt){K.error(K,{message:"Could not get private key.",cause:Pt,send:!0,alert:{level:h.Alert.Level.fatal,description:h.Alert.Description.internal_error}})}if(null===z)return K.error(K,{message:"No private key set.",send:!0,alert:{level:h.Alert.Level.fatal,description:h.Alert.Description.internal_error}});try{var Ie=K.session.sp;Ie.pre_master_secret=z.decrypt(Ue.enc_pre_master_secret);var lt=K.session.clientHelloVersion;if(lt.major!==Ie.pre_master_secret.charCodeAt(0)||lt.minor!==Ie.pre_master_secret.charCodeAt(1))throw new Error("TLS version rollback attack detected.")}catch{Ie.pre_master_secret=s.random.getBytes(48)}K.expect=G,null!==K.session.clientCertificate&&(K.expect=V),K.process()},h.handleCertificateRequest=function(K,U,ee){if(ee<3)return K.error(K,{message:"Invalid CertificateRequest. Message too short.",send:!0,alert:{level:h.Alert.Level.fatal,description:h.Alert.Description.illegal_parameter}});var me=U.fragment,Ue={certificate_types:v(me,1),certificate_authorities:v(me,2)};K.session.certificateRequest=Ue,K.expect=_,K.process()},h.handleCertificateVerify=function(K,U,ee){if(ee<2)return K.error(K,{message:"Invalid CertificateVerify. Message too short.",send:!0,alert:{level:h.Alert.Level.fatal,description:h.Alert.Description.illegal_parameter}});var me=U.fragment;me.read-=4;var Ue=me.bytes();me.read+=4;var z={signature:v(me,2).getBytes()},Ie=s.util.createBuffer();Ie.putBuffer(K.session.md5.digest()),Ie.putBuffer(K.session.sha1.digest()),Ie=Ie.getBytes();try{if(!K.session.clientCertificate.publicKey.verify(Ie,z.signature,"NONE"))throw new Error("CertificateVerify signature does not match.");K.session.md5.update(Ue),K.session.sha1.update(Ue)}catch{return K.error(K,{message:"Bad signature in CertificateVerify.",send:!0,alert:{level:h.Alert.Level.fatal,description:h.Alert.Description.handshake_failure}})}K.expect=G,K.process()},h.handleServerHelloDone=function(K,U,ee){if(ee>0)return K.error(K,{message:"Invalid ServerHelloDone message. Invalid length.",send:!0,alert:{level:h.Alert.Level.fatal,description:h.Alert.Description.record_overflow}});if(null===K.serverCertificate){var me={message:"No server certificate provided. Not enough security.",send:!0,alert:{level:h.Alert.Level.fatal,description:h.Alert.Description.insufficient_security}},z=K.verify(K,me.alert.description,0,[]);if(!0!==z)return(z||0===z)&&("object"!=typeof z||s.util.isArray(z)?"number"==typeof z&&(me.alert.description=z):(z.message&&(me.message=z.message),z.alert&&(me.alert.description=z.alert))),K.error(K,me)}null!==K.session.certificateRequest&&(U=h.createRecord(K,{type:h.ContentType.handshake,data:h.createCertificate(K)}),h.queue(K,U)),U=h.createRecord(K,{type:h.ContentType.handshake,data:h.createClientKeyExchange(K)}),h.queue(K,U),K.expect=p;var Ie=function(lt,Pt){null!==lt.session.certificateRequest&&null!==lt.session.clientCertificate&&h.queue(lt,h.createRecord(lt,{type:h.ContentType.handshake,data:h.createCertificateVerify(lt,Pt)})),h.queue(lt,h.createRecord(lt,{type:h.ContentType.change_cipher_spec,data:h.createChangeCipherSpec()})),lt.state.pending=h.createConnectionState(lt),lt.state.current.write=lt.state.pending.write,h.queue(lt,h.createRecord(lt,{type:h.ContentType.handshake,data:h.createFinished(lt)})),lt.expect=N,h.flush(lt),lt.process()};if(null===K.session.certificateRequest||null===K.session.clientCertificate)return Ie(K,null);h.getClientSignature(K,Ie)},h.handleChangeCipherSpec=function(K,U){if(1!==U.fragment.getByte())return K.error(K,{message:"Invalid ChangeCipherSpec message received.",send:!0,alert:{level:h.Alert.Level.fatal,description:h.Alert.Description.illegal_parameter}});var ee=K.entity===h.ConnectionEnd.client;(K.session.resuming&&ee||!K.session.resuming&&!ee)&&(K.state.pending=h.createConnectionState(K)),K.state.current.read=K.state.pending.read,(!K.session.resuming&&ee||K.session.resuming&&!ee)&&(K.state.pending=null),K.expect=ee?T:k,K.process()},h.handleFinished=function(K,U,ee){var me=U.fragment;me.read-=4;var Ue=me.bytes();me.read+=4;var z=U.fragment.getBytes();(me=s.util.createBuffer()).putBuffer(K.session.md5.digest()),me.putBuffer(K.session.sha1.digest());var Ie=K.entity===h.ConnectionEnd.client;if((me=i(K.session.sp.master_secret,Ie?"server finished":"client finished",me.getBytes(),12)).getBytes()!==z)return K.error(K,{message:"Invalid verify_data in Finished message.",send:!0,alert:{level:h.Alert.Level.fatal,description:h.Alert.Description.decrypt_error}});K.session.md5.update(Ue),K.session.sha1.update(Ue),(K.session.resuming&&Ie||!K.session.resuming&&!Ie)&&(h.queue(K,h.createRecord(K,{type:h.ContentType.change_cipher_spec,data:h.createChangeCipherSpec()})),K.state.current.write=K.state.pending.write,K.state.pending=null,h.queue(K,h.createRecord(K,{type:h.ContentType.handshake,data:h.createFinished(K)}))),K.expect=Ie?I:P,K.handshaking=!1,++K.handshakes,K.peerCertificate=Ie?K.session.serverCertificate:K.session.clientCertificate,h.flush(K),K.isConnected=!0,K.connected(K),K.process()},h.handleAlert=function(K,U){var Ue,ee=U.fragment,me={level:ee.getByte(),description:ee.getByte()};switch(me.description){case h.Alert.Description.close_notify:Ue="Connection closed.";break;case h.Alert.Description.unexpected_message:Ue="Unexpected message.";break;case h.Alert.Description.bad_record_mac:Ue="Bad record MAC.";break;case h.Alert.Description.decryption_failed:Ue="Decryption failed.";break;case h.Alert.Description.record_overflow:Ue="Record overflow.";break;case h.Alert.Description.decompression_failure:Ue="Decompression failed.";break;case h.Alert.Description.handshake_failure:Ue="Handshake failure.";break;case h.Alert.Description.bad_certificate:Ue="Bad certificate.";break;case h.Alert.Description.unsupported_certificate:Ue="Unsupported certificate.";break;case h.Alert.Description.certificate_revoked:Ue="Certificate revoked.";break;case h.Alert.Description.certificate_expired:Ue="Certificate expired.";break;case h.Alert.Description.certificate_unknown:Ue="Certificate unknown.";break;case h.Alert.Description.illegal_parameter:Ue="Illegal parameter.";break;case h.Alert.Description.unknown_ca:Ue="Unknown certificate authority.";break;case h.Alert.Description.access_denied:Ue="Access denied.";break;case h.Alert.Description.decode_error:Ue="Decode error.";break;case h.Alert.Description.decrypt_error:Ue="Decrypt error.";break;case h.Alert.Description.export_restriction:Ue="Export restriction.";break;case h.Alert.Description.protocol_version:Ue="Unsupported protocol version.";break;case h.Alert.Description.insufficient_security:Ue="Insufficient security.";break;case h.Alert.Description.internal_error:Ue="Internal error.";break;case h.Alert.Description.user_canceled:Ue="User canceled.";break;case h.Alert.Description.no_renegotiation:Ue="Renegotiation not supported.";break;default:Ue="Unknown error."}if(me.description===h.Alert.Description.close_notify)return K.close();K.error(K,{message:Ue,send:!1,origin:K.entity===h.ConnectionEnd.client?"server":"client",alert:me}),K.process()},h.handleHandshake=function(K,U){var ee=U.fragment,me=ee.getByte(),Ue=ee.getInt24();if(Ue>ee.length())return K.fragmented=U,U.fragment=s.util.createBuffer(),ee.read-=4,K.process();K.fragmented=null,ee.read-=4;var z=ee.bytes(Ue+4);ee.read+=4,me in tt[K.entity][K.expect]?(K.entity===h.ConnectionEnd.server&&!K.open&&!K.fail&&(K.handshaking=!0,K.session={version:null,extensions:{server_name:{serverNameList:[]}},cipherSuite:null,compressionMethod:null,serverCertificate:null,clientCertificate:null,md5:s.md.md5.create(),sha1:s.md.sha1.create()}),me!==h.HandshakeType.hello_request&&me!==h.HandshakeType.certificate_verify&&me!==h.HandshakeType.finished&&(K.session.md5.update(z),K.session.sha1.update(z)),tt[K.entity][K.expect][me](K,U,Ue)):h.handleUnexpected(K,U)},h.handleApplicationData=function(K,U){K.data.putBuffer(U.fragment),K.dataReady(K),K.process()},h.handleHeartbeat=function(K,U){var ee=U.fragment,me=ee.getByte(),Ue=ee.getInt16(),z=ee.getBytes(Ue);if(me===h.HeartbeatMessageType.heartbeat_request){if(K.handshaking||Ue>z.length)return K.process();h.queue(K,h.createRecord(K,{type:h.ContentType.heartbeat,data:h.createHeartbeat(h.HeartbeatMessageType.heartbeat_response,z)})),h.flush(K)}else if(me===h.HeartbeatMessageType.heartbeat_response){if(z!==K.expectedHeartbeatPayload)return K.process();K.heartbeatReceived&&K.heartbeatReceived(K,s.util.createBuffer(z))}K.process()};var A=1,H=2,C=3,_=4,N=5,T=6,I=7,p=8,S=1,O=2,V=3,G=4,k=5,P=6,l=h.handleUnexpected,F=h.handleChangeCipherSpec,Y=h.handleAlert,W=h.handleHandshake,ne=h.handleApplicationData,de=h.handleHeartbeat,Ae=[];Ae[h.ConnectionEnd.client]=[[l,Y,W,l,de],[l,Y,W,l,de],[l,Y,W,l,de],[l,Y,W,l,de],[l,Y,W,l,de],[F,Y,l,l,de],[l,Y,W,l,de],[l,Y,W,ne,de],[l,Y,W,l,de]],Ae[h.ConnectionEnd.server]=[[l,Y,W,l,de],[l,Y,W,l,de],[l,Y,W,l,de],[l,Y,W,l,de],[F,Y,l,l,de],[l,Y,W,l,de],[l,Y,W,ne,de],[l,Y,W,l,de]];var Re=h.handleHelloRequest,be=h.handleCertificate,Pe=h.handleServerKeyExchange,We=h.handleCertificateRequest,Ze=h.handleServerHelloDone,Ct=h.handleFinished,tt=[];tt[h.ConnectionEnd.client]=[[l,l,h.handleServerHello,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l],[Re,l,l,l,l,l,l,l,l,l,l,be,Pe,We,Ze,l,l,l,l,l,l],[Re,l,l,l,l,l,l,l,l,l,l,l,Pe,We,Ze,l,l,l,l,l,l],[Re,l,l,l,l,l,l,l,l,l,l,l,l,We,Ze,l,l,l,l,l,l],[Re,l,l,l,l,l,l,l,l,l,l,l,l,l,Ze,l,l,l,l,l,l],[Re,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l],[Re,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,Ct],[Re,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l],[Re,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l]],tt[h.ConnectionEnd.server]=[[l,h.handleClientHello,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l],[l,l,l,l,l,l,l,l,l,l,l,be,l,l,l,l,l,l,l,l,l],[l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,h.handleClientKeyExchange,l,l,l,l],[l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,h.handleCertificateVerify,l,l,l,l,l],[l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l],[l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,Ct],[l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l],[l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l]],h.generateKeys=function(K,U){var ee=i,me=U.client_random+U.server_random;K.session.resuming||(U.master_secret=ee(U.pre_master_secret,"master secret",me,48).bytes(),U.pre_master_secret=null);var Ue=2*U.mac_key_length+2*U.enc_key_length,z=K.version.major===h.Versions.TLS_1_0.major&&K.version.minor===h.Versions.TLS_1_0.minor;z&&(Ue+=2*U.fixed_iv_length);var Ie=ee(U.master_secret,"key expansion",me=U.server_random+U.client_random,Ue),lt={client_write_MAC_key:Ie.getBytes(U.mac_key_length),server_write_MAC_key:Ie.getBytes(U.mac_key_length),client_write_key:Ie.getBytes(U.enc_key_length),server_write_key:Ie.getBytes(U.enc_key_length)};return z&&(lt.client_write_IV=Ie.getBytes(U.fixed_iv_length),lt.server_write_IV=Ie.getBytes(U.fixed_iv_length)),lt},h.createConnectionState=function(K){var U=K.entity===h.ConnectionEnd.client,ee=function(){var z={sequenceNumber:[0,0],macKey:null,macLength:0,macFunction:null,cipherState:null,cipherFunction:function(Ie){return!0},compressionState:null,compressFunction:function(Ie){return!0},updateSequenceNumber:function(){4294967295===z.sequenceNumber[1]?(z.sequenceNumber[1]=0,++z.sequenceNumber[0]):++z.sequenceNumber[1]}};return z},me={read:ee(),write:ee()};if(me.read.update=function(z,Ie){return me.read.cipherFunction(Ie,me.read)?me.read.compressFunction(z,Ie,me.read)||z.error(z,{message:"Could not decompress record.",send:!0,alert:{level:h.Alert.Level.fatal,description:h.Alert.Description.decompression_failure}}):z.error(z,{message:"Could not decrypt record or bad MAC.",send:!0,alert:{level:h.Alert.Level.fatal,description:h.Alert.Description.bad_record_mac}}),!z.fail},me.write.update=function(z,Ie){return me.write.compressFunction(z,Ie,me.write)?me.write.cipherFunction(Ie,me.write)||z.error(z,{message:"Could not encrypt record.",send:!1,alert:{level:h.Alert.Level.fatal,description:h.Alert.Description.internal_error}}):z.error(z,{message:"Could not compress record.",send:!1,alert:{level:h.Alert.Level.fatal,description:h.Alert.Description.internal_error}}),!z.fail},K.session){var Ue=K.session.sp;switch(K.session.cipherSuite.initSecurityParameters(Ue),Ue.keys=h.generateKeys(K,Ue),me.read.macKey=U?Ue.keys.server_write_MAC_key:Ue.keys.client_write_MAC_key,me.write.macKey=U?Ue.keys.client_write_MAC_key:Ue.keys.server_write_MAC_key,K.session.cipherSuite.initConnectionState(me,K,Ue),Ue.compression_algorithm){case h.CompressionMethod.none:break;case h.CompressionMethod.deflate:me.read.compressFunction=E,me.write.compressFunction=B;break;default:throw new Error("Unsupported compression algorithm.")}}return me},h.createRandom=function(){var K=new Date,U=+K+6e4*K.getTimezoneOffset(),ee=s.util.createBuffer();return ee.putInt32(U),ee.putBytes(s.random.getBytes(28)),ee},h.createRecord=function(K,U){return U.data?{type:U.type,version:{major:K.version.major,minor:K.version.minor},length:U.data.length(),fragment:U.data}:null},h.createAlert=function(K,U){var ee=s.util.createBuffer();return ee.putByte(U.level),ee.putByte(U.description),h.createRecord(K,{type:h.ContentType.alert,data:ee})},h.createClientHello=function(K){K.session.clientHelloVersion={major:K.version.major,minor:K.version.minor};for(var U=s.util.createBuffer(),ee=0;ee<K.cipherSuites.length;++ee){var me=K.cipherSuites[ee];U.putByte(me.id[0]),U.putByte(me.id[1])}var Ue=U.length(),z=s.util.createBuffer();z.putByte(h.CompressionMethod.none);var Ie=z.length(),lt=s.util.createBuffer();if(K.virtualHost){var Pt=s.util.createBuffer();Pt.putByte(0),Pt.putByte(0);var kt=s.util.createBuffer();kt.putByte(0),y(kt,2,s.util.createBuffer(K.virtualHost));var at=s.util.createBuffer();y(at,2,kt),y(Pt,2,at),lt.putBuffer(Pt)}var _t=lt.length();_t>0&&(_t+=2);var Vt=K.session.id,Qt=Vt.length+1+2+4+28+2+Ue+1+Ie+_t,Z=s.util.createBuffer();return Z.putByte(h.HandshakeType.client_hello),Z.putInt24(Qt),Z.putByte(K.version.major),Z.putByte(K.version.minor),Z.putBytes(K.session.sp.client_random),y(Z,1,s.util.createBuffer(Vt)),y(Z,2,U),y(Z,1,z),_t>0&&y(Z,2,lt),Z},h.createServerHello=function(K){var U=K.session.id,ee=U.length+1+2+4+28+2+1,me=s.util.createBuffer();return me.putByte(h.HandshakeType.server_hello),me.putInt24(ee),me.putByte(K.version.major),me.putByte(K.version.minor),me.putBytes(K.session.sp.server_random),y(me,1,s.util.createBuffer(U)),me.putByte(K.session.cipherSuite.id[0]),me.putByte(K.session.cipherSuite.id[1]),me.putByte(K.session.compressionMethod),me},h.createCertificate=function(K){var U=K.entity===h.ConnectionEnd.client,ee=null;K.getCertificate&&(ee=K.getCertificate(K,U?K.session.certificateRequest:K.session.extensions.server_name.serverNameList));var Ue=s.util.createBuffer();if(null!==ee)try{s.util.isArray(ee)||(ee=[ee]);for(var z=null,Ie=0;Ie<ee.length;++Ie){var lt=s.pem.decode(ee[Ie])[0];if("CERTIFICATE"!==lt.type&&"X509 CERTIFICATE"!==lt.type&&"TRUSTED CERTIFICATE"!==lt.type){var Pt=new Error('Could not convert certificate from PEM; PEM header type is not "CERTIFICATE", "X509 CERTIFICATE", or "TRUSTED CERTIFICATE".');throw Pt.headerType=lt.type,Pt}if(lt.procType&&"ENCRYPTED"===lt.procType.type)throw new Error("Could not convert certificate from PEM; PEM is encrypted.");var kt=s.util.createBuffer(lt.body);null===z&&(z=s.asn1.fromDer(kt.bytes(),!1));var at=s.util.createBuffer();y(at,3,kt),Ue.putBuffer(at)}ee=s.pki.certificateFromAsn1(z),U?K.session.clientCertificate=ee:K.session.serverCertificate=ee}catch(Qt){return K.error(K,{message:"Could not send certificate list.",cause:Qt,send:!0,alert:{level:h.Alert.Level.fatal,description:h.Alert.Description.bad_certificate}})}var _t=3+Ue.length(),Vt=s.util.createBuffer();return Vt.putByte(h.HandshakeType.certificate),Vt.putInt24(_t),y(Vt,3,Ue),Vt},h.createClientKeyExchange=function(K){var U=s.util.createBuffer();U.putByte(K.session.clientHelloVersion.major),U.putByte(K.session.clientHelloVersion.minor),U.putBytes(s.random.getBytes(46));var ee=K.session.sp;ee.pre_master_secret=U.getBytes();var Ue=(U=K.session.serverCertificate.publicKey.encrypt(ee.pre_master_secret)).length+2,z=s.util.createBuffer();return z.putByte(h.HandshakeType.client_key_exchange),z.putInt24(Ue),z.putInt16(U.length),z.putBytes(U),z},h.createServerKeyExchange=function(K){return s.util.createBuffer()},h.getClientSignature=function(K,U){var ee=s.util.createBuffer();ee.putBuffer(K.session.md5.digest()),ee.putBuffer(K.session.sha1.digest()),ee=ee.getBytes(),K.getSignature=K.getSignature||function(me,Ue,z){var Ie=null;if(me.getPrivateKey)try{Ie=me.getPrivateKey(me,me.session.clientCertificate),Ie=s.pki.privateKeyFromPem(Ie)}catch(lt){me.error(me,{message:"Could not get private key.",cause:lt,send:!0,alert:{level:h.Alert.Level.fatal,description:h.Alert.Description.internal_error}})}null===Ie?me.error(me,{message:"No private key set.",send:!0,alert:{level:h.Alert.Level.fatal,description:h.Alert.Description.internal_error}}):Ue=Ie.sign(Ue,null),z(me,Ue)},K.getSignature(K,ee,U)},h.createCertificateVerify=function(K,U){var ee=U.length+2,me=s.util.createBuffer();return me.putByte(h.HandshakeType.certificate_verify),me.putInt24(ee),me.putInt16(U.length),me.putBytes(U),me},h.createCertificateRequest=function(K){var U=s.util.createBuffer();U.putByte(1);var ee=s.util.createBuffer();for(var me in K.caStore.certs){var z=s.pki.distinguishedNameToAsn1(K.caStore.certs[me].subject),Ie=s.asn1.toDer(z);ee.putInt16(Ie.length()),ee.putBuffer(Ie)}var lt=1+U.length()+2+ee.length(),Pt=s.util.createBuffer();return Pt.putByte(h.HandshakeType.certificate_request),Pt.putInt24(lt),y(Pt,1,U),y(Pt,2,ee),Pt},h.createServerHelloDone=function(K){var U=s.util.createBuffer();return U.putByte(h.HandshakeType.server_hello_done),U.putInt24(0),U},h.createChangeCipherSpec=function(){var K=s.util.createBuffer();return K.putByte(1),K},h.createFinished=function(K){var U=s.util.createBuffer();U.putBuffer(K.session.md5.digest()),U.putBuffer(K.session.sha1.digest()),U=i(K.session.sp.master_secret,K.entity===h.ConnectionEnd.client?"client finished":"server finished",U.getBytes(),12);var lt=s.util.createBuffer();return lt.putByte(h.HandshakeType.finished),lt.putInt24(U.length()),lt.putBuffer(U),lt},h.createHeartbeat=function(K,U,ee){typeof ee>"u"&&(ee=U.length);var me=s.util.createBuffer();me.putByte(K),me.putInt16(ee),me.putBytes(U);var Ue=me.length(),z=Math.max(16,Ue-ee-3);return me.putBytes(s.random.getBytes(z)),me},h.queue=function(K,U){if(U&&(0!==U.fragment.length()||U.type!==h.ContentType.handshake&&U.type!==h.ContentType.alert&&U.type!==h.ContentType.change_cipher_spec)){if(U.type===h.ContentType.handshake){var ee=U.fragment.bytes();K.session.md5.update(ee),K.session.sha1.update(ee),ee=null}var me;if(U.fragment.length()<=h.MaxFragment)me=[U];else{me=[];for(var Ue=U.fragment.bytes();Ue.length>h.MaxFragment;)me.push(h.createRecord(K,{type:U.type,data:s.util.createBuffer(Ue.slice(0,h.MaxFragment))})),Ue=Ue.slice(h.MaxFragment);Ue.length>0&&me.push(h.createRecord(K,{type:U.type,data:s.util.createBuffer(Ue)}))}for(var z=0;z<me.length&&!K.fail;++z){var Ie=me[z];K.state.current.write.update(K,Ie)&&K.records.push(Ie)}}},h.flush=function(K){for(var U=0;U<K.records.length;++U){var ee=K.records[U];K.tlsData.putByte(ee.type),K.tlsData.putByte(ee.version.major),K.tlsData.putByte(ee.version.minor),K.tlsData.putInt16(ee.fragment.length()),K.tlsData.putBuffer(K.records[U].fragment)}return K.records=[],K.tlsDataReady(K)};var Rt=function(K){switch(K){case!0:return!0;case s.pki.certificateError.bad_certificate:return h.Alert.Description.bad_certificate;case s.pki.certificateError.unsupported_certificate:return h.Alert.Description.unsupported_certificate;case s.pki.certificateError.certificate_revoked:return h.Alert.Description.certificate_revoked;case s.pki.certificateError.certificate_expired:return h.Alert.Description.certificate_expired;case s.pki.certificateError.certificate_unknown:return h.Alert.Description.certificate_unknown;case s.pki.certificateError.unknown_ca:return h.Alert.Description.unknown_ca;default:return h.Alert.Description.bad_certificate}};for(var Ge in h.verifyCertificateChain=function(K,U){try{var ee={};for(var me in K.verifyOptions)ee[me]=K.verifyOptions[me];ee.verify=function(z,Ie,lt){Rt(z);var kt=K.verify(K,z,Ie,lt);if(!0!==kt){if("object"==typeof kt&&!s.util.isArray(kt)){var at=new Error("The application rejected the certificate.");throw at.send=!0,at.alert={level:h.Alert.Level.fatal,description:h.Alert.Description.bad_certificate},kt.message&&(at.message=kt.message),kt.alert&&(at.alert.description=kt.alert),at}kt!==z&&(kt=function(K){switch(K){case!0:return!0;case h.Alert.Description.bad_certificate:return s.pki.certificateError.bad_certificate;case h.Alert.Description.unsupported_certificate:return s.pki.certificateError.unsupported_certificate;case h.Alert.Description.certificate_revoked:return s.pki.certificateError.certificate_revoked;case h.Alert.Description.certificate_expired:return s.pki.certificateError.certificate_expired;case h.Alert.Description.certificate_unknown:return s.pki.certificateError.certificate_unknown;case h.Alert.Description.unknown_ca:return s.pki.certificateError.unknown_ca;default:return s.pki.certificateError.bad_certificate}}(kt))}return kt},s.pki.verifyCertificateChain(K.caStore,U,ee)}catch(z){var Ue=z;("object"!=typeof Ue||s.util.isArray(Ue))&&(Ue={send:!0,alert:{level:h.Alert.Level.fatal,description:Rt(z)}}),"send"in Ue||(Ue.send=!0),"alert"in Ue||(Ue.alert={level:h.Alert.Level.fatal,description:Rt(Ue.error)}),K.error(K,Ue)}return!K.fail},h.createSessionCache=function(K,U){var ee=null;if(K&&K.getSession&&K.setSession&&K.order)ee=K;else{for(var me in(ee={}).cache=K||{},ee.capacity=Math.max(U||100,1),ee.order=[],K)ee.order.length<=U?ee.order.push(me):delete K[me];ee.getSession=function(Ue){var z=null,Ie=null;if(Ue?Ie=s.util.bytesToHex(Ue):ee.order.length>0&&(Ie=ee.order[0]),null!==Ie&&Ie in ee.cache)for(var lt in z=ee.cache[Ie],delete ee.cache[Ie],ee.order)if(ee.order[lt]===Ie){ee.order.splice(lt,1);break}return z},ee.setSession=function(Ue,z){if(ee.order.length===ee.capacity){var Ie=ee.order.shift();delete ee.cache[Ie]}Ie=s.util.bytesToHex(Ue),ee.order.push(Ie),ee.cache[Ie]=z}}return ee},h.createConnection=function(K){var U;U=K.caStore?s.util.isArray(K.caStore)?s.pki.createCaStore(K.caStore):K.caStore:s.pki.createCaStore();var ee=K.cipherSuites||null;if(null===ee)for(var me in ee=[],h.CipherSuites)ee.push(h.CipherSuites[me]);var Ue=K.server?h.ConnectionEnd.server:h.ConnectionEnd.client,z=K.sessionCache?h.createSessionCache(K.sessionCache):null,Ie={version:{major:h.Version.major,minor:h.Version.minor},entity:Ue,sessionId:K.sessionId,caStore:U,sessionCache:z,cipherSuites:ee,connected:K.connected,virtualHost:K.virtualHost||null,verifyClient:K.verifyClient||!1,verify:K.verify||function(at,_t,Vt,Qt){return _t},verifyOptions:K.verifyOptions||{},getCertificate:K.getCertificate||null,getPrivateKey:K.getPrivateKey||null,getSignature:K.getSignature||null,input:s.util.createBuffer(),tlsData:s.util.createBuffer(),data:s.util.createBuffer(),tlsDataReady:K.tlsDataReady,dataReady:K.dataReady,heartbeatReceived:K.heartbeatReceived,closed:K.closed,error:function(at,_t){_t.origin=_t.origin||(at.entity===h.ConnectionEnd.client?"client":"server"),_t.send&&(h.queue(at,h.createAlert(at,_t.alert)),h.flush(at));var Vt=!1!==_t.fatal;Vt&&(at.fail=!0),K.error(at,_t),Vt&&at.close(!1)},deflate:K.deflate||null,inflate:K.inflate||null,reset:function(at){Ie.version={major:h.Version.major,minor:h.Version.minor},Ie.record=null,Ie.session=null,Ie.peerCertificate=null,Ie.state={pending:null,current:null},Ie.expect=0,Ie.fragmented=null,Ie.records=[],Ie.open=!1,Ie.handshakes=0,Ie.handshaking=!1,Ie.isConnected=!1,Ie.fail=!(at||typeof at>"u"),Ie.input.clear(),Ie.tlsData.clear(),Ie.data.clear(),Ie.state.current=h.createConnectionState(Ie)}};return Ie.reset(),Ie.handshake=function(at){if(Ie.entity!==h.ConnectionEnd.client)Ie.error(Ie,{message:"Cannot initiate handshake as a server.",fatal:!1});else if(Ie.handshaking)Ie.error(Ie,{message:"Handshake already in progress.",fatal:!1});else{Ie.fail&&!Ie.open&&0===Ie.handshakes&&(Ie.fail=!1),Ie.handshaking=!0;var _t=null;(at=at||"").length>0&&(Ie.sessionCache&&(_t=Ie.sessionCache.getSession(at)),null===_t&&(at="")),0===at.length&&Ie.sessionCache&&null!==(_t=Ie.sessionCache.getSession())&&(at=_t.id),Ie.session={id:at,version:null,cipherSuite:null,compressionMethod:null,serverCertificate:null,certificateRequest:null,clientCertificate:null,sp:{},md5:s.md.md5.create(),sha1:s.md.sha1.create()},_t&&(Ie.version=_t.version,Ie.session.sp=_t.sp),Ie.session.sp.client_random=h.createRandom().getBytes(),Ie.open=!0,h.queue(Ie,h.createRecord(Ie,{type:h.ContentType.handshake,data:h.createClientHello(Ie)})),h.flush(Ie)}},Ie.process=function(at){var _t=0;return at&&Ie.input.putBytes(at),Ie.fail||(null!==Ie.record&&Ie.record.ready&&Ie.record.fragment.isEmpty()&&(Ie.record=null),null===Ie.record&&(_t=function(at){var _t=0,Vt=at.input,Qt=Vt.length();if(Qt<5)_t=5-Qt;else{at.record={type:Vt.getByte(),version:{major:Vt.getByte(),minor:Vt.getByte()},length:Vt.getInt16(),fragment:s.util.createBuffer(),ready:!1};var Z=at.record.version.major===at.version.major;Z&&at.session&&at.session.version&&(Z=at.record.version.minor===at.version.minor),Z||at.error(at,{message:"Incompatible TLS version.",send:!0,alert:{level:h.Alert.Level.fatal,description:h.Alert.Description.protocol_version}})}return _t}(Ie)),!Ie.fail&&null!==Ie.record&&!Ie.record.ready&&(_t=function(at){var _t=0,Vt=at.input,Qt=Vt.length();return Qt<at.record.length?_t=at.record.length-Qt:(at.record.fragment.putBytes(Vt.getBytes(at.record.length)),Vt.compact(),at.state.current.read.update(at,at.record)&&(null!==at.fragmented&&(at.fragmented.type===at.record.type?(at.fragmented.fragment.putBuffer(at.record.fragment),at.record=at.fragmented):at.error(at,{message:"Invalid fragmented record.",send:!0,alert:{level:h.Alert.Level.fatal,description:h.Alert.Description.unexpected_message}})),at.record.ready=!0)),_t}(Ie)),!Ie.fail&&null!==Ie.record&&Ie.record.ready&&function(at,_t){var Vt=_t.type-h.ContentType.change_cipher_spec,Qt=Ae[at.entity][at.expect];Vt in Qt?Qt[Vt](at,_t):h.handleUnexpected(at,_t)}(Ie,Ie.record)),_t},Ie.prepare=function(at){return h.queue(Ie,h.createRecord(Ie,{type:h.ContentType.application_data,data:s.util.createBuffer(at)})),h.flush(Ie)},Ie.prepareHeartbeatRequest=function(at,_t){return at instanceof s.util.ByteBuffer&&(at=at.bytes()),typeof _t>"u"&&(_t=at.length),Ie.expectedHeartbeatPayload=at,h.queue(Ie,h.createRecord(Ie,{type:h.ContentType.heartbeat,data:h.createHeartbeat(h.HeartbeatMessageType.heartbeat_request,at,_t)})),h.flush(Ie)},Ie.close=function(at){if(!Ie.fail&&Ie.sessionCache&&Ie.session){var _t={id:Ie.session.id,version:Ie.session.version,sp:Ie.session.sp};_t.sp.keys=null,Ie.sessionCache.setSession(_t.id,_t)}Ie.open&&(Ie.open=!1,Ie.input.clear(),(Ie.isConnected||Ie.handshaking)&&(Ie.isConnected=Ie.handshaking=!1,h.queue(Ie,h.createAlert(Ie,{level:h.Alert.Level.warning,description:h.Alert.Description.close_notify})),h.flush(Ie)),Ie.closed(Ie)),Ie.reset(at)},Ie},De.exports=s.tls=s.tls||{},h)"function"!=typeof h[Ge]&&(s.tls[Ge]=h[Ge]);s.tls.prf_tls1=i,s.tls.hmac_sha1=function(K,U,ee){var me=s.hmac.create();me.start("SHA1",K);var Ue=s.util.createBuffer();return Ue.putInt32(U[0]),Ue.putInt32(U[1]),Ue.putByte(ee.type),Ue.putByte(ee.version.major),Ue.putByte(ee.version.minor),Ue.putInt16(ee.length),Ue.putBytes(ee.fragment.bytes()),me.update(Ue.getBytes()),me.digest().getBytes()},s.tls.createSessionCache=h.createSessionCache,s.tls.createConnection=h.createConnection},4747:(De,J,M)=>{var s=M(8659),i=M(2020),d=De.exports=s.util=s.util||{};function c(p){if(8!==p&&16!==p&&24!==p&&32!==p)throw new Error("Only 8, 16, 24, or 32 bits supported: "+p)}function B(p){if(this.data="",this.read=0,"string"==typeof p)this.data=p;else if(d.isArrayBuffer(p)||d.isArrayBufferView(p))if(typeof Buffer<"u"&&p instanceof Buffer)this.data=p.toString("binary");else{var m=new Uint8Array(p);try{this.data=String.fromCharCode.apply(null,m)}catch{for(var S=0;S<m.length;++S)this.putByte(m[S])}}else(p instanceof B||"object"==typeof p&&"string"==typeof p.data&&"number"==typeof p.read)&&(this.data=p.data,this.read=p.read);this._constructedStringLength=0}(function(){if(typeof process<"u"&&process.nextTick&&!process.browser)return d.nextTick=process.nextTick,void(d.setImmediate="function"==typeof setImmediate?setImmediate:d.nextTick);if("function"==typeof setImmediate)return d.setImmediate=function(){return setImmediate.apply(void 0,arguments)},void(d.nextTick=function(P){return setImmediate(P)});if(d.setImmediate=function(P){setTimeout(P,0)},typeof window<"u"&&"function"==typeof window.postMessage){let P=function(D){if(D.source===window&&D.data===p){D.stopPropagation();var l=m.slice();m.length=0,l.forEach(function(F){F()})}};var p="forge.setImmediate",m=[];d.setImmediate=function(D){m.push(D),1===m.length&&window.postMessage(p,"*")},window.addEventListener("message",P,!0)}if(typeof MutationObserver<"u"){var S=Date.now(),O=!0,V=document.createElement("div");m=[],new MutationObserver(function(){var D=m.slice();m.length=0,D.forEach(function(l){l()})}).observe(V,{attributes:!0});var G=d.setImmediate;d.setImmediate=function(D){Date.now()-S>15?(S=Date.now(),G(D)):(m.push(D),1===m.length&&V.setAttribute("a",O=!O))}}d.nextTick=d.setImmediate})(),d.isNodejs=typeof process<"u"&&process.versions&&process.versions.node,d.globalScope=d.isNodejs?global:typeof self>"u"?window:self,d.isArray=Array.isArray||function(p){return"[object Array]"===Object.prototype.toString.call(p)},d.isArrayBuffer=function(p){return typeof ArrayBuffer<"u"&&p instanceof ArrayBuffer},d.isArrayBufferView=function(p){return p&&d.isArrayBuffer(p.buffer)&&void 0!==p.byteLength},d.ByteBuffer=B,d.ByteStringBuffer=B,d.ByteStringBuffer.prototype._optimizeConstructedString=function(p){this._constructedStringLength+=p,this._constructedStringLength>4096&&(this.data.substr(0,1),this._constructedStringLength=0)},d.ByteStringBuffer.prototype.length=function(){return this.data.length-this.read},d.ByteStringBuffer.prototype.isEmpty=function(){return this.length()<=0},d.ByteStringBuffer.prototype.putByte=function(p){return this.putBytes(String.fromCharCode(p))},d.ByteStringBuffer.prototype.fillWithByte=function(p,m){p=String.fromCharCode(p);for(var S=this.data;m>0;)1&m&&(S+=p),(m>>>=1)>0&&(p+=p);return this.data=S,this._optimizeConstructedString(m),this},d.ByteStringBuffer.prototype.putBytes=function(p){return this.data+=p,this._optimizeConstructedString(p.length),this},d.ByteStringBuffer.prototype.putString=function(p){return this.putBytes(d.encodeUtf8(p))},d.ByteStringBuffer.prototype.putInt16=function(p){return this.putBytes(String.fromCharCode(p>>8&255)+String.fromCharCode(255&p))},d.ByteStringBuffer.prototype.putInt24=function(p){return this.putBytes(String.fromCharCode(p>>16&255)+String.fromCharCode(p>>8&255)+String.fromCharCode(255&p))},d.ByteStringBuffer.prototype.putInt32=function(p){return this.putBytes(String.fromCharCode(p>>24&255)+String.fromCharCode(p>>16&255)+String.fromCharCode(p>>8&255)+String.fromCharCode(255&p))},d.ByteStringBuffer.prototype.putInt16Le=function(p){return this.putBytes(String.fromCharCode(255&p)+String.fromCharCode(p>>8&255))},d.ByteStringBuffer.prototype.putInt24Le=function(p){return this.putBytes(String.fromCharCode(255&p)+String.fromCharCode(p>>8&255)+String.fromCharCode(p>>16&255))},d.ByteStringBuffer.prototype.putInt32Le=function(p){return this.putBytes(String.fromCharCode(255&p)+String.fromCharCode(p>>8&255)+String.fromCharCode(p>>16&255)+String.fromCharCode(p>>24&255))},d.ByteStringBuffer.prototype.putInt=function(p,m){c(m);var S="";do{m-=8,S+=String.fromCharCode(p>>m&255)}while(m>0);return this.putBytes(S)},d.ByteStringBuffer.prototype.putSignedInt=function(p,m){return p<0&&(p+=2<<m-1),this.putInt(p,m)},d.ByteStringBuffer.prototype.putBuffer=function(p){return this.putBytes(p.getBytes())},d.ByteStringBuffer.prototype.getByte=function(){return this.data.charCodeAt(this.read++)},d.ByteStringBuffer.prototype.getInt16=function(){var p=this.data.charCodeAt(this.read)<<8^this.data.charCodeAt(this.read+1);return this.read+=2,p},d.ByteStringBuffer.prototype.getInt24=function(){var p=this.data.charCodeAt(this.read)<<16^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2);return this.read+=3,p},d.ByteStringBuffer.prototype.getInt32=function(){var p=this.data.charCodeAt(this.read)<<24^this.data.charCodeAt(this.read+1)<<16^this.data.charCodeAt(this.read+2)<<8^this.data.charCodeAt(this.read+3);return this.read+=4,p},d.ByteStringBuffer.prototype.getInt16Le=function(){var p=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8;return this.read+=2,p},d.ByteStringBuffer.prototype.getInt24Le=function(){var p=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16;return this.read+=3,p},d.ByteStringBuffer.prototype.getInt32Le=function(){var p=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16^this.data.charCodeAt(this.read+3)<<24;return this.read+=4,p},d.ByteStringBuffer.prototype.getInt=function(p){c(p);var m=0;do{m=(m<<8)+this.data.charCodeAt(this.read++),p-=8}while(p>0);return m},d.ByteStringBuffer.prototype.getSignedInt=function(p){var m=this.getInt(p),S=2<<p-2;return m>=S&&(m-=S<<1),m},d.ByteStringBuffer.prototype.getBytes=function(p){var m;return p?(p=Math.min(this.length(),p),m=this.data.slice(this.read,this.read+p),this.read+=p):0===p?m="":(m=0===this.read?this.data:this.data.slice(this.read),this.clear()),m},d.ByteStringBuffer.prototype.bytes=function(p){return typeof p>"u"?this.data.slice(this.read):this.data.slice(this.read,this.read+p)},d.ByteStringBuffer.prototype.at=function(p){return this.data.charCodeAt(this.read+p)},d.ByteStringBuffer.prototype.setAt=function(p,m){return this.data=this.data.substr(0,this.read+p)+String.fromCharCode(m)+this.data.substr(this.read+p+1),this},d.ByteStringBuffer.prototype.last=function(){return this.data.charCodeAt(this.data.length-1)},d.ByteStringBuffer.prototype.copy=function(){var p=d.createBuffer(this.data);return p.read=this.read,p},d.ByteStringBuffer.prototype.compact=function(){return this.read>0&&(this.data=this.data.slice(this.read),this.read=0),this},d.ByteStringBuffer.prototype.clear=function(){return this.data="",this.read=0,this},d.ByteStringBuffer.prototype.truncate=function(p){var m=Math.max(0,this.length()-p);return this.data=this.data.substr(this.read,m),this.read=0,this},d.ByteStringBuffer.prototype.toHex=function(){for(var p="",m=this.read;m<this.data.length;++m){var S=this.data.charCodeAt(m);S<16&&(p+="0"),p+=S.toString(16)}return p},d.ByteStringBuffer.prototype.toString=function(){return d.decodeUtf8(this.bytes())},d.DataBuffer=function v(p,m){this.read=(m=m||{}).readOffset||0,this.growSize=m.growSize||1024;var S=d.isArrayBuffer(p),O=d.isArrayBufferView(p);if(S||O)return this.data=S?new DataView(p):new DataView(p.buffer,p.byteOffset,p.byteLength),void(this.write="writeOffset"in m?m.writeOffset:this.data.byteLength);this.data=new DataView(new ArrayBuffer(0)),this.write=0,null!=p&&this.putBytes(p),"writeOffset"in m&&(this.write=m.writeOffset)},d.DataBuffer.prototype.length=function(){return this.write-this.read},d.DataBuffer.prototype.isEmpty=function(){return this.length()<=0},d.DataBuffer.prototype.accommodate=function(p,m){if(this.length()>=p)return this;m=Math.max(m||this.growSize,p);var S=new Uint8Array(this.data.buffer,this.data.byteOffset,this.data.byteLength),O=new Uint8Array(this.length()+m);return O.set(S),this.data=new DataView(O.buffer),this},d.DataBuffer.prototype.putByte=function(p){return this.accommodate(1),this.data.setUint8(this.write++,p),this},d.DataBuffer.prototype.fillWithByte=function(p,m){this.accommodate(m);for(var S=0;S<m;++S)this.data.setUint8(p);return this},d.DataBuffer.prototype.putBytes=function(p,m){if(d.isArrayBufferView(p)){var O=(S=new Uint8Array(p.buffer,p.byteOffset,p.byteLength)).byteLength-S.byteOffset;return this.accommodate(O),new Uint8Array(this.data.buffer,this.write).set(S),this.write+=O,this}if(d.isArrayBuffer(p)){var S=new Uint8Array(p);return this.accommodate(S.byteLength),new Uint8Array(this.data.buffer).set(S,this.write),this.write+=S.byteLength,this}if(p instanceof d.DataBuffer||"object"==typeof p&&"number"==typeof p.read&&"number"==typeof p.write&&d.isArrayBufferView(p.data))return S=new Uint8Array(p.data.byteLength,p.read,p.length()),this.accommodate(S.byteLength),new Uint8Array(p.data.byteLength,this.write).set(S),this.write+=S.byteLength,this;if(p instanceof d.ByteStringBuffer&&(p=p.data,m="binary"),m=m||"binary","string"==typeof p){var G;if("hex"===m)return this.accommodate(Math.ceil(p.length/2)),G=new Uint8Array(this.data.buffer,this.write),this.write+=d.binary.hex.decode(p,G,this.write),this;if("base64"===m)return this.accommodate(3*Math.ceil(p.length/4)),G=new Uint8Array(this.data.buffer,this.write),this.write+=d.binary.base64.decode(p,G,this.write),this;if("utf8"===m&&(p=d.encodeUtf8(p),m="binary"),"binary"===m||"raw"===m)return this.accommodate(p.length),G=new Uint8Array(this.data.buffer,this.write),this.write+=d.binary.raw.decode(G),this;if("utf16"===m)return this.accommodate(2*p.length),G=new Uint16Array(this.data.buffer,this.write),this.write+=d.text.utf16.encode(G),this;throw new Error("Invalid encoding: "+m)}throw Error("Invalid parameter: "+p)},d.DataBuffer.prototype.putBuffer=function(p){return this.putBytes(p),p.clear(),this},d.DataBuffer.prototype.putString=function(p){return this.putBytes(p,"utf16")},d.DataBuffer.prototype.putInt16=function(p){return this.accommodate(2),this.data.setInt16(this.write,p),this.write+=2,this},d.DataBuffer.prototype.putInt24=function(p){return this.accommodate(3),this.data.setInt16(this.write,p>>8&65535),this.data.setInt8(this.write,p>>16&255),this.write+=3,this},d.DataBuffer.prototype.putInt32=function(p){return this.accommodate(4),this.data.setInt32(this.write,p),this.write+=4,this},d.DataBuffer.prototype.putInt16Le=function(p){return this.accommodate(2),this.data.setInt16(this.write,p,!0),this.write+=2,this},d.DataBuffer.prototype.putInt24Le=function(p){return this.accommodate(3),this.data.setInt8(this.write,p>>16&255),this.data.setInt16(this.write,p>>8&65535,!0),this.write+=3,this},d.DataBuffer.prototype.putInt32Le=function(p){return this.accommodate(4),this.data.setInt32(this.write,p,!0),this.write+=4,this},d.DataBuffer.prototype.putInt=function(p,m){c(m),this.accommodate(m/8);do{m-=8,this.data.setInt8(this.write++,p>>m&255)}while(m>0);return this},d.DataBuffer.prototype.putSignedInt=function(p,m){return c(m),this.accommodate(m/8),p<0&&(p+=2<<m-1),this.putInt(p,m)},d.DataBuffer.prototype.getByte=function(){return this.data.getInt8(this.read++)},d.DataBuffer.prototype.getInt16=function(){var p=this.data.getInt16(this.read);return this.read+=2,p},d.DataBuffer.prototype.getInt24=function(){var p=this.data.getInt16(this.read)<<8^this.data.getInt8(this.read+2);return this.read+=3,p},d.DataBuffer.prototype.getInt32=function(){var p=this.data.getInt32(this.read);return this.read+=4,p},d.DataBuffer.prototype.getInt16Le=function(){var p=this.data.getInt16(this.read,!0);return this.read+=2,p},d.DataBuffer.prototype.getInt24Le=function(){var p=this.data.getInt8(this.read)^this.data.getInt16(this.read+1,!0)<<8;return this.read+=3,p},d.DataBuffer.prototype.getInt32Le=function(){var p=this.data.getInt32(this.read,!0);return this.read+=4,p},d.DataBuffer.prototype.getInt=function(p){c(p);var m=0;do{m=(m<<8)+this.data.getInt8(this.read++),p-=8}while(p>0);return m},d.DataBuffer.prototype.getSignedInt=function(p){var m=this.getInt(p),S=2<<p-2;return m>=S&&(m-=S<<1),m},d.DataBuffer.prototype.getBytes=function(p){var m;return p?(p=Math.min(this.length(),p),m=this.data.slice(this.read,this.read+p),this.read+=p):0===p?m="":(m=0===this.read?this.data:this.data.slice(this.read),this.clear()),m},d.DataBuffer.prototype.bytes=function(p){return typeof p>"u"?this.data.slice(this.read):this.data.slice(this.read,this.read+p)},d.DataBuffer.prototype.at=function(p){return this.data.getUint8(this.read+p)},d.DataBuffer.prototype.setAt=function(p,m){return this.data.setUint8(p,m),this},d.DataBuffer.prototype.last=function(){return this.data.getUint8(this.write-1)},d.DataBuffer.prototype.copy=function(){return new d.DataBuffer(this)},d.DataBuffer.prototype.compact=function(){if(this.read>0){var p=new Uint8Array(this.data.buffer,this.read),m=new Uint8Array(p.byteLength);m.set(p),this.data=new DataView(m),this.write-=this.read,this.read=0}return this},d.DataBuffer.prototype.clear=function(){return this.data=new DataView(new ArrayBuffer(0)),this.read=this.write=0,this},d.DataBuffer.prototype.truncate=function(p){return this.write=Math.max(0,this.length()-p),this.read=Math.min(this.read,this.write),this},d.DataBuffer.prototype.toHex=function(){for(var p="",m=this.read;m<this.data.byteLength;++m){var S=this.data.getUint8(m);S<16&&(p+="0"),p+=S.toString(16)}return p},d.DataBuffer.prototype.toString=function(p){var m=new Uint8Array(this.data,this.read,this.length());if("binary"===(p=p||"utf8")||"raw"===p)return d.binary.raw.encode(m);if("hex"===p)return d.binary.hex.encode(m);if("base64"===p)return d.binary.base64.encode(m);if("utf8"===p)return d.text.utf8.decode(m);if("utf16"===p)return d.text.utf16.decode(m);throw new Error("Invalid encoding: "+p)},d.createBuffer=function(p,m){return m=m||"raw",void 0!==p&&"utf8"===m&&(p=d.encodeUtf8(p)),new d.ByteBuffer(p)},d.fillString=function(p,m){for(var S="";m>0;)1&m&&(S+=p),(m>>>=1)>0&&(p+=p);return S},d.xorBytes=function(p,m,S){for(var O="",V="",G="",k=0,P=0;S>0;--S,++k)V=p.charCodeAt(k)^m.charCodeAt(k),P>=10&&(O+=G,G="",P=0),G+=String.fromCharCode(V),++P;return O+G},d.hexToBytes=function(p){var m="",S=0;for(!0&p.length&&(S=1,m+=String.fromCharCode(parseInt(p[0],16)));S<p.length;S+=2)m+=String.fromCharCode(parseInt(p.substr(S,2),16));return m},d.bytesToHex=function(p){return d.createBuffer(p).toHex()},d.int32ToBytes=function(p){return String.fromCharCode(p>>24&255)+String.fromCharCode(p>>16&255)+String.fromCharCode(p>>8&255)+String.fromCharCode(255&p)};var y="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",h=[62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,64,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51],x="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";d.encode64=function(p,m){for(var V,G,k,S="",O="",P=0;P<p.length;)V=p.charCodeAt(P++),G=p.charCodeAt(P++),k=p.charCodeAt(P++),S+=y.charAt(V>>2),S+=y.charAt((3&V)<<4|G>>4),isNaN(G)?S+="==":(S+=y.charAt((15&G)<<2|k>>6),S+=isNaN(k)?"=":y.charAt(63&k)),m&&S.length>m&&(O+=S.substr(0,m)+"\r\n",S=S.substr(m));return O+S},d.decode64=function(p){p=p.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var S,O,V,G,m="",k=0;k<p.length;)S=h[p.charCodeAt(k++)-43],O=h[p.charCodeAt(k++)-43],V=h[p.charCodeAt(k++)-43],G=h[p.charCodeAt(k++)-43],m+=String.fromCharCode(S<<2|O>>4),64!==V&&(m+=String.fromCharCode((15&O)<<4|V>>2),64!==G&&(m+=String.fromCharCode((3&V)<<6|G)));return m},d.encodeUtf8=function(p){return unescape(encodeURIComponent(p))},d.decodeUtf8=function(p){return decodeURIComponent(escape(p))},d.binary={raw:{},hex:{},base64:{},base58:{},baseN:{encode:i.encode,decode:i.decode}},d.binary.raw.encode=function(p){return String.fromCharCode.apply(null,p)},d.binary.raw.decode=function(p,m,S){var O=m;O||(O=new Uint8Array(p.length));for(var V=S=S||0,G=0;G<p.length;++G)O[V++]=p.charCodeAt(G);return m?V-S:O},d.binary.hex.encode=d.bytesToHex,d.binary.hex.decode=function(p,m,S){var O=m;O||(O=new Uint8Array(Math.ceil(p.length/2)));var V=0,G=S=S||0;for(1&p.length&&(V=1,O[G++]=parseInt(p[0],16));V<p.length;V+=2)O[G++]=parseInt(p.substr(V,2),16);return m?G-S:O},d.binary.base64.encode=function(p,m){for(var V,G,k,S="",O="",P=0;P<p.byteLength;)V=p[P++],G=p[P++],k=p[P++],S+=y.charAt(V>>2),S+=y.charAt((3&V)<<4|G>>4),isNaN(G)?S+="==":(S+=y.charAt((15&G)<<2|k>>6),S+=isNaN(k)?"=":y.charAt(63&k)),m&&S.length>m&&(O+=S.substr(0,m)+"\r\n",S=S.substr(m));return O+S},d.binary.base64.decode=function(p,m,S){var O=m;O||(O=new Uint8Array(3*Math.ceil(p.length/4))),p=p.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var V,G,k,P,D=0,l=S=S||0;D<p.length;)V=h[p.charCodeAt(D++)-43],G=h[p.charCodeAt(D++)-43],k=h[p.charCodeAt(D++)-43],P=h[p.charCodeAt(D++)-43],O[l++]=V<<2|G>>4,64!==k&&(O[l++]=(15&G)<<4|k>>2,64!==P&&(O[l++]=(3&k)<<6|P));return m?l-S:O.subarray(0,l)},d.binary.base58.encode=function(p,m){return d.binary.baseN.encode(p,x,m)},d.binary.base58.decode=function(p,m){return d.binary.baseN.decode(p,x,m)},d.text={utf8:{},utf16:{}},d.text.utf8.encode=function(p,m,S){p=d.encodeUtf8(p);var O=m;O||(O=new Uint8Array(p.length));for(var V=S=S||0,G=0;G<p.length;++G)O[V++]=p.charCodeAt(G);return m?V-S:O},d.text.utf8.decode=function(p){return d.decodeUtf8(String.fromCharCode.apply(null,p))},d.text.utf16.encode=function(p,m,S){var O=m;O||(O=new Uint8Array(2*p.length));for(var V=new Uint16Array(O.buffer),G=S=S||0,k=S,P=0;P<p.length;++P)V[k++]=p.charCodeAt(P),G+=2;return m?G-S:O},d.text.utf16.decode=function(p){return String.fromCharCode.apply(null,new Uint16Array(p.buffer))},d.deflate=function(p,m,S){if(m=d.decode64(p.deflate(d.encode64(m)).rval),S){var O=2;32&m.charCodeAt(1)&&(O=6),m=m.substring(O,m.length-4)}return m},d.inflate=function(p,m,S){var O=p.inflate(d.encode64(m)).rval;return null===O?null:d.decode64(O)};var A=function(p,m,S){if(!p)throw new Error("WebStorage not available.");var O;if(null===S?O=p.removeItem(m):(S=d.encode64(JSON.stringify(S)),O=p.setItem(m,S)),typeof O<"u"&&!0!==O.rval){var V=new Error(O.error.message);throw V.id=O.error.id,V.name=O.error.name,V}},H=function(p,m){if(!p)throw new Error("WebStorage not available.");var S=p.getItem(m);if(p.init)if(null===S.rval){if(S.error){var O=new Error(S.error.message);throw O.id=S.error.id,O.name=S.error.name,O}S=null}else S=S.rval;return null!==S&&(S=JSON.parse(d.decode64(S))),S},C=function(p,m,S,O){var V=H(p,m);null===V&&(V={}),V[S]=O,A(p,m,V)},_=function(p,m,S){var O=H(p,m);return null!==O&&(O=S in O?O[S]:null),O},N=function(p,m,S){var O=H(p,m);if(null!==O&&S in O){delete O[S];var V=!0;for(var G in O){V=!1;break}V&&(O=null),A(p,m,O)}},T=function(p,m){A(p,m,null)},I=function(p,m,S){var O=null;typeof S>"u"&&(S=["web","flash"]);var V,G=!1,k=null;for(var P in S){V=S[P];try{if("flash"===V||"both"===V){if(null===m[0])throw new Error("Flash local storage not available.");O=p.apply(this,m),G="flash"===V}("web"===V||"both"===V)&&(m[0]=localStorage,O=p.apply(this,m),G=!0)}catch(D){k=D}if(G)break}if(!G)throw k;return O};d.setItem=function(p,m,S,O,V){I(C,arguments,V)},d.getItem=function(p,m,S,O){return I(_,arguments,O)},d.removeItem=function(p,m,S,O){I(N,arguments,O)},d.clearItems=function(p,m,S){I(T,arguments,S)},d.isEmpty=function(p){for(var m in p)if(p.hasOwnProperty(m))return!1;return!0},d.format=function(p){for(var S,O,m=/%./g,V=0,G=[],k=0;S=m.exec(p);){(O=p.substring(k,m.lastIndex-2)).length>0&&G.push(O),k=m.lastIndex;var P=S[0][1];switch(P){case"s":case"o":G.push(V<arguments.length?arguments[1+V++]:"<?>");break;case"%":G.push("%");break;default:G.push("<%"+P+"?>")}}return G.push(p.substring(k)),G.join("")},d.formatNumber=function(p,m,S,O){var V=p,G=isNaN(m=Math.abs(m))?2:m,k=void 0===S?",":S,P=void 0===O?".":O,D=V<0?"-":"",l=parseInt(V=Math.abs(+V||0).toFixed(G),10)+"",F=l.length>3?l.length%3:0;return D+(F?l.substr(0,F)+P:"")+l.substr(F).replace(/(\d{3})(?=\d)/g,"$1"+P)+(G?k+Math.abs(V-l).toFixed(G).slice(2):"")},d.formatSize=function(p){return p>=1073741824?d.formatNumber(p/1073741824,2,".","")+" GiB":p>=1048576?d.formatNumber(p/1048576,2,".","")+" MiB":p>=1024?d.formatNumber(p/1024,0)+" KiB":d.formatNumber(p,0)+" bytes"},d.bytesFromIP=function(p){return-1!==p.indexOf(".")?d.bytesFromIPv4(p):-1!==p.indexOf(":")?d.bytesFromIPv6(p):null},d.bytesFromIPv4=function(p){if(4!==(p=p.split(".")).length)return null;for(var m=d.createBuffer(),S=0;S<p.length;++S){var O=parseInt(p[S],10);if(isNaN(O))return null;m.putByte(O)}return m.getBytes()},d.bytesFromIPv6=function(p){for(var m=0,S=2*(8-(p=p.split(":").filter(function(k){return 0===k.length&&++m,!0})).length+m),O=d.createBuffer(),V=0;V<8;++V)if(p[V]&&0!==p[V].length){var G=d.hexToBytes(p[V]);G.length<2&&O.putByte(0),O.putBytes(G)}else O.fillWithByte(0,S),S=0;return O.getBytes()},d.bytesToIP=function(p){return 4===p.length?d.bytesToIPv4(p):16===p.length?d.bytesToIPv6(p):null},d.bytesToIPv4=function(p){if(4!==p.length)return null;for(var m=[],S=0;S<p.length;++S)m.push(p.charCodeAt(S));return m.join(".")},d.bytesToIPv6=function(p){if(16!==p.length)return null;for(var m=[],S=[],O=0,V=0;V<p.length;V+=2){for(var G=d.bytesToHex(p[V]+p[V+1]);"0"===G[0]&&"0"!==G;)G=G.substr(1);if("0"===G){var k=S[S.length-1],P=m.length;k&&P===k.end+1?(k.end=P,k.end-k.start>S[O].end-S[O].start&&(O=S.length-1)):S.push({start:P,end:P})}m.push(G)}if(S.length>0){var D=S[O];D.end-D.start>0&&(m.splice(D.start,D.end-D.start+1,""),0===D.start&&m.unshift(""),7===D.end&&m.push(""))}return m.join(":")},d.estimateCores=function(p,m){if("function"==typeof p&&(m=p,p={}),p=p||{},"cores"in d&&!p.update)return m(null,d.cores);if(typeof navigator<"u"&&"hardwareConcurrency"in navigator&&navigator.hardwareConcurrency>0)return d.cores=navigator.hardwareConcurrency,m(null,d.cores);if(typeof Worker>"u")return d.cores=1,m(null,d.cores);if(typeof Blob>"u")return d.cores=2,m(null,d.cores);var S=URL.createObjectURL(new Blob(["(",function(){self.addEventListener("message",function(k){for(var P=Date.now(),D=P+4;Date.now()<D;);self.postMessage({st:P,et:D})})}.toString(),")()"],{type:"application/javascript"}));!function O(k,P,D){if(0===P){var l=Math.floor(k.reduce(function(F,Y){return F+Y},0)/k.length);return d.cores=Math.max(1,l),URL.revokeObjectURL(S),m(null,d.cores)}!function V(k,P){for(var D=[],l=[],F=0;F<k;++F){var Y=new Worker(S);Y.addEventListener("message",function(W){if(l.push(W.data),l.length===k){for(var ne=0;ne<k;++ne)D[ne].terminate();P(null,l)}}),D.push(Y)}for(F=0;F<k;++F)D[F].postMessage(F)}(D,function(F,Y){k.push(function G(k,P){for(var D=[],l=0;l<k;++l)for(var F=P[l],Y=D[l]=[],W=0;W<k;++W)if(l!==W){var ne=P[W];(F.st>ne.st&&F.st<ne.et||ne.st>F.st&&ne.st<F.et)&&Y.push(W)}return D.reduce(function(de,Ae){return Math.max(de,Ae.length)},0)}(D,Y)),O(k,P-1,D)})}([],5,16)}},5911:(De,J,M)=>{var s=M(8659);M(1298),M(7791),M(279),M(979),M(9386),M(6078),M(8604),M(7256),M(5517),M(4747);var i=s.asn1,d=De.exports=s.pki=s.pki||{},c=d.oids,B={};B.CN=c.commonName,B.commonName="CN",B.C=c.countryName,B.countryName="C",B.L=c.localityName,B.localityName="L",B.ST=c.stateOrProvinceName,B.stateOrProvinceName="ST",B.O=c.organizationName,B.organizationName="O",B.OU=c.organizationalUnitName,B.organizationalUnitName="OU",B.E=c.emailAddress,B.emailAddress="E";var E=s.pki.rsa.publicKeyValidator,v={name:"Certificate",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,captureAsn1:"tbsCertificate",value:[{name:"Certificate.TBSCertificate.version",tagClass:i.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.version.integer",tagClass:i.Class.UNIVERSAL,type:i.Type.INTEGER,constructed:!1,capture:"certVersion"}]},{name:"Certificate.TBSCertificate.serialNumber",tagClass:i.Class.UNIVERSAL,type:i.Type.INTEGER,constructed:!1,capture:"certSerialNumber"},{name:"Certificate.TBSCertificate.signature",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.signature.algorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:!1,capture:"certinfoSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:i.Class.UNIVERSAL,optional:!0,captureAsn1:"certinfoSignatureParams"}]},{name:"Certificate.TBSCertificate.issuer",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,captureAsn1:"certIssuer"},{name:"Certificate.TBSCertificate.validity",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.validity.notBefore (utc)",tagClass:i.Class.UNIVERSAL,type:i.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity1UTCTime"},{name:"Certificate.TBSCertificate.validity.notBefore (generalized)",tagClass:i.Class.UNIVERSAL,type:i.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity2GeneralizedTime"},{name:"Certificate.TBSCertificate.validity.notAfter (utc)",tagClass:i.Class.UNIVERSAL,type:i.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity3UTCTime"},{name:"Certificate.TBSCertificate.validity.notAfter (generalized)",tagClass:i.Class.UNIVERSAL,type:i.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity4GeneralizedTime"}]},{name:"Certificate.TBSCertificate.subject",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,captureAsn1:"certSubject"},E,{name:"Certificate.TBSCertificate.issuerUniqueID",tagClass:i.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.issuerUniqueID.id",tagClass:i.Class.UNIVERSAL,type:i.Type.BITSTRING,constructed:!1,captureBitStringValue:"certIssuerUniqueId"}]},{name:"Certificate.TBSCertificate.subjectUniqueID",tagClass:i.Class.CONTEXT_SPECIFIC,type:2,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.subjectUniqueID.id",tagClass:i.Class.UNIVERSAL,type:i.Type.BITSTRING,constructed:!1,captureBitStringValue:"certSubjectUniqueId"}]},{name:"Certificate.TBSCertificate.extensions",tagClass:i.Class.CONTEXT_SPECIFIC,type:3,constructed:!0,captureAsn1:"certExtensions",optional:!0}]},{name:"Certificate.signatureAlgorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.signatureAlgorithm.algorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:!1,capture:"certSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:i.Class.UNIVERSAL,optional:!0,captureAsn1:"certSignatureParams"}]},{name:"Certificate.signatureValue",tagClass:i.Class.UNIVERSAL,type:i.Type.BITSTRING,constructed:!1,captureBitStringValue:"certSignature"}]},y={name:"rsapss",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.hashAlgorithm",tagClass:i.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier",tagClass:i.Class.UNIVERSAL,type:i.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier.algorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:!1,capture:"hashOid"}]}]},{name:"rsapss.maskGenAlgorithm",tagClass:i.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier",tagClass:i.Class.UNIVERSAL,type:i.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.algorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:!1,capture:"maskGenOid"},{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params.algorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:!1,capture:"maskGenHashOid"}]}]}]},{name:"rsapss.saltLength",tagClass:i.Class.CONTEXT_SPECIFIC,type:2,optional:!0,value:[{name:"rsapss.saltLength.saltLength",tagClass:i.Class.UNIVERSAL,type:i.Class.INTEGER,constructed:!1,capture:"saltLength"}]},{name:"rsapss.trailerField",tagClass:i.Class.CONTEXT_SPECIFIC,type:3,optional:!0,value:[{name:"rsapss.trailer.trailer",tagClass:i.Class.UNIVERSAL,type:i.Class.INTEGER,constructed:!1,capture:"trailer"}]}]},x={name:"CertificationRequest",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,captureAsn1:"csr",value:[{name:"CertificationRequestInfo",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfo",value:[{name:"CertificationRequestInfo.integer",tagClass:i.Class.UNIVERSAL,type:i.Type.INTEGER,constructed:!1,capture:"certificationRequestInfoVersion"},{name:"CertificationRequestInfo.subject",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfoSubject"},E,{name:"CertificationRequestInfo.attributes",tagClass:i.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"certificationRequestInfoAttributes",value:[{name:"CertificationRequestInfo.attributes",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequestInfo.attributes.type",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:!1},{name:"CertificationRequestInfo.attributes.value",tagClass:i.Class.UNIVERSAL,type:i.Type.SET,constructed:!0}]}]}]},{name:"CertificationRequest.signatureAlgorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequest.signatureAlgorithm.algorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:!1,capture:"csrSignatureOid"},{name:"CertificationRequest.signatureAlgorithm.parameters",tagClass:i.Class.UNIVERSAL,optional:!0,captureAsn1:"csrSignatureParams"}]},{name:"CertificationRequest.signature",tagClass:i.Class.UNIVERSAL,type:i.Type.BITSTRING,constructed:!1,captureBitStringValue:"csrSignature"}]};function A(k,P){"string"==typeof P&&(P={shortName:P});for(var l,D=null,F=0;null===D&&F<k.attributes.length;++F)l=k.attributes[F],(P.type&&P.type===l.type||P.name&&P.name===l.name||P.shortName&&P.shortName===l.shortName)&&(D=l);return D}d.RDNAttributesAsArray=function(k,P){for(var l,F,Y,D=[],W=0;W<k.value.length;++W){l=k.value[W];for(var ne=0;ne<l.value.length;++ne)(Y={}).type=i.derToOid((F=l.value[ne]).value[0].value),Y.value=F.value[1].value,Y.valueTagClass=F.value[1].type,Y.type in c&&(Y.name=c[Y.type],Y.name in B&&(Y.shortName=B[Y.name])),P&&(P.update(Y.type),P.update(Y.value)),D.push(Y)}return D},d.CRIAttributesAsArray=function(k){for(var P=[],D=0;D<k.length;++D)for(var l=k[D],F=i.derToOid(l.value[0].value),Y=l.value[1].value,W=0;W<Y.length;++W){var ne={};if(ne.type=F,ne.value=Y[W].value,ne.valueTagClass=Y[W].type,ne.type in c&&(ne.name=c[ne.type],ne.name in B&&(ne.shortName=B[ne.name])),ne.type===c.extensionRequest){ne.extensions=[];for(var de=0;de<ne.value.length;++de)ne.extensions.push(d.certificateExtensionFromAsn1(ne.value[de]))}P.push(ne)}return P};var H=function(k,P,D){var l={};if(k!==c["RSASSA-PSS"])return l;D&&(l={hash:{algorithmOid:c.sha1},mgf:{algorithmOid:c.mgf1,hash:{algorithmOid:c.sha1}},saltLength:20});var F={},Y=[];if(!i.validate(P,y,F,Y)){var W=new Error("Cannot read RSASSA-PSS parameter block.");throw W.errors=Y,W}return void 0!==F.hashOid&&(l.hash=l.hash||{},l.hash.algorithmOid=i.derToOid(F.hashOid)),void 0!==F.maskGenOid&&(l.mgf=l.mgf||{},l.mgf.algorithmOid=i.derToOid(F.maskGenOid),l.mgf.hash=l.mgf.hash||{},l.mgf.hash.algorithmOid=i.derToOid(F.maskGenHashOid)),void 0!==F.saltLength&&(l.saltLength=F.saltLength.charCodeAt(0)),l},C=function(k){switch(c[k.signatureOid]){case"sha1WithRSAEncryption":case"sha1WithRSASignature":return s.md.sha1.create();case"md5WithRSAEncryption":return s.md.md5.create();case"sha256WithRSAEncryption":case"RSASSA-PSS":return s.md.sha256.create();case"sha384WithRSAEncryption":return s.md.sha384.create();case"sha512WithRSAEncryption":return s.md.sha512.create();default:var P=new Error("Could not compute "+k.type+" digest. Unknown signature OID.");throw P.signatureOid=k.signatureOid,P}},_=function(k){var D,P=k.certificate;switch(P.signatureOid){case c.sha1WithRSAEncryption:case c.sha1WithRSASignature:break;case c["RSASSA-PSS"]:var l,F,Y;if(void 0===(l=c[P.signatureParameters.mgf.hash.algorithmOid])||void 0===s.md[l])throw(Y=new Error("Unsupported MGF hash function.")).oid=P.signatureParameters.mgf.hash.algorithmOid,Y.name=l,Y;if(void 0===(F=c[P.signatureParameters.mgf.algorithmOid])||void 0===s.mgf[F])throw(Y=new Error("Unsupported MGF function.")).oid=P.signatureParameters.mgf.algorithmOid,Y.name=F,Y;if(F=s.mgf[F].create(s.md[l].create()),void 0===(l=c[P.signatureParameters.hash.algorithmOid])||void 0===s.md[l])throw(Y=new Error("Unsupported RSASSA-PSS hash function.")).oid=P.signatureParameters.hash.algorithmOid,Y.name=l,Y;D=s.pss.create(s.md[l].create(),F,P.signatureParameters.saltLength)}return P.publicKey.verify(k.md.digest().getBytes(),k.signature,D)};function N(k){for(var D,l,P=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[]),F=k.attributes,Y=0;Y<F.length;++Y){var W=(D=F[Y]).value,ne=i.Type.PRINTABLESTRING;"valueTagClass"in D&&(ne=D.valueTagClass)===i.Type.UTF8&&(W=s.util.encodeUtf8(W)),l=i.create(i.Class.UNIVERSAL,i.Type.SET,!0,[i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(D.type).getBytes()),i.create(i.Class.UNIVERSAL,ne,!1,W)])]),P.value.push(l)}return P}function I(k){for(var P,D=0;D<k.length;++D){if(typeof(P=k[D]).name>"u"&&(P.type&&P.type in d.oids?P.name=d.oids[P.type]:P.shortName&&P.shortName in B&&(P.name=d.oids[B[P.shortName]])),typeof P.type>"u"){if(!P.name||!(P.name in d.oids))throw(l=new Error("Attribute type not specified.")).attribute=P,l;P.type=d.oids[P.name]}if(typeof P.shortName>"u"&&P.name&&P.name in B&&(P.shortName=B[P.name]),P.type===c.extensionRequest&&(P.valueConstructed=!0,P.valueTagClass=i.Type.SEQUENCE,!P.value&&P.extensions)){P.value=[];for(var F=0;F<P.extensions.length;++F)P.value.push(d.certificateExtensionToAsn1(p(P.extensions[F])))}var l;if(typeof P.value>"u")throw(l=new Error("Attribute value not specified.")).attribute=P,l}}function p(k,P){if(P=P||{},typeof k.name>"u"&&k.id&&k.id in d.oids&&(k.name=d.oids[k.id]),typeof k.id>"u"){if(!k.name||!(k.name in d.oids))throw(D=new Error("Extension ID not specified.")).extension=k,D;k.id=d.oids[k.name]}if(typeof k.value<"u")return k;if("keyUsage"===k.name){var l=0,F=0,Y=0;k.digitalSignature&&(F|=128,l=7),k.nonRepudiation&&(F|=64,l=6),k.keyEncipherment&&(F|=32,l=5),k.dataEncipherment&&(F|=16,l=4),k.keyAgreement&&(F|=8,l=3),k.keyCertSign&&(F|=4,l=2),k.cRLSign&&(F|=2,l=1),k.encipherOnly&&(F|=1,l=0),k.decipherOnly&&(Y|=128,l=7);var W=String.fromCharCode(l);0!==Y?W+=String.fromCharCode(F)+String.fromCharCode(Y):0!==F&&(W+=String.fromCharCode(F)),k.value=i.create(i.Class.UNIVERSAL,i.Type.BITSTRING,!1,W)}else if("basicConstraints"===k.name)k.value=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[]),k.cA&&k.value.value.push(i.create(i.Class.UNIVERSAL,i.Type.BOOLEAN,!1,String.fromCharCode(255))),"pathLenConstraint"in k&&k.value.value.push(i.create(i.Class.UNIVERSAL,i.Type.INTEGER,!1,i.integerToDer(k.pathLenConstraint).getBytes()));else if("extKeyUsage"===k.name){k.value=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[]);var ne=k.value.value;for(var de in k)!0===k[de]&&(de in c?ne.push(i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(c[de]).getBytes())):-1!==de.indexOf(".")&&ne.push(i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(de).getBytes())))}else if("nsCertType"===k.name)l=0,F=0,k.client&&(F|=128,l=7),k.server&&(F|=64,l=6),k.email&&(F|=32,l=5),k.objsign&&(F|=16,l=4),k.reserved&&(F|=8,l=3),k.sslCA&&(F|=4,l=2),k.emailCA&&(F|=2,l=1),k.objCA&&(F|=1,l=0),W=String.fromCharCode(l),0!==F&&(W+=String.fromCharCode(F)),k.value=i.create(i.Class.UNIVERSAL,i.Type.BITSTRING,!1,W);else if("subjectAltName"===k.name||"issuerAltName"===k.name){k.value=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[]);for(var Re=0;Re<k.altNames.length;++Re){if(W=(Ae=k.altNames[Re]).value,7===Ae.type&&Ae.ip){if(null===(W=s.util.bytesFromIP(Ae.ip)))throw(D=new Error('Extension "ip" value is not a valid IPv4 or IPv6 address.')).extension=k,D}else 8===Ae.type&&(W=i.oidToDer(Ae.oid?i.oidToDer(Ae.oid):W));k.value.value.push(i.create(i.Class.CONTEXT_SPECIFIC,Ae.type,!1,W))}}else if("nsComment"===k.name&&P.cert){if(!/^[\x00-\x7F]*$/.test(k.comment)||k.comment.length<1||k.comment.length>128)throw new Error('Invalid "nsComment" content.');k.value=i.create(i.Class.UNIVERSAL,i.Type.IA5STRING,!1,k.comment)}else if("subjectKeyIdentifier"===k.name&&P.cert){var Fe=P.cert.generateSubjectKeyIdentifier();k.subjectKeyIdentifier=Fe.toHex(),k.value=i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,!1,Fe.getBytes())}else if("authorityKeyIdentifier"===k.name&&P.cert){if(k.value=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[]),ne=k.value.value,k.keyIdentifier){var be=!0===k.keyIdentifier?P.cert.generateSubjectKeyIdentifier().getBytes():k.keyIdentifier;ne.push(i.create(i.Class.CONTEXT_SPECIFIC,0,!1,be))}if(k.authorityCertIssuer){var Pe=[i.create(i.Class.CONTEXT_SPECIFIC,4,!0,[N(!0===k.authorityCertIssuer?P.cert.issuer:k.authorityCertIssuer)])];ne.push(i.create(i.Class.CONTEXT_SPECIFIC,1,!0,Pe))}if(k.serialNumber){var We=s.util.hexToBytes(!0===k.serialNumber?P.cert.serialNumber:k.serialNumber);ne.push(i.create(i.Class.CONTEXT_SPECIFIC,2,!1,We))}}else if("cRLDistributionPoints"===k.name){k.value=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[]),ne=k.value.value;var Ae,Ze=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[]),Ct=i.create(i.Class.CONTEXT_SPECIFIC,0,!0,[]);for(Re=0;Re<k.altNames.length;++Re){if(W=(Ae=k.altNames[Re]).value,7===Ae.type&&Ae.ip){if(null===(W=s.util.bytesFromIP(Ae.ip)))throw(D=new Error('Extension "ip" value is not a valid IPv4 or IPv6 address.')).extension=k,D}else 8===Ae.type&&(W=i.oidToDer(Ae.oid?i.oidToDer(Ae.oid):W));Ct.value.push(i.create(i.Class.CONTEXT_SPECIFIC,Ae.type,!1,W))}Ze.value.push(i.create(i.Class.CONTEXT_SPECIFIC,0,!0,[Ct])),ne.push(Ze)}var D;if(typeof k.value>"u")throw(D=new Error("Extension value not specified.")).extension=k,D;return k}function m(k,P){if(k===c["RSASSA-PSS"]){var D=[];return void 0!==P.hash.algorithmOid&&D.push(i.create(i.Class.CONTEXT_SPECIFIC,0,!0,[i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(P.hash.algorithmOid).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.NULL,!1,"")])])),void 0!==P.mgf.algorithmOid&&D.push(i.create(i.Class.CONTEXT_SPECIFIC,1,!0,[i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(P.mgf.algorithmOid).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(P.mgf.hash.algorithmOid).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.NULL,!1,"")])])])),void 0!==P.saltLength&&D.push(i.create(i.Class.CONTEXT_SPECIFIC,2,!0,[i.create(i.Class.UNIVERSAL,i.Type.INTEGER,!1,i.integerToDer(P.saltLength).getBytes())])),i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,D)}return i.create(i.Class.UNIVERSAL,i.Type.NULL,!1,"")}function S(k){var P=i.create(i.Class.CONTEXT_SPECIFIC,0,!0,[]);if(0===k.attributes.length)return P;for(var D=k.attributes,l=0;l<D.length;++l){var F=D[l],Y=F.value,W=i.Type.UTF8;"valueTagClass"in F&&(W=F.valueTagClass),W===i.Type.UTF8&&(Y=s.util.encodeUtf8(Y));var ne=!1;"valueConstructed"in F&&(ne=F.valueConstructed);var de=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(F.type).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.SET,!0,[i.create(i.Class.UNIVERSAL,W,ne,Y)])]);P.value.push(de)}return P}d.certificateFromPem=function(k,P,D){var l=s.pem.decode(k)[0];if("CERTIFICATE"!==l.type&&"X509 CERTIFICATE"!==l.type&&"TRUSTED CERTIFICATE"!==l.type){var F=new Error('Could not convert certificate from PEM; PEM header type is not "CERTIFICATE", "X509 CERTIFICATE", or "TRUSTED CERTIFICATE".');throw F.headerType=l.type,F}if(l.procType&&"ENCRYPTED"===l.procType.type)throw new Error("Could not convert certificate from PEM; PEM is encrypted.");var Y=i.fromDer(l.body,D);return d.certificateFromAsn1(Y,P)},d.certificateToPem=function(k,P){var D={type:"CERTIFICATE",body:i.toDer(d.certificateToAsn1(k)).getBytes()};return s.pem.encode(D,{maxline:P})},d.publicKeyFromPem=function(k){var P=s.pem.decode(k)[0];if("PUBLIC KEY"!==P.type&&"RSA PUBLIC KEY"!==P.type){var D=new Error('Could not convert public key from PEM; PEM header type is not "PUBLIC KEY" or "RSA PUBLIC KEY".');throw D.headerType=P.type,D}if(P.procType&&"ENCRYPTED"===P.procType.type)throw new Error("Could not convert public key from PEM; PEM is encrypted.");var l=i.fromDer(P.body);return d.publicKeyFromAsn1(l)},d.publicKeyToPem=function(k,P){var D={type:"PUBLIC KEY",body:i.toDer(d.publicKeyToAsn1(k)).getBytes()};return s.pem.encode(D,{maxline:P})},d.publicKeyToRSAPublicKeyPem=function(k,P){var D={type:"RSA PUBLIC KEY",body:i.toDer(d.publicKeyToRSAPublicKey(k)).getBytes()};return s.pem.encode(D,{maxline:P})},d.getPublicKeyFingerprint=function(k,P){var F,D=(P=P||{}).md||s.md.sha1.create();switch(P.type||"RSAPublicKey"){case"RSAPublicKey":F=i.toDer(d.publicKeyToRSAPublicKey(k)).getBytes();break;case"SubjectPublicKeyInfo":F=i.toDer(d.publicKeyToAsn1(k)).getBytes();break;default:throw new Error('Unknown fingerprint type "'+P.type+'".')}D.start(),D.update(F);var Y=D.digest();if("hex"===P.encoding){var W=Y.toHex();return P.delimiter?W.match(/.{2}/g).join(P.delimiter):W}if("binary"===P.encoding)return Y.getBytes();if(P.encoding)throw new Error('Unknown encoding "'+P.encoding+'".');return Y},d.certificationRequestFromPem=function(k,P,D){var l=s.pem.decode(k)[0];if("CERTIFICATE REQUEST"!==l.type){var F=new Error('Could not convert certification request from PEM; PEM header type is not "CERTIFICATE REQUEST".');throw F.headerType=l.type,F}if(l.procType&&"ENCRYPTED"===l.procType.type)throw new Error("Could not convert certification request from PEM; PEM is encrypted.");var Y=i.fromDer(l.body,D);return d.certificationRequestFromAsn1(Y,P)},d.certificationRequestToPem=function(k,P){var D={type:"CERTIFICATE REQUEST",body:i.toDer(d.certificationRequestToAsn1(k)).getBytes()};return s.pem.encode(D,{maxline:P})},d.createCertificate=function(){var k={version:2,serialNumber:"00",signatureOid:null,signature:null,siginfo:{}};return k.siginfo.algorithmOid=null,k.validity={},k.validity.notBefore=new Date,k.validity.notAfter=new Date,k.issuer={},k.issuer.getField=function(P){return A(k.issuer,P)},k.issuer.addField=function(P){I([P]),k.issuer.attributes.push(P)},k.issuer.attributes=[],k.issuer.hash=null,k.subject={},k.subject.getField=function(P){return A(k.subject,P)},k.subject.addField=function(P){I([P]),k.subject.attributes.push(P)},k.subject.attributes=[],k.subject.hash=null,k.extensions=[],k.publicKey=null,k.md=null,k.setSubject=function(P,D){I(P),k.subject.attributes=P,delete k.subject.uniqueId,D&&(k.subject.uniqueId=D),k.subject.hash=null},k.setIssuer=function(P,D){I(P),k.issuer.attributes=P,delete k.issuer.uniqueId,D&&(k.issuer.uniqueId=D),k.issuer.hash=null},k.setExtensions=function(P){for(var D=0;D<P.length;++D)p(P[D],{cert:k});k.extensions=P},k.getExtension=function(P){"string"==typeof P&&(P={name:P});for(var l,D=null,F=0;null===D&&F<k.extensions.length;++F)l=k.extensions[F],(P.id&&l.id===P.id||P.name&&l.name===P.name)&&(D=l);return D},k.sign=function(P,D){k.md=D||s.md.sha1.create();var l=c[k.md.algorithm+"WithRSAEncryption"];if(!l){var F=new Error("Could not compute certificate digest. Unknown message digest algorithm OID.");throw F.algorithm=k.md.algorithm,F}k.signatureOid=k.siginfo.algorithmOid=l,k.tbsCertificate=d.getTBSCertificate(k);var Y=i.toDer(k.tbsCertificate);k.md.update(Y.getBytes()),k.signature=P.sign(k.md)},k.verify=function(P){var D=!1;if(!k.issued(P)){var l=P.issuer,F=k.subject,Y=new Error("The parent certificate did not issue the given child certificate; the child certificate's issuer does not match the parent's subject.");throw Y.expectedIssuer=F.attributes,Y.actualIssuer=l.attributes,Y}var W=P.md;if(null===W){W=C({signatureOid:P.signatureOid,type:"certificate"});var ne=P.tbsCertificate||d.getTBSCertificate(P),de=i.toDer(ne);W.update(de.getBytes())}return null!==W&&(D=_({certificate:k,md:W,signature:P.signature})),D},k.isIssuer=function(P){var D=!1,l=k.issuer,F=P.subject;if(l.hash&&F.hash)D=l.hash===F.hash;else if(l.attributes.length===F.attributes.length){D=!0;for(var Y,W,ne=0;D&&ne<l.attributes.length;++ne)((Y=l.attributes[ne]).type!==(W=F.attributes[ne]).type||Y.value!==W.value)&&(D=!1)}return D},k.issued=function(P){return P.isIssuer(k)},k.generateSubjectKeyIdentifier=function(){return d.getPublicKeyFingerprint(k.publicKey,{type:"RSAPublicKey"})},k.verifySubjectKeyIdentifier=function(){for(var P=c.subjectKeyIdentifier,D=0;D<k.extensions.length;++D){var l=k.extensions[D];if(l.id===P){var F=k.generateSubjectKeyIdentifier().getBytes();return s.util.hexToBytes(l.subjectKeyIdentifier)===F}}return!1},k},d.certificateFromAsn1=function(k,P){var D={},l=[];if(!i.validate(k,v,D,l)){var F=new Error("Cannot read X.509 certificate. ASN.1 object is not an X509v3 Certificate.");throw F.errors=l,F}if(i.derToOid(D.publicKeyOid)!==d.oids.rsaEncryption)throw new Error("Cannot read public key. OID is not RSA.");var W=d.createCertificate();W.version=D.certVersion?D.certVersion.charCodeAt(0):0;var ne=s.util.createBuffer(D.certSerialNumber);W.serialNumber=ne.toHex(),W.signatureOid=s.asn1.derToOid(D.certSignatureOid),W.signatureParameters=H(W.signatureOid,D.certSignatureParams,!0),W.siginfo.algorithmOid=s.asn1.derToOid(D.certinfoSignatureOid),W.siginfo.parameters=H(W.siginfo.algorithmOid,D.certinfoSignatureParams,!1),W.signature=D.certSignature;var de=[];if(void 0!==D.certValidity1UTCTime&&de.push(i.utcTimeToDate(D.certValidity1UTCTime)),void 0!==D.certValidity2GeneralizedTime&&de.push(i.generalizedTimeToDate(D.certValidity2GeneralizedTime)),void 0!==D.certValidity3UTCTime&&de.push(i.utcTimeToDate(D.certValidity3UTCTime)),void 0!==D.certValidity4GeneralizedTime&&de.push(i.generalizedTimeToDate(D.certValidity4GeneralizedTime)),de.length>2)throw new Error("Cannot read notBefore/notAfter validity times; more than two times were provided in the certificate.");if(de.length<2)throw new Error("Cannot read notBefore/notAfter validity times; they were not provided as either UTCTime or GeneralizedTime.");if(W.validity.notBefore=de[0],W.validity.notAfter=de[1],W.tbsCertificate=D.tbsCertificate,P){W.md=C({signatureOid:W.signatureOid,type:"certificate"});var Ae=i.toDer(W.tbsCertificate);W.md.update(Ae.getBytes())}var Re=s.md.sha1.create(),Fe=i.toDer(D.certIssuer);Re.update(Fe.getBytes()),W.issuer.getField=function(We){return A(W.issuer,We)},W.issuer.addField=function(We){I([We]),W.issuer.attributes.push(We)},W.issuer.attributes=d.RDNAttributesAsArray(D.certIssuer),D.certIssuerUniqueId&&(W.issuer.uniqueId=D.certIssuerUniqueId),W.issuer.hash=Re.digest().toHex();var be=s.md.sha1.create(),Pe=i.toDer(D.certSubject);return be.update(Pe.getBytes()),W.subject.getField=function(We){return A(W.subject,We)},W.subject.addField=function(We){I([We]),W.subject.attributes.push(We)},W.subject.attributes=d.RDNAttributesAsArray(D.certSubject),D.certSubjectUniqueId&&(W.subject.uniqueId=D.certSubjectUniqueId),W.subject.hash=be.digest().toHex(),W.extensions=D.certExtensions?d.certificateExtensionsFromAsn1(D.certExtensions):[],W.publicKey=d.publicKeyFromAsn1(D.subjectPublicKeyInfo),W},d.certificateExtensionsFromAsn1=function(k){for(var P=[],D=0;D<k.value.length;++D)for(var l=k.value[D],F=0;F<l.value.length;++F)P.push(d.certificateExtensionFromAsn1(l.value[F]));return P},d.certificateExtensionFromAsn1=function(k){var P={};if(P.id=i.derToOid(k.value[0].value),P.critical=!1,k.value[1].type===i.Type.BOOLEAN?(P.critical=0!==k.value[1].value.charCodeAt(0),P.value=k.value[2].value):P.value=k.value[1].value,P.id in c)if(P.name=c[P.id],"keyUsage"===P.name){var l=0,F=0;(D=i.fromDer(P.value)).value.length>1&&(l=D.value.charCodeAt(1),F=D.value.length>2?D.value.charCodeAt(2):0),P.digitalSignature=128==(128&l),P.nonRepudiation=64==(64&l),P.keyEncipherment=32==(32&l),P.dataEncipherment=16==(16&l),P.keyAgreement=8==(8&l),P.keyCertSign=4==(4&l),P.cRLSign=2==(2&l),P.encipherOnly=1==(1&l),P.decipherOnly=128==(128&F)}else if("basicConstraints"===P.name){var D=i.fromDer(P.value);P.cA=D.value.length>0&&D.value[0].type===i.Type.BOOLEAN&&0!==D.value[0].value.charCodeAt(0);var Y=null;D.value.length>0&&D.value[0].type===i.Type.INTEGER?Y=D.value[0].value:D.value.length>1&&(Y=D.value[1].value),null!==Y&&(P.pathLenConstraint=i.derToInteger(Y))}else if("extKeyUsage"===P.name){D=i.fromDer(P.value);for(var W=0;W<D.value.length;++W){var ne=i.derToOid(D.value[W].value);ne in c?P[c[ne]]=!0:P[ne]=!0}}else if("nsCertType"===P.name)l=0,(D=i.fromDer(P.value)).value.length>1&&(l=D.value.charCodeAt(1)),P.client=128==(128&l),P.server=64==(64&l),P.email=32==(32&l),P.objsign=16==(16&l),P.reserved=8==(8&l),P.sslCA=4==(4&l),P.emailCA=2==(2&l),P.objCA=1==(1&l);else if("subjectAltName"===P.name||"issuerAltName"===P.name){P.altNames=[],D=i.fromDer(P.value);for(var de,Ae=0;Ae<D.value.length;++Ae){var Re={type:(de=D.value[Ae]).type,value:de.value};switch(P.altNames.push(Re),de.type){case 1:case 2:case 6:break;case 7:Re.ip=s.util.bytesToIP(de.value);break;case 8:Re.oid=i.derToOid(de.value)}}}else"subjectKeyIdentifier"===P.name&&(D=i.fromDer(P.value),P.subjectKeyIdentifier=s.util.bytesToHex(D.value));return P},d.certificationRequestFromAsn1=function(k,P){var D={},l=[];if(!i.validate(k,x,D,l)){var F=new Error("Cannot read PKCS#10 certificate request. ASN.1 object is not a PKCS#10 CertificationRequest.");throw F.errors=l,F}if(i.derToOid(D.publicKeyOid)!==d.oids.rsaEncryption)throw new Error("Cannot read public key. OID is not RSA.");var W=d.createCertificationRequest();if(W.version=D.csrVersion?D.csrVersion.charCodeAt(0):0,W.signatureOid=s.asn1.derToOid(D.csrSignatureOid),W.signatureParameters=H(W.signatureOid,D.csrSignatureParams,!0),W.siginfo.algorithmOid=s.asn1.derToOid(D.csrSignatureOid),W.siginfo.parameters=H(W.siginfo.algorithmOid,D.csrSignatureParams,!1),W.signature=D.csrSignature,W.certificationRequestInfo=D.certificationRequestInfo,P){W.md=C({signatureOid:W.signatureOid,type:"certification request"});var ne=i.toDer(W.certificationRequestInfo);W.md.update(ne.getBytes())}var de=s.md.sha1.create();return W.subject.getField=function(Ae){return A(W.subject,Ae)},W.subject.addField=function(Ae){I([Ae]),W.subject.attributes.push(Ae)},W.subject.attributes=d.RDNAttributesAsArray(D.certificationRequestInfoSubject,de),W.subject.hash=de.digest().toHex(),W.publicKey=d.publicKeyFromAsn1(D.subjectPublicKeyInfo),W.getAttribute=function(Ae){return A(W,Ae)},W.addAttribute=function(Ae){I([Ae]),W.attributes.push(Ae)},W.attributes=d.CRIAttributesAsArray(D.certificationRequestInfoAttributes||[]),W},d.createCertificationRequest=function(){var k={version:0,signatureOid:null,signature:null,siginfo:{}};return k.siginfo.algorithmOid=null,k.subject={},k.subject.getField=function(P){return A(k.subject,P)},k.subject.addField=function(P){I([P]),k.subject.attributes.push(P)},k.subject.attributes=[],k.subject.hash=null,k.publicKey=null,k.attributes=[],k.getAttribute=function(P){return A(k,P)},k.addAttribute=function(P){I([P]),k.attributes.push(P)},k.md=null,k.setSubject=function(P){I(P),k.subject.attributes=P,k.subject.hash=null},k.setAttributes=function(P){I(P),k.attributes=P},k.sign=function(P,D){k.md=D||s.md.sha1.create();var l=c[k.md.algorithm+"WithRSAEncryption"];if(!l){var F=new Error("Could not compute certification request digest. Unknown message digest algorithm OID.");throw F.algorithm=k.md.algorithm,F}k.signatureOid=k.siginfo.algorithmOid=l,k.certificationRequestInfo=d.getCertificationRequestInfo(k);var Y=i.toDer(k.certificationRequestInfo);k.md.update(Y.getBytes()),k.signature=P.sign(k.md)},k.verify=function(){var P=!1,D=k.md;if(null===D){D=C({signatureOid:k.signatureOid,type:"certification request"});var l=k.certificationRequestInfo||d.getCertificationRequestInfo(k),F=i.toDer(l);D.update(F.getBytes())}return null!==D&&(P=_({certificate:k,md:D,signature:k.signature})),P},k};var O=new Date("1950-01-01T00:00:00Z"),V=new Date("2050-01-01T00:00:00Z");function G(k){return k>=O&&k<V?i.create(i.Class.UNIVERSAL,i.Type.UTCTIME,!1,i.dateToUtcTime(k)):i.create(i.Class.UNIVERSAL,i.Type.GENERALIZEDTIME,!1,i.dateToGeneralizedTime(k))}d.getTBSCertificate=function(k){var P=G(k.validity.notBefore),D=G(k.validity.notAfter),l=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.CONTEXT_SPECIFIC,0,!0,[i.create(i.Class.UNIVERSAL,i.Type.INTEGER,!1,i.integerToDer(k.version).getBytes())]),i.create(i.Class.UNIVERSAL,i.Type.INTEGER,!1,s.util.hexToBytes(k.serialNumber)),i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(k.siginfo.algorithmOid).getBytes()),m(k.siginfo.algorithmOid,k.siginfo.parameters)]),N(k.issuer),i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[P,D]),N(k.subject),d.publicKeyToAsn1(k.publicKey)]);return k.issuer.uniqueId&&l.value.push(i.create(i.Class.CONTEXT_SPECIFIC,1,!0,[i.create(i.Class.UNIVERSAL,i.Type.BITSTRING,!1,String.fromCharCode(0)+k.issuer.uniqueId)])),k.subject.uniqueId&&l.value.push(i.create(i.Class.CONTEXT_SPECIFIC,2,!0,[i.create(i.Class.UNIVERSAL,i.Type.BITSTRING,!1,String.fromCharCode(0)+k.subject.uniqueId)])),k.extensions.length>0&&l.value.push(d.certificateExtensionsToAsn1(k.extensions)),l},d.getCertificationRequestInfo=function(k){return i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.INTEGER,!1,i.integerToDer(k.version).getBytes()),N(k.subject),d.publicKeyToAsn1(k.publicKey),S(k)])},d.distinguishedNameToAsn1=function(k){return N(k)},d.certificateToAsn1=function(k){var P=k.tbsCertificate||d.getTBSCertificate(k);return i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[P,i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(k.signatureOid).getBytes()),m(k.signatureOid,k.signatureParameters)]),i.create(i.Class.UNIVERSAL,i.Type.BITSTRING,!1,String.fromCharCode(0)+k.signature)])},d.certificateExtensionsToAsn1=function(k){var P=i.create(i.Class.CONTEXT_SPECIFIC,3,!0,[]),D=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[]);P.value.push(D);for(var l=0;l<k.length;++l)D.value.push(d.certificateExtensionToAsn1(k[l]));return P},d.certificateExtensionToAsn1=function(k){var P=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[]);P.value.push(i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(k.id).getBytes())),k.critical&&P.value.push(i.create(i.Class.UNIVERSAL,i.Type.BOOLEAN,!1,String.fromCharCode(255)));var D=k.value;return"string"!=typeof k.value&&(D=i.toDer(D).getBytes()),P.value.push(i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,!1,D)),P},d.certificationRequestToAsn1=function(k){var P=k.certificationRequestInfo||d.getCertificationRequestInfo(k);return i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[P,i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(k.signatureOid).getBytes()),m(k.signatureOid,k.signatureParameters)]),i.create(i.Class.UNIVERSAL,i.Type.BITSTRING,!1,String.fromCharCode(0)+k.signature)])},d.createCaStore=function(k){var P={certs:{}};function D(W){return l(W),P.certs[W.hash]||null}function l(W){if(!W.hash){var ne=s.md.sha1.create();W.attributes=d.RDNAttributesAsArray(N(W),ne),W.hash=ne.digest().toHex()}}if(P.getIssuer=function(W){return D(W.issuer)},P.addCertificate=function(W){if("string"==typeof W&&(W=s.pki.certificateFromPem(W)),l(W.subject),!P.hasCertificate(W))if(W.subject.hash in P.certs){var ne=P.certs[W.subject.hash];s.util.isArray(ne)||(ne=[ne]),ne.push(W),P.certs[W.subject.hash]=ne}else P.certs[W.subject.hash]=W},P.hasCertificate=function(W){"string"==typeof W&&(W=s.pki.certificateFromPem(W));var ne=D(W.subject);if(!ne)return!1;s.util.isArray(ne)||(ne=[ne]);for(var de=i.toDer(d.certificateToAsn1(W)).getBytes(),Ae=0;Ae<ne.length;++Ae)if(de===i.toDer(d.certificateToAsn1(ne[Ae])).getBytes())return!0;return!1},P.listAllCertificates=function(){var W=[];for(var ne in P.certs)if(P.certs.hasOwnProperty(ne)){var de=P.certs[ne];if(s.util.isArray(de))for(var Ae=0;Ae<de.length;++Ae)W.push(de[Ae]);else W.push(de)}return W},P.removeCertificate=function(W){var ne;if("string"==typeof W&&(W=s.pki.certificateFromPem(W)),l(W.subject),!P.hasCertificate(W))return null;var de=D(W.subject);if(!s.util.isArray(de))return ne=P.certs[W.subject.hash],delete P.certs[W.subject.hash],ne;for(var Ae=i.toDer(d.certificateToAsn1(W)).getBytes(),Re=0;Re<de.length;++Re)Ae===i.toDer(d.certificateToAsn1(de[Re])).getBytes()&&(ne=de[Re],de.splice(Re,1));return 0===de.length&&delete P.certs[W.subject.hash],ne},k)for(var F=0;F<k.length;++F)P.addCertificate(k[F]);return P},d.certificateError={bad_certificate:"forge.pki.BadCertificate",unsupported_certificate:"forge.pki.UnsupportedCertificate",certificate_revoked:"forge.pki.CertificateRevoked",certificate_expired:"forge.pki.CertificateExpired",certificate_unknown:"forge.pki.CertificateUnknown",unknown_ca:"forge.pki.UnknownCertificateAuthority"},d.verifyCertificateChain=function(k,P,D){"function"==typeof D&&(D={verify:D}),D=D||{};var l=(P=P.slice(0)).slice(0),F=D.validityCheckDate;typeof F>"u"&&(F=new Date);var Y=!0,W=null,ne=0;do{var de=P.shift(),Ae=null,Re=!1;if(F&&(F<de.validity.notBefore||F>de.validity.notAfter)&&(W={message:"Certificate is not valid yet or has expired.",error:d.certificateError.certificate_expired,notBefore:de.validity.notBefore,notAfter:de.validity.notAfter,now:F}),null===W){if(null===(Ae=P[0]||k.getIssuer(de))&&de.isIssuer(de)&&(Re=!0,Ae=de),Ae){var Fe=Ae;s.util.isArray(Fe)||(Fe=[Fe]);for(var be=!1;!be&&Fe.length>0;){Ae=Fe.shift();try{be=Ae.verify(de)}catch{}}be||(W={message:"Certificate signature is invalid.",error:d.certificateError.bad_certificate})}null===W&&(!Ae||Re)&&!k.hasCertificate(de)&&(W={message:"Certificate is not trusted.",error:d.certificateError.unknown_ca})}if(null===W&&Ae&&!de.isIssuer(Ae)&&(W={message:"Certificate issuer is invalid.",error:d.certificateError.bad_certificate}),null===W)for(var Pe={keyUsage:!0,basicConstraints:!0},We=0;null===W&&We<de.extensions.length;++We){var Ze=de.extensions[We];Ze.critical&&!(Ze.name in Pe)&&(W={message:"Certificate has an unsupported critical extension.",error:d.certificateError.unsupported_certificate})}if(null===W&&(!Y||0===P.length&&(!Ae||Re))){var Ct=de.getExtension("basicConstraints"),tt=de.getExtension("keyUsage");null!==tt&&(!tt.keyCertSign||null===Ct)&&(W={message:"Certificate keyUsage or basicConstraints conflict or indicate that the certificate is not a CA. If the certificate is the only one in the chain or isn't the first then the certificate must be a valid CA.",error:d.certificateError.bad_certificate}),null===W&&null!==Ct&&!Ct.cA&&(W={message:"Certificate basicConstraints indicates the certificate is not a CA.",error:d.certificateError.bad_certificate}),null===W&&null!==tt&&"pathLenConstraint"in Ct&&ne-1>Ct.pathLenConstraint&&(W={message:"Certificate basicConstraints pathLenConstraint violated.",error:d.certificateError.bad_certificate})}var ct=null===W||W.error,jt=D.verify?D.verify(ct,ne,l):ct;if(!0!==jt)throw!0===ct&&(W={message:"The application rejected the certificate.",error:d.certificateError.bad_certificate}),(jt||0===jt)&&("object"!=typeof jt||s.util.isArray(jt)?"string"==typeof jt&&(W.error=jt):(jt.message&&(W.message=jt.message),jt.error&&(W.error=jt.error))),W;W=null,Y=!1,++ne}while(P.length>0);return!0}},3259:(De,J,M)=>{const i=M(8695),d=M(1465),c=M(3210),B=M(2334);function E(v,y,h,x,A){const H=[].slice.call(arguments,1),C=H.length,_="function"==typeof H[C-1];if(!_&&!i())throw new Error("Callback required as last argument");if(!_){if(C<1)throw new Error("Too few arguments provided");return 1===C?(h=y,y=x=void 0):2===C&&!y.getContext&&(x=h,h=y,y=void 0),new Promise(function(N,T){try{const I=d.create(h,x);N(v(I,y,x))}catch(I){T(I)}})}if(C<2)throw new Error("Too few arguments provided");2===C?(A=h,h=y,y=x=void 0):3===C&&(y.getContext&&typeof A>"u"?(A=x,x=void 0):(A=x,x=h,h=y,y=void 0));try{const N=d.create(h,x);A(null,v(N,y,x))}catch(N){A(N)}}E.bind(null,c.render),J.hz=E.bind(null,c.renderToDataURL),E.bind(null,function(v,y,h){return B.render(v,h)})},8695:De=>{De.exports=function(){return"function"==typeof Promise&&Promise.prototype&&Promise.prototype.then}},6221:(De,J,M)=>{const s=M(4792).getSymbolSize;J.getRowColCoords=function(d){if(1===d)return[];const c=Math.floor(d/7)+2,B=s(d),E=145===B?26:2*Math.ceil((B-13)/(2*c-2)),v=[B-7];for(let y=1;y<c-1;y++)v[y]=v[y-1]-E;return v.push(6),v.reverse()},J.getPositions=function(d){const c=[],B=J.getRowColCoords(d),E=B.length;for(let v=0;v<E;v++)for(let y=0;y<E;y++)0===v&&0===y||0===v&&y===E-1||v===E-1&&0===y||c.push([B[v],B[y]]);return c}},2424:(De,J,M)=>{const s=M(4016),i=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function d(c){this.mode=s.ALPHANUMERIC,this.data=c}d.getBitsLength=function(B){return 11*Math.floor(B/2)+B%2*6},d.prototype.getLength=function(){return this.data.length},d.prototype.getBitsLength=function(){return d.getBitsLength(this.data.length)},d.prototype.write=function(B){let E;for(E=0;E+2<=this.data.length;E+=2){let v=45*i.indexOf(this.data[E]);v+=i.indexOf(this.data[E+1]),B.put(v,11)}this.data.length%2&&B.put(i.indexOf(this.data[E]),6)},De.exports=d},2118:De=>{function J(){this.buffer=[],this.length=0}J.prototype={get:function(M){const s=Math.floor(M/8);return 1==(this.buffer[s]>>>7-M%8&1)},put:function(M,s){for(let i=0;i<s;i++)this.putBit(1==(M>>>s-i-1&1))},getLengthInBits:function(){return this.length},putBit:function(M){const s=Math.floor(this.length/8);this.buffer.length<=s&&this.buffer.push(0),M&&(this.buffer[s]|=128>>>this.length%8),this.length++}},De.exports=J},4425:De=>{function J(M){if(!M||M<1)throw new Error("BitMatrix size must be defined and greater than 0");this.size=M,this.data=new Uint8Array(M*M),this.reservedBit=new Uint8Array(M*M)}J.prototype.set=function(M,s,i,d){const c=M*this.size+s;this.data[c]=i,d&&(this.reservedBit[c]=!0)},J.prototype.get=function(M,s){return this.data[M*this.size+s]},J.prototype.xor=function(M,s,i){this.data[M*this.size+s]^=i},J.prototype.isReserved=function(M,s){return this.reservedBit[M*this.size+s]},De.exports=J},5663:(De,J,M)=>{const s=M(8419),i=M(4016);function d(c){this.mode=i.BYTE,"string"==typeof c&&(c=s(c)),this.data=new Uint8Array(c)}d.getBitsLength=function(B){return 8*B},d.prototype.getLength=function(){return this.data.length},d.prototype.getBitsLength=function(){return d.getBitsLength(this.data.length)},d.prototype.write=function(c){for(let B=0,E=this.data.length;B<E;B++)c.put(this.data[B],8)},De.exports=d},4655:(De,J,M)=>{const s=M(2259),i=[1,1,1,1,1,1,1,1,1,1,2,2,1,2,2,4,1,2,4,4,2,4,4,4,2,4,6,5,2,4,6,6,2,5,8,8,4,5,8,8,4,5,8,11,4,8,10,11,4,9,12,16,4,9,16,16,6,10,12,18,6,10,17,16,6,11,16,19,6,13,18,21,7,14,21,25,8,16,20,25,8,17,23,25,9,17,23,34,9,18,25,30,10,20,27,32,12,21,29,35,12,23,34,37,12,25,34,40,13,26,35,42,14,28,38,45,15,29,40,48,16,31,43,51,17,33,45,54,18,35,48,57,19,37,51,60,19,38,53,63,20,40,56,66,21,43,59,70,22,45,62,74,24,47,65,77,25,49,68,81],d=[7,10,13,17,10,16,22,28,15,26,36,44,20,36,52,64,26,48,72,88,36,64,96,112,40,72,108,130,48,88,132,156,60,110,160,192,72,130,192,224,80,150,224,264,96,176,260,308,104,198,288,352,120,216,320,384,132,240,360,432,144,280,408,480,168,308,448,532,180,338,504,588,196,364,546,650,224,416,600,700,224,442,644,750,252,476,690,816,270,504,750,900,300,560,810,960,312,588,870,1050,336,644,952,1110,360,700,1020,1200,390,728,1050,1260,420,784,1140,1350,450,812,1200,1440,480,868,1290,1530,510,924,1350,1620,540,980,1440,1710,570,1036,1530,1800,570,1064,1590,1890,600,1120,1680,1980,630,1204,1770,2100,660,1260,1860,2220,720,1316,1950,2310,750,1372,2040,2430];J.getBlocksCount=function(B,E){switch(E){case s.L:return i[4*(B-1)+0];case s.M:return i[4*(B-1)+1];case s.Q:return i[4*(B-1)+2];case s.H:return i[4*(B-1)+3];default:return}},J.getTotalCodewordsCount=function(B,E){switch(E){case s.L:return d[4*(B-1)+0];case s.M:return d[4*(B-1)+1];case s.Q:return d[4*(B-1)+2];case s.H:return d[4*(B-1)+3];default:return}}},2259:(De,J)=>{J.L={bit:1},J.M={bit:0},J.Q={bit:3},J.H={bit:2},J.isValid=function(i){return i&&typeof i.bit<"u"&&i.bit>=0&&i.bit<4},J.from=function(i,d){if(J.isValid(i))return i;try{return function M(s){if("string"!=typeof s)throw new Error("Param is not a string");switch(s.toLowerCase()){case"l":case"low":return J.L;case"m":case"medium":return J.M;case"q":case"quartile":return J.Q;case"h":case"high":return J.H;default:throw new Error("Unknown EC Level: "+s)}}(i)}catch{return d}}},3114:(De,J,M)=>{const s=M(4792).getSymbolSize;J.getPositions=function(c){const B=s(c);return[[0,0],[B-7,0],[0,B-7]]}},7078:(De,J,M)=>{const s=M(4792),c=s.getBCHDigit(1335);J.getEncodedBits=function(E,v){const y=E.bit<<3|v;let h=y<<10;for(;s.getBCHDigit(h)-c>=0;)h^=1335<<s.getBCHDigit(h)-c;return 21522^(y<<10|h)}},5339:(De,J)=>{const M=new Uint8Array(512),s=new Uint8Array(256);(function(){let d=1;for(let c=0;c<255;c++)M[c]=d,s[d]=c,d<<=1,256&d&&(d^=285);for(let c=255;c<512;c++)M[c]=M[c-255]})(),J.log=function(d){if(d<1)throw new Error("log("+d+")");return s[d]},J.exp=function(d){return M[d]},J.mul=function(d,c){return 0===d||0===c?0:M[s[d]+s[c]]}},449:(De,J,M)=>{const s=M(4016),i=M(4792);function d(c){this.mode=s.KANJI,this.data=c}d.getBitsLength=function(B){return 13*B},d.prototype.getLength=function(){return this.data.length},d.prototype.getBitsLength=function(){return d.getBitsLength(this.data.length)},d.prototype.write=function(c){let B;for(B=0;B<this.data.length;B++){let E=i.toSJIS(this.data[B]);if(E>=33088&&E<=40956)E-=33088;else{if(!(E>=57408&&E<=60351))throw new Error("Invalid SJIS character: "+this.data[B]+"\nMake sure your charset is UTF-8");E-=49472}E=192*(E>>>8&255)+(255&E),c.put(E,13)}},De.exports=d},3667:(De,J)=>{J.Patterns={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};function s(i,d,c){switch(i){case J.Patterns.PATTERN000:return(d+c)%2==0;case J.Patterns.PATTERN001:return d%2==0;case J.Patterns.PATTERN010:return c%3==0;case J.Patterns.PATTERN011:return(d+c)%3==0;case J.Patterns.PATTERN100:return(Math.floor(d/2)+Math.floor(c/3))%2==0;case J.Patterns.PATTERN101:return d*c%2+d*c%3==0;case J.Patterns.PATTERN110:return(d*c%2+d*c%3)%2==0;case J.Patterns.PATTERN111:return(d*c%3+(d+c)%2)%2==0;default:throw new Error("bad maskPattern:"+i)}}J.isValid=function(d){return null!=d&&""!==d&&!isNaN(d)&&d>=0&&d<=7},J.from=function(d){return J.isValid(d)?parseInt(d,10):void 0},J.getPenaltyN1=function(d){const c=d.size;let B=0,E=0,v=0,y=null,h=null;for(let x=0;x<c;x++){E=v=0,y=h=null;for(let A=0;A<c;A++){let H=d.get(x,A);H===y?E++:(E>=5&&(B+=E-5+3),y=H,E=1),H=d.get(A,x),H===h?v++:(v>=5&&(B+=v-5+3),h=H,v=1)}E>=5&&(B+=E-5+3),v>=5&&(B+=v-5+3)}return B},J.getPenaltyN2=function(d){const c=d.size;let B=0;for(let E=0;E<c-1;E++)for(let v=0;v<c-1;v++){const y=d.get(E,v)+d.get(E,v+1)+d.get(E+1,v)+d.get(E+1,v+1);(4===y||0===y)&&B++}return 3*B},J.getPenaltyN3=function(d){const c=d.size;let B=0,E=0,v=0;for(let y=0;y<c;y++){E=v=0;for(let h=0;h<c;h++)E=E<<1&2047|d.get(y,h),h>=10&&(1488===E||93===E)&&B++,v=v<<1&2047|d.get(h,y),h>=10&&(1488===v||93===v)&&B++}return 40*B},J.getPenaltyN4=function(d){let c=0;const B=d.data.length;for(let v=0;v<B;v++)c+=d.data[v];return 10*Math.abs(Math.ceil(100*c/B/5)-10)},J.applyMask=function(d,c){const B=c.size;for(let E=0;E<B;E++)for(let v=0;v<B;v++)c.isReserved(v,E)||c.xor(v,E,s(d,v,E))},J.getBestMask=function(d,c){const B=Object.keys(J.Patterns).length;let E=0,v=1/0;for(let y=0;y<B;y++){c(y),J.applyMask(y,d);const h=J.getPenaltyN1(d)+J.getPenaltyN2(d)+J.getPenaltyN3(d)+J.getPenaltyN4(d);J.applyMask(y,d),h<v&&(v=h,E=y)}return E}},4016:(De,J,M)=>{const s=M(4406),i=M(2699);J.NUMERIC={id:"Numeric",bit:1,ccBits:[10,12,14]},J.ALPHANUMERIC={id:"Alphanumeric",bit:2,ccBits:[9,11,13]},J.BYTE={id:"Byte",bit:4,ccBits:[8,16,16]},J.KANJI={id:"Kanji",bit:8,ccBits:[8,10,12]},J.MIXED={bit:-1},J.getCharCountIndicator=function(B,E){if(!B.ccBits)throw new Error("Invalid mode: "+B);if(!s.isValid(E))throw new Error("Invalid version: "+E);return E>=1&&E<10?B.ccBits[0]:E<27?B.ccBits[1]:B.ccBits[2]},J.getBestModeForData=function(B){return i.testNumeric(B)?J.NUMERIC:i.testAlphanumeric(B)?J.ALPHANUMERIC:i.testKanji(B)?J.KANJI:J.BYTE},J.toString=function(B){if(B&&B.id)return B.id;throw new Error("Invalid mode")},J.isValid=function(B){return B&&B.bit&&B.ccBits},J.from=function(B,E){if(J.isValid(B))return B;try{return function d(c){if("string"!=typeof c)throw new Error("Param is not a string");switch(c.toLowerCase()){case"numeric":return J.NUMERIC;case"alphanumeric":return J.ALPHANUMERIC;case"kanji":return J.KANJI;case"byte":return J.BYTE;default:throw new Error("Unknown mode: "+c)}}(B)}catch{return E}}},7783:(De,J,M)=>{const s=M(4016);function i(d){this.mode=s.NUMERIC,this.data=d.toString()}i.getBitsLength=function(c){return 10*Math.floor(c/3)+(c%3?c%3*3+1:0)},i.prototype.getLength=function(){return this.data.length},i.prototype.getBitsLength=function(){return i.getBitsLength(this.data.length)},i.prototype.write=function(c){let B,E,v;for(B=0;B+3<=this.data.length;B+=3)E=this.data.substr(B,3),v=parseInt(E,10),c.put(v,10);const y=this.data.length-B;y>0&&(E=this.data.substr(B),v=parseInt(E,10),c.put(v,3*y+1))},De.exports=i},1106:(De,J,M)=>{const s=M(5339);J.mul=function(d,c){const B=new Uint8Array(d.length+c.length-1);for(let E=0;E<d.length;E++)for(let v=0;v<c.length;v++)B[E+v]^=s.mul(d[E],c[v]);return B},J.mod=function(d,c){let B=new Uint8Array(d);for(;B.length-c.length>=0;){const E=B[0];for(let y=0;y<c.length;y++)B[y]^=s.mul(c[y],E);let v=0;for(;v<B.length&&0===B[v];)v++;B=B.slice(v)}return B},J.generateECPolynomial=function(d){let c=new Uint8Array([1]);for(let B=0;B<d;B++)c=J.mul(c,new Uint8Array([1,s.exp(B)]));return c}},1465:(De,J,M)=>{const s=M(4792),i=M(2259),d=M(2118),c=M(4425),B=M(6221),E=M(3114),v=M(3667),y=M(4655),h=M(2636),x=M(2088),A=M(7078),H=M(4016),C=M(2033);function p(G,k,P){const D=G.size,l=A.getEncodedBits(k,P);let F,Y;for(F=0;F<15;F++)Y=1==(l>>F&1),G.set(F<6?F:F<8?F+1:D-15+F,8,Y,!0),G.set(8,F<8?D-F-1:F<9?15-F-1+1:15-F-1,Y,!0);G.set(D-8,8,1,!0)}function V(G,k,P,D){let l;if(Array.isArray(G))l=C.fromArray(G);else{if("string"!=typeof G)throw new Error("Invalid data");{let de=k;if(!de){const Ae=C.rawSplit(G);de=x.getBestVersionForData(Ae,P)}l=C.fromString(G,de||40)}}const F=x.getBestVersionForData(l,P);if(!F)throw new Error("The amount of data is too big to be stored in a QR Code");if(k){if(k<F)throw new Error("\nThe chosen QR Code version cannot contain this amount of data.\nMinimum version required to store current data is: "+F+".\n")}else k=F;const Y=function S(G,k,P){const D=new d;P.forEach(function(ne){D.put(ne.mode.bit,4),D.put(ne.getLength(),H.getCharCountIndicator(ne.mode,G)),ne.write(D)});const Y=8*(s.getSymbolTotalCodewords(G)-y.getTotalCodewordsCount(G,k));for(D.getLengthInBits()+4<=Y&&D.put(0,4);D.getLengthInBits()%8!=0;)D.putBit(0);const W=(Y-D.getLengthInBits())/8;for(let ne=0;ne<W;ne++)D.put(ne%2?17:236,8);return function O(G,k,P){const D=s.getSymbolTotalCodewords(k),F=D-y.getTotalCodewordsCount(k,P),Y=y.getBlocksCount(k,P),ne=Y-D%Y,de=Math.floor(D/Y),Ae=Math.floor(F/Y),Re=Ae+1,Fe=de-Ae,be=new h(Fe);let Pe=0;const We=new Array(Y),Ze=new Array(Y);let Ct=0;const tt=new Uint8Array(G.buffer);for(let Le=0;Le<Y;Le++){const Ge=Le<ne?Ae:Re;We[Le]=tt.slice(Pe,Pe+Ge),Ze[Le]=be.encode(We[Le]),Pe+=Ge,Ct=Math.max(Ct,Ge)}const Ht=new Uint8Array(D);let jt,Rt,ct=0;for(jt=0;jt<Ct;jt++)for(Rt=0;Rt<Y;Rt++)jt<We[Rt].length&&(Ht[ct++]=We[Rt][jt]);for(jt=0;jt<Fe;jt++)for(Rt=0;Rt<Y;Rt++)Ht[ct++]=Ze[Rt][jt];return Ht}(D,G,k)}(k,P,l),W=s.getSymbolSize(k),ne=new c(W);return function _(G,k){const P=G.size,D=E.getPositions(k);for(let l=0;l<D.length;l++){const F=D[l][0],Y=D[l][1];for(let W=-1;W<=7;W++)if(!(F+W<=-1||P<=F+W))for(let ne=-1;ne<=7;ne++)Y+ne<=-1||P<=Y+ne||G.set(F+W,Y+ne,W>=0&&W<=6&&(0===ne||6===ne)||ne>=0&&ne<=6&&(0===W||6===W)||W>=2&&W<=4&&ne>=2&&ne<=4,!0)}}(ne,k),function N(G){const k=G.size;for(let P=8;P<k-8;P++){const D=P%2==0;G.set(P,6,D,!0),G.set(6,P,D,!0)}}(ne),function T(G,k){const P=B.getPositions(k);for(let D=0;D<P.length;D++){const l=P[D][0],F=P[D][1];for(let Y=-2;Y<=2;Y++)for(let W=-2;W<=2;W++)G.set(l+Y,F+W,-2===Y||2===Y||-2===W||2===W||0===Y&&0===W,!0)}}(ne,k),p(ne,P,0),k>=7&&function I(G,k){const P=G.size,D=x.getEncodedBits(k);let l,F,Y;for(let W=0;W<18;W++)l=Math.floor(W/3),F=W%3+P-8-3,Y=1==(D>>W&1),G.set(l,F,Y,!0),G.set(F,l,Y,!0)}(ne,k),function m(G,k){const P=G.size;let D=-1,l=P-1,F=7,Y=0;for(let W=P-1;W>0;W-=2)for(6===W&&W--;;){for(let ne=0;ne<2;ne++)if(!G.isReserved(l,W-ne)){let de=!1;Y<k.length&&(de=1==(k[Y]>>>F&1)),G.set(l,W-ne,de),F--,-1===F&&(Y++,F=7)}if(l+=D,l<0||P<=l){l-=D,D=-D;break}}}(ne,Y),isNaN(D)&&(D=v.getBestMask(ne,p.bind(null,ne,P))),v.applyMask(D,ne),p(ne,P,D),{modules:ne,version:k,errorCorrectionLevel:P,maskPattern:D,segments:l}}J.create=function(k,P){if(typeof k>"u"||""===k)throw new Error("No input text");let l,F,D=i.M;return typeof P<"u"&&(D=i.from(P.errorCorrectionLevel,i.M),l=x.from(P.version),F=v.from(P.maskPattern),P.toSJISFunc&&s.setToSJISFunction(P.toSJISFunc)),V(k,l,D,F)}},2636:(De,J,M)=>{const s=M(1106);function i(d){this.genPoly=void 0,this.degree=d,this.degree&&this.initialize(this.degree)}i.prototype.initialize=function(c){this.degree=c,this.genPoly=s.generateECPolynomial(this.degree)},i.prototype.encode=function(c){if(!this.genPoly)throw new Error("Encoder not initialized");const B=new Uint8Array(c.length+this.degree);B.set(c);const E=s.mod(B,this.genPoly),v=this.degree-E.length;if(v>0){const y=new Uint8Array(this.degree);return y.set(E,v),y}return E},De.exports=i},2699:(De,J)=>{const M="[0-9]+";let i="(?:[u3000-u303F]|[u3040-u309F]|[u30A0-u30FF]|[uFF00-uFFEF]|[u4E00-u9FAF]|[u2605-u2606]|[u2190-u2195]|u203B|[u2010u2015u2018u2019u2025u2026u201Cu201Du2225u2260]|[u0391-u0451]|[u00A7u00A8u00B1u00B4u00D7u00F7])+";i=i.replace(/u/g,"\\u");const d="(?:(?![A-Z0-9 $%*+\\-./:]|"+i+")(?:.|[\r\n]))+";J.KANJI=new RegExp(i,"g"),J.BYTE_KANJI=new RegExp("[^A-Z0-9 $%*+\\-./:]+","g"),J.BYTE=new RegExp(d,"g"),J.NUMERIC=new RegExp(M,"g"),J.ALPHANUMERIC=new RegExp("[A-Z $%*+\\-./:]+","g");const c=new RegExp("^"+i+"$"),B=new RegExp("^"+M+"$"),E=new RegExp("^[A-Z0-9 $%*+\\-./:]+$");J.testKanji=function(y){return c.test(y)},J.testNumeric=function(y){return B.test(y)},J.testAlphanumeric=function(y){return E.test(y)}},2033:(De,J,M)=>{const s=M(4016),i=M(7783),d=M(2424),c=M(5663),B=M(449),E=M(2699),v=M(4792),y=M(4901);function h(I){return unescape(encodeURIComponent(I)).length}function x(I,p,m){const S=[];let O;for(;null!==(O=I.exec(m));)S.push({data:O[0],index:O.index,mode:p,length:O[0].length});return S}function A(I){const p=x(E.NUMERIC,s.NUMERIC,I),m=x(E.ALPHANUMERIC,s.ALPHANUMERIC,I);let S,O;return v.isKanjiModeEnabled()?(S=x(E.BYTE,s.BYTE,I),O=x(E.KANJI,s.KANJI,I)):(S=x(E.BYTE_KANJI,s.BYTE,I),O=[]),p.concat(m,S,O).sort(function(G,k){return G.index-k.index}).map(function(G){return{data:G.data,mode:G.mode,length:G.length}})}function H(I,p){switch(p){case s.NUMERIC:return i.getBitsLength(I);case s.ALPHANUMERIC:return d.getBitsLength(I);case s.KANJI:return B.getBitsLength(I);case s.BYTE:return c.getBitsLength(I)}}function T(I,p){let m;const S=s.getBestModeForData(I);if(m=s.from(p,S),m!==s.BYTE&&m.bit<S.bit)throw new Error('"'+I+'" cannot be encoded with mode '+s.toString(m)+".\n Suggested mode is: "+s.toString(S));switch(m===s.KANJI&&!v.isKanjiModeEnabled()&&(m=s.BYTE),m){case s.NUMERIC:return new i(I);case s.ALPHANUMERIC:return new d(I);case s.KANJI:return new B(I);case s.BYTE:return new c(I)}}J.fromArray=function(p){return p.reduce(function(m,S){return"string"==typeof S?m.push(T(S,null)):S.data&&m.push(T(S.data,S.mode)),m},[])},J.fromString=function(p,m){const O=function _(I){const p=[];for(let m=0;m<I.length;m++){const S=I[m];switch(S.mode){case s.NUMERIC:p.push([S,{data:S.data,mode:s.ALPHANUMERIC,length:S.length},{data:S.data,mode:s.BYTE,length:S.length}]);break;case s.ALPHANUMERIC:p.push([S,{data:S.data,mode:s.BYTE,length:S.length}]);break;case s.KANJI:p.push([S,{data:S.data,mode:s.BYTE,length:h(S.data)}]);break;case s.BYTE:p.push([{data:S.data,mode:s.BYTE,length:h(S.data)}])}}return p}(A(p,v.isKanjiModeEnabled())),V=function N(I,p){const m={},S={start:{}};let O=["start"];for(let V=0;V<I.length;V++){const G=I[V],k=[];for(let P=0;P<G.length;P++){const D=G[P],l=""+V+P;k.push(l),m[l]={node:D,lastCount:0},S[l]={};for(let F=0;F<O.length;F++){const Y=O[F];m[Y]&&m[Y].node.mode===D.mode?(S[Y][l]=H(m[Y].lastCount+D.length,D.mode)-H(m[Y].lastCount,D.mode),m[Y].lastCount+=D.length):(m[Y]&&(m[Y].lastCount=D.length),S[Y][l]=H(D.length,D.mode)+4+s.getCharCountIndicator(D.mode,p))}}O=k}for(let V=0;V<O.length;V++)S[O[V]].end=0;return{map:S,table:m}}(O,m),G=y.find_path(V.map,"start","end"),k=[];for(let P=1;P<G.length-1;P++)k.push(V.table[G[P]].node);return J.fromArray(function C(I){return I.reduce(function(p,m){const S=p.length-1>=0?p[p.length-1]:null;return S&&S.mode===m.mode?(p[p.length-1].data+=m.data,p):(p.push(m),p)},[])}(k))},J.rawSplit=function(p){return J.fromArray(A(p,v.isKanjiModeEnabled()))}},4792:(De,J)=>{let M;const s=[0,26,44,70,100,134,172,196,242,292,346,404,466,532,581,655,733,815,901,991,1085,1156,1258,1364,1474,1588,1706,1828,1921,2051,2185,2323,2465,2611,2761,2876,3034,3196,3362,3532,3706];J.getSymbolSize=function(d){if(!d)throw new Error('"version" cannot be null or undefined');if(d<1||d>40)throw new Error('"version" should be in range from 1 to 40');return 4*d+17},J.getSymbolTotalCodewords=function(d){return s[d]},J.getBCHDigit=function(i){let d=0;for(;0!==i;)d++,i>>>=1;return d},J.setToSJISFunction=function(d){if("function"!=typeof d)throw new Error('"toSJISFunc" is not a valid function.');M=d},J.isKanjiModeEnabled=function(){return typeof M<"u"},J.toSJIS=function(d){return M(d)}},4406:(De,J)=>{J.isValid=function(s){return!isNaN(s)&&s>=1&&s<=40}},2088:(De,J,M)=>{const s=M(4792),i=M(4655),d=M(2259),c=M(4016),B=M(4406),v=s.getBCHDigit(7973);function h(H,C){return c.getCharCountIndicator(H,C)+4}function x(H,C){let _=0;return H.forEach(function(N){_+=h(N.mode,C)+N.getBitsLength()}),_}J.from=function(C,_){return B.isValid(C)?parseInt(C,10):_},J.getCapacity=function(C,_,N){if(!B.isValid(C))throw new Error("Invalid QR Code version");typeof N>"u"&&(N=c.BYTE);const p=8*(s.getSymbolTotalCodewords(C)-i.getTotalCodewordsCount(C,_));if(N===c.MIXED)return p;const m=p-h(N,C);switch(N){case c.NUMERIC:return Math.floor(m/10*3);case c.ALPHANUMERIC:return Math.floor(m/11*2);case c.KANJI:return Math.floor(m/13);default:return Math.floor(m/8)}},J.getBestVersionForData=function(C,_){let N;const T=d.from(_,d.M);if(Array.isArray(C)){if(C.length>1)return function A(H,C){for(let _=1;_<=40;_++)if(x(H,_)<=J.getCapacity(_,C,c.MIXED))return _}(C,T);if(0===C.length)return 1;N=C[0]}else N=C;return function y(H,C,_){for(let N=1;N<=40;N++)if(C<=J.getCapacity(N,_,H))return N}(N.mode,N.getLength(),T)},J.getEncodedBits=function(C){if(!B.isValid(C)||C<7)throw new Error("Invalid QR Code version");let _=C<<12;for(;s.getBCHDigit(_)-v>=0;)_^=7973<<s.getBCHDigit(_)-v;return C<<12|_}},3210:(De,J,M)=>{const s=M(6355);J.render=function(B,E,v){let y=v,h=E;typeof y>"u"&&(!E||!E.getContext)&&(y=E,E=void 0),E||(h=function d(){try{return document.createElement("canvas")}catch{throw new Error("You need to specify a canvas element")}}()),y=s.getOptions(y);const x=s.getImageWidth(B.modules.size,y),A=h.getContext("2d"),H=A.createImageData(x,x);return s.qrToImageData(H.data,B,y),function i(c,B,E){c.clearRect(0,0,B.width,B.height),B.style||(B.style={}),B.height=E,B.width=E,B.style.height=E+"px",B.style.width=E+"px"}(A,h,x),A.putImageData(H,0,0),h},J.renderToDataURL=function(B,E,v){let y=v;return typeof y>"u"&&(!E||!E.getContext)&&(y=E,E=void 0),y||(y={}),J.render(B,E,y).toDataURL(y.type||"image/png",(y.rendererOpts||{}).quality)}},2334:(De,J,M)=>{const s=M(6355);function i(B,E){const v=B.a/255,y=E+'="'+B.hex+'"';return v<1?y+" "+E+'-opacity="'+v.toFixed(2).slice(1)+'"':y}function d(B,E,v){let y=B+E;return typeof v<"u"&&(y+=" "+v),y}J.render=function(E,v,y){const h=s.getOptions(v),x=E.modules.size,A=E.modules.data,H=x+2*h.margin,C=h.color.light.a?"<path "+i(h.color.light,"fill")+' d="M0 0h'+H+"v"+H+'H0z"/>':"",_="<path "+i(h.color.dark,"stroke")+' d="'+function c(B,E,v){let y="",h=0,x=!1,A=0;for(let H=0;H<B.length;H++){const C=Math.floor(H%E),_=Math.floor(H/E);!C&&!x&&(x=!0),B[H]?(A++,H>0&&C>0&&B[H-1]||(y+=x?d("M",C+v,.5+_+v):d("m",h,0),h=0,x=!1),C+1<E&&B[H+1]||(y+=d("h",A),A=0)):h++}return y}(A,x,h.margin)+'"/>',I='<svg xmlns="http://www.w3.org/2000/svg" '+(h.width?'width="'+h.width+'" height="'+h.width+'" ':"")+'viewBox="0 0 '+H+" "+H+'" shape-rendering="crispEdges">'+C+_+"</svg>\n";return"function"==typeof y&&y(null,I),I}},6355:(De,J)=>{function M(s){if("number"==typeof s&&(s=s.toString()),"string"!=typeof s)throw new Error("Color should be defined as hex string");let i=s.slice().replace("#","").split("");if(i.length<3||5===i.length||i.length>8)throw new Error("Invalid hex color: "+s);(3===i.length||4===i.length)&&(i=Array.prototype.concat.apply([],i.map(function(c){return[c,c]}))),6===i.length&&i.push("F","F");const d=parseInt(i.join(""),16);return{r:d>>24&255,g:d>>16&255,b:d>>8&255,a:255&d,hex:"#"+i.slice(0,6).join("")}}J.getOptions=function(i){i||(i={}),i.color||(i.color={});const c=i.width&&i.width>=21?i.width:void 0;return{width:c,scale:c?4:i.scale||4,margin:typeof i.margin>"u"||null===i.margin||i.margin<0?4:i.margin,color:{dark:M(i.color.dark||"#000000ff"),light:M(i.color.light||"#ffffffff")},type:i.type,rendererOpts:i.rendererOpts||{}}},J.getScale=function(i,d){return d.width&&d.width>=i+2*d.margin?d.width/(i+2*d.margin):d.scale},J.getImageWidth=function(i,d){const c=J.getScale(i,d);return Math.floor((i+2*d.margin)*c)},J.qrToImageData=function(i,d,c){const B=d.modules.size,E=d.modules.data,v=J.getScale(B,c),y=Math.floor((B+2*c.margin)*v),h=c.margin*v,x=[c.color.light,c.color.dark];for(let A=0;A<y;A++)for(let H=0;H<y;H++){let C=4*(A*y+H),_=c.color.light;A>=h&&H>=h&&A<y-h&&H<y-h&&(_=x[E[Math.floor((A-h)/v)*B+Math.floor((H-h)/v)]?1:0]),i[C++]=_.r,i[C++]=_.g,i[C++]=_.b,i[C]=_.a}}},2480:()=>{},5819:()=>{},7156:De=>{function J(s,i,d,c,B,E,v){try{var y=s[E](v),h=y.value}catch(x){return void d(x)}y.done?i(h):Promise.resolve(h).then(c,B)}De.exports=function M(s){return function(){var i=this,d=arguments;return new Promise(function(c,B){var E=s.apply(i,d);function v(h){J(E,c,B,v,y,"next",h)}function y(h){J(E,c,B,v,y,"throw",h)}v(void 0)})}},De.exports.__esModule=!0,De.exports.default=De.exports},4585:(De,J,M)=>{"use strict";M.d(J,{HI:()=>M1,IM:()=>O1,Lo:()=>I1,Rk:()=>R1,_:()=>io,a:()=>hs,b:()=>Wr,c:()=>gi,d:()=>ht,e:()=>ds,f:()=>co,g:()=>zi,i:()=>ma,k$:()=>K1,m:()=>oi,pe:()=>F1,r:()=>gu,tn:()=>N1,u:()=>fe,xh:()=>B1});var s=M(5861);const i=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},d=Symbol("doneWritingPromise"),c=Symbol("doneWritingResolve"),B=Symbol("doneWritingReject"),E=Symbol("readingIndex");class v extends Array{constructor(){super(),this[d]=new Promise((t,e)=>{this[c]=t,this[B]=e}),this[d].catch(()=>{})}}function y(r){return r&&r.getReader&&Array.isArray(r)}function h(r){if(!y(r)){const t=r.getWriter(),e=t.releaseLock;return t.releaseLock=()=>{t.closed.catch(function(){}),e.call(t)},t}this.stream=r}v.prototype.getReader=function(){var t,r=this;return void 0===this[E]&&(this[E]=0),{read:(t=(0,s.Z)(function*(){return yield r[d],r[E]===r.length?{value:void 0,done:!0}:{value:r[r[E]++],done:!1}}),function(){return t.apply(this,arguments)})}},v.prototype.readToEnd=function(){var r=(0,s.Z)(function*(t){yield this[d];const e=t(this.slice(this[E]));return this.length=0,e});return function(t){return r.apply(this,arguments)}}(),v.prototype.clone=function(){const r=new v;return r[d]=this[d].then(()=>{r.push(...this)}),r},h.prototype.write=function(){var r=(0,s.Z)(function*(t){this.stream.push(t)});return function(t){return r.apply(this,arguments)}}(),h.prototype.close=(0,s.Z)(function*(){this.stream[c]()}),h.prototype.abort=function(){var r=(0,s.Z)(function*(t){return this.stream[B](t),t});return function(t){return r.apply(this,arguments)}}(),h.prototype.releaseLock=function(){};const x="object"==typeof i.process&&"object"==typeof i.process.versions,A=x&&void 0;function H(r){return y(r)?"array":i.ReadableStream&&i.ReadableStream.prototype.isPrototypeOf(r)?"web":k&&k.prototype.isPrototypeOf(r)?"ponyfill":A&&A.prototype.isPrototypeOf(r)?"node":!(!r||!r.getReader)&&"web-like"}function C(r){return Uint8Array.prototype.isPrototypeOf(r)}function _(r){if(1===r.length)return r[0];let t=0;for(let a=0;a<r.length;a++){if(!C(r[a]))throw Error("concatUint8Array: Data must be in the form of a Uint8Array");t+=r[a].length}const e=new Uint8Array(t);let n=0;return r.forEach(function(a){e.set(a,n),n+=a.length}),e}const N=x&&void 0,T=x&&void 0;let I,p;if(T){I=function(t){let e=!1;return new k({start(n){t.pause(),t.on("data",a=>{e||(N.isBuffer(a)&&(a=new Uint8Array(a.buffer,a.byteOffset,a.byteLength)),n.enqueue(a),t.pause())}),t.on("end",()=>{e||n.close()}),t.on("error",a=>n.error(a))},pull(){t.resume()},cancel(n){e=!0,t.destroy(n)}})};class r extends T{constructor(e,n){super(n),this._reader=Ae(e)}_read(e){var n=this;return(0,s.Z)(function*(){try{for(;;){const{done:a,value:o}=yield n._reader.read();if(a){n.push(null);break}if(!n.push(o)||n._cancelling){n._reading=!1;break}}}catch(a){n.emit("error",a)}})()}_destroy(e){this._reader.cancel(e)}}p=function(t,e){return new r(t,e)}}const m=new WeakSet,S=Symbol("externalBuffer");function O(r){if(this.stream=r,r[S]&&(this[S]=r[S].slice()),y(r)){const n=r.getReader();return this._read=n.read.bind(n),this._releaseLock=()=>{},void(this._cancel=()=>{})}let t=H(r);if("node"===t&&(r=I(r)),t){const n=r.getReader();return this._read=n.read.bind(n),this._releaseLock=()=>{n.closed.catch(function(){}),n.releaseLock()},void(this._cancel=n.cancel.bind(n))}let e=!1;this._read=(0,s.Z)(function*(){return e||m.has(r)?{value:void 0,done:!0}:(e=!0,{value:r,done:!1})}),this._releaseLock=()=>{if(e)try{m.add(r)}catch{}}}O.prototype.read=(0,s.Z)(function*(){return this[S]&&this[S].length?{done:!1,value:this[S].shift()}:this._read()}),O.prototype.releaseLock=function(){this[S]&&(this.stream[S]=this[S]),this._releaseLock()},O.prototype.cancel=function(r){return this._cancel(r)},O.prototype.readLine=(0,s.Z)(function*(){let r,t=[];for(;!r;){let{done:e,value:n}=yield this.read();if(n+="",e)return t.length?de(t):void 0;const a=n.indexOf("\n")+1;a&&(r=de(t.concat(n.substr(0,a))),t=[]),a!==n.length&&t.push(n.substr(a))}return this.unshift(...t),r}),O.prototype.readByte=(0,s.Z)(function*(){const{done:r,value:t}=yield this.read();if(r)return;const e=t[0];return this.unshift(Rt(t,1)),e}),O.prototype.readBytes=function(){var r=(0,s.Z)(function*(t){const e=[];let n=0;for(;;){const{done:a,value:o}=yield this.read();if(a)return e.length?de(e):void 0;if(e.push(o),n+=o.length,n>=t){const u=de(e);return this.unshift(Rt(u,t)),Rt(u,0,t)}}});return function(t){return r.apply(this,arguments)}}(),O.prototype.peekBytes=function(){var r=(0,s.Z)(function*(t){const e=yield this.readBytes(t);return this.unshift(e),e});return function(t){return r.apply(this,arguments)}}(),O.prototype.unshift=function(...r){this[S]||(this[S]=[]),1===r.length&&C(r[0])&&this[S].length&&r[0].length&&this[S][0].byteOffset>=r[0].length?this[S][0]=new Uint8Array(this[S][0].buffer,this[S][0].byteOffset-r[0].length,this[S][0].byteLength+r[0].length):this[S].unshift(...r.filter(t=>t&&t.length))},O.prototype.readToEnd=(0,s.Z)(function*(r=de){const t=[];for(;;){const{done:e,value:n}=yield this.read();if(e)break;t.push(n)}return r(t)});let V,G,{ReadableStream:k,WritableStream:P,TransformStream:D}=i;function l(){return F.apply(this,arguments)}function F(){return(F=(0,s.Z)(function*(){if(D)return;const[r,t]=yield Promise.all([M.e(7648).then(M.bind(M,7648)),M.e(1241).then(M.bind(M,1241))]);({ReadableStream:k,WritableStream:P,TransformStream:D}=r);const{createReadableStreamWrapper:e}=t;i.ReadableStream&&k!==i.ReadableStream&&(V=e(k),G=e(i.ReadableStream))})).apply(this,arguments)}const Y=x&&void 0;function W(r){let t=H(r);return"node"===t?I(r):"web"===t&&V?V(r):t?r:new k({start(e){e.enqueue(r),e.close()}})}function ne(r){if(H(r))return r;const t=new v;return(0,s.Z)(function*(){const e=Re(t);yield e.write(r),yield e.close()})(),t}function de(r){return r.some(t=>H(t)&&!y(t))?function(t){t=t.map(W);const e=We(function(){var o=(0,s.Z)(function*(u){yield Promise.all(a.map(f=>K(f,u)))});return function(u){return o.apply(this,arguments)}}());let n=Promise.resolve();const a=t.map((o,u)=>Ct(o,(f,w)=>(n=n.then(()=>Fe(f,e.writable,{preventClose:u!==t.length-1})),n)));return e.readable}(r):r.some(t=>y(t))?function(t){const e=new v;let n=Promise.resolve();return t.forEach((a,o)=>(n=n.then(()=>Fe(a,e,{preventClose:o!==t.length-1})),n)),e}(r):"string"==typeof r[0]?r.join(""):Y&&Y.isBuffer(r[0])?Y.concat(r):_(r)}function Ae(r){return new O(r)}function Re(r){return new h(r)}function Fe(r,t){return be.apply(this,arguments)}function be(){return(be=(0,s.Z)(function*(r,t,{preventClose:e=!1,preventAbort:n=!1,preventCancel:a=!1}={}){if(H(r)&&!y(r)){r=W(r);try{if(r[S]){const f=Re(t);for(let w=0;w<r[S].length;w++)yield f.ready,yield f.write(r[S][w]);f.releaseLock()}yield r.pipeTo(t,{preventClose:e,preventAbort:n,preventCancel:a})}catch{}return}const o=Ae(r=ne(r)),u=Re(t);try{for(;;){yield u.ready;const{done:f,value:w}=yield o.read();if(f){e||(yield u.close());break}yield u.write(w)}}catch(f){n||(yield u.abort(f))}finally{o.releaseLock(),u.releaseLock()}})).apply(this,arguments)}function Pe(r,t){const e=new D(t);return Fe(r,e.writable),e.readable}function We(r){let t,e,n=!1;return{readable:new k({start(a){e=a},pull(){t?t():n=!0},cancel:r},{highWaterMark:0}),writable:new P({write:(a=(0,s.Z)(function*(o){e.enqueue(o),n?n=!1:(yield new Promise(u=>{t=u}),t=null)}),function(u){return a.apply(this,arguments)}),close:e.close.bind(e),abort:e.error.bind(e)})};var a}function Ze(r,t=(()=>{}),e=(()=>{})){if(y(r)){const o=new v;return(0,s.Z)(function*(){const u=Re(o);try{const f=yield Le(r),w=t(f),g=e();let b;b=void 0!==w&&void 0!==g?de([w,g]):void 0!==w?w:g,yield u.write(b),yield u.close()}catch(f){yield u.abort(f)}})(),o}if(H(r))return Pe(r,{transform:(o,u)=>(0,s.Z)(function*(){try{const f=yield t(o);void 0!==f&&u.enqueue(f)}catch(f){u.error(f)}})(),flush:o=>(0,s.Z)(function*(){try{const u=yield e();void 0!==u&&o.enqueue(u)}catch(u){o.error(u)}})()});const n=t(r),a=e();return void 0!==n&&void 0!==a?de([n,a]):void 0!==n?n:a}function Ct(r,t){if(H(r)&&!y(r)){let n;const a=new D({start(f){n=f}}),o=Fe(r,a.writable),u=We(function(){var f=(0,s.Z)(function*(w){n.error(w),yield o,yield new Promise(setTimeout)});return function(w){return f.apply(this,arguments)}}());return t(a.readable,u.writable),u.readable}r=ne(r);const e=new v;return t(r,e),e}function tt(r,t){let e;const n=Ct(r,(a,o)=>{const u=Ae(a);u.remainder=()=>(u.releaseLock(),Fe(a,o),n),e=t(u)});return e}function Ht(r){if(y(r))return r.clone();if(H(r)){const t=function(e){if(y(e))throw Error("ArrayStream cannot be tee()d, use clone() instead");if(H(e)){const n=W(e).tee();return n[0][S]=n[1][S]=e[S],n}return[Rt(e),Rt(e)]}(r);return jt(r,t[0]),t[1]}return Rt(r)}function ct(r){return y(r)?Ht(r):H(r)?new k({start(t){const e=Ct(r,function(){var n=(0,s.Z)(function*(a,o){const u=Ae(a),f=Re(o);try{for(;;){yield f.ready;const{done:w,value:g}=yield u.read();if(w){try{t.close()}catch{}return void(yield f.close())}try{t.enqueue(g)}catch{}yield f.write(g)}}catch(w){t.error(w),yield f.abort(w)}});return function(a,o){return n.apply(this,arguments)}}());jt(r,e)}}):Rt(r)}function jt(r,t){Object.entries(Object.getOwnPropertyDescriptors(r.constructor.prototype)).forEach(([e,n])=>{"constructor"!==e&&(n.value?n.value=n.value.bind(t):n.get=n.get.bind(t),Object.defineProperty(r,e,n))})}function Rt(r,t=0,e=1/0){if(y(r))throw Error("Not implemented");if(H(r)){if(t>=0&&e>=0){let n=0;return Pe(r,{transform(a,o){n<e?(n+a.length>=t&&o.enqueue(Rt(a,Math.max(t-n,0),e-n)),n+=a.length):o.terminate()}})}if(t<0&&(e<0||e===1/0)){let n=[];return Ze(r,a=>{a.length>=-t?n=[a]:n.push(a)},()=>Rt(de(n),t,e))}if(0===t&&e<0){let n;return Ze(r,a=>{const o=n?de([n,a]):a;if(o.length>=-e)return n=Rt(o,e),Rt(o,t,e);n=o})}return console.warn(`stream.slice(input, ${t}, ${e}) not implemented efficiently.`),ee((0,s.Z)(function*(){return Rt(yield Le(r),t,e)}))}return r[S]&&(r=de(r[S].concat([r]))),!C(r)||Y&&Y.isBuffer(r)?r.slice(t,e):(e===1/0&&(e=r.length),r.subarray(t,e))}function Le(r){return Ge.apply(this,arguments)}function Ge(){return(Ge=(0,s.Z)(function*(r,t=de){return y(r)?r.readToEnd(t):H(r)?Ae(r).readToEnd(t):r})).apply(this,arguments)}function K(r,t){return U.apply(this,arguments)}function U(){return(U=(0,s.Z)(function*(r,t){if(H(r)){if(r.cancel)return r.cancel(t);if(r.destroy)return r.destroy(t),yield new Promise(setTimeout),t}})).apply(this,arguments)}function ee(r){const t=new v;return(0,s.Z)(function*(){const e=Re(t);try{yield e.write(yield r()),yield e.close()}catch(n){yield e.abort(n)}})(),t}class me{constructor(t){if(void 0===t)throw Error("Invalid BigInteger input");if(t instanceof Uint8Array){const e=t,n=Array(e.length);for(let a=0;a<e.length;a++){const o=e[a].toString(16);n[a]=e[a]<=15?"0"+o:o}this.value=BigInt("0x0"+n.join(""))}else this.value=BigInt(t)}clone(){return new me(this.value)}iinc(){return this.value++,this}inc(){return this.clone().iinc()}idec(){return this.value--,this}dec(){return this.clone().idec()}iadd(t){return this.value+=t.value,this}add(t){return this.clone().iadd(t)}isub(t){return this.value-=t.value,this}sub(t){return this.clone().isub(t)}imul(t){return this.value*=t.value,this}mul(t){return this.clone().imul(t)}imod(t){return this.value%=t.value,this.isNegative()&&this.iadd(t),this}mod(t){return this.clone().imod(t)}modExp(t,e){if(e.isZero())throw Error("Modulo cannot be zero");if(e.isOne())return new me(0);if(t.isNegative())throw Error("Unsopported negative exponent");let n=t.value,a=this.value;a%=e.value;let o=BigInt(1);for(;n>BigInt(0);){const u=n&BigInt(1);n>>=BigInt(1);const f=o*a%e.value;o=u?f:o,a=a*a%e.value}return new me(o)}modInv(t){const{gcd:e,x:n}=this._egcd(t);if(!e.isOne())throw Error("Inverse does not exist");return n.add(t).mod(t)}_egcd(t){let e=BigInt(0),n=BigInt(1),a=BigInt(1),o=BigInt(0),u=this.value;for(t=t.value;t!==BigInt(0);){const f=u/t;let w=e;e=a-f*e,a=w,w=n,n=o-f*n,o=w,w=t,t=u%t,u=w}return{x:new me(a),y:new me(o),gcd:new me(u)}}gcd(t){let e=this.value;for(t=t.value;t!==BigInt(0);){const n=t;t=e%t,e=n}return new me(e)}ileftShift(t){return this.value<<=t.value,this}leftShift(t){return this.clone().ileftShift(t)}irightShift(t){return this.value>>=t.value,this}rightShift(t){return this.clone().irightShift(t)}equal(t){return this.value===t.value}lt(t){return this.value<t.value}lte(t){return this.value<=t.value}gt(t){return this.value>t.value}gte(t){return this.value>=t.value}isZero(){return this.value===BigInt(0)}isOne(){return this.value===BigInt(1)}isNegative(){return this.value<BigInt(0)}isEven(){return!(this.value&BigInt(1))}abs(){const t=this.clone();return this.isNegative()&&(t.value=-t.value),t}toString(){return this.value.toString()}toNumber(){const t=Number(this.value);if(t>Number.MAX_SAFE_INTEGER)throw Error("Number can only safely store up to 53 bits");return t}getBit(t){return(this.value>>BigInt(t)&BigInt(1))===BigInt(0)?0:1}bitLength(){const t=new me(0),e=new me(1),n=new me(-1),a=this.isNegative()?n:t;let o=1;const u=this.clone();for(;!u.irightShift(e).equal(a);)o++;return o}byteLength(){const t=new me(0),e=new me(-1),n=this.isNegative()?e:t,a=new me(8);let o=1;const u=this.clone();for(;!u.irightShift(a).equal(n);)o++;return o}toUint8Array(t="be",e){let n=this.value.toString(16);n.length%2==1&&(n="0"+n);const a=n.length/2,o=new Uint8Array(e||a),u=e?e-a:0;let f=0;for(;f<a;)o[f+u]=parseInt(n.slice(2*f,2*f+2),16),f++;return"be"!==t&&o.reverse(),o}}const Ue=(()=>{try{return!1}catch{}return!1})(),z={isString:function(r){return"string"==typeof r||String.prototype.isPrototypeOf(r)},isArray:function(r){return Array.prototype.isPrototypeOf(r)},isUint8Array:C,isStream:H,readNumber:function(r){let t=0;for(let e=0;e<r.length;e++)t+=256**e*r[r.length-1-e];return t},writeNumber:function(r,t){const e=new Uint8Array(t);for(let n=0;n<t;n++)e[n]=r>>8*(t-n-1)&255;return e},readDate:function(r){const t=z.readNumber(r);return new Date(1e3*t)},writeDate:function(r){const t=Math.floor(r.getTime()/1e3);return z.writeNumber(t,4)},normalizeDate:function(r=Date.now()){return null===r||r===1/0?r:new Date(1e3*Math.floor(+r/1e3))},readMPI:function(r){return r.subarray(2,2+(7+(r[0]<<8|r[1])>>>3))},leftPad(r,t){const e=new Uint8Array(t);return e.set(r,t-r.length),e},uint8ArrayToMPI:function(r){const t=z.uint8ArrayBitLength(r);if(0===t)throw Error("Zero MPI");const e=r.subarray(r.length-Math.ceil(t/8)),n=new Uint8Array([(65280&t)>>8,255&t]);return z.concatUint8Array([n,e])},uint8ArrayBitLength:function(r){let t;for(t=0;t<r.length&&0===r[t];t++);if(t===r.length)return 0;const e=r.subarray(t);return 8*(e.length-1)+z.nbits(e[0])},hexToUint8Array:function(r){const t=new Uint8Array(r.length>>1);for(let e=0;e<r.length>>1;e++)t[e]=parseInt(r.substr(e<<1,2),16);return t},uint8ArrayToHex:function(r){const t=[],e=r.length;let n,a=0;for(;a<e;){for(n=r[a++].toString(16);n.length<2;)n="0"+n;t.push(""+n)}return t.join("")},stringToUint8Array:function(r){return Ze(r,t=>{if(!z.isString(t))throw Error("stringToUint8Array: Data must be in the form of a string");const e=new Uint8Array(t.length);for(let n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e})},uint8ArrayToString:function(r){const t=[],n=(r=new Uint8Array(r)).length;for(let a=0;a<n;a+=16384)t.push(String.fromCharCode.apply(String,r.subarray(a,a+16384<n?a+16384:n)));return t.join("")},encodeUTF8:function(r){const t=new TextEncoder("utf-8");function e(n,a=!1){return t.encode(n,{stream:!a})}return Ze(r,e,()=>e("",!0))},decodeUTF8:function(r){const t=new TextDecoder("utf-8");function e(n,a=!1){return t.decode(n,{stream:!a})}return Ze(r,e,()=>e(new Uint8Array,!0))},concat:de,concatUint8Array:_,equalsUint8Array:function(r,t){if(!z.isUint8Array(r)||!z.isUint8Array(t))throw Error("Data must be in the form of a Uint8Array");if(r.length!==t.length)return!1;for(let e=0;e<r.length;e++)if(r[e]!==t[e])return!1;return!0},writeChecksum:function(r){let t=0;for(let e=0;e<r.length;e++)t=t+r[e]&65535;return z.writeNumber(t,2)},printDebug:function(r){Ue&&console.log(r)},printDebugError:function(r){Ue&&console.error(r)},nbits:function(r){let t=1,e=r>>>16;return 0!==e&&(r=e,t+=16),e=r>>8,0!==e&&(r=e,t+=8),e=r>>4,0!==e&&(r=e,t+=4),e=r>>2,0!==e&&(r=e,t+=2),e=r>>1,0!==e&&(r=e,t+=1),t},double:function(r){const t=new Uint8Array(r.length),e=r.length-1;for(let n=0;n<e;n++)t[n]=r[n]<<1^r[n+1]>>7;return t[e]=r[e]<<1^135*(r[0]>>7),t},shiftRight:function(r,t){if(t)for(let e=r.length-1;e>=0;e--)r[e]>>=t,e>0&&(r[e]|=r[e-1]<<8-t);return r},getWebCrypto:function(){return void 0!==i&&i.crypto&&i.crypto.subtle},detectBigInt:()=>typeof BigInt<"u",getBigInteger:(r=(0,s.Z)(function*(){if(z.detectBigInt())return me;{const{default:t}=yield Promise.all([M.e(2983),M.e(5058)]).then(M.bind(M,5058));return t}}),function(){return r.apply(this,arguments)}),getNodeCrypto:function(){},getNodeZlib:function(){},getNodeBuffer:function(){return{}.Buffer},getHardwareConcurrency:function(){return typeof navigator<"u"?navigator.hardwareConcurrency||1:(void 0).cpus().length},isEmailAddress:function(r){return!!z.isString(r)&&/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+([a-zA-Z]{2,}|xn--[a-zA-Z\-0-9]+)))$/.test(r)},canonicalizeEOL:function(r){let t=!1;return Ze(r,e=>{let n;t&&(e=z.concatUint8Array([new Uint8Array([13]),e])),13===e[e.length-1]?(t=!0,e=e.subarray(0,-1)):t=!1;const a=[];for(let f=0;n=e.indexOf(10,f)+1,n;f=n)13!==e[n-2]&&a.push(n);if(!a.length)return e;const o=new Uint8Array(e.length+a.length);let u=0;for(let f=0;f<a.length;f++){const w=e.subarray(a[f-1]||0,a[f]);o.set(w,u),u+=w.length,o[u-1]=13,o[u]=10,u++}return o.set(e.subarray(a[a.length-1]||0),u),o},()=>t?new Uint8Array([13]):void 0)},nativeEOL:function(r){let t=!1;return Ze(r,e=>{let n;13===(e=t&&10!==e[0]?z.concatUint8Array([new Uint8Array([13]),e]):new Uint8Array(e))[e.length-1]?(t=!0,e=e.subarray(0,-1)):t=!1;let a=0;for(let o=0;o!==e.length;o=n){n=e.indexOf(13,o)+1,n||(n=e.length);const u=n-(10===e[n]?1:0);o&&e.copyWithin(a,o,u),a+=u-o}return e.subarray(0,a)},()=>t?new Uint8Array([13]):void 0)},removeTrailingSpaces:function(r){return r.split("\n").map(t=>{let e=t.length-1;for(;e>=0&&(" "===t[e]||"\t"===t[e]||"\r"===t[e]);e--);return t.substr(0,e+1)}).join("\n")},wrapError:function(r,t){if(!t)return Error(r);try{t.message=r+": "+t.message}catch{}return t},constructAllowedPackets:function(r){const t={};return r.forEach(e=>{if(!e.tag)throw Error("Invalid input: expected a packet class");t[e.tag]=e}),t},anyPromise:function(r){return new Promise(function(){var t=(0,s.Z)(function*(e,n){let a;yield Promise.all(r.map(function(){var o=(0,s.Z)(function*(u){try{e(yield u)}catch(f){a=f}});return function(u){return o.apply(this,arguments)}}())),n(a)});return function(e,n){return t.apply(this,arguments)}}())},selectUint8Array:function(r,t,e){const n=Math.max(t.length,e.length),a=new Uint8Array(n);let o=0;for(let u=0;u<a.length;u++)a[u]=t[u]&256-r|e[u]&255+r,o+=r&u<t.length|1-r&u<e.length;return a.subarray(0,o)},selectUint8:function(r,t,e){return t&256-r|e&255+r}},Ie=z.getNodeBuffer();var r;let lt,Pt;function kt(r){let t=new Uint8Array;return Ze(r,e=>{t=z.concatUint8Array([t,e]);const n=[],a=Math.floor(t.length/45),o=45*a,u=lt(t.subarray(0,o));for(let f=0;f<a;f++)n.push(u.substr(60*f,60)),n.push("\n");return t=t.subarray(o),n.join("")},()=>t.length?lt(t)+"\n":"")}function at(r){let t="";return Ze(r,e=>{t+=e;let n=0;const a=[" ","\t","\r","\n"];for(let f=0;f<a.length;f++){const w=a[f];for(let g=t.indexOf(w);-1!==g;g=t.indexOf(w,g+1))n++}let o=t.length;for(;o>0&&(o-n)%4!=0;o--)a.includes(t[o])&&n--;const u=Pt(t.substr(0,o));return t=t.substr(o),u},()=>Pt(t))}function _t(r){return at(r.replace(/-/g,"+").replace(/_/g,"/"))}function Vt(r,t){let e=kt(r).replace(/[\r\n]/g,"");return t&&(e=e.replace(/[+]/g,"-").replace(/[/]/g,"_").replace(/[=]/g,"")),e}Ie?(lt=r=>Ie.from(r).toString("base64"),Pt=r=>{const t=Ie.from(r,"base64");return new Uint8Array(t.buffer,t.byteOffset,t.byteLength)}):(lt=r=>btoa(z.uint8ArrayToString(r)),Pt=r=>z.stringToUint8Array(atob(r)));const Qt=Symbol("byValue");var Z={curve:{p256:"p256","P-256":"p256",secp256r1:"p256",prime256v1:"p256","1.2.840.10045.3.1.7":"p256","2a8648ce3d030107":"p256","2A8648CE3D030107":"p256",p384:"p384","P-384":"p384",secp384r1:"p384","1.3.132.0.34":"p384","2b81040022":"p384","2B81040022":"p384",p521:"p521","P-521":"p521",secp521r1:"p521","1.3.132.0.35":"p521","2b81040023":"p521","2B81040023":"p521",secp256k1:"secp256k1","1.3.132.0.10":"secp256k1","2b8104000a":"secp256k1","2B8104000A":"secp256k1",ED25519:"ed25519",ed25519:"ed25519",Ed25519:"ed25519","1.3.6.1.4.1.11591.15.1":"ed25519","2b06010401da470f01":"ed25519","2B06010401DA470F01":"ed25519",X25519:"curve25519",cv25519:"curve25519",curve25519:"curve25519",Curve25519:"curve25519","1.3.6.1.4.1.3029.1.5.1":"curve25519","2b060104019755010501":"curve25519","2B060104019755010501":"curve25519",brainpoolP256r1:"brainpoolP256r1","1.3.36.3.3.2.8.1.1.7":"brainpoolP256r1","2b2403030208010107":"brainpoolP256r1","2B2403030208010107":"brainpoolP256r1",brainpoolP384r1:"brainpoolP384r1","1.3.36.3.3.2.8.1.1.11":"brainpoolP384r1","2b240303020801010b":"brainpoolP384r1","2B240303020801010B":"brainpoolP384r1",brainpoolP512r1:"brainpoolP512r1","1.3.36.3.3.2.8.1.1.13":"brainpoolP512r1","2b240303020801010d":"brainpoolP512r1","2B240303020801010D":"brainpoolP512r1"},s2k:{simple:0,salted:1,iterated:3,gnu:101},publicKey:{rsaEncryptSign:1,rsaEncrypt:2,rsaSign:3,elgamal:16,dsa:17,ecdh:18,ecdsa:19,eddsa:22,aedh:23,aedsa:24},symmetric:{plaintext:0,idea:1,tripledes:2,cast5:3,blowfish:4,aes128:7,aes192:8,aes256:9,twofish:10},compression:{uncompressed:0,zip:1,zlib:2,bzip2:3},hash:{md5:1,sha1:2,ripemd:3,sha256:8,sha384:9,sha512:10,sha224:11},webHash:{"SHA-1":2,"SHA-256":8,"SHA-384":9,"SHA-512":10},aead:{eax:1,ocb:2,experimentalGCM:100},packet:{publicKeyEncryptedSessionKey:1,signature:2,symEncryptedSessionKey:3,onePassSignature:4,secretKey:5,publicKey:6,secretSubkey:7,compressedData:8,symmetricallyEncryptedData:9,marker:10,literalData:11,trust:12,userID:13,publicSubkey:14,userAttribute:17,symEncryptedIntegrityProtectedData:18,modificationDetectionCode:19,aeadEncryptedData:20},literal:{binary:98,text:116,utf8:117,mime:109},signature:{binary:0,text:1,standalone:2,certGeneric:16,certPersona:17,certCasual:18,certPositive:19,certRevocation:48,subkeyBinding:24,keyBinding:25,key:31,keyRevocation:32,subkeyRevocation:40,timestamp:64,thirdParty:80},signatureSubpacket:{signatureCreationTime:2,signatureExpirationTime:3,exportableCertification:4,trustSignature:5,regularExpression:6,revocable:7,keyExpirationTime:9,placeholderBackwardsCompatibility:10,preferredSymmetricAlgorithms:11,revocationKey:12,issuer:16,notationData:20,preferredHashAlgorithms:21,preferredCompressionAlgorithms:22,keyServerPreferences:23,preferredKeyServer:24,primaryUserID:25,policyURI:26,keyFlags:27,signersUserID:28,reasonForRevocation:29,features:30,signatureTarget:31,embeddedSignature:32,issuerFingerprint:33,preferredAEADAlgorithms:34},keyFlags:{certifyKeys:1,signData:2,encryptCommunication:4,encryptStorage:8,splitPrivateKey:16,authentication:32,sharedPrivateKey:128},armor:{multipartSection:0,multipartLast:1,signed:2,message:3,publicKey:4,privateKey:5,signature:6},reasonForRevocation:{noReason:0,keySuperseded:1,keyCompromised:2,keyRetired:3,userIDInvalid:32},features:{modificationDetection:1,aead:2,v5Keys:4},write:function(r,t){if("number"==typeof t&&(t=this.read(r,t)),void 0!==r[t])return r[t];throw Error("Invalid enum value.")},read:function(r,t){if(r[Qt]||(r[Qt]=[],Object.entries(r).forEach(([e,n])=>{r[Qt][n]=e})),void 0!==r[Qt][t])return r[Qt][t];throw Error("Invalid enum value.")}},ut={preferredHashAlgorithm:Z.hash.sha256,preferredSymmetricAlgorithm:Z.symmetric.aes256,preferredCompressionAlgorithm:Z.compression.uncompressed,deflateLevel:6,aeadProtect:!1,preferredAEADAlgorithm:Z.aead.eax,aeadChunkSizeByte:12,v5Keys:!1,s2kIterationCountByte:224,allowUnauthenticatedMessages:!1,allowUnauthenticatedStream:!1,checksumRequired:!1,minRSABits:2047,passwordCollisionCheck:!1,revocationsExpire:!1,allowInsecureDecryptionWithSigningKeys:!1,allowInsecureVerificationWithReformattedKeys:!1,constantTimePKCS1Decryption:!1,constantTimePKCS1DecryptionSupportedSymmetricAlgorithms:new Set([Z.symmetric.aes128,Z.symmetric.aes192,Z.symmetric.aes256]),minBytesForWebCrypto:1e3,ignoreUnsupportedPackets:!0,ignoreMalformedPackets:!1,showVersion:!1,showComment:!1,versionString:"OpenPGP.js 5.4.0",commentString:"https://openpgpjs.org",maxUserIDLength:5120,knownNotations:["preferred-email-encoding@pgp.com","pka-address@gnupg.org"],useIndutnyElliptic:!0,rejectHashAlgorithms:new Set([Z.hash.md5,Z.hash.ripemd]),rejectMessageHashAlgorithms:new Set([Z.hash.md5,Z.hash.ripemd,Z.hash.sha1]),rejectPublicKeyAlgorithms:new Set([Z.publicKey.elgamal,Z.publicKey.dsa]),rejectCurves:new Set([Z.curve.brainpoolP256r1,Z.curve.brainpoolP384r1,Z.curve.brainpoolP512r1,Z.curve.secp256k1])};function je(r){const t=r.match(/^-----BEGIN PGP (MESSAGE, PART \d+\/\d+|MESSAGE, PART \d+|SIGNED MESSAGE|MESSAGE|PUBLIC KEY BLOCK|PRIVATE KEY BLOCK|SIGNATURE)-----$/m);if(!t)throw Error("Unknown ASCII armor type");return/MESSAGE, PART \d+\/\d+/.test(t[1])?Z.armor.multipartSection:/MESSAGE, PART \d+/.test(t[1])?Z.armor.multipartLast:/SIGNED MESSAGE/.test(t[1])?Z.armor.signed:/MESSAGE/.test(t[1])?Z.armor.message:/PUBLIC KEY BLOCK/.test(t[1])?Z.armor.publicKey:/PRIVATE KEY BLOCK/.test(t[1])?Z.armor.privateKey:/SIGNATURE/.test(t[1])?Z.armor.signature:void 0}function mt(r,t){let e="";return t.showVersion&&(e+="Version: "+t.versionString+"\n"),t.showComment&&(e+="Comment: "+t.commentString+"\n"),r&&(e+="Comment: "+r+"\n"),e+="\n",e}function X(r){return kt(function(t){let e=13501623;return Ze(t,n=>{const a=Me?Math.floor(n.length/4):0,o=new Uint32Array(n.buffer,n.byteOffset,a);for(let u=0;u<a;u++)e^=o[u],e=ue[0][e>>24&255]^ue[1][e>>16&255]^ue[2][e>>8&255]^ue[3][e>>0&255];for(let u=4*a;u<n.length;u++)e=e>>8^ue[0][255&e^n[u]]},()=>new Uint8Array([e,e>>8,e>>16]))}(r))}const ue=[Array(255),Array(255),Array(255),Array(255)];for(let r=0;r<=255;r++){let t=r<<16;for(let e=0;e<8;e++)t=t<<1^(0!=(8388608&t)?8801531:0);ue[0][r]=(16711680&t)>>16|65280&t|(255&t)<<16}for(let r=0;r<=255;r++)ue[1][r]=ue[0][r]>>8^ue[0][255&ue[0][r]];for(let r=0;r<=255;r++)ue[2][r]=ue[1][r]>>8^ue[0][255&ue[1][r]];for(let r=0;r<=255;r++)ue[3][r]=ue[2][r]>>8^ue[0][255&ue[2][r]];const Me=function(){const r=new ArrayBuffer(2);return new DataView(r).setInt16(0,255,!0),255===new Int16Array(r)[0]}();function et(r){for(let t=0;t<r.length;t++){if(!/^([^\s:]|[^\s:][^:]*[^\s:]): .+$/.test(r[t]))throw Error("Improperly formatted armor header: "+r[t]);/^(Version|Comment|MessageID|Hash|Charset): .+$/.test(r[t])||z.printDebugError(Error("Unknown header: "+r[t]))}}function gt(r){let t=r,e="";const n=r.lastIndexOf("=");return n>=0&&n!==r.length-1&&(t=r.slice(0,n),e=r.slice(n+1).substr(0,4)),{body:t,checksum:e}}function Tt(r,t=ut){return new Promise(function(){var e=(0,s.Z)(function*(n,a){try{const o=/^-----[^-]+-----$/m,u=/^[ \f\r\t\u00a0\u2000-\u200a\u202f\u205f\u3000]*$/;let f;const w=[];let g,b,L,$=w,j=[],se=at(Ct(r,function(){var pe=(0,s.Z)(function*(xe,Ke){const Qe=Ae(xe);try{for(;;){let le=yield Qe.readLine();if(void 0===le)throw Error("Misformed armored text");if(le=z.removeTrailingSpaces(le.replace(/[\r\n]/g,"")),f)if(g)b||2!==f||(o.test(le)?(j=j.join("\r\n"),b=!0,et($),$=[],g=!1):j.push(le.replace(/^- /,"")));else if(o.test(le)&&a(Error("Mandatory blank line missing between armor headers and armor data")),u.test(le)){if(et($),g=!0,b||2!==f){n({text:j,data:se,headers:w,type:f});break}}else $.push(le);else o.test(le)&&(f=je(le))}}catch(le){return void a(le)}const Be=Re(Ke);try{for(;;){yield Be.ready;const{done:le,value:Xe}=yield Qe.read();if(le)throw Error("Misformed armored text");const He=Xe+"";if(-1!==He.indexOf("=")||-1!==He.indexOf("-")){let $e=yield Qe.readToEnd();$e.length||($e=""),$e=He+$e,$e=z.removeTrailingSpaces($e.replace(/\r/g,""));const rt=$e.split(o);if(1===rt.length)throw Error("Misformed armored text");const Je=gt(rt[0].slice(0,-1));L=Je.checksum,yield Be.write(Je.body);break}yield Be.write(He)}yield Be.ready,yield Be.close()}catch(le){yield Be.abort(le)}});return function(xe,Ke){return pe.apply(this,arguments)}}()));se=Ct(se,function(){var pe=(0,s.Z)(function*(xe,Ke){const Qe=Le(X(ct(xe)));Qe.catch(()=>{}),yield Fe(xe,Ke,{preventClose:!0});const Be=Re(Ke);try{const le=(yield Qe).replace("\n","");if(L!==le&&(L||t.checksumRequired))throw Error("Ascii armor integrity check failed");yield Be.ready,yield Be.close()}catch(le){yield Be.abort(le)}});return function(xe,Ke){return pe.apply(this,arguments)}}())}catch(o){a(o)}});return function(n,a){return e.apply(this,arguments)}}()).then(function(){var e=(0,s.Z)(function*(n){return y(n.data)&&(n.data=yield Le(n.data)),n});return function(n){return e.apply(this,arguments)}}())}function $t(r,t,e,n,a,o=ut){let u,f;r===Z.armor.signed&&(u=t.text,f=t.hash,t=t.data);const w=ct(t),g=[];switch(r){case Z.armor.multipartSection:g.push("-----BEGIN PGP MESSAGE, PART "+e+"/"+n+"-----\n"),g.push(mt(a,o)),g.push(kt(t)),g.push("=",X(w)),g.push("-----END PGP MESSAGE, PART "+e+"/"+n+"-----\n");break;case Z.armor.multipartLast:g.push("-----BEGIN PGP MESSAGE, PART "+e+"-----\n"),g.push(mt(a,o)),g.push(kt(t)),g.push("=",X(w)),g.push("-----END PGP MESSAGE, PART "+e+"-----\n");break;case Z.armor.signed:g.push("\n-----BEGIN PGP SIGNED MESSAGE-----\n"),g.push("Hash: "+f+"\n\n"),g.push(u.replace(/^-/gm,"- -")),g.push("\n-----BEGIN PGP SIGNATURE-----\n"),g.push(mt(a,o)),g.push(kt(t)),g.push("=",X(w)),g.push("-----END PGP SIGNATURE-----\n");break;case Z.armor.message:g.push("-----BEGIN PGP MESSAGE-----\n"),g.push(mt(a,o)),g.push(kt(t)),g.push("=",X(w)),g.push("-----END PGP MESSAGE-----\n");break;case Z.armor.publicKey:g.push("-----BEGIN PGP PUBLIC KEY BLOCK-----\n"),g.push(mt(a,o)),g.push(kt(t)),g.push("=",X(w)),g.push("-----END PGP PUBLIC KEY BLOCK-----\n");break;case Z.armor.privateKey:g.push("-----BEGIN PGP PRIVATE KEY BLOCK-----\n"),g.push(mt(a,o)),g.push(kt(t)),g.push("=",X(w)),g.push("-----END PGP PRIVATE KEY BLOCK-----\n");break;case Z.armor.signature:g.push("-----BEGIN PGP SIGNATURE-----\n"),g.push(mt(a,o)),g.push(kt(t)),g.push("=",X(w)),g.push("-----END PGP SIGNATURE-----\n")}return z.concat(g)}class qt{constructor(){this.bytes=""}read(t){this.bytes=z.uint8ArrayToString(t.subarray(0,8))}write(){return z.stringToUint8Array(this.bytes)}toHex(){return z.uint8ArrayToHex(z.stringToUint8Array(this.bytes))}equals(t,e=!1){return e&&(t.isWildcard()||this.isWildcard())||this.bytes===t.bytes}isNull(){return""===this.bytes}isWildcard(){return/^0+$/.test(this.toHex())}static mapToHex(t){return t.toHex()}static fromID(t){const e=new qt;return e.read(z.hexToUint8Array(t)),e}static wildcard(){const t=new qt;return t.read(new Uint8Array(8)),t}}var Lt=function(){var r,t,e=!1;function n(L,$){var j=r[(t[L]+t[$])%255];return 0!==L&&0!==$||(j=0),j}var a,o,u,f,w=!1,b=function(L,$){w||function g(){function L(pe){var xe,Ke,Qe,Be,le;for(le=void 0,le=r[255-t[Be=pe]],0===Be&&(le=0),Ke=Qe=le,xe=0;xe<4;xe++)Qe^=Ke=255&(Ke<<1|Ke>>>7);return 99^Qe}e||function(){r=[],t=[];var pe,xe,Ke=1;for(pe=0;pe<255;pe++)r[pe]=Ke,xe=128&Ke,Ke<<=1,Ke&=255,128===xe&&(Ke^=27),Ke^=r[pe],t[r[pe]]=pe;r[255]=r[0],t[0]=0,e=!0}(),a=[],o=[],u=[[],[],[],[]],f=[[],[],[],[]];for(var $=0;$<256;$++){var j=L($);a[$]=j,o[j]=$,u[0][$]=n(2,j)<<24|j<<16|j<<8|n(3,j),f[0][j]=n(14,$)<<24|n(9,$)<<16|n(13,$)<<8|n(11,$);for(var se=1;se<4;se++)u[se][$]=u[se-1][$]>>>8|u[se-1][$]<<24,f[se][j]=f[se-1][j]>>>8|f[se-1][j]<<24}w=!0}();var j=new Uint32Array($);j.set(a,512),j.set(o,768);for(var se=0;se<4;se++)j.set(u[se],4096+1024*se>>2),j.set(f[se],8192+1024*se>>2);var pe=function(xe,Ke,Qe){var Be=0,le=0,Xe=0,He=0,$e=0,rt=0,Je=0,dt=0,It=0,Ut=0,zt=0,pt=0,Ye=0,rr=0,ze=0,yt=0,Ot=0,Zt=0,Kt=0,Nt=0,Gt=0,xt=new xe.Uint32Array(Qe),ge=new xe.Uint8Array(Qe);function Ne(ae,ie,he,vt,tr,ur,hr,sr){ie|=0,vt|=0,tr|=0,ur|=0,hr|=0,sr|=0;var Or,Vr,jr,ar=0,xr=0,vr=0,er=0;for(Or=1024|(he|=0),Vr=2048|he,jr=3072|he,tr^=xt[(0|(ae|=0))>>2],ur^=xt[(4|ae)>>2],hr^=xt[(8|ae)>>2],sr^=xt[(12|ae)>>2],er=16;(0|er)<=vt<<4;er=er+16|0)ar=xt[(he|ur>>22&1020)>>2]^xt[(Or|hr>>14&1020)>>2]^xt[(Vr|sr>>6&1020)>>2]^xt[(jr|tr<<2&1020)>>2]^xt[(ae|er|4)>>2],xr=xt[(he|hr>>22&1020)>>2]^xt[(Or|sr>>14&1020)>>2]^xt[(Vr|tr>>6&1020)>>2]^xt[(jr|ur<<2&1020)>>2]^xt[(ae|er|8)>>2],vr=xt[(he|sr>>22&1020)>>2]^xt[(Or|tr>>14&1020)>>2]^xt[(Vr|ur>>6&1020)>>2]^xt[(jr|hr<<2&1020)>>2]^xt[(ae|er|12)>>2],tr=xt[(he|tr>>22&1020)>>2]^xt[(Or|ur>>14&1020)>>2]^xt[(Vr|hr>>6&1020)>>2]^xt[(jr|sr<<2&1020)>>2]^xt[(ae|er|0)>>2],ur=ar,hr=xr,sr=vr;Be=xt[(ie|tr>>22&1020)>>2]<<24^xt[(ie|ur>>14&1020)>>2]<<16^xt[(ie|hr>>6&1020)>>2]<<8^xt[(ie|sr<<2&1020)>>2]^xt[(ae|er|0)>>2],le=xt[(ie|ur>>22&1020)>>2]<<24^xt[(ie|hr>>14&1020)>>2]<<16^xt[(ie|sr>>6&1020)>>2]<<8^xt[(ie|tr<<2&1020)>>2]^xt[(ae|er|4)>>2],Xe=xt[(ie|hr>>22&1020)>>2]<<24^xt[(ie|sr>>14&1020)>>2]<<16^xt[(ie|tr>>6&1020)>>2]<<8^xt[(ie|ur<<2&1020)>>2]^xt[(ae|er|8)>>2],He=xt[(ie|sr>>22&1020)>>2]<<24^xt[(ie|tr>>14&1020)>>2]<<16^xt[(ie|ur>>6&1020)>>2]<<8^xt[(ie|hr<<2&1020)>>2]^xt[(ae|er|12)>>2]}function Oe(ae,ie,he,vt){Ne(0,2048,4096,Gt,ae|=0,ie|=0,he|=0,vt|=0)}function ye(ae,ie,he,vt){Ne(0,2048,4096,Gt,$e^(ae|=0),rt^(ie|=0),Je^(he|=0),dt^(vt|=0)),$e=Be,rt=le,Je=Xe,dt=He}var _e=[Oe,function R(ae,ie,he,vt){var tr;Ne(1024,3072,8192,Gt,ae|=0,vt|=0,he|=0,ie|=0),tr=le,le=He,He=tr},ye,function qe(ae,ie,he,vt){var tr;Ne(1024,3072,8192,Gt,ae|=0,vt|=0,he|=0,ie|=0),tr=le,le=He,He=tr,Be^=$e,le^=rt,Xe^=Je,He^=dt,$e=ae,rt=ie,Je=he,dt=vt},function nt(ae,ie,he,vt){ae|=0,ie|=0,he|=0,vt|=0,Ne(0,2048,4096,Gt,$e,rt,Je,dt),$e=Be^=ae,rt=le^=ie,Je=Xe^=he,dt=He^=vt},function it(ae,ie,he,vt){ae|=0,ie|=0,he|=0,vt|=0,Ne(0,2048,4096,Gt,$e,rt,Je,dt),Be^=ae,le^=ie,Xe^=he,He^=vt,$e=ae,rt=ie,Je=he,dt=vt},function q(ae,ie,he,vt){ae|=0,ie|=0,he|=0,vt|=0,Ne(0,2048,4096,Gt,$e,rt,Je,dt),$e=Be,rt=le,Je=Xe,dt=He,Be^=ae,le^=ie,Xe^=he,He^=vt},function Q(ae,ie,he,vt){ae|=0,ie|=0,he|=0,vt|=0,Ne(0,2048,4096,Gt,It,Ut,zt,pt),It=~Ye&It|Ye&It+(0==(0|(Ut=~rr&Ut|rr&Ut+(0==(0|(zt=~ze&zt|ze&zt+(0==(0|(pt=~yt&pt|yt&pt+1))))))))),Be^=ae,le^=ie,Xe^=he,He^=vt}],ke=[ye,function te(ae,ie,he,vt){ae|=0,ie|=0,he|=0,vt|=0;var tr=0,ur=0,hr=0,sr=0,Or=0,Vr=0,jr=0,qr=0,ar=0,xr=0;for(ae^=$e,ie^=rt,he^=Je,vt^=dt,tr=0|Ot,ur=0|Zt,hr=0|Kt,sr=0|Nt;(0|ar)<128;ar=ar+1|0)tr>>>31&&(Or^=ae,Vr^=ie,jr^=he,qr^=vt),tr=tr<<1|ur>>>31,ur=ur<<1|hr>>>31,hr=hr<<1|sr>>>31,sr<<=1,xr=1&vt,vt=vt>>>1|he<<31,he=he>>>1|ie<<31,ie=ie>>>1|ae<<31,ae>>>=1,xr&&(ae^=3774873600);$e=Or,rt=Vr,Je=jr,dt=qr}];return{set_rounds:function oe(ae){Gt=ae|=0},set_state:function Ce(ae,ie,he,vt){Be=ae|=0,le=ie|=0,Xe=he|=0,He=vt|=0},set_iv:function ve(ae,ie,he,vt){$e=ae|=0,rt=ie|=0,Je=he|=0,dt=vt|=0},set_nonce:function Te(ae,ie,he,vt){It=ae|=0,Ut=ie|=0,zt=he|=0,pt=vt|=0},set_mask:function St(ae,ie,he,vt){Ye=ae|=0,rr=ie|=0,ze=he|=0,yt=vt|=0},set_counter:function bt(ae,ie,he,vt){pt=~yt&pt|yt&(vt|=0),zt=~ze&zt|ze&(he|=0),Ut=~rr&Ut|rr&(ie|=0),It=~Ye&It|Ye&(ae|=0)},get_state:function At(ae){return 15&(ae|=0)?-1:(ge[0|ae]=Be>>>24,ge[1|ae]=Be>>>16&255,ge[2|ae]=Be>>>8&255,ge[3|ae]=255&Be,ge[4|ae]=le>>>24,ge[5|ae]=le>>>16&255,ge[6|ae]=le>>>8&255,ge[7|ae]=255&le,ge[8|ae]=Xe>>>24,ge[9|ae]=Xe>>>16&255,ge[10|ae]=Xe>>>8&255,ge[11|ae]=255&Xe,ge[12|ae]=He>>>24,ge[13|ae]=He>>>16&255,ge[14|ae]=He>>>8&255,ge[15|ae]=255&He,16)},get_iv:function Et(ae){return 15&(ae|=0)?-1:(ge[0|ae]=$e>>>24,ge[1|ae]=$e>>>16&255,ge[2|ae]=$e>>>8&255,ge[3|ae]=255&$e,ge[4|ae]=rt>>>24,ge[5|ae]=rt>>>16&255,ge[6|ae]=rt>>>8&255,ge[7|ae]=255&rt,ge[8|ae]=Je>>>24,ge[9|ae]=Je>>>16&255,ge[10|ae]=Je>>>8&255,ge[11|ae]=255&Je,ge[12|ae]=dt>>>24,ge[13|ae]=dt>>>16&255,ge[14|ae]=dt>>>8&255,ge[15|ae]=255&dt,16)},gcm_init:function Ee(){Oe(0,0,0,0),Ot=Be,Zt=le,Kt=Xe,Nt=He},cipher:function we(ae,ie,he){ae|=0,he|=0;var vt=0;if(15&(ie|=0))return-1;for(;(0|he)>=16;)_e[7&ae](ge[0|ie]<<24|ge[1|ie]<<16|ge[2|ie]<<8|ge[3|ie],ge[4|ie]<<24|ge[5|ie]<<16|ge[6|ie]<<8|ge[7|ie],ge[8|ie]<<24|ge[9|ie]<<16|ge[10|ie]<<8|ge[11|ie],ge[12|ie]<<24|ge[13|ie]<<16|ge[14|ie]<<8|ge[15|ie]),ge[0|ie]=Be>>>24,ge[1|ie]=Be>>>16&255,ge[2|ie]=Be>>>8&255,ge[3|ie]=255&Be,ge[4|ie]=le>>>24,ge[5|ie]=le>>>16&255,ge[6|ie]=le>>>8&255,ge[7|ie]=255&le,ge[8|ie]=Xe>>>24,ge[9|ie]=Xe>>>16&255,ge[10|ie]=Xe>>>8&255,ge[11|ie]=255&Xe,ge[12|ie]=He>>>24,ge[13|ie]=He>>>16&255,ge[14|ie]=He>>>8&255,ge[15|ie]=255&He,vt=vt+16|0,ie=ie+16|0,he=he-16|0;return 0|vt},mac:function Se(ae,ie,he){ae|=0,he|=0;var vt=0;if(15&(ie|=0))return-1;for(;(0|he)>=16;)ke[1&ae](ge[0|ie]<<24|ge[1|ie]<<16|ge[2|ie]<<8|ge[3|ie],ge[4|ie]<<24|ge[5|ie]<<16|ge[6|ie]<<8|ge[7|ie],ge[8|ie]<<24|ge[9|ie]<<16|ge[10|ie]<<8|ge[11|ie],ge[12|ie]<<24|ge[13|ie]<<16|ge[14|ie]<<8|ge[15|ie]),vt=vt+16|0,ie=ie+16|0,he=he-16|0;return 0|vt}}}({Uint8Array,Uint32Array},0,$);return pe.set_key=function(xe,Ke,Qe,Be,le,Xe,He,$e,rt){var Je=j.subarray(0,60),dt=j.subarray(256,316);Je.set([Ke,Qe,Be,le,Xe,He,$e,rt]);for(var It=xe,Ut=1;It<4*xe+28;It++){var zt=Je[It-1];(It%xe==0||8===xe&&It%xe==4)&&(zt=a[zt>>>24]<<24^a[zt>>>16&255]<<16^a[zt>>>8&255]<<8^a[255&zt]),It%xe==0&&(zt=zt<<8^zt>>>24^Ut<<24,Ut=Ut<<1^(128&Ut?27:0)),Je[It]=Je[It-xe]^zt}for(var pt=0;pt<It;pt+=4)for(var Ye=0;Ye<4;Ye++)zt=Je[It-(4+pt)+(4-Ye)%4],dt[pt+Ye]=pt<4||pt>=It-4?zt:f[0][a[zt>>>24]]^f[1][a[zt>>>16&255]]^f[2][a[zt>>>8&255]]^f[3][a[255&zt]];pe.set_rounds(xe+5)},pe};return b.ENC={ECB:0,CBC:2,CFB:4,OFB:6,CTR:7},b.DEC={ECB:1,CBC:3,CFB:5,OFB:6,CTR:7},b.MAC={CBC:0,GCM:1},b.HEAP_DATA=16384,b}();function or(r){return r instanceof Uint8Array}function _r(r,t){const e=r?r.byteLength:t||65536;if(4095&e||e<=0)throw Error("heap size must be a positive integer and a multiple of 4096");return r||new Uint8Array(new ArrayBuffer(e))}function Xt(r,t,e,n,a){const o=r.length-t,u=o<a?o:a;return r.set(e.subarray(n,n+u),t),u}function cr(...r){const t=r.reduce((a,o)=>a+o.length,0),e=new Uint8Array(t);let n=0;for(let a=0;a<r.length;a++)e.set(r[a],n),n+=r[a].length;return e}class $r extends Error{constructor(...t){super(...t)}}class Hr extends Error{constructor(...t){super(...t)}}class Yr extends Error{constructor(...t){super(...t)}}const yr=[],Cr=[];class dr{constructor(t,e,n=!0,a,o,u){this.pos=0,this.len=0,this.mode=a,this.pos=0,this.len=0,this.key=t,this.iv=e,this.padding=n,this.acquire_asm(o,u)}acquire_asm(t,e){return void 0!==this.heap&&void 0!==this.asm||(this.heap=t||yr.pop()||_r().subarray(Lt.HEAP_DATA),this.asm=e||Cr.pop()||new Lt(null,this.heap.buffer),this.reset(this.key,this.iv)),{heap:this.heap,asm:this.asm}}release_asm(){void 0!==this.heap&&void 0!==this.asm&&(yr.push(this.heap),Cr.push(this.asm)),this.heap=void 0,this.asm=void 0}reset(t,e){const{asm:n}=this.acquire_asm(),a=t.length;if(16!==a&&24!==a&&32!==a)throw new Hr("illegal key size");const o=new DataView(t.buffer,t.byteOffset,t.byteLength);if(n.set_key(a>>2,o.getUint32(0),o.getUint32(4),o.getUint32(8),o.getUint32(12),a>16?o.getUint32(16):0,a>16?o.getUint32(20):0,a>24?o.getUint32(24):0,a>24?o.getUint32(28):0),void 0!==e){if(16!==e.length)throw new Hr("illegal iv size");let u=new DataView(e.buffer,e.byteOffset,e.byteLength);n.set_iv(u.getUint32(0),u.getUint32(4),u.getUint32(8),u.getUint32(12))}else n.set_iv(0,0,0,0)}AES_Encrypt_process(t){if(!or(t))throw new TypeError("data isn't of expected type");let{heap:e,asm:n}=this.acquire_asm(),a=Lt.ENC[this.mode],o=Lt.HEAP_DATA,u=this.pos,f=this.len,w=0,g=t.length||0,b=0,L=0,$=new Uint8Array(f+g&-16);for(;g>0;)L=Xt(e,u+f,t,w,g),f+=L,w+=L,g-=L,L=n.cipher(a,o+u,f),L&&$.set(e.subarray(u,u+L),b),b+=L,L<f?(u+=L,f-=L):(u=0,f=0);return this.pos=u,this.len=f,$}AES_Encrypt_finish(){let{heap:t,asm:e}=this.acquire_asm(),n=Lt.ENC[this.mode],a=Lt.HEAP_DATA,o=this.pos,u=this.len,f=16-u%16,w=u;if(this.hasOwnProperty("padding")){if(this.padding){for(let b=0;b<f;++b)t[o+u+b]=f;u+=f,w=u}else if(u%16)throw new Hr("data length must be a multiple of the block size")}else u+=f;const g=new Uint8Array(w);return u&&e.cipher(n,a+o,u),w&&g.set(t.subarray(o,o+w)),this.pos=0,this.len=0,this.release_asm(),g}AES_Decrypt_process(t){if(!or(t))throw new TypeError("data isn't of expected type");let{heap:e,asm:n}=this.acquire_asm(),a=Lt.DEC[this.mode],o=Lt.HEAP_DATA,u=this.pos,f=this.len,w=0,g=t.length||0,b=0,L=f+g&-16,$=0,j=0;this.padding&&($=f+g-L||16,L-=$);const se=new Uint8Array(L);for(;g>0;)j=Xt(e,u+f,t,w,g),f+=j,w+=j,g-=j,j=n.cipher(a,o+u,f-(g?0:$)),j&&se.set(e.subarray(u,u+j),b),b+=j,j<f?(u+=j,f-=j):(u=0,f=0);return this.pos=u,this.len=f,se}AES_Decrypt_finish(){let{heap:t,asm:e}=this.acquire_asm(),n=Lt.DEC[this.mode],a=Lt.HEAP_DATA,o=this.pos,u=this.len,f=u;if(u>0){if(u%16){if(this.hasOwnProperty("padding"))throw new Hr("data length must be a multiple of the block size");u+=16-u%16}if(e.cipher(n,a+o,u),this.hasOwnProperty("padding")&&this.padding){let g=t[o+f-1];if(g<1||g>16||g>f)throw new Yr("bad padding");let b=0;for(let L=g;L>1;L--)b|=g^t[o+f-L];if(b)throw new Yr("bad padding");f-=g}}const w=new Uint8Array(f);return f>0&&w.set(t.subarray(o,o+f)),this.pos=0,this.len=0,this.release_asm(),w}}class lr{static encrypt(t,e,n=!1){return new lr(e,n).encrypt(t)}static decrypt(t,e,n=!1){return new lr(e,n).decrypt(t)}constructor(t,e=!1,n){this.aes=n||new dr(t,void 0,e,"ECB")}encrypt(t){return cr(this.aes.AES_Encrypt_process(t),this.aes.AES_Encrypt_finish())}decrypt(t){return cr(this.aes.AES_Decrypt_process(t),this.aes.AES_Decrypt_finish())}}function Ur(r){const t=function(e){const n=new lr(e);this.encrypt=function(a){return n.encrypt(a)},this.decrypt=function(a){return n.decrypt(a)}};return t.blockSize=t.prototype.blockSize=16,t.keySize=t.prototype.keySize=r/8,t}function ir(r,t,e,n,a,o){const u=[16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756],f=[-2146402272,-2147450880,32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,-2147450848,-2147483616,1048608,1081344,0,-2147450880,32800,-2147483648,-2146435040,-2146402272,1081344],w=[520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584],g=[8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928],b=[256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080],L=[536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312],$=[2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154],j=[268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696];let se,pe,xe,Ke,Qe,Be,le,Xe,He,$e,rt,Je,dt,It,Ut=0,zt=t.length;const pt=32===r.length?3:9;Xe=3===pt?e?[0,32,2]:[30,-2,-2]:e?[0,32,2,62,30,-2,64,96,2]:[94,62,-2,32,64,2,30,-2,-2],e&&(zt=(t=function(ze,yt){const Ot=8-ze.length%8;let Zt;if(2===yt&&Ot<8)Zt=32;else if(1===yt)Zt=Ot;else{if(yt||!(Ot<8)){if(8===Ot)return ze;throw Error("des: invalid padding")}Zt=0}const Kt=new Uint8Array(ze.length+Ot);for(let Nt=0;Nt<ze.length;Nt++)Kt[Nt]=ze[Nt];for(let Nt=0;Nt<Ot;Nt++)Kt[ze.length+Nt]=Zt;return Kt}(t,o)).length);let Ye=new Uint8Array(zt),rr=0;for(1===n&&(He=a[Ut++]<<24|a[Ut++]<<16|a[Ut++]<<8|a[Ut++],rt=a[Ut++]<<24|a[Ut++]<<16|a[Ut++]<<8|a[Ut++],Ut=0);Ut<zt;){for(Be=t[Ut++]<<24|t[Ut++]<<16|t[Ut++]<<8|t[Ut++],le=t[Ut++]<<24|t[Ut++]<<16|t[Ut++]<<8|t[Ut++],1===n&&(e?(Be^=He,le^=rt):($e=He,Je=rt,He=Be,rt=le)),xe=252645135&(Be>>>4^le),le^=xe,Be^=xe<<4,xe=65535&(Be>>>16^le),le^=xe,Be^=xe<<16,xe=858993459&(le>>>2^Be),Be^=xe,le^=xe<<2,xe=16711935&(le>>>8^Be),Be^=xe,le^=xe<<8,xe=1431655765&(Be>>>1^le),le^=xe,Be^=xe<<1,Be=Be<<1|Be>>>31,le=le<<1|le>>>31,pe=0;pe<pt;pe+=3){for(dt=Xe[pe+1],It=Xe[pe+2],se=Xe[pe];se!==dt;se+=It)Ke=le^r[se],Qe=(le>>>4|le<<28)^r[se+1],xe=Be,Be=le,le=xe^(f[Ke>>>24&63]|g[Ke>>>16&63]|L[Ke>>>8&63]|j[63&Ke]|u[Qe>>>24&63]|w[Qe>>>16&63]|b[Qe>>>8&63]|$[63&Qe]);xe=Be,Be=le,le=xe}Be=Be>>>1|Be<<31,le=le>>>1|le<<31,xe=1431655765&(Be>>>1^le),le^=xe,Be^=xe<<1,xe=16711935&(le>>>8^Be),Be^=xe,le^=xe<<8,xe=858993459&(le>>>2^Be),Be^=xe,le^=xe<<2,xe=65535&(Be>>>16^le),le^=xe,Be^=xe<<16,xe=252645135&(Be>>>4^le),le^=xe,Be^=xe<<4,1===n&&(e?(He=Be,rt=le):(Be^=$e,le^=Je)),Ye[rr++]=Be>>>24,Ye[rr++]=Be>>>16&255,Ye[rr++]=Be>>>8&255,Ye[rr++]=255&Be,Ye[rr++]=le>>>24,Ye[rr++]=le>>>16&255,Ye[rr++]=le>>>8&255,Ye[rr++]=255&le}return e||(Ye=function(ze,yt){let Ot,Zt=null;if(2===yt)Ot=32;else if(1===yt)Zt=ze[ze.length-1];else{if(yt)throw Error("des: invalid padding");Ot=0}if(!Zt){for(Zt=1;ze[ze.length-Zt]===Ot;)Zt++;Zt--}return ze.subarray(0,ze.length-Zt)}(Ye,o)),Ye}function pr(r){const t=[0,4,536870912,536870916,65536,65540,536936448,536936452,512,516,536871424,536871428,66048,66052,536936960,536936964],e=[0,1,1048576,1048577,67108864,67108865,68157440,68157441,256,257,1048832,1048833,67109120,67109121,68157696,68157697],n=[0,8,2048,2056,16777216,16777224,16779264,16779272,0,8,2048,2056,16777216,16777224,16779264,16779272],a=[0,2097152,134217728,136314880,8192,2105344,134225920,136323072,131072,2228224,134348800,136445952,139264,2236416,134356992,136454144],o=[0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256],u=[0,1024,32,1056,0,1024,32,1056,33554432,33555456,33554464,33555488,33554432,33555456,33554464,33555488],f=[0,268435456,524288,268959744,2,268435458,524290,268959746,0,268435456,524288,268959744,2,268435458,524290,268959746],w=[0,65536,2048,67584,536870912,536936448,536872960,536938496,131072,196608,133120,198656,537001984,537067520,537004032,537069568],g=[0,262144,0,262144,2,262146,2,262146,33554432,33816576,33554432,33816576,33554434,33816578,33554434,33816578],b=[0,268435456,8,268435464,0,268435456,8,268435464,1024,268436480,1032,268436488,1024,268436480,1032,268436488],L=[0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800],$=[0,16777216,512,16777728,2097152,18874368,2097664,18874880,67108864,83886080,67109376,83886592,69206016,85983232,69206528,85983744],j=[0,4096,134217728,134221824,524288,528384,134742016,134746112,16,4112,134217744,134221840,524304,528400,134742032,134746128],se=[0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261],pe=r.length>8?3:1,xe=Array(32*pe),Ke=[0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0];let Qe,Be,le,Xe=0,He=0;for(let $e=0;$e<pe;$e++){let rt=r[Xe++]<<24|r[Xe++]<<16|r[Xe++]<<8|r[Xe++],Je=r[Xe++]<<24|r[Xe++]<<16|r[Xe++]<<8|r[Xe++];le=252645135&(rt>>>4^Je),Je^=le,rt^=le<<4,le=65535&(Je>>>-16^rt),rt^=le,Je^=le<<-16,le=858993459&(rt>>>2^Je),Je^=le,rt^=le<<2,le=65535&(Je>>>-16^rt),rt^=le,Je^=le<<-16,le=1431655765&(rt>>>1^Je),Je^=le,rt^=le<<1,le=16711935&(Je>>>8^rt),rt^=le,Je^=le<<8,le=1431655765&(rt>>>1^Je),Je^=le,rt^=le<<1,le=rt<<8|Je>>>20&240,rt=Je<<24|Je<<8&16711680|Je>>>8&65280|Je>>>24&240,Je=le;for(let dt=0;dt<16;dt++)Ke[dt]?(rt=rt<<2|rt>>>26,Je=Je<<2|Je>>>26):(rt=rt<<1|rt>>>27,Je=Je<<1|Je>>>27),rt&=-15,Je&=-15,Qe=t[rt>>>28]|e[rt>>>24&15]|n[rt>>>20&15]|a[rt>>>16&15]|o[rt>>>12&15]|u[rt>>>8&15]|f[rt>>>4&15],Be=w[Je>>>28]|g[Je>>>24&15]|b[Je>>>20&15]|L[Je>>>16&15]|$[Je>>>12&15]|j[Je>>>8&15]|se[Je>>>4&15],le=65535&(Be>>>16^Qe),xe[He++]=Qe^le,xe[He++]=Be^le<<16}return xe}function kr(r){this.key=[];for(let t=0;t<3;t++)this.key.push(new Uint8Array(r.subarray(8*t,8*t+8)));this.encrypt=function(t){return ir(pr(this.key[2]),ir(pr(this.key[1]),ir(pr(this.key[0]),t,!0,0,null,null),!1,0,null,null),!0,0,null,null)}}function zr(){this.BlockSize=8,this.KeySize=16,this.setKey=function(u){if(this.masking=Array(16),this.rotate=Array(16),this.reset(),u.length!==this.KeySize)throw Error("CAST-128: keys must be 16 bytes");return this.keySchedule(u),!0},this.reset=function(){for(let u=0;u<16;u++)this.masking[u]=0,this.rotate[u]=0},this.getBlockSize=function(){return this.BlockSize},this.encrypt=function(u){const f=Array(u.length);for(let w=0;w<u.length;w+=8){let g,b=u[w]<<24|u[w+1]<<16|u[w+2]<<8|u[w+3],L=u[w+4]<<24|u[w+5]<<16|u[w+6]<<8|u[w+7];g=L,L=b^e(L,this.masking[0],this.rotate[0]),b=g,g=L,L=b^n(L,this.masking[1],this.rotate[1]),b=g,g=L,L=b^a(L,this.masking[2],this.rotate[2]),b=g,g=L,L=b^e(L,this.masking[3],this.rotate[3]),b=g,g=L,L=b^n(L,this.masking[4],this.rotate[4]),b=g,g=L,L=b^a(L,this.masking[5],this.rotate[5]),b=g,g=L,L=b^e(L,this.masking[6],this.rotate[6]),b=g,g=L,L=b^n(L,this.masking[7],this.rotate[7]),b=g,g=L,L=b^a(L,this.masking[8],this.rotate[8]),b=g,g=L,L=b^e(L,this.masking[9],this.rotate[9]),b=g,g=L,L=b^n(L,this.masking[10],this.rotate[10]),b=g,g=L,L=b^a(L,this.masking[11],this.rotate[11]),b=g,g=L,L=b^e(L,this.masking[12],this.rotate[12]),b=g,g=L,L=b^n(L,this.masking[13],this.rotate[13]),b=g,g=L,L=b^a(L,this.masking[14],this.rotate[14]),b=g,g=L,L=b^e(L,this.masking[15],this.rotate[15]),b=g,f[w]=L>>>24&255,f[w+1]=L>>>16&255,f[w+2]=L>>>8&255,f[w+3]=255&L,f[w+4]=b>>>24&255,f[w+5]=b>>>16&255,f[w+6]=b>>>8&255,f[w+7]=255&b}return f},this.decrypt=function(u){const f=Array(u.length);for(let w=0;w<u.length;w+=8){let g,b=u[w]<<24|u[w+1]<<16|u[w+2]<<8|u[w+3],L=u[w+4]<<24|u[w+5]<<16|u[w+6]<<8|u[w+7];g=L,L=b^e(L,this.masking[15],this.rotate[15]),b=g,g=L,L=b^a(L,this.masking[14],this.rotate[14]),b=g,g=L,L=b^n(L,this.masking[13],this.rotate[13]),b=g,g=L,L=b^e(L,this.masking[12],this.rotate[12]),b=g,g=L,L=b^a(L,this.masking[11],this.rotate[11]),b=g,g=L,L=b^n(L,this.masking[10],this.rotate[10]),b=g,g=L,L=b^e(L,this.masking[9],this.rotate[9]),b=g,g=L,L=b^a(L,this.masking[8],this.rotate[8]),b=g,g=L,L=b^n(L,this.masking[7],this.rotate[7]),b=g,g=L,L=b^e(L,this.masking[6],this.rotate[6]),b=g,g=L,L=b^a(L,this.masking[5],this.rotate[5]),b=g,g=L,L=b^n(L,this.masking[4],this.rotate[4]),b=g,g=L,L=b^e(L,this.masking[3],this.rotate[3]),b=g,g=L,L=b^a(L,this.masking[2],this.rotate[2]),b=g,g=L,L=b^n(L,this.masking[1],this.rotate[1]),b=g,g=L,L=b^e(L,this.masking[0],this.rotate[0]),b=g,f[w]=L>>>24&255,f[w+1]=L>>>16&255,f[w+2]=L>>>8&255,f[w+3]=255&L,f[w+4]=b>>>24&255,f[w+5]=b>>16&255,f[w+6]=b>>8&255,f[w+7]=255&b}return f};const r=[,,,,];r[0]=[,,,,],r[0][0]=[4,0,13,15,12,14,8],r[0][1]=[5,2,16,18,17,19,10],r[0][2]=[6,3,23,22,21,20,9],r[0][3]=[7,1,26,25,27,24,11],r[1]=[,,,,],r[1][0]=[0,6,21,23,20,22,16],r[1][1]=[1,4,0,2,1,3,18],r[1][2]=[2,5,7,6,5,4,17],r[1][3]=[3,7,10,9,11,8,19],r[2]=[,,,,],r[2][0]=[4,0,13,15,12,14,8],r[2][1]=[5,2,16,18,17,19,10],r[2][2]=[6,3,23,22,21,20,9],r[2][3]=[7,1,26,25,27,24,11],r[3]=[,,,,],r[3][0]=[0,6,21,23,20,22,16],r[3][1]=[1,4,0,2,1,3,18],r[3][2]=[2,5,7,6,5,4,17],r[3][3]=[3,7,10,9,11,8,19];const t=[,,,,];function e(u,f,w){const g=f+u,b=g<<w|g>>>32-w;return(o[0][b>>>24]^o[1][b>>>16&255])-o[2][b>>>8&255]+o[3][255&b]}function n(u,f,w){const g=f^u,b=g<<w|g>>>32-w;return o[0][b>>>24]-o[1][b>>>16&255]+o[2][b>>>8&255]^o[3][255&b]}function a(u,f,w){const g=f-u,b=g<<w|g>>>32-w;return(o[0][b>>>24]+o[1][b>>>16&255]^o[2][b>>>8&255])-o[3][255&b]}t[0]=[,,,,],t[0][0]=[24,25,23,22,18],t[0][1]=[26,27,21,20,22],t[0][2]=[28,29,19,18,25],t[0][3]=[30,31,17,16,28],t[1]=[,,,,],t[1][0]=[3,2,12,13,8],t[1][1]=[1,0,14,15,13],t[1][2]=[7,6,8,9,3],t[1][3]=[5,4,10,11,7],t[2]=[,,,,],t[2][0]=[19,18,28,29,25],t[2][1]=[17,16,30,31,28],t[2][2]=[23,22,24,25,18],t[2][3]=[21,20,26,27,22],t[3]=[,,,,],t[3][0]=[8,9,7,6,3],t[3][1]=[10,11,5,4,7],t[3][2]=[12,13,3,2,8],t[3][3]=[14,15,1,0,13],this.keySchedule=function(u){const f=[,,,,,,,,],w=Array(32);let g;for(let j=0;j<4;j++)g=4*j,f[j]=u[g]<<24|u[g+1]<<16|u[g+2]<<8|u[g+3];const b=[6,7,4,5];let L,$=0;for(let j=0;j<2;j++)for(let se=0;se<4;se++){for(g=0;g<4;g++){const pe=r[se][g];L=f[pe[1]],L^=o[4][f[pe[2]>>>2]>>>24-8*(3&pe[2])&255],L^=o[5][f[pe[3]>>>2]>>>24-8*(3&pe[3])&255],L^=o[6][f[pe[4]>>>2]>>>24-8*(3&pe[4])&255],L^=o[7][f[pe[5]>>>2]>>>24-8*(3&pe[5])&255],L^=o[b[g]][f[pe[6]>>>2]>>>24-8*(3&pe[6])&255],f[pe[0]]=L}for(g=0;g<4;g++){const pe=t[se][g];L=o[4][f[pe[0]>>>2]>>>24-8*(3&pe[0])&255],L^=o[5][f[pe[1]>>>2]>>>24-8*(3&pe[1])&255],L^=o[6][f[pe[2]>>>2]>>>24-8*(3&pe[2])&255],L^=o[7][f[pe[3]>>>2]>>>24-8*(3&pe[3])&255],L^=o[4+g][f[pe[4]>>>2]>>>24-8*(3&pe[4])&255],w[$]=L,$++}}for(let j=0;j<16;j++)this.masking[j]=w[j],this.rotate[j]=31&w[16+j]};const o=[,,,,,,,,];o[0]=[821772500,2678128395,1810681135,1059425402,505495343,2617265619,1610868032,3483355465,3218386727,2294005173,3791863952,2563806837,1852023008,365126098,3269944861,584384398,677919599,3229601881,4280515016,2002735330,1136869587,3744433750,2289869850,2731719981,2714362070,879511577,1639411079,575934255,717107937,2857637483,576097850,2731753936,1725645e3,2810460463,5111599,767152862,2543075244,1251459544,1383482551,3052681127,3089939183,3612463449,1878520045,1510570527,2189125840,2431448366,582008916,3163445557,1265446783,1354458274,3529918736,3202711853,3073581712,3912963487,3029263377,1275016285,4249207360,2905708351,3304509486,1442611557,3585198765,2712415662,2731849581,3248163920,2283946226,208555832,2766454743,1331405426,1447828783,3315356441,3108627284,2957404670,2981538698,3339933917,1669711173,286233437,1465092821,1782121619,3862771680,710211251,980974943,1651941557,430374111,2051154026,704238805,4128970897,3144820574,2857402727,948965521,3333752299,2227686284,718756367,2269778983,2731643755,718440111,2857816721,3616097120,1113355533,2478022182,410092745,1811985197,1944238868,2696854588,1415722873,1682284203,1060277122,1998114690,1503841958,82706478,2315155686,1068173648,845149890,2167947013,1768146376,1993038550,3566826697,3390574031,940016341,3355073782,2328040721,904371731,1205506512,4094660742,2816623006,825647681,85914773,2857843460,1249926541,1417871568,3287612,3211054559,3126306446,1975924523,1353700161,2814456437,2438597621,1800716203,722146342,2873936343,1151126914,4160483941,2877670899,458611604,2866078500,3483680063,770352098,2652916994,3367839148,3940505011,3585973912,3809620402,718646636,2504206814,2914927912,3631288169,2857486607,2860018678,575749918,2857478043,718488780,2069512688,3548183469,453416197,1106044049,3032691430,52586708,3378514636,3459808877,3211506028,1785789304,218356169,3571399134,3759170522,1194783844,1523787992,3007827094,1975193539,2555452411,1341901877,3045838698,3776907964,3217423946,2802510864,2889438986,1057244207,1636348243,3761863214,1462225785,2632663439,481089165,718503062,24497053,3332243209,3344655856,3655024856,3960371065,1195698900,2971415156,3710176158,2115785917,4027663609,3525578417,2524296189,2745972565,3564906415,1372086093,1452307862,2780501478,1476592880,3389271281,18495466,2378148571,901398090,891748256,3279637769,3157290713,2560960102,1447622437,4284372637,216884176,2086908623,1879786977,3588903153,2242455666,2938092967,3559082096,2810645491,758861177,1121993112,215018983,642190776,4169236812,1196255959,2081185372,3508738393,941322904,4124243163,2877523539,1848581667,2205260958,3180453958,2589345134,3694731276,550028657,2519456284,3789985535,2973870856,2093648313,443148163,46942275,2734146937,1117713533,1115362972,1523183689,3717140224,1551984063],o[1]=[522195092,4010518363,1776537470,960447360,4267822970,4005896314,1435016340,1929119313,2913464185,1310552629,3579470798,3724818106,2579771631,1594623892,417127293,2715217907,2696228731,1508390405,3994398868,3925858569,3695444102,4019471449,3129199795,3770928635,3520741761,990456497,4187484609,2783367035,21106139,3840405339,631373633,3783325702,532942976,396095098,3548038825,4267192484,2564721535,2011709262,2039648873,620404603,3776170075,2898526339,3612357925,4159332703,1645490516,223693667,1567101217,3362177881,1029951347,3470931136,3570957959,1550265121,119497089,972513919,907948164,3840628539,1613718692,3594177948,465323573,2659255085,654439692,2575596212,2699288441,3127702412,277098644,624404830,4100943870,2717858591,546110314,2403699828,3655377447,1321679412,4236791657,1045293279,4010672264,895050893,2319792268,494945126,1914543101,2777056443,3894764339,2219737618,311263384,4275257268,3458730721,669096869,3584475730,3835122877,3319158237,3949359204,2005142349,2713102337,2228954793,3769984788,569394103,3855636576,1425027204,108000370,2736431443,3671869269,3043122623,1750473702,2211081108,762237499,3972989403,2798899386,3061857628,2943854345,867476300,964413654,1591880597,1594774276,2179821409,552026980,3026064248,3726140315,2283577634,3110545105,2152310760,582474363,1582640421,1383256631,2043843868,3322775884,1217180674,463797851,2763038571,480777679,2718707717,2289164131,3118346187,214354409,200212307,3810608407,3025414197,2674075964,3997296425,1847405948,1342460550,510035443,4080271814,815934613,833030224,1620250387,1945732119,2703661145,3966000196,1388869545,3456054182,2687178561,2092620194,562037615,1356438536,3409922145,3261847397,1688467115,2150901366,631725691,3840332284,549916902,3455104640,394546491,837744717,2114462948,751520235,2221554606,2415360136,3999097078,2063029875,803036379,2702586305,821456707,3019566164,360699898,4018502092,3511869016,3677355358,2402471449,812317050,49299192,2570164949,3259169295,2816732080,3331213574,3101303564,2156015656,3705598920,3546263921,143268808,3200304480,1638124008,3165189453,3341807610,578956953,2193977524,3638120073,2333881532,807278310,658237817,2969561766,1641658566,11683945,3086995007,148645947,1138423386,4158756760,1981396783,2401016740,3699783584,380097457,2680394679,2803068651,3334260286,441530178,4016580796,1375954390,761952171,891809099,2183123478,157052462,3683840763,1592404427,341349109,2438483839,1417898363,644327628,2233032776,2353769706,2201510100,220455161,1815641738,182899273,2995019788,3627381533,3702638151,2890684138,1052606899,588164016,1681439879,4038439418,2405343923,4229449282,167996282,1336969661,1688053129,2739224926,1543734051,1046297529,1138201970,2121126012,115334942,1819067631,1902159161,1941945968,2206692869,1159982321],o[2]=[2381300288,637164959,3952098751,3893414151,1197506559,916448331,2350892612,2932787856,3199334847,4009478890,3905886544,1373570990,2450425862,4037870920,3778841987,2456817877,286293407,124026297,3001279700,1028597854,3115296800,4208886496,2691114635,2188540206,1430237888,1218109995,3572471700,308166588,570424558,2187009021,2455094765,307733056,1310360322,3135275007,1384269543,2388071438,863238079,2359263624,2801553128,3380786597,2831162807,1470087780,1728663345,4072488799,1090516929,532123132,2389430977,1132193179,2578464191,3051079243,1670234342,1434557849,2711078940,1241591150,3314043432,3435360113,3091448339,1812415473,2198440252,267246943,796911696,3619716990,38830015,1526438404,2806502096,374413614,2943401790,1489179520,1603809326,1920779204,168801282,260042626,2358705581,1563175598,2397674057,1356499128,2217211040,514611088,2037363785,2186468373,4022173083,2792511869,2913485016,1173701892,4200428547,3896427269,1334932762,2455136706,602925377,2835607854,1613172210,41346230,2499634548,2457437618,2188827595,41386358,4172255629,1313404830,2405527007,3801973774,2217704835,873260488,2528884354,2478092616,4012915883,2555359016,2006953883,2463913485,575479328,2218240648,2099895446,660001756,2341502190,3038761536,3888151779,3848713377,3286851934,1022894237,1620365795,3449594689,1551255054,15374395,3570825345,4249311020,4151111129,3181912732,310226346,1133119310,530038928,136043402,2476768958,3107506709,2544909567,1036173560,2367337196,1681395281,1758231547,3641649032,306774401,1575354324,3716085866,1990386196,3114533736,2455606671,1262092282,3124342505,2768229131,4210529083,1833535011,423410938,660763973,2187129978,1639812e3,3508421329,3467445492,310289298,272797111,2188552562,2456863912,310240523,677093832,1013118031,901835429,3892695601,1116285435,3036471170,1337354835,243122523,520626091,277223598,4244441197,4194248841,1766575121,594173102,316590669,742362309,3536858622,4176435350,3838792410,2501204839,1229605004,3115755532,1552908988,2312334149,979407927,3959474601,1148277331,176638793,3614686272,2083809052,40992502,1340822838,2731552767,3535757508,3560899520,1354035053,122129617,7215240,2732932949,3118912700,2718203926,2539075635,3609230695,3725561661,1928887091,2882293555,1988674909,2063640240,2491088897,1459647954,4189817080,2302804382,1113892351,2237858528,1927010603,4002880361,1856122846,1594404395,2944033133,3855189863,3474975698,1643104450,4054590833,3431086530,1730235576,2984608721,3084664418,2131803598,4178205752,267404349,1617849798,1616132681,1462223176,736725533,2327058232,551665188,2945899023,1749386277,2575514597,1611482493,674206544,2201269090,3642560800,728599968,1680547377,2620414464,1388111496,453204106,4156223445,1094905244,2754698257,2201108165,3757000246,2704524545,3922940700,3996465027],o[3]=[2645754912,532081118,2814278639,3530793624,1246723035,1689095255,2236679235,4194438865,2116582143,3859789411,157234593,2045505824,4245003587,1687664561,4083425123,605965023,672431967,1336064205,3376611392,214114848,4258466608,3232053071,489488601,605322005,3998028058,264917351,1912574028,756637694,436560991,202637054,135989450,85393697,2152923392,3896401662,2895836408,2145855233,3535335007,115294817,3147733898,1922296357,3464822751,4117858305,1037454084,2725193275,2127856640,1417604070,1148013728,1827919605,642362335,2929772533,909348033,1346338451,3547799649,297154785,1917849091,4161712827,2883604526,3968694238,1469521537,3780077382,3375584256,1763717519,136166297,4290970789,1295325189,2134727907,2798151366,1566297257,3672928234,2677174161,2672173615,965822077,2780786062,289653839,1133871874,3491843819,35685304,1068898316,418943774,672553190,642281022,2346158704,1954014401,3037126780,4079815205,2030668546,3840588673,672283427,1776201016,359975446,3750173538,555499703,2769985273,1324923,69110472,152125443,3176785106,3822147285,1340634837,798073664,1434183902,15393959,216384236,1303690150,3881221631,3711134124,3960975413,106373927,2578434224,1455997841,1801814300,1578393881,1854262133,3188178946,3258078583,2302670060,1539295533,3505142565,3078625975,2372746020,549938159,3278284284,2620926080,181285381,2865321098,3970029511,68876850,488006234,1728155692,2608167508,836007927,2435231793,919367643,3339422534,3655756360,1457871481,40520939,1380155135,797931188,234455205,2255801827,3990488299,397000196,739833055,3077865373,2871719860,4022553888,772369276,390177364,3853951029,557662966,740064294,1640166671,1699928825,3535942136,622006121,3625353122,68743880,1742502,219489963,1664179233,1577743084,1236991741,410585305,2366487942,823226535,1050371084,3426619607,3586839478,212779912,4147118561,1819446015,1911218849,530248558,3486241071,3252585495,2886188651,3410272728,2342195030,20547779,2982490058,3032363469,3631753222,312714466,1870521650,1493008054,3491686656,615382978,4103671749,2534517445,1932181,2196105170,278426614,6369430,3274544417,2913018367,697336853,2143000447,2946413531,701099306,1558357093,2805003052,3500818408,2321334417,3567135975,216290473,3591032198,23009561,1996984579,3735042806,2024298078,3739440863,569400510,2339758983,3016033873,3097871343,3639523026,3844324983,3256173865,795471839,2951117563,4101031090,4091603803,3603732598,971261452,534414648,428311343,3389027175,2844869880,694888862,1227866773,2456207019,3043454569,2614353370,3749578031,3676663836,459166190,4132644070,1794958188,51825668,2252611902,3084671440,2036672799,3436641603,1099053433,2469121526,3059204941,1323291266,2061838604,1018778475,2233344254,2553501054,334295216,3556750194,1065731521,183467730],o[4]=[2127105028,745436345,2601412319,2788391185,3093987327,500390133,1155374404,389092991,150729210,3891597772,3523549952,1935325696,716645080,946045387,2901812282,1774124410,3869435775,4039581901,3293136918,3438657920,948246080,363898952,3867875531,1286266623,1598556673,68334250,630723836,1104211938,1312863373,613332731,2377784574,1101634306,441780740,3129959883,1917973735,2510624549,3238456535,2544211978,3308894634,1299840618,4076074851,1756332096,3977027158,297047435,3790297736,2265573040,3621810518,1311375015,1667687725,47300608,3299642885,2474112369,201668394,1468347890,576830978,3594690761,3742605952,1958042578,1747032512,3558991340,1408974056,3366841779,682131401,1033214337,1545599232,4265137049,206503691,103024618,2855227313,1337551222,2428998917,2963842932,4015366655,3852247746,2796956967,3865723491,3747938335,247794022,3755824572,702416469,2434691994,397379957,851939612,2314769512,218229120,1380406772,62274761,214451378,3170103466,2276210409,3845813286,28563499,446592073,1693330814,3453727194,29968656,3093872512,220656637,2470637031,77972100,1667708854,1358280214,4064765667,2395616961,325977563,4277240721,4220025399,3605526484,3355147721,811859167,3069544926,3962126810,652502677,3075892249,4132761541,3498924215,1217549313,3250244479,3858715919,3053989961,1538642152,2279026266,2875879137,574252750,3324769229,2651358713,1758150215,141295887,2719868960,3515574750,4093007735,4194485238,1082055363,3417560400,395511885,2966884026,179534037,3646028556,3738688086,1092926436,2496269142,257381841,3772900718,1636087230,1477059743,2499234752,3811018894,2675660129,3285975680,90732309,1684827095,1150307763,1723134115,3237045386,1769919919,1240018934,815675215,750138730,2239792499,1234303040,1995484674,138143821,675421338,1145607174,1936608440,3238603024,2345230278,2105974004,323969391,779555213,3004902369,2861610098,1017501463,2098600890,2628620304,2940611490,2682542546,1171473753,3656571411,3687208071,4091869518,393037935,159126506,1662887367,1147106178,391545844,3452332695,1891500680,3016609650,1851642611,546529401,1167818917,3194020571,2848076033,3953471836,575554290,475796850,4134673196,450035699,2351251534,844027695,1080539133,86184846,1554234488,3692025454,1972511363,2018339607,1491841390,1141460869,1061690759,4244549243,2008416118,2351104703,2868147542,1598468138,722020353,1027143159,212344630,1387219594,1725294528,3745187956,2500153616,458938280,4129215917,1828119673,544571780,3503225445,2297937496,1241802790,267843827,2694610800,1397140384,1558801448,3782667683,1806446719,929573330,2234912681,400817706,616011623,4121520928,3603768725,1761550015,1968522284,4053731006,4192232858,4005120285,872482584,3140537016,3894607381,2287405443,1963876937,3663887957,1584857e3,2975024454,1833426440,4025083860],o[5]=[4143615901,749497569,1285769319,3795025788,2514159847,23610292,3974978748,844452780,3214870880,3751928557,2213566365,1676510905,448177848,3730751033,4086298418,2307502392,871450977,3222878141,4110862042,3831651966,2735270553,1310974780,2043402188,1218528103,2736035353,4274605013,2702448458,3936360550,2693061421,162023535,2827510090,687910808,23484817,3784910947,3371371616,779677500,3503626546,3473927188,4157212626,3500679282,4248902014,2466621104,3899384794,1958663117,925738300,1283408968,3669349440,1840910019,137959847,2679828185,1239142320,1315376211,1547541505,1690155329,739140458,3128809933,3933172616,3876308834,905091803,1548541325,4040461708,3095483362,144808038,451078856,676114313,2861728291,2469707347,993665471,373509091,2599041286,4025009006,4170239449,2149739950,3275793571,3749616649,2794760199,1534877388,572371878,2590613551,1753320020,3467782511,1405125690,4270405205,633333386,3026356924,3475123903,632057672,2846462855,1404951397,3882875879,3915906424,195638627,2385783745,3902872553,1233155085,3355999740,2380578713,2702246304,2144565621,3663341248,3894384975,2502479241,4248018925,3094885567,1594115437,572884632,3385116731,767645374,1331858858,1475698373,3793881790,3532746431,1321687957,619889600,1121017241,3440213920,2070816767,2833025776,1933951238,4095615791,890643334,3874130214,859025556,360630002,925594799,1764062180,3920222280,4078305929,979562269,2810700344,4087740022,1949714515,546639971,1165388173,3069891591,1495988560,922170659,1291546247,2107952832,1813327274,3406010024,3306028637,4241950635,153207855,2313154747,1608695416,1150242611,1967526857,721801357,1220138373,3691287617,3356069787,2112743302,3281662835,1111556101,1778980689,250857638,2298507990,673216130,2846488510,3207751581,3562756981,3008625920,3417367384,2198807050,529510932,3547516680,3426503187,2364944742,102533054,2294910856,1617093527,1204784762,3066581635,1019391227,1069574518,1317995090,1691889997,3661132003,510022745,3238594800,1362108837,1817929911,2184153760,805817662,1953603311,3699844737,120799444,2118332377,207536705,2282301548,4120041617,145305846,2508124933,3086745533,3261524335,1877257368,2977164480,3160454186,2503252186,4221677074,759945014,254147243,2767453419,3801518371,629083197,2471014217,907280572,3900796746,940896768,2751021123,2625262786,3161476951,3661752313,3260732218,1425318020,2977912069,1496677566,3988592072,2140652971,3126511541,3069632175,977771578,1392695845,1698528874,1411812681,1369733098,1343739227,3620887944,1142123638,67414216,3102056737,3088749194,1626167401,2546293654,3941374235,697522451,33404913,143560186,2595682037,994885535,1247667115,3859094837,2699155541,3547024625,4114935275,2968073508,3199963069,2732024527,1237921620,951448369,1898488916,1211705605,2790989240,2233243581,3598044975],o[6]=[2246066201,858518887,1714274303,3485882003,713916271,2879113490,3730835617,539548191,36158695,1298409750,419087104,1358007170,749914897,2989680476,1261868530,2995193822,2690628854,3443622377,3780124940,3796824509,2976433025,4259637129,1551479e3,512490819,1296650241,951993153,2436689437,2460458047,144139966,3136204276,310820559,3068840729,643875328,1969602020,1680088954,2185813161,3283332454,672358534,198762408,896343282,276269502,3014846926,84060815,197145886,376173866,3943890818,3813173521,3545068822,1316698879,1598252827,2633424951,1233235075,859989710,2358460855,3503838400,3409603720,1203513385,1193654839,2792018475,2060853022,207403770,1144516871,3068631394,1121114134,177607304,3785736302,326409831,1929119770,2983279095,4183308101,3474579288,3200513878,3228482096,119610148,1170376745,3378393471,3163473169,951863017,3337026068,3135789130,2907618374,1183797387,2015970143,4045674555,2182986399,2952138740,3928772205,384012900,2454997643,10178499,2879818989,2596892536,111523738,2995089006,451689641,3196290696,235406569,1441906262,3890558523,3013735005,4158569349,1644036924,376726067,1006849064,3664579700,2041234796,1021632941,1374734338,2566452058,371631263,4007144233,490221539,206551450,3140638584,1053219195,1853335209,3412429660,3562156231,735133835,1623211703,3104214392,2738312436,4096837757,3366392578,3110964274,3956598718,3196820781,2038037254,3877786376,2339753847,300912036,3766732888,2372630639,1516443558,4200396704,1574567987,4069441456,4122592016,2699739776,146372218,2748961456,2043888151,35287437,2596680554,655490400,1132482787,110692520,1031794116,2188192751,1324057718,1217253157,919197030,686247489,3261139658,1028237775,3135486431,3059715558,2460921700,986174950,2661811465,4062904701,2752986992,3709736643,367056889,1353824391,731860949,1650113154,1778481506,784341916,357075625,3608602432,1074092588,2480052770,3811426202,92751289,877911070,3600361838,1231880047,480201094,3756190983,3094495953,434011822,87971354,363687820,1717726236,1901380172,3926403882,2481662265,400339184,1490350766,2661455099,1389319756,2558787174,784598401,1983468483,30828846,3550527752,2716276238,3841122214,1765724805,1955612312,1277890269,1333098070,1564029816,2704417615,1026694237,3287671188,1260819201,3349086767,1016692350,1582273796,1073413053,1995943182,694588404,1025494639,3323872702,3551898420,4146854327,453260480,1316140391,1435673405,3038941953,3486689407,1622062951,403978347,817677117,950059133,4246079218,3278066075,1486738320,1417279718,481875527,2549965225,3933690356,760697757,1452955855,3897451437,1177426808,1702951038,4085348628,2447005172,1084371187,3516436277,3068336338,1073369276,1027665953,3284188590,1230553676,1368340146,2226246512,267243139,2274220762,4070734279,2497715176,2423353163,2504755875],o[7]=[3793104909,3151888380,2817252029,895778965,2005530807,3871412763,237245952,86829237,296341424,3851759377,3974600970,2475086196,709006108,1994621201,2972577594,937287164,3734691505,168608556,3189338153,2225080640,3139713551,3033610191,3025041904,77524477,185966941,1208824168,2344345178,1721625922,3354191921,1066374631,1927223579,1971335949,2483503697,1551748602,2881383779,2856329572,3003241482,48746954,1398218158,2050065058,313056748,4255789917,393167848,1912293076,940740642,3465845460,3091687853,2522601570,2197016661,1727764327,364383054,492521376,1291706479,3264136376,1474851438,1685747964,2575719748,1619776915,1814040067,970743798,1561002147,2925768690,2123093554,1880132620,3151188041,697884420,2550985770,2607674513,2659114323,110200136,1489731079,997519150,1378877361,3527870668,478029773,2766872923,1022481122,431258168,1112503832,897933369,2635587303,669726182,3383752315,918222264,163866573,3246985393,3776823163,114105080,1903216136,761148244,3571337562,1690750982,3166750252,1037045171,1888456500,2010454850,642736655,616092351,365016990,1185228132,4174898510,1043824992,2023083429,2241598885,3863320456,3279669087,3674716684,108438443,2132974366,830746235,606445527,4173263986,2204105912,1844756978,2532684181,4245352700,2969441100,3796921661,1335562986,4061524517,2720232303,2679424040,634407289,885462008,3294724487,3933892248,2094100220,339117932,4048830727,3202280980,1458155303,2689246273,1022871705,2464987878,3714515309,353796843,2822958815,4256850100,4052777845,551748367,618185374,3778635579,4020649912,1904685140,3069366075,2670879810,3407193292,2954511620,4058283405,2219449317,3135758300,1120655984,3447565834,1474845562,3577699062,550456716,3466908712,2043752612,881257467,869518812,2005220179,938474677,3305539448,3850417126,1315485940,3318264702,226533026,965733244,321539988,1136104718,804158748,573969341,3708209826,937399083,3290727049,2901666755,1461057207,4013193437,4066861423,3242773476,2421326174,1581322155,3028952165,786071460,3900391652,3918438532,1485433313,4023619836,3708277595,3678951060,953673138,1467089153,1930354364,1533292819,2492563023,1346121658,1685000834,1965281866,3765933717,4190206607,2052792609,3515332758,690371149,3125873887,2180283551,2903598061,3933952357,436236910,289419410,14314871,1242357089,2904507907,1616633776,2666382180,585885352,3471299210,2699507360,1432659641,277164553,3354103607,770115018,2303809295,3741942315,3177781868,2853364978,2269453327,3774259834,987383833,1290892879,225909803,1741533526,890078084,1496906255,1111072499,916028167,243534141,1252605537,2204162171,531204876,290011180,3916834213,102027703,237315147,209093447,1486785922,220223953,2758195998,4175039106,82940208,3127791296,2569425252,518464269,1353887104,3941492737,2377294467,3935040926]}function Mr(r){this.cast5=new zr,this.cast5.setKey(r),this.encrypt=function(t){return this.cast5.encrypt(t)}}kr.keySize=kr.prototype.keySize=24,kr.blockSize=kr.prototype.blockSize=8,Mr.blockSize=Mr.prototype.blockSize=8,Mr.keySize=Mr.prototype.keySize=16;const mr=4294967295;function wr(r,t){return(r<<t|r>>>32-t)&mr}function Ar(r,t){return r[t]|r[t+1]<<8|r[t+2]<<16|r[t+3]<<24}function Tr(r,t,e){r.splice(t,4,255&e,e>>>8&255,e>>>16&255,e>>>24&255)}function Ft(r,t){return r>>>8*t&255}function Dr(r){this.tf=function(){let t=null,e=null,n=-1,a=[],o=[[],[],[],[]];function u(b){return o[0][Ft(b,0)]^o[1][Ft(b,1)]^o[2][Ft(b,2)]^o[3][Ft(b,3)]}function f(b){return o[0][Ft(b,3)]^o[1][Ft(b,0)]^o[2][Ft(b,1)]^o[3][Ft(b,2)]}function w(b,L){let $=u(L[0]),j=f(L[1]);L[2]=wr(L[2]^$+j+a[4*b+8]&mr,31),L[3]=wr(L[3],1)^$+2*j+a[4*b+9]&mr,$=u(L[2]),j=f(L[3]),L[0]=wr(L[0]^$+j+a[4*b+10]&mr,31),L[1]=wr(L[1],1)^$+2*j+a[4*b+11]&mr}function g(b,L){let $=u(L[0]),j=f(L[1]);L[2]=wr(L[2],1)^$+j+a[4*b+10]&mr,L[3]=wr(L[3]^$+2*j+a[4*b+11]&mr,31),$=u(L[2]),j=f(L[3]),L[0]=wr(L[0],1)^$+j+a[4*b+8]&mr,L[1]=wr(L[1]^$+2*j+a[4*b+9]&mr,31)}return{name:"twofish",blocksize:16,open:function(b){let L,$,j,se,pe;t=b;const xe=[],Ke=[],Qe=[];let Be;const le=[];let Xe,He,$e;const rt=[[8,1,7,13,6,15,3,2,0,11,5,9,14,12,10,4],[2,8,11,13,15,7,6,14,3,1,9,4,0,10,12,5]],Je=[[14,12,11,8,1,2,3,5,15,4,10,6,7,0,9,13],[1,14,2,11,4,12,3,7,6,13,10,5,15,9,0,8]],dt=[[11,10,5,14,6,13,9,0,12,8,15,3,2,4,7,1],[4,12,7,5,1,6,9,10,0,14,13,8,2,11,3,15]],It=[[13,7,15,4,1,2,6,14,9,11,3,0,8,5,12,10],[11,9,5,1,12,3,13,14,6,4,7,15,2,0,8,10]],Ut=[0,8,1,9,2,10,3,11,4,12,5,13,6,14,7,15],zt=[0,9,2,11,4,13,6,15,8,1,10,3,12,5,14,7],pt=[[],[]],Ye=[[],[],[],[]];function rr(Kt){return Kt^Kt>>2^[0,90,180,238][3&Kt]}function ze(Kt){return Kt^Kt>>1^Kt>>2^[0,238,180,90][3&Kt]}function yt(Kt,Nt){let Gt,xt,ge;for(Gt=0;Gt<8;Gt++)xt=Nt>>>24,Nt=Nt<<8&mr|Kt>>>24,Kt=Kt<<8&mr,ge=xt<<1,128&xt&&(ge^=333),Nt^=xt^ge<<16,ge^=xt>>>1,1&xt&&(ge^=166),Nt^=ge<<24|ge<<8;return Nt}function Ot(Kt,Nt){const Gt=Nt>>4,xt=15&Nt,ge=rt[Kt][Gt^xt],Ne=Je[Kt][Ut[xt]^zt[Gt]];return It[Kt][Ut[Ne]^zt[ge]]<<4|dt[Kt][ge^Ne]}function Zt(Kt,Nt){let Gt=Ft(Kt,0),xt=Ft(Kt,1),ge=Ft(Kt,2),Ne=Ft(Kt,3);switch(Be){case 4:Gt=pt[1][Gt]^Ft(Nt[3],0),xt=pt[0][xt]^Ft(Nt[3],1),ge=pt[0][ge]^Ft(Nt[3],2),Ne=pt[1][Ne]^Ft(Nt[3],3);case 3:Gt=pt[1][Gt]^Ft(Nt[2],0),xt=pt[1][xt]^Ft(Nt[2],1),ge=pt[0][ge]^Ft(Nt[2],2),Ne=pt[0][Ne]^Ft(Nt[2],3);case 2:Gt=pt[0][pt[0][Gt]^Ft(Nt[1],0)]^Ft(Nt[0],0),xt=pt[0][pt[1][xt]^Ft(Nt[1],1)]^Ft(Nt[0],1),ge=pt[1][pt[0][ge]^Ft(Nt[1],2)]^Ft(Nt[0],2),Ne=pt[1][pt[1][Ne]^Ft(Nt[1],3)]^Ft(Nt[0],3)}return Ye[0][Gt]^Ye[1][xt]^Ye[2][ge]^Ye[3][Ne]}for(t=t.slice(0,32),L=t.length;16!==L&&24!==L&&32!==L;)t[L++]=0;for(L=0;L<t.length;L+=4)Qe[L>>2]=Ar(t,L);for(L=0;L<256;L++)pt[0][L]=Ot(0,L),pt[1][L]=Ot(1,L);for(L=0;L<256;L++)Xe=pt[1][L],He=rr(Xe),$e=ze(Xe),Ye[0][L]=Xe+(He<<8)+($e<<16)+($e<<24),Ye[2][L]=He+($e<<8)+(Xe<<16)+($e<<24),Xe=pt[0][L],He=rr(Xe),$e=ze(Xe),Ye[1][L]=$e+($e<<8)+(He<<16)+(Xe<<24),Ye[3][L]=He+(Xe<<8)+($e<<16)+(He<<24);for(Be=Qe.length/2,L=0;L<Be;L++)$=Qe[L+L],xe[L]=$,j=Qe[L+L+1],Ke[L]=j,le[Be-L-1]=yt($,j);for(L=0;L<40;L+=2)$=16843009*L,j=$+16843009,$=Zt($,xe),j=wr(Zt(j,Ke),8),a[L]=$+j&mr,a[L+1]=wr($+2*j,9);for(L=0;L<256;L++)switch($=j=se=pe=L,Be){case 4:$=pt[1][$]^Ft(le[3],0),j=pt[0][j]^Ft(le[3],1),se=pt[0][se]^Ft(le[3],2),pe=pt[1][pe]^Ft(le[3],3);case 3:$=pt[1][$]^Ft(le[2],0),j=pt[1][j]^Ft(le[2],1),se=pt[0][se]^Ft(le[2],2),pe=pt[0][pe]^Ft(le[2],3);case 2:o[0][L]=Ye[0][pt[0][pt[0][$]^Ft(le[1],0)]^Ft(le[0],0)],o[1][L]=Ye[1][pt[0][pt[1][j]^Ft(le[1],1)]^Ft(le[0],1)],o[2][L]=Ye[2][pt[1][pt[0][se]^Ft(le[1],2)]^Ft(le[0],2)],o[3][L]=Ye[3][pt[1][pt[1][pe]^Ft(le[1],3)]^Ft(le[0],3)]}},close:function(){a=[],o=[[],[],[],[]]},encrypt:function(b,L){e=b,n=L;const $=[Ar(e,n)^a[0],Ar(e,n+4)^a[1],Ar(e,n+8)^a[2],Ar(e,n+12)^a[3]];for(let j=0;j<8;j++)w(j,$);return Tr(e,n,$[2]^a[4]),Tr(e,n+4,$[3]^a[5]),Tr(e,n+8,$[0]^a[6]),Tr(e,n+12,$[1]^a[7]),n+=16,e},decrypt:function(b,L){e=b,n=L;const $=[Ar(e,n)^a[4],Ar(e,n+4)^a[5],Ar(e,n+8)^a[6],Ar(e,n+12)^a[7]];for(let j=7;j>=0;j--)g(j,$);Tr(e,n,$[2]^a[0]),Tr(e,n+4,$[3]^a[1]),Tr(e,n+8,$[0]^a[2]),Tr(e,n+12,$[1]^a[3]),n+=16},finalize:function(){return e}}}(),this.tf.open(Array.from(r),0),this.encrypt=function(t){return this.tf.encrypt(Array.from(t),0)}}function hn(){}function si(r){this.bf=new hn,this.bf.init(r),this.encrypt=function(t){return this.bf.encryptBlock(t)}}Dr.keySize=Dr.prototype.keySize=32,Dr.blockSize=Dr.prototype.blockSize=16,hn.prototype.BLOCKSIZE=8,hn.prototype.SBOXES=[[3509652390,2564797868,805139163,3491422135,3101798381,1780907670,3128725573,4046225305,614570311,3012652279,134345442,2240740374,1667834072,1901547113,2757295779,4103290238,227898511,1921955416,1904987480,2182433518,2069144605,3260701109,2620446009,720527379,3318853667,677414384,3393288472,3101374703,2390351024,1614419982,1822297739,2954791486,3608508353,3174124327,2024746970,1432378464,3864339955,2857741204,1464375394,1676153920,1439316330,715854006,3033291828,289532110,2706671279,2087905683,3018724369,1668267050,732546397,1947742710,3462151702,2609353502,2950085171,1814351708,2050118529,680887927,999245976,1800124847,3300911131,1713906067,1641548236,4213287313,1216130144,1575780402,4018429277,3917837745,3693486850,3949271944,596196993,3549867205,258830323,2213823033,772490370,2760122372,1774776394,2652871518,566650946,4142492826,1728879713,2882767088,1783734482,3629395816,2517608232,2874225571,1861159788,326777828,3124490320,2130389656,2716951837,967770486,1724537150,2185432712,2364442137,1164943284,2105845187,998989502,3765401048,2244026483,1075463327,1455516326,1322494562,910128902,469688178,1117454909,936433444,3490320968,3675253459,1240580251,122909385,2157517691,634681816,4142456567,3825094682,3061402683,2540495037,79693498,3249098678,1084186820,1583128258,426386531,1761308591,1047286709,322548459,995290223,1845252383,2603652396,3431023940,2942221577,3202600964,3727903485,1712269319,422464435,3234572375,1170764815,3523960633,3117677531,1434042557,442511882,3600875718,1076654713,1738483198,4213154764,2393238008,3677496056,1014306527,4251020053,793779912,2902807211,842905082,4246964064,1395751752,1040244610,2656851899,3396308128,445077038,3742853595,3577915638,679411651,2892444358,2354009459,1767581616,3150600392,3791627101,3102740896,284835224,4246832056,1258075500,768725851,2589189241,3069724005,3532540348,1274779536,3789419226,2764799539,1660621633,3471099624,4011903706,913787905,3497959166,737222580,2514213453,2928710040,3937242737,1804850592,3499020752,2949064160,2386320175,2390070455,2415321851,4061277028,2290661394,2416832540,1336762016,1754252060,3520065937,3014181293,791618072,3188594551,3933548030,2332172193,3852520463,3043980520,413987798,3465142937,3030929376,4245938359,2093235073,3534596313,375366246,2157278981,2479649556,555357303,3870105701,2008414854,3344188149,4221384143,3956125452,2067696032,3594591187,2921233993,2428461,544322398,577241275,1471733935,610547355,4027169054,1432588573,1507829418,2025931657,3646575487,545086370,48609733,2200306550,1653985193,298326376,1316178497,3007786442,2064951626,458293330,2589141269,3591329599,3164325604,727753846,2179363840,146436021,1461446943,4069977195,705550613,3059967265,3887724982,4281599278,3313849956,1404054877,2845806497,146425753,1854211946],[1266315497,3048417604,3681880366,3289982499,290971e4,1235738493,2632868024,2414719590,3970600049,1771706367,1449415276,3266420449,422970021,1963543593,2690192192,3826793022,1062508698,1531092325,1804592342,2583117782,2714934279,4024971509,1294809318,4028980673,1289560198,2221992742,1669523910,35572830,157838143,1052438473,1016535060,1802137761,1753167236,1386275462,3080475397,2857371447,1040679964,2145300060,2390574316,1461121720,2956646967,4031777805,4028374788,33600511,2920084762,1018524850,629373528,3691585981,3515945977,2091462646,2486323059,586499841,988145025,935516892,3367335476,2599673255,2839830854,265290510,3972581182,2759138881,3795373465,1005194799,847297441,406762289,1314163512,1332590856,1866599683,4127851711,750260880,613907577,1450815602,3165620655,3734664991,3650291728,3012275730,3704569646,1427272223,778793252,1343938022,2676280711,2052605720,1946737175,3164576444,3914038668,3967478842,3682934266,1661551462,3294938066,4011595847,840292616,3712170807,616741398,312560963,711312465,1351876610,322626781,1910503582,271666773,2175563734,1594956187,70604529,3617834859,1007753275,1495573769,4069517037,2549218298,2663038764,504708206,2263041392,3941167025,2249088522,1514023603,1998579484,1312622330,694541497,2582060303,2151582166,1382467621,776784248,2618340202,3323268794,2497899128,2784771155,503983604,4076293799,907881277,423175695,432175456,1378068232,4145222326,3954048622,3938656102,3820766613,2793130115,2977904593,26017576,3274890735,3194772133,1700274565,1756076034,4006520079,3677328699,720338349,1533947780,354530856,688349552,3973924725,1637815568,332179504,3949051286,53804574,2852348879,3044236432,1282449977,3583942155,3416972820,4006381244,1617046695,2628476075,3002303598,1686838959,431878346,2686675385,1700445008,1080580658,1009431731,832498133,3223435511,2605976345,2271191193,2516031870,1648197032,4164389018,2548247927,300782431,375919233,238389289,3353747414,2531188641,2019080857,1475708069,455242339,2609103871,448939670,3451063019,1395535956,2413381860,1841049896,1491858159,885456874,4264095073,4001119347,1565136089,3898914787,1108368660,540939232,1173283510,2745871338,3681308437,4207628240,3343053890,4016749493,1699691293,1103962373,3625875870,2256883143,3830138730,1031889488,3479347698,1535977030,4236805024,3251091107,2132092099,1774941330,1199868427,1452454533,157007616,2904115357,342012276,595725824,1480756522,206960106,497939518,591360097,863170706,2375253569,3596610801,1814182875,2094937945,3421402208,1082520231,3463918190,2785509508,435703966,3908032597,1641649973,2842273706,3305899714,1510255612,2148256476,2655287854,3276092548,4258621189,236887753,3681803219,274041037,1734335097,3815195456,3317970021,1899903192,1026095262,4050517792,356393447,2410691914,3873677099,3682840055],[3913112168,2491498743,4132185628,2489919796,1091903735,1979897079,3170134830,3567386728,3557303409,857797738,1136121015,1342202287,507115054,2535736646,337727348,3213592640,1301675037,2528481711,1895095763,1721773893,3216771564,62756741,2142006736,835421444,2531993523,1442658625,3659876326,2882144922,676362277,1392781812,170690266,3921047035,1759253602,3611846912,1745797284,664899054,1329594018,3901205900,3045908486,2062866102,2865634940,3543621612,3464012697,1080764994,553557557,3656615353,3996768171,991055499,499776247,1265440854,648242737,3940784050,980351604,3713745714,1749149687,3396870395,4211799374,3640570775,1161844396,3125318951,1431517754,545492359,4268468663,3499529547,1437099964,2702547544,3433638243,2581715763,2787789398,1060185593,1593081372,2418618748,4260947970,69676912,2159744348,86519011,2512459080,3838209314,1220612927,3339683548,133810670,1090789135,1078426020,1569222167,845107691,3583754449,4072456591,1091646820,628848692,1613405280,3757631651,526609435,236106946,48312990,2942717905,3402727701,1797494240,859738849,992217954,4005476642,2243076622,3870952857,3732016268,765654824,3490871365,2511836413,1685915746,3888969200,1414112111,2273134842,3281911079,4080962846,172450625,2569994100,980381355,4109958455,2819808352,2716589560,2568741196,3681446669,3329971472,1835478071,660984891,3704678404,4045999559,3422617507,3040415634,1762651403,1719377915,3470491036,2693910283,3642056355,3138596744,1364962596,2073328063,1983633131,926494387,3423689081,2150032023,4096667949,1749200295,3328846651,309677260,2016342300,1779581495,3079819751,111262694,1274766160,443224088,298511866,1025883608,3806446537,1145181785,168956806,3641502830,3584813610,1689216846,3666258015,3200248200,1692713982,2646376535,4042768518,1618508792,1610833997,3523052358,4130873264,2001055236,3610705100,2202168115,4028541809,2961195399,1006657119,2006996926,3186142756,1430667929,3210227297,1314452623,4074634658,4101304120,2273951170,1399257539,3367210612,3027628629,1190975929,2062231137,2333990788,2221543033,2438960610,1181637006,548689776,2362791313,3372408396,3104550113,3145860560,296247880,1970579870,3078560182,3769228297,1714227617,3291629107,3898220290,166772364,1251581989,493813264,448347421,195405023,2709975567,677966185,3703036547,1463355134,2715995803,1338867538,1343315457,2802222074,2684532164,233230375,2599980071,2000651841,3277868038,1638401717,4028070440,3237316320,6314154,819756386,300326615,590932579,1405279636,3267499572,3150704214,2428286686,3959192993,3461946742,1862657033,1266418056,963775037,2089974820,2263052895,1917689273,448879540,3550394620,3981727096,150775221,3627908307,1303187396,508620638,2975983352,2726630617,1817252668,1876281319,1457606340,908771278,3720792119,3617206836,2455994898,1729034894,1080033504],[976866871,3556439503,2881648439,1522871579,1555064734,1336096578,3548522304,2579274686,3574697629,3205460757,3593280638,3338716283,3079412587,564236357,2993598910,1781952180,1464380207,3163844217,3332601554,1699332808,1393555694,1183702653,3581086237,1288719814,691649499,2847557200,2895455976,3193889540,2717570544,1781354906,1676643554,2592534050,3230253752,1126444790,2770207658,2633158820,2210423226,2615765581,2414155088,3127139286,673620729,2805611233,1269405062,4015350505,3341807571,4149409754,1057255273,2012875353,2162469141,2276492801,2601117357,993977747,3918593370,2654263191,753973209,36408145,2530585658,25011837,3520020182,2088578344,530523599,2918365339,1524020338,1518925132,3760827505,3759777254,1202760957,3985898139,3906192525,674977740,4174734889,2031300136,2019492241,3983892565,4153806404,3822280332,352677332,2297720250,60907813,90501309,3286998549,1016092578,2535922412,2839152426,457141659,509813237,4120667899,652014361,1966332200,2975202805,55981186,2327461051,676427537,3255491064,2882294119,3433927263,1307055953,942726286,933058658,2468411793,3933900994,4215176142,1361170020,2001714738,2830558078,3274259782,1222529897,1679025792,2729314320,3714953764,1770335741,151462246,3013232138,1682292957,1483529935,471910574,1539241949,458788160,3436315007,1807016891,3718408830,978976581,1043663428,3165965781,1927990952,4200891579,2372276910,3208408903,3533431907,1412390302,2931980059,4132332400,1947078029,3881505623,4168226417,2941484381,1077988104,1320477388,886195818,18198404,3786409e3,2509781533,112762804,3463356488,1866414978,891333506,18488651,661792760,1628790961,3885187036,3141171499,876946877,2693282273,1372485963,791857591,2686433993,3759982718,3167212022,3472953795,2716379847,445679433,3561995674,3504004811,3574258232,54117162,3331405415,2381918588,3769707343,4154350007,1140177722,4074052095,668550556,3214352940,367459370,261225585,2610173221,4209349473,3468074219,3265815641,314222801,3066103646,3808782860,282218597,3406013506,3773591054,379116347,1285071038,846784868,2669647154,3771962079,3550491691,2305946142,453669953,1268987020,3317592352,3279303384,3744833421,2610507566,3859509063,266596637,3847019092,517658769,3462560207,3443424879,370717030,4247526661,2224018117,4143653529,4112773975,2788324899,2477274417,1456262402,2901442914,1517677493,1846949527,2295493580,3734397586,2176403920,1280348187,1908823572,3871786941,846861322,1172426758,3287448474,3383383037,1655181056,3139813346,901632758,1897031941,2986607138,3066810236,3447102507,1393639104,373351379,950779232,625454576,3124240540,4148612726,2007998917,544563296,2244738638,2330496472,2058025392,1291430526,424198748,50039436,29584100,3605783033,2429876329,2791104160,1057563949,3255363231,3075367218,3463963227,1469046755,985887462]],hn.prototype.PARRAY=[608135816,2242054355,320440878,57701188,2752067618,698298832,137296536,3964562569,1160258022,953160567,3193202383,887688300,3232508343,3380367581,1065670069,3041331479,2450970073,2306472731],hn.prototype.NN=16,hn.prototype._clean=function(r){return r<0&&(r=2147483648+(2147483647&r)),r},hn.prototype._F=function(r){let t;const e=255&r,n=255&(r>>>=8),a=255&(r>>>=8),o=255&(r>>>=8);return t=this.sboxes[0][o]+this.sboxes[1][a],t^=this.sboxes[2][n],t+=this.sboxes[3][e],t},hn.prototype._encryptBlock=function(r){let t,e=r[0],n=r[1];for(t=0;t<this.NN;++t){e^=this.parray[t],n=this._F(e)^n;const a=e;e=n,n=a}e^=this.parray[this.NN+0],n^=this.parray[this.NN+1],r[0]=this._clean(n),r[1]=this._clean(e)},hn.prototype.encryptBlock=function(r){let t;const e=[0,0],n=this.BLOCKSIZE/2;for(t=0;t<this.BLOCKSIZE/2;++t)e[0]=e[0]<<8|255&r[t+0],e[1]=e[1]<<8|255&r[t+n];this._encryptBlock(e);const a=[];for(t=0;t<this.BLOCKSIZE/2;++t)a[t+0]=e[0]>>>24-8*t&255,a[t+n]=e[1]>>>24-8*t&255;return a},hn.prototype._decryptBlock=function(r){let t,e=r[0],n=r[1];for(t=this.NN+1;t>1;--t){e^=this.parray[t],n=this._F(e)^n;const a=e;e=n,n=a}e^=this.parray[1],n^=this.parray[0],r[0]=this._clean(n),r[1]=this._clean(e)},hn.prototype.init=function(r){let t,e=0;for(this.parray=[],t=0;t<this.NN+2;++t){let a=0;for(let o=0;o<4;++o)a=a<<8|255&r[e],++e>=r.length&&(e=0);this.parray[t]=this.PARRAY[t]^a}for(this.sboxes=[],t=0;t<4;++t)for(this.sboxes[t]=[],e=0;e<256;++e)this.sboxes[t][e]=this.SBOXES[t][e];const n=[0,0];for(t=0;t<this.NN+2;t+=2)this._encryptBlock(n),this.parray[t+0]=n[0],this.parray[t+1]=n[1];for(t=0;t<4;++t)for(e=0;e<256;e+=2)this._encryptBlock(n),this.sboxes[t][e+0]=n[0],this.sboxes[t][e+1]=n[1]},si.keySize=si.prototype.keySize=16,si.blockSize=si.prototype.blockSize=8;const cs=Ur(128),us=Ur(192),ls=Ur(256);var cn=Object.freeze({__proto__:null,aes128:cs,aes192:us,aes256:ls,des:function(r){this.key=r,this.encrypt=function(t,e){return ir(pr(this.key),t,!0,0,null,e)},this.decrypt=function(t,e){return ir(pr(this.key),t,!1,0,null,e)}},tripledes:kr,cast5:Mr,twofish:Dr,blowfish:si,idea:function(){throw Error("IDEA symmetric-key algorithm not implemented")}}),ha=function(r,t,e){var n=0,a=0,o=0,u=0,f=0,w=0,g=0,b=0,L=0,$=0,j=0,se=0,pe=0,xe=0,Ke=0,Qe=0,Be=0,le=new r.Uint8Array(e);function Xe(ze,yt,Ot,Zt,Kt,Nt,Gt,xt,ge,Ne,Oe,R,ye,qe,nt,it){var St,bt,At,Et,Ee,we,Se,_e,ke,ae,ie,he,vt,tr,ur,hr,sr,Or,Vr,jr,qr,ar,xr,vr,er,Ir,Sr,Br,st,ot,wt,Wt,Yt,nr,Jt,Er,Pr,wn,Cn,An,Fn,Ni,Li,Ki,Oi,Mi,Fi,Hi,la,fa,rs,ns,is,as,ss,os,q0,J0,eo,to,ro,q=0,Q=0,te=0,oe=0,Ce=0,ve=0,Te=0;Te=(ze|=0)+((q=n)<<5|q>>>27)+(Ce=f)+((Q=a)&(te=o)|~Q&(oe=u))+1518500249|0,Ce=oe,oe=te,te=Q<<30|Q>>>2,Q=q,Te=(yt|=0)+((q=Te)<<5|q>>>27)+Ce+(Q&te|~Q&oe)+1518500249|0,Ce=oe,oe=te,te=Q<<30|Q>>>2,Q=q,Te=(Ot|=0)+((q=Te)<<5|q>>>27)+Ce+(Q&te|~Q&oe)+1518500249|0,Ce=oe,oe=te,te=Q<<30|Q>>>2,Q=q,Te=(Zt|=0)+((q=Te)<<5|q>>>27)+Ce+(Q&te|~Q&oe)+1518500249|0,Ce=oe,oe=te,te=Q<<30|Q>>>2,Q=q,Te=(Kt|=0)+((q=Te)<<5|q>>>27)+Ce+(Q&te|~Q&oe)+1518500249|0,Ce=oe,oe=te,te=Q<<30|Q>>>2,Q=q,Te=(Nt|=0)+((q=Te)<<5|q>>>27)+Ce+(Q&te|~Q&oe)+1518500249|0,Ce=oe,oe=te,te=Q<<30|Q>>>2,Q=q,Te=(Gt|=0)+((q=Te)<<5|q>>>27)+Ce+(Q&te|~Q&oe)+1518500249|0,Ce=oe,oe=te,te=Q<<30|Q>>>2,Q=q,Te=(xt|=0)+((q=Te)<<5|q>>>27)+Ce+(Q&te|~Q&oe)+1518500249|0,Ce=oe,oe=te,te=Q<<30|Q>>>2,Q=q,Te=(ge|=0)+((q=Te)<<5|q>>>27)+Ce+(Q&te|~Q&oe)+1518500249|0,Ce=oe,oe=te,te=Q<<30|Q>>>2,Q=q,Te=(Ne|=0)+((q=Te)<<5|q>>>27)+Ce+(Q&te|~Q&oe)+1518500249|0,Ce=oe,oe=te,te=Q<<30|Q>>>2,Q=q,Te=(Oe|=0)+((q=Te)<<5|q>>>27)+Ce+(Q&te|~Q&oe)+1518500249|0,Ce=oe,oe=te,te=Q<<30|Q>>>2,Q=q,Te=(R|=0)+((q=Te)<<5|q>>>27)+Ce+(Q&te|~Q&oe)+1518500249|0,Ce=oe,oe=te,te=Q<<30|Q>>>2,Q=q,Te=(ye|=0)+((q=Te)<<5|q>>>27)+Ce+(Q&te|~Q&oe)+1518500249|0,Ce=oe,oe=te,te=Q<<30|Q>>>2,Q=q,Te=(qe|=0)+((q=Te)<<5|q>>>27)+Ce+(Q&te|~Q&oe)+1518500249|0,Ce=oe,oe=te,te=Q<<30|Q>>>2,Q=q,Te=(nt|=0)+((q=Te)<<5|q>>>27)+Ce+(Q&te|~Q&oe)+1518500249|0,Ce=oe,oe=te,te=Q<<30|Q>>>2,Q=q,Te=(it|=0)+((q=Te)<<5|q>>>27)+Ce+(Q&te|~Q&oe)+1518500249|0,Ce=oe,oe=te,te=Q<<30|Q>>>2,Q=q,Te=(St=(ve=qe^ge^Ot^ze)<<1|ve>>>31)+((q=Te)<<5|q>>>27)+Ce+(Q&te|~Q&oe)+1518500249|0,Ce=oe,oe=te,te=Q<<30|Q>>>2,Q=q,Te=(bt=(ve=nt^Ne^Zt^yt)<<1|ve>>>31)+((q=Te)<<5|q>>>27)+Ce+(Q&te|~Q&oe)+1518500249|0,Ce=oe,oe=te,te=Q<<30|Q>>>2,Q=q,Te=(At=(ve=it^Oe^Kt^Ot)<<1|ve>>>31)+((q=Te)<<5|q>>>27)+Ce+(Q&te|~Q&oe)+1518500249|0,Ce=oe,oe=te,te=Q<<30|Q>>>2,Q=q,Te=(Et=(ve=St^R^Nt^Zt)<<1|ve>>>31)+((q=Te)<<5|q>>>27)+Ce+(Q&te|~Q&oe)+1518500249|0,Ce=oe,oe=te,te=Q<<30|Q>>>2,Q=q,Te=(Ee=(ve=bt^ye^Gt^Kt)<<1|ve>>>31)+((q=Te)<<5|q>>>27)+Ce+(Q^te^oe)+1859775393|0,Ce=oe,oe=te,te=Q<<30|Q>>>2,Q=q,Te=(we=(ve=At^qe^xt^Nt)<<1|ve>>>31)+((q=Te)<<5|q>>>27)+Ce+(Q^te^oe)+1859775393|0,Ce=oe,oe=te,te=Q<<30|Q>>>2,Q=q,Te=(Se=(ve=Et^nt^ge^Gt)<<1|ve>>>31)+((q=Te)<<5|q>>>27)+Ce+(Q^te^oe)+1859775393|0,Ce=oe,oe=te,te=Q<<30|Q>>>2,Q=q,Te=(_e=(ve=Ee^it^Ne^xt)<<1|ve>>>31)+((q=Te)<<5|q>>>27)+Ce+(Q^te^oe)+1859775393|0,Ce=oe,oe=te,te=Q<<30|Q>>>2,Q=q,Te=(ke=(ve=we^St^Oe^ge)<<1|ve>>>31)+((q=Te)<<5|q>>>27)+Ce+(Q^te^oe)+1859775393|0,Ce=oe,oe=te,te=Q<<30|Q>>>2,Q=q,Te=(ae=(ve=Se^bt^R^Ne)<<1|ve>>>31)+((q=Te)<<5|q>>>27)+Ce+(Q^te^oe)+1859775393|0,Ce=oe,oe=te,te=Q<<30|Q>>>2,Q=q,Te=(ie=(ve=_e^At^ye^Oe)<<1|ve>>>31)+((q=Te)<<5|q>>>27)+Ce+(Q^te^oe)+1859775393|0,Ce=oe,oe=te,te=Q<<30|Q>>>2,Q=q,Te=(he=(ve=ke^Et^qe^R)<<1|ve>>>31)+((q=Te)<<5|q>>>27)+Ce+(Q^te^oe)+1859775393|0,Ce=oe,oe=te,te=Q<<30|Q>>>2,Q=q,Te=(vt=(ve=ae^Ee^nt^ye)<<1|ve>>>31)+((q=Te)<<5|q>>>27)+Ce+(Q^te^oe)+1859775393|0,Ce=oe,oe=te,te=Q<<30|Q>>>2,Q=q,Te=(tr=(ve=ie^we^it^qe)<<1|ve>>>31)+((q=Te)<<5|q>>>27)+Ce+(Q^te^oe)+1859775393|0,Ce=oe,oe=te,te=Q<<30|Q>>>2,Q=q,Te=(ur=(ve=he^Se^St^nt)<<1|ve>>>31)+((q=Te)<<5|q>>>27)+Ce+(Q^te^oe)+1859775393|0,Ce=oe,oe=te,te=Q<<30|Q>>>2,Q=q,Te=(hr=(ve=vt^_e^bt^it)<<1|ve>>>31)+((q=Te)<<5|q>>>27)+Ce+(Q^te^oe)+1859775393|0,Ce=oe,oe=te,te=Q<<30|Q>>>2,Q=q,Te=(sr=(ve=tr^ke^At^St)<<1|ve>>>31)+((q=Te)<<5|q>>>27)+Ce+(Q^te^oe)+1859775393|0,Ce=oe,oe=te,te=Q<<30|Q>>>2,Q=q,Te=(Or=(ve=ur^ae^Et^bt)<<1|ve>>>31)+((q=Te)<<5|q>>>27)+Ce+(Q^te^oe)+1859775393|0,Ce=oe,oe=te,te=Q<<30|Q>>>2,Q=q,Te=(Vr=(ve=hr^ie^Ee^At)<<1|ve>>>31)+((q=Te)<<5|q>>>27)+Ce+(Q^te^oe)+1859775393|0,Ce=oe,oe=te,te=Q<<30|Q>>>2,Q=q,Te=(jr=(ve=sr^he^we^Et)<<1|ve>>>31)+((q=Te)<<5|q>>>27)+Ce+(Q^te^oe)+1859775393|0,Ce=oe,oe=te,te=Q<<30|Q>>>2,Q=q,Te=(qr=(ve=Or^vt^Se^Ee)<<1|ve>>>31)+((q=Te)<<5|q>>>27)+Ce+(Q^te^oe)+1859775393|0,Ce=oe,oe=te,te=Q<<30|Q>>>2,Q=q,Te=(ar=(ve=Vr^tr^_e^we)<<1|ve>>>31)+((q=Te)<<5|q>>>27)+Ce+(Q^te^oe)+1859775393|0,Ce=oe,oe=te,te=Q<<30|Q>>>2,Q=q,Te=(xr=(ve=jr^ur^ke^Se)<<1|ve>>>31)+((q=Te)<<5|q>>>27)+Ce+(Q^te^oe)+1859775393|0,Ce=oe,oe=te,te=Q<<30|Q>>>2,Q=q,Te=(vr=(ve=qr^hr^ae^_e)<<1|ve>>>31)+((q=Te)<<5|q>>>27)+Ce+(Q^te^oe)+1859775393|0,Ce=oe,oe=te,te=Q<<30|Q>>>2,Q=q,Te=(er=(ve=ar^sr^ie^ke)<<1|ve>>>31)+((q=Te)<<5|q>>>27)+Ce+(Q&te|Q&oe|te&oe)-1894007588|0,Ce=oe,oe=te,te=Q<<30|Q>>>2,Q=q,Te=(Ir=(ve=xr^Or^he^ae)<<1|ve>>>31)+((q=Te)<<5|q>>>27)+Ce+(Q&te|Q&oe|te&oe)-1894007588|0,Ce=oe,oe=te,te=Q<<30|Q>>>2,Q=q,Te=(Sr=(ve=vr^Vr^vt^ie)<<1|ve>>>31)+((q=Te)<<5|q>>>27)+Ce+(Q&te|Q&oe|te&oe)-1894007588|0,Ce=oe,oe=te,te=Q<<30|Q>>>2,Q=q,Te=(Br=(ve=er^jr^tr^he)<<1|ve>>>31)+((q=Te)<<5|q>>>27)+Ce+(Q&te|Q&oe|te&oe)-1894007588|0,Ce=oe,oe=te,te=Q<<30|Q>>>2,Q=q,Te=(st=(ve=Ir^qr^ur^vt)<<1|ve>>>31)+((q=Te)<<5|q>>>27)+Ce+(Q&te|Q&oe|te&oe)-1894007588|0,Ce=oe,oe=te,te=Q<<30|Q>>>2,Q=q,Te=(ot=(ve=Sr^ar^hr^tr)<<1|ve>>>31)+((q=Te)<<5|q>>>27)+Ce+(Q&te|Q&oe|te&oe)-1894007588|0,Ce=oe,oe=te,te=Q<<30|Q>>>2,Q=q,Te=(wt=(ve=Br^xr^sr^ur)<<1|ve>>>31)+((q=Te)<<5|q>>>27)+Ce+(Q&te|Q&oe|te&oe)-1894007588|0,Ce=oe,oe=te,te=Q<<30|Q>>>2,Q=q,Te=(Wt=(ve=st^vr^Or^hr)<<1|ve>>>31)+((q=Te)<<5|q>>>27)+Ce+(Q&te|Q&oe|te&oe)-1894007588|0,Ce=oe,oe=te,te=Q<<30|Q>>>2,Q=q,Te=(Yt=(ve=ot^er^Vr^sr)<<1|ve>>>31)+((q=Te)<<5|q>>>27)+Ce+(Q&te|Q&oe|te&oe)-1894007588|0,Ce=oe,oe=te,te=Q<<30|Q>>>2,Q=q,Te=(nr=(ve=wt^Ir^jr^Or)<<1|ve>>>31)+((q=Te)<<5|q>>>27)+Ce+(Q&te|Q&oe|te&oe)-1894007588|0,Ce=oe,oe=te,te=Q<<30|Q>>>2,Q=q,Te=(Jt=(ve=Wt^Sr^qr^Vr)<<1|ve>>>31)+((q=Te)<<5|q>>>27)+Ce+(Q&te|Q&oe|te&oe)-1894007588|0,Ce=oe,oe=te,te=Q<<30|Q>>>2,Q=q,Te=(Er=(ve=Yt^Br^ar^jr)<<1|ve>>>31)+((q=Te)<<5|q>>>27)+Ce+(Q&te|Q&oe|te&oe)-1894007588|0,Ce=oe,oe=te,te=Q<<30|Q>>>2,Q=q,Te=(Pr=(ve=nr^st^xr^qr)<<1|ve>>>31)+((q=Te)<<5|q>>>27)+Ce+(Q&te|Q&oe|te&oe)-1894007588|0,Ce=oe,oe=te,te=Q<<30|Q>>>2,Q=q,Te=(wn=(ve=Jt^ot^vr^ar)<<1|ve>>>31)+((q=Te)<<5|q>>>27)+Ce+(Q&te|Q&oe|te&oe)-1894007588|0,Ce=oe,oe=te,te=Q<<30|Q>>>2,Q=q,Te=(Cn=(ve=Er^wt^er^xr)<<1|ve>>>31)+((q=Te)<<5|q>>>27)+Ce+(Q&te|Q&oe|te&oe)-1894007588|0,Ce=oe,oe=te,te=Q<<30|Q>>>2,Q=q,Te=(An=(ve=Pr^Wt^Ir^vr)<<1|ve>>>31)+((q=Te)<<5|q>>>27)+Ce+(Q&te|Q&oe|te&oe)-1894007588|0,Ce=oe,oe=te,te=Q<<30|Q>>>2,Q=q,Te=(Fn=(ve=wn^Yt^Sr^er)<<1|ve>>>31)+((q=Te)<<5|q>>>27)+Ce+(Q&te|Q&oe|te&oe)-1894007588|0,Ce=oe,oe=te,te=Q<<30|Q>>>2,Q=q,Te=(Ni=(ve=Cn^nr^Br^Ir)<<1|ve>>>31)+((q=Te)<<5|q>>>27)+Ce+(Q&te|Q&oe|te&oe)-1894007588|0,Ce=oe,oe=te,te=Q<<30|Q>>>2,Q=q,Te=(Li=(ve=An^Jt^st^Sr)<<1|ve>>>31)+((q=Te)<<5|q>>>27)+Ce+(Q&te|Q&oe|te&oe)-1894007588|0,Ce=oe,oe=te,te=Q<<30|Q>>>2,Q=q,Te=(Ki=(ve=Fn^Er^ot^Br)<<1|ve>>>31)+((q=Te)<<5|q>>>27)+Ce+(Q&te|Q&oe|te&oe)-1894007588|0,Ce=oe,oe=te,te=Q<<30|Q>>>2,Q=q,Te=(Oi=(ve=Ni^Pr^wt^st)<<1|ve>>>31)+((q=Te)<<5|q>>>27)+Ce+(Q^te^oe)-899497514|0,Ce=oe,oe=te,te=Q<<30|Q>>>2,Q=q,Te=(Mi=(ve=Li^wn^Wt^ot)<<1|ve>>>31)+((q=Te)<<5|q>>>27)+Ce+(Q^te^oe)-899497514|0,Ce=oe,oe=te,te=Q<<30|Q>>>2,Q=q,Te=(Fi=(ve=Ki^Cn^Yt^wt)<<1|ve>>>31)+((q=Te)<<5|q>>>27)+Ce+(Q^te^oe)-899497514|0,Ce=oe,oe=te,te=Q<<30|Q>>>2,Q=q,Te=(Hi=(ve=Oi^An^nr^Wt)<<1|ve>>>31)+((q=Te)<<5|q>>>27)+Ce+(Q^te^oe)-899497514|0,Ce=oe,oe=te,te=Q<<30|Q>>>2,Q=q,Te=(la=(ve=Mi^Fn^Jt^Yt)<<1|ve>>>31)+((q=Te)<<5|q>>>27)+Ce+(Q^te^oe)-899497514|0,Ce=oe,oe=te,te=Q<<30|Q>>>2,Q=q,Te=(fa=(ve=Fi^Ni^Er^nr)<<1|ve>>>31)+((q=Te)<<5|q>>>27)+Ce+(Q^te^oe)-899497514|0,Ce=oe,oe=te,te=Q<<30|Q>>>2,Q=q,Te=(rs=(ve=Hi^Li^Pr^Jt)<<1|ve>>>31)+((q=Te)<<5|q>>>27)+Ce+(Q^te^oe)-899497514|0,Ce=oe,oe=te,te=Q<<30|Q>>>2,Q=q,Te=(ns=(ve=la^Ki^wn^Er)<<1|ve>>>31)+((q=Te)<<5|q>>>27)+Ce+(Q^te^oe)-899497514|0,Ce=oe,oe=te,te=Q<<30|Q>>>2,Q=q,Te=(is=(ve=fa^Oi^Cn^Pr)<<1|ve>>>31)+((q=Te)<<5|q>>>27)+Ce+(Q^te^oe)-899497514|0,Ce=oe,oe=te,te=Q<<30|Q>>>2,Q=q,Te=(as=(ve=rs^Mi^An^wn)<<1|ve>>>31)+((q=Te)<<5|q>>>27)+Ce+(Q^te^oe)-899497514|0,Ce=oe,oe=te,te=Q<<30|Q>>>2,Q=q,Te=(ss=(ve=ns^Fi^Fn^Cn)<<1|ve>>>31)+((q=Te)<<5|q>>>27)+Ce+(Q^te^oe)-899497514|0,Ce=oe,oe=te,te=Q<<30|Q>>>2,Q=q,Te=(os=(ve=is^Hi^Ni^An)<<1|ve>>>31)+((q=Te)<<5|q>>>27)+Ce+(Q^te^oe)-899497514|0,Ce=oe,oe=te,te=Q<<30|Q>>>2,Q=q,Te=(q0=(ve=as^la^Li^Fn)<<1|ve>>>31)+((q=Te)<<5|q>>>27)+Ce+(Q^te^oe)-899497514|0,Ce=oe,oe=te,te=Q<<30|Q>>>2,Q=q,Te=(J0=(ve=ss^fa^Ki^Ni)<<1|ve>>>31)+((q=Te)<<5|q>>>27)+Ce+(Q^te^oe)-899497514|0,Ce=oe,oe=te,te=Q<<30|Q>>>2,Q=q,Te=(eo=(ve=os^rs^Oi^Li)<<1|ve>>>31)+((q=Te)<<5|q>>>27)+Ce+(Q^te^oe)-899497514|0,Ce=oe,oe=te,te=Q<<30|Q>>>2,Q=q,Te=(to=(ve=q0^ns^Mi^Ki)<<1|ve>>>31)+((q=Te)<<5|q>>>27)+Ce+(Q^te^oe)-899497514|0,Ce=oe,oe=te,te=Q<<30|Q>>>2,Q=q,Te=(ro=(ve=J0^is^Fi^Oi)<<1|ve>>>31)+((q=Te)<<5|q>>>27)+Ce+(Q^te^oe)-899497514|0,Ce=oe,oe=te,te=Q<<30|Q>>>2,Q=q,Te=((ve=eo^as^Hi^Mi)<<1|ve>>>31)+((q=Te)<<5|q>>>27)+Ce+(Q^te^oe)-899497514|0,Ce=oe,oe=te,te=Q<<30|Q>>>2,Q=q,Te=((ve=to^ss^la^Fi)<<1|ve>>>31)+((q=Te)<<5|q>>>27)+Ce+(Q^te^oe)-899497514|0,Ce=oe,oe=te,te=Q<<30|Q>>>2,Q=q,Te=((ve=ro^os^fa^Hi)<<1|ve>>>31)+((q=Te)<<5|q>>>27)+Ce+(Q^te^oe)-899497514|0,Ce=oe,oe=te,te=Q<<30|Q>>>2,Q=q,n=n+(q=Te)|0,a=a+Q|0,o=o+te|0,u=u+oe|0,f=f+Ce|0}function He(ze){Xe(le[0|(ze|=0)]<<24|le[1|ze]<<16|le[2|ze]<<8|le[3|ze],le[4|ze]<<24|le[5|ze]<<16|le[6|ze]<<8|le[7|ze],le[8|ze]<<24|le[9|ze]<<16|le[10|ze]<<8|le[11|ze],le[12|ze]<<24|le[13|ze]<<16|le[14|ze]<<8|le[15|ze],le[16|ze]<<24|le[17|ze]<<16|le[18|ze]<<8|le[19|ze],le[20|ze]<<24|le[21|ze]<<16|le[22|ze]<<8|le[23|ze],le[24|ze]<<24|le[25|ze]<<16|le[26|ze]<<8|le[27|ze],le[28|ze]<<24|le[29|ze]<<16|le[30|ze]<<8|le[31|ze],le[32|ze]<<24|le[33|ze]<<16|le[34|ze]<<8|le[35|ze],le[36|ze]<<24|le[37|ze]<<16|le[38|ze]<<8|le[39|ze],le[40|ze]<<24|le[41|ze]<<16|le[42|ze]<<8|le[43|ze],le[44|ze]<<24|le[45|ze]<<16|le[46|ze]<<8|le[47|ze],le[48|ze]<<24|le[49|ze]<<16|le[50|ze]<<8|le[51|ze],le[52|ze]<<24|le[53|ze]<<16|le[54|ze]<<8|le[55|ze],le[56|ze]<<24|le[57|ze]<<16|le[58|ze]<<8|le[59|ze],le[60|ze]<<24|le[61|ze]<<16|le[62|ze]<<8|le[63|ze])}function $e(ze){le[0|(ze|=0)]=n>>>24,le[1|ze]=n>>>16&255,le[2|ze]=n>>>8&255,le[3|ze]=255&n,le[4|ze]=a>>>24,le[5|ze]=a>>>16&255,le[6|ze]=a>>>8&255,le[7|ze]=255&a,le[8|ze]=o>>>24,le[9|ze]=o>>>16&255,le[10|ze]=o>>>8&255,le[11|ze]=255&o,le[12|ze]=u>>>24,le[13|ze]=u>>>16&255,le[14|ze]=u>>>8&255,le[15|ze]=255&u,le[16|ze]=f>>>24,le[17|ze]=f>>>16&255,le[18|ze]=f>>>8&255,le[19|ze]=255&f}function rt(){n=1732584193,a=4023233417,o=2562383102,u=271733878,f=3285377520,w=g=0}function dt(ze,yt){yt|=0;var Ot=0;if(63&(ze|=0))return-1;for(;(0|yt)>=64;)He(ze),ze=ze+64|0,yt=yt-64|0,Ot=Ot+64|0;return(w=w+Ot|0)>>>0<Ot>>>0&&(g=g+1|0),0|Ot}function It(ze,yt,Ot){Ot|=0;var Zt=0,Kt=0;if(63&(ze|=0)||~Ot&&31&Ot)return-1;if((0|(yt|=0))>=64){if(-1==(0|(Zt=0|dt(ze,yt))))return-1;ze=ze+Zt|0,yt=yt-Zt|0}if(Zt=Zt+yt|0,(w=w+yt|0)>>>0<yt>>>0&&(g=g+1|0),le[ze|yt]=128,(0|yt)>=56){for(Kt=yt+1|0;(0|Kt)<64;Kt=Kt+1|0)le[ze|Kt]=0;He(ze),yt=0,le[0|ze]=0}for(Kt=yt+1|0;(0|Kt)<59;Kt=Kt+1|0)le[ze|Kt]=0;return le[56|ze]=g>>>21&255,le[57|ze]=g>>>13&255,le[58|ze]=g>>>5&255,le[59|ze]=g<<3&255|w>>>29,le[60|ze]=w>>>21&255,le[61|ze]=w>>>13&255,le[62|ze]=w>>>5&255,le[63|ze]=w<<3&255,He(ze),~Ot&&$e(Ot),0|Zt}function Ut(){n=b,a=L,o=$,u=j,f=se,w=64,g=0}function zt(){n=pe,a=xe,o=Ke,u=Qe,f=Be,w=64,g=0}function Ye(ze,yt,Ot){Ot|=0;var Zt=0,Kt=0,Nt=0,Gt=0,xt=0,ge=0;return 63&(ze|=0)||~Ot&&31&Ot?-1:(ge=0|It(ze,yt|=0,-1),Zt=n,Kt=a,Nt=o,Gt=u,xt=f,zt(),Xe(Zt,Kt,Nt,Gt,xt,2147483648,0,0,0,0,0,0,0,0,0,672),~Ot&&$e(Ot),0|ge)}return{reset:rt,init:function Je(ze,yt,Ot,Zt,Kt,Nt,Gt){n=ze|=0,a=yt|=0,o=Ot|=0,u=Zt|=0,f=Kt|=0,w=Nt|=0,g=Gt|=0},process:dt,finish:It,hmac_reset:Ut,hmac_init:function pt(ze,yt,Ot,Zt,Kt,Nt,Gt,xt,ge,Ne,Oe,R,ye,qe,nt,it){ze|=0,yt|=0,Ot|=0,Zt|=0,Kt|=0,Nt|=0,Gt|=0,xt|=0,ge|=0,Ne|=0,Oe|=0,R|=0,ye|=0,qe|=0,nt|=0,it|=0,rt(),Xe(1549556828^ze,1549556828^yt,1549556828^Ot,1549556828^Zt,1549556828^Kt,1549556828^Nt,1549556828^Gt,1549556828^xt,1549556828^ge,1549556828^Ne,1549556828^Oe,1549556828^R,1549556828^ye,1549556828^qe,1549556828^nt,1549556828^it),pe=n,xe=a,Ke=o,Qe=u,Be=f,rt(),Xe(909522486^ze,909522486^yt,909522486^Ot,909522486^Zt,909522486^Kt,909522486^Nt,909522486^Gt,909522486^xt,909522486^ge,909522486^Ne,909522486^Oe,909522486^R,909522486^ye,909522486^qe,909522486^nt,909522486^it),b=n,L=a,$=o,j=u,se=f,w=64,g=0},hmac_finish:Ye,pbkdf2_generate_block:function rr(ze,yt,Ot,Zt,Kt){Zt|=0,Kt|=0;var Nt=0,Gt=0,xt=0,ge=0,Ne=0,Oe=0,R=0,ye=0,qe=0,nt=0;if(63&(ze|=0)||~Kt&&31&Kt)return-1;for(le[ze+(yt|=0)|0]=(Ot|=0)>>>24,le[ze+yt+1|0]=Ot>>>16&255,le[ze+yt+2|0]=Ot>>>8&255,le[ze+yt+3|0]=255&Ot,Ye(ze,yt+4|0,-1),Nt=Oe=n,Gt=R=a,xt=ye=o,ge=qe=u,Ne=nt=f,Zt=Zt-1|0;(0|Zt)>0;)Ut(),Xe(Oe,R,ye,qe,nt,2147483648,0,0,0,0,0,0,0,0,0,672),Oe=n,R=a,ye=o,qe=u,nt=f,zt(),Xe(Oe,R,ye,qe,nt,2147483648,0,0,0,0,0,0,0,0,0,672),Oe=n,R=a,ye=o,qe=u,nt=f,Nt^=n,Gt^=a,xt^=o,ge^=u,Ne^=f,Zt=Zt-1|0;return n=Nt,a=Gt,o=xt,u=ge,f=Ne,~Kt&&$e(Kt),0}}};class da{constructor(){this.pos=0,this.len=0}reset(){const{asm:t}=this.acquire_asm();return this.result=null,this.pos=0,this.len=0,t.reset(),this}process(t){if(null!==this.result)throw new $r("state must be reset before processing new data");const{asm:e,heap:n}=this.acquire_asm();let a=this.pos,o=this.len,u=0,f=t.length,w=0;for(;f>0;)w=Xt(n,a+o,t,u,f),o+=w,u+=w,f-=w,w=e.process(a,o),a+=w,o-=w,o||(a=0);return this.pos=a,this.len=o,this}finish(){if(null!==this.result)throw new $r("state must be reset before processing new data");const{asm:t,heap:e}=this.acquire_asm();return t.finish(this.pos,this.len,0),this.result=new Uint8Array(this.HASH_SIZE),this.result.set(e.subarray(0,this.HASH_SIZE)),this.pos=0,this.len=0,this.release_asm(),this}}const pa=[],ya=[];class Hn extends da{constructor(){super(),this.NAME="sha1",this.BLOCK_SIZE=64,this.HASH_SIZE=20,this.acquire_asm()}acquire_asm(){return void 0!==this.heap&&void 0!==this.asm||(this.heap=pa.pop()||_r(),this.asm=ya.pop()||ha({Uint8Array},0,this.heap.buffer),this.reset()),{heap:this.heap,asm:this.asm}}release_asm(){void 0!==this.heap&&void 0!==this.asm&&(pa.push(this.heap),ya.push(this.asm)),this.heap=void 0,this.asm=void 0}static bytes(t){return(new Hn).process(t).finish().result}}Hn.NAME="sha1",Hn.heap_pool=[],Hn.asm_pool=[],Hn.asm_function=ha;const ga=[],va=[];let fs=(()=>{class r extends da{constructor(){super(),this.NAME="sha256",this.BLOCK_SIZE=64,this.HASH_SIZE=32,this.acquire_asm()}acquire_asm(){return void 0!==this.heap&&void 0!==this.asm||(this.heap=ga.pop()||_r(),this.asm=va.pop()||function(e,n,a){var o=0,u=0,f=0,w=0,g=0,b=0,L=0,$=0,j=0,se=0,pe=0,xe=0,Ke=0,Qe=0,Be=0,le=0,Xe=0,He=0,$e=0,rt=0,Je=0,dt=0,It=0,Ut=0,zt=0,pt=0,Ye=new e.Uint8Array(a);function rr(R,ye,qe,nt,it,q,Q,te,oe,Ce,ve,Te,St,bt,At,Et){var Ee=0,we=0,Se=0,_e=0,ke=0,ae=0,ie=0,he=0;_e=(_e=w)+(he=(R|=0)+(he=$)+((ke=g)>>>6^ke>>>11^ke>>>25^ke<<26^ke<<21^ke<<7)+((ie=L)^ke&((ae=b)^ie))+1116352408|0)|0,he=he+((Ee=o)&(we=u)^(Se=f)&(Ee^we))+(Ee>>>2^Ee>>>13^Ee>>>22^Ee<<30^Ee<<19^Ee<<10)|0,Se=Se+(ie=(ye|=0)+ie+(_e>>>6^_e>>>11^_e>>>25^_e<<26^_e<<21^_e<<7)+(ae^_e&(ke^ae))+1899447441|0)|0,ie=ie+(he&Ee^we&(he^Ee))+(he>>>2^he>>>13^he>>>22^he<<30^he<<19^he<<10)|0,we=we+(ae=(qe|=0)+ae+(Se>>>6^Se>>>11^Se>>>25^Se<<26^Se<<21^Se<<7)+(ke^Se&(_e^ke))+3049323471|0)|0,ae=ae+(ie&he^Ee&(ie^he))+(ie>>>2^ie>>>13^ie>>>22^ie<<30^ie<<19^ie<<10)|0,Ee=Ee+(ke=(nt|=0)+ke+(we>>>6^we>>>11^we>>>25^we<<26^we<<21^we<<7)+(_e^we&(Se^_e))+3921009573|0)|0,ke=ke+(ae&ie^he&(ae^ie))+(ae>>>2^ae>>>13^ae>>>22^ae<<30^ae<<19^ae<<10)|0,he=he+(_e=(it|=0)+_e+(Ee>>>6^Ee>>>11^Ee>>>25^Ee<<26^Ee<<21^Ee<<7)+(Se^Ee&(we^Se))+961987163|0)|0,_e=_e+(ke&ae^ie&(ke^ae))+(ke>>>2^ke>>>13^ke>>>22^ke<<30^ke<<19^ke<<10)|0,ie=ie+(Se=(q|=0)+Se+(he>>>6^he>>>11^he>>>25^he<<26^he<<21^he<<7)+(we^he&(Ee^we))+1508970993|0)|0,Se=Se+(_e&ke^ae&(_e^ke))+(_e>>>2^_e>>>13^_e>>>22^_e<<30^_e<<19^_e<<10)|0,ae=ae+(we=(Q|=0)+we+(ie>>>6^ie>>>11^ie>>>25^ie<<26^ie<<21^ie<<7)+(Ee^ie&(he^Ee))+2453635748|0)|0,we=we+(Se&_e^ke&(Se^_e))+(Se>>>2^Se>>>13^Se>>>22^Se<<30^Se<<19^Se<<10)|0,ke=ke+(Ee=(te|=0)+Ee+(ae>>>6^ae>>>11^ae>>>25^ae<<26^ae<<21^ae<<7)+(he^ae&(ie^he))+2870763221|0)|0,Ee=Ee+(we&Se^_e&(we^Se))+(we>>>2^we>>>13^we>>>22^we<<30^we<<19^we<<10)|0,_e=_e+(he=(oe|=0)+he+(ke>>>6^ke>>>11^ke>>>25^ke<<26^ke<<21^ke<<7)+(ie^ke&(ae^ie))+3624381080|0)|0,he=he+(Ee&we^Se&(Ee^we))+(Ee>>>2^Ee>>>13^Ee>>>22^Ee<<30^Ee<<19^Ee<<10)|0,Se=Se+(ie=(Ce|=0)+ie+(_e>>>6^_e>>>11^_e>>>25^_e<<26^_e<<21^_e<<7)+(ae^_e&(ke^ae))+310598401|0)|0,ie=ie+(he&Ee^we&(he^Ee))+(he>>>2^he>>>13^he>>>22^he<<30^he<<19^he<<10)|0,we=we+(ae=(ve|=0)+ae+(Se>>>6^Se>>>11^Se>>>25^Se<<26^Se<<21^Se<<7)+(ke^Se&(_e^ke))+607225278|0)|0,ae=ae+(ie&he^Ee&(ie^he))+(ie>>>2^ie>>>13^ie>>>22^ie<<30^ie<<19^ie<<10)|0,Ee=Ee+(ke=(Te|=0)+ke+(we>>>6^we>>>11^we>>>25^we<<26^we<<21^we<<7)+(_e^we&(Se^_e))+1426881987|0)|0,ke=ke+(ae&ie^he&(ae^ie))+(ae>>>2^ae>>>13^ae>>>22^ae<<30^ae<<19^ae<<10)|0,he=he+(_e=(St|=0)+_e+(Ee>>>6^Ee>>>11^Ee>>>25^Ee<<26^Ee<<21^Ee<<7)+(Se^Ee&(we^Se))+1925078388|0)|0,_e=_e+(ke&ae^ie&(ke^ae))+(ke>>>2^ke>>>13^ke>>>22^ke<<30^ke<<19^ke<<10)|0,ie=ie+(Se=(bt|=0)+Se+(he>>>6^he>>>11^he>>>25^he<<26^he<<21^he<<7)+(we^he&(Ee^we))+2162078206|0)|0,Se=Se+(_e&ke^ae&(_e^ke))+(_e>>>2^_e>>>13^_e>>>22^_e<<30^_e<<19^_e<<10)|0,ae=ae+(we=(At|=0)+we+(ie>>>6^ie>>>11^ie>>>25^ie<<26^ie<<21^ie<<7)+(Ee^ie&(he^Ee))+2614888103|0)|0,we=we+(Se&_e^ke&(Se^_e))+(Se>>>2^Se>>>13^Se>>>22^Se<<30^Se<<19^Se<<10)|0,ke=ke+(Ee=(Et|=0)+Ee+(ae>>>6^ae>>>11^ae>>>25^ae<<26^ae<<21^ae<<7)+(he^ae&(ie^he))+3248222580|0)|0,Ee=Ee+(we&Se^_e&(we^Se))+(we>>>2^we>>>13^we>>>22^we<<30^we<<19^we<<10)|0,_e=_e+(he=(R=(ye>>>7^ye>>>18^ye>>>3^ye<<25^ye<<14)+(At>>>17^At>>>19^At>>>10^At<<15^At<<13)+R+Ce|0)+he+(ke>>>6^ke>>>11^ke>>>25^ke<<26^ke<<21^ke<<7)+(ie^ke&(ae^ie))+3835390401|0)|0,he=he+(Ee&we^Se&(Ee^we))+(Ee>>>2^Ee>>>13^Ee>>>22^Ee<<30^Ee<<19^Ee<<10)|0,Se=Se+(ie=(ye=(qe>>>7^qe>>>18^qe>>>3^qe<<25^qe<<14)+(Et>>>17^Et>>>19^Et>>>10^Et<<15^Et<<13)+ye+ve|0)+ie+(_e>>>6^_e>>>11^_e>>>25^_e<<26^_e<<21^_e<<7)+(ae^_e&(ke^ae))+4022224774|0)|0,ie=ie+(he&Ee^we&(he^Ee))+(he>>>2^he>>>13^he>>>22^he<<30^he<<19^he<<10)|0,we=we+(ae=(qe=(nt>>>7^nt>>>18^nt>>>3^nt<<25^nt<<14)+(R>>>17^R>>>19^R>>>10^R<<15^R<<13)+qe+Te|0)+ae+(Se>>>6^Se>>>11^Se>>>25^Se<<26^Se<<21^Se<<7)+(ke^Se&(_e^ke))+264347078|0)|0,ae=ae+(ie&he^Ee&(ie^he))+(ie>>>2^ie>>>13^ie>>>22^ie<<30^ie<<19^ie<<10)|0,Ee=Ee+(ke=(nt=(it>>>7^it>>>18^it>>>3^it<<25^it<<14)+(ye>>>17^ye>>>19^ye>>>10^ye<<15^ye<<13)+nt+St|0)+ke+(we>>>6^we>>>11^we>>>25^we<<26^we<<21^we<<7)+(_e^we&(Se^_e))+604807628|0)|0,ke=ke+(ae&ie^he&(ae^ie))+(ae>>>2^ae>>>13^ae>>>22^ae<<30^ae<<19^ae<<10)|0,he=he+(_e=(it=(q>>>7^q>>>18^q>>>3^q<<25^q<<14)+(qe>>>17^qe>>>19^qe>>>10^qe<<15^qe<<13)+it+bt|0)+_e+(Ee>>>6^Ee>>>11^Ee>>>25^Ee<<26^Ee<<21^Ee<<7)+(Se^Ee&(we^Se))+770255983|0)|0,_e=_e+(ke&ae^ie&(ke^ae))+(ke>>>2^ke>>>13^ke>>>22^ke<<30^ke<<19^ke<<10)|0,ie=ie+(Se=(q=(Q>>>7^Q>>>18^Q>>>3^Q<<25^Q<<14)+(nt>>>17^nt>>>19^nt>>>10^nt<<15^nt<<13)+q+At|0)+Se+(he>>>6^he>>>11^he>>>25^he<<26^he<<21^he<<7)+(we^he&(Ee^we))+1249150122|0)|0,Se=Se+(_e&ke^ae&(_e^ke))+(_e>>>2^_e>>>13^_e>>>22^_e<<30^_e<<19^_e<<10)|0,ae=ae+(we=(Q=(te>>>7^te>>>18^te>>>3^te<<25^te<<14)+(it>>>17^it>>>19^it>>>10^it<<15^it<<13)+Q+Et|0)+we+(ie>>>6^ie>>>11^ie>>>25^ie<<26^ie<<21^ie<<7)+(Ee^ie&(he^Ee))+1555081692|0)|0,we=we+(Se&_e^ke&(Se^_e))+(Se>>>2^Se>>>13^Se>>>22^Se<<30^Se<<19^Se<<10)|0,ke=ke+(Ee=(te=(oe>>>7^oe>>>18^oe>>>3^oe<<25^oe<<14)+(q>>>17^q>>>19^q>>>10^q<<15^q<<13)+te+R|0)+Ee+(ae>>>6^ae>>>11^ae>>>25^ae<<26^ae<<21^ae<<7)+(he^ae&(ie^he))+1996064986|0)|0,Ee=Ee+(we&Se^_e&(we^Se))+(we>>>2^we>>>13^we>>>22^we<<30^we<<19^we<<10)|0,_e=_e+(he=(oe=(Ce>>>7^Ce>>>18^Ce>>>3^Ce<<25^Ce<<14)+(Q>>>17^Q>>>19^Q>>>10^Q<<15^Q<<13)+oe+ye|0)+he+(ke>>>6^ke>>>11^ke>>>25^ke<<26^ke<<21^ke<<7)+(ie^ke&(ae^ie))+2554220882|0)|0,he=he+(Ee&we^Se&(Ee^we))+(Ee>>>2^Ee>>>13^Ee>>>22^Ee<<30^Ee<<19^Ee<<10)|0,Se=Se+(ie=(Ce=(ve>>>7^ve>>>18^ve>>>3^ve<<25^ve<<14)+(te>>>17^te>>>19^te>>>10^te<<15^te<<13)+Ce+qe|0)+ie+(_e>>>6^_e>>>11^_e>>>25^_e<<26^_e<<21^_e<<7)+(ae^_e&(ke^ae))+2821834349|0)|0,ie=ie+(he&Ee^we&(he^Ee))+(he>>>2^he>>>13^he>>>22^he<<30^he<<19^he<<10)|0,we=we+(ae=(ve=(Te>>>7^Te>>>18^Te>>>3^Te<<25^Te<<14)+(oe>>>17^oe>>>19^oe>>>10^oe<<15^oe<<13)+ve+nt|0)+ae+(Se>>>6^Se>>>11^Se>>>25^Se<<26^Se<<21^Se<<7)+(ke^Se&(_e^ke))+2952996808|0)|0,ae=ae+(ie&he^Ee&(ie^he))+(ie>>>2^ie>>>13^ie>>>22^ie<<30^ie<<19^ie<<10)|0,Ee=Ee+(ke=(Te=(St>>>7^St>>>18^St>>>3^St<<25^St<<14)+(Ce>>>17^Ce>>>19^Ce>>>10^Ce<<15^Ce<<13)+Te+it|0)+ke+(we>>>6^we>>>11^we>>>25^we<<26^we<<21^we<<7)+(_e^we&(Se^_e))+3210313671|0)|0,ke=ke+(ae&ie^he&(ae^ie))+(ae>>>2^ae>>>13^ae>>>22^ae<<30^ae<<19^ae<<10)|0,he=he+(_e=(St=(bt>>>7^bt>>>18^bt>>>3^bt<<25^bt<<14)+(ve>>>17^ve>>>19^ve>>>10^ve<<15^ve<<13)+St+q|0)+_e+(Ee>>>6^Ee>>>11^Ee>>>25^Ee<<26^Ee<<21^Ee<<7)+(Se^Ee&(we^Se))+3336571891|0)|0,_e=_e+(ke&ae^ie&(ke^ae))+(ke>>>2^ke>>>13^ke>>>22^ke<<30^ke<<19^ke<<10)|0,ie=ie+(Se=(bt=(At>>>7^At>>>18^At>>>3^At<<25^At<<14)+(Te>>>17^Te>>>19^Te>>>10^Te<<15^Te<<13)+bt+Q|0)+Se+(he>>>6^he>>>11^he>>>25^he<<26^he<<21^he<<7)+(we^he&(Ee^we))+3584528711|0)|0,Se=Se+(_e&ke^ae&(_e^ke))+(_e>>>2^_e>>>13^_e>>>22^_e<<30^_e<<19^_e<<10)|0,ae=ae+(we=(At=(Et>>>7^Et>>>18^Et>>>3^Et<<25^Et<<14)+(St>>>17^St>>>19^St>>>10^St<<15^St<<13)+At+te|0)+we+(ie>>>6^ie>>>11^ie>>>25^ie<<26^ie<<21^ie<<7)+(Ee^ie&(he^Ee))+113926993|0)|0,we=we+(Se&_e^ke&(Se^_e))+(Se>>>2^Se>>>13^Se>>>22^Se<<30^Se<<19^Se<<10)|0,ke=ke+(Ee=(Et=(R>>>7^R>>>18^R>>>3^R<<25^R<<14)+(bt>>>17^bt>>>19^bt>>>10^bt<<15^bt<<13)+Et+oe|0)+Ee+(ae>>>6^ae>>>11^ae>>>25^ae<<26^ae<<21^ae<<7)+(he^ae&(ie^he))+338241895|0)|0,Ee=Ee+(we&Se^_e&(we^Se))+(we>>>2^we>>>13^we>>>22^we<<30^we<<19^we<<10)|0,_e=_e+(he=(R=(ye>>>7^ye>>>18^ye>>>3^ye<<25^ye<<14)+(At>>>17^At>>>19^At>>>10^At<<15^At<<13)+R+Ce|0)+he+(ke>>>6^ke>>>11^ke>>>25^ke<<26^ke<<21^ke<<7)+(ie^ke&(ae^ie))+666307205|0)|0,he=he+(Ee&we^Se&(Ee^we))+(Ee>>>2^Ee>>>13^Ee>>>22^Ee<<30^Ee<<19^Ee<<10)|0,Se=Se+(ie=(ye=(qe>>>7^qe>>>18^qe>>>3^qe<<25^qe<<14)+(Et>>>17^Et>>>19^Et>>>10^Et<<15^Et<<13)+ye+ve|0)+ie+(_e>>>6^_e>>>11^_e>>>25^_e<<26^_e<<21^_e<<7)+(ae^_e&(ke^ae))+773529912|0)|0,ie=ie+(he&Ee^we&(he^Ee))+(he>>>2^he>>>13^he>>>22^he<<30^he<<19^he<<10)|0,we=we+(ae=(qe=(nt>>>7^nt>>>18^nt>>>3^nt<<25^nt<<14)+(R>>>17^R>>>19^R>>>10^R<<15^R<<13)+qe+Te|0)+ae+(Se>>>6^Se>>>11^Se>>>25^Se<<26^Se<<21^Se<<7)+(ke^Se&(_e^ke))+1294757372|0)|0,ae=ae+(ie&he^Ee&(ie^he))+(ie>>>2^ie>>>13^ie>>>22^ie<<30^ie<<19^ie<<10)|0,Ee=Ee+(ke=(nt=(it>>>7^it>>>18^it>>>3^it<<25^it<<14)+(ye>>>17^ye>>>19^ye>>>10^ye<<15^ye<<13)+nt+St|0)+ke+(we>>>6^we>>>11^we>>>25^we<<26^we<<21^we<<7)+(_e^we&(Se^_e))+1396182291|0)|0,ke=ke+(ae&ie^he&(ae^ie))+(ae>>>2^ae>>>13^ae>>>22^ae<<30^ae<<19^ae<<10)|0,he=he+(_e=(it=(q>>>7^q>>>18^q>>>3^q<<25^q<<14)+(qe>>>17^qe>>>19^qe>>>10^qe<<15^qe<<13)+it+bt|0)+_e+(Ee>>>6^Ee>>>11^Ee>>>25^Ee<<26^Ee<<21^Ee<<7)+(Se^Ee&(we^Se))+1695183700|0)|0,_e=_e+(ke&ae^ie&(ke^ae))+(ke>>>2^ke>>>13^ke>>>22^ke<<30^ke<<19^ke<<10)|0,ie=ie+(Se=(q=(Q>>>7^Q>>>18^Q>>>3^Q<<25^Q<<14)+(nt>>>17^nt>>>19^nt>>>10^nt<<15^nt<<13)+q+At|0)+Se+(he>>>6^he>>>11^he>>>25^he<<26^he<<21^he<<7)+(we^he&(Ee^we))+1986661051|0)|0,Se=Se+(_e&ke^ae&(_e^ke))+(_e>>>2^_e>>>13^_e>>>22^_e<<30^_e<<19^_e<<10)|0,ae=ae+(we=(Q=(te>>>7^te>>>18^te>>>3^te<<25^te<<14)+(it>>>17^it>>>19^it>>>10^it<<15^it<<13)+Q+Et|0)+we+(ie>>>6^ie>>>11^ie>>>25^ie<<26^ie<<21^ie<<7)+(Ee^ie&(he^Ee))+2177026350|0)|0,we=we+(Se&_e^ke&(Se^_e))+(Se>>>2^Se>>>13^Se>>>22^Se<<30^Se<<19^Se<<10)|0,ke=ke+(Ee=(te=(oe>>>7^oe>>>18^oe>>>3^oe<<25^oe<<14)+(q>>>17^q>>>19^q>>>10^q<<15^q<<13)+te+R|0)+Ee+(ae>>>6^ae>>>11^ae>>>25^ae<<26^ae<<21^ae<<7)+(he^ae&(ie^he))+2456956037|0)|0,Ee=Ee+(we&Se^_e&(we^Se))+(we>>>2^we>>>13^we>>>22^we<<30^we<<19^we<<10)|0,_e=_e+(he=(oe=(Ce>>>7^Ce>>>18^Ce>>>3^Ce<<25^Ce<<14)+(Q>>>17^Q>>>19^Q>>>10^Q<<15^Q<<13)+oe+ye|0)+he+(ke>>>6^ke>>>11^ke>>>25^ke<<26^ke<<21^ke<<7)+(ie^ke&(ae^ie))+2730485921|0)|0,he=he+(Ee&we^Se&(Ee^we))+(Ee>>>2^Ee>>>13^Ee>>>22^Ee<<30^Ee<<19^Ee<<10)|0,Se=Se+(ie=(Ce=(ve>>>7^ve>>>18^ve>>>3^ve<<25^ve<<14)+(te>>>17^te>>>19^te>>>10^te<<15^te<<13)+Ce+qe|0)+ie+(_e>>>6^_e>>>11^_e>>>25^_e<<26^_e<<21^_e<<7)+(ae^_e&(ke^ae))+2820302411|0)|0,ie=ie+(he&Ee^we&(he^Ee))+(he>>>2^he>>>13^he>>>22^he<<30^he<<19^he<<10)|0,we=we+(ae=(ve=(Te>>>7^Te>>>18^Te>>>3^Te<<25^Te<<14)+(oe>>>17^oe>>>19^oe>>>10^oe<<15^oe<<13)+ve+nt|0)+ae+(Se>>>6^Se>>>11^Se>>>25^Se<<26^Se<<21^Se<<7)+(ke^Se&(_e^ke))+3259730800|0)|0,ae=ae+(ie&he^Ee&(ie^he))+(ie>>>2^ie>>>13^ie>>>22^ie<<30^ie<<19^ie<<10)|0,Ee=Ee+(ke=(Te=(St>>>7^St>>>18^St>>>3^St<<25^St<<14)+(Ce>>>17^Ce>>>19^Ce>>>10^Ce<<15^Ce<<13)+Te+it|0)+ke+(we>>>6^we>>>11^we>>>25^we<<26^we<<21^we<<7)+(_e^we&(Se^_e))+3345764771|0)|0,ke=ke+(ae&ie^he&(ae^ie))+(ae>>>2^ae>>>13^ae>>>22^ae<<30^ae<<19^ae<<10)|0,he=he+(_e=(St=(bt>>>7^bt>>>18^bt>>>3^bt<<25^bt<<14)+(ve>>>17^ve>>>19^ve>>>10^ve<<15^ve<<13)+St+q|0)+_e+(Ee>>>6^Ee>>>11^Ee>>>25^Ee<<26^Ee<<21^Ee<<7)+(Se^Ee&(we^Se))+3516065817|0)|0,_e=_e+(ke&ae^ie&(ke^ae))+(ke>>>2^ke>>>13^ke>>>22^ke<<30^ke<<19^ke<<10)|0,ie=ie+(Se=(bt=(At>>>7^At>>>18^At>>>3^At<<25^At<<14)+(Te>>>17^Te>>>19^Te>>>10^Te<<15^Te<<13)+bt+Q|0)+Se+(he>>>6^he>>>11^he>>>25^he<<26^he<<21^he<<7)+(we^he&(Ee^we))+3600352804|0)|0,Se=Se+(_e&ke^ae&(_e^ke))+(_e>>>2^_e>>>13^_e>>>22^_e<<30^_e<<19^_e<<10)|0,ae=ae+(we=(At=(Et>>>7^Et>>>18^Et>>>3^Et<<25^Et<<14)+(St>>>17^St>>>19^St>>>10^St<<15^St<<13)+At+te|0)+we+(ie>>>6^ie>>>11^ie>>>25^ie<<26^ie<<21^ie<<7)+(Ee^ie&(he^Ee))+4094571909|0)|0,we=we+(Se&_e^ke&(Se^_e))+(Se>>>2^Se>>>13^Se>>>22^Se<<30^Se<<19^Se<<10)|0,ke=ke+(Ee=(Et=(R>>>7^R>>>18^R>>>3^R<<25^R<<14)+(bt>>>17^bt>>>19^bt>>>10^bt<<15^bt<<13)+Et+oe|0)+Ee+(ae>>>6^ae>>>11^ae>>>25^ae<<26^ae<<21^ae<<7)+(he^ae&(ie^he))+275423344|0)|0,Ee=Ee+(we&Se^_e&(we^Se))+(we>>>2^we>>>13^we>>>22^we<<30^we<<19^we<<10)|0,_e=_e+(he=(R=(ye>>>7^ye>>>18^ye>>>3^ye<<25^ye<<14)+(At>>>17^At>>>19^At>>>10^At<<15^At<<13)+R+Ce|0)+he+(ke>>>6^ke>>>11^ke>>>25^ke<<26^ke<<21^ke<<7)+(ie^ke&(ae^ie))+430227734|0)|0,he=he+(Ee&we^Se&(Ee^we))+(Ee>>>2^Ee>>>13^Ee>>>22^Ee<<30^Ee<<19^Ee<<10)|0,Se=Se+(ie=(ye=(qe>>>7^qe>>>18^qe>>>3^qe<<25^qe<<14)+(Et>>>17^Et>>>19^Et>>>10^Et<<15^Et<<13)+ye+ve|0)+ie+(_e>>>6^_e>>>11^_e>>>25^_e<<26^_e<<21^_e<<7)+(ae^_e&(ke^ae))+506948616|0)|0,ie=ie+(he&Ee^we&(he^Ee))+(he>>>2^he>>>13^he>>>22^he<<30^he<<19^he<<10)|0,we=we+(ae=(qe=(nt>>>7^nt>>>18^nt>>>3^nt<<25^nt<<14)+(R>>>17^R>>>19^R>>>10^R<<15^R<<13)+qe+Te|0)+ae+(Se>>>6^Se>>>11^Se>>>25^Se<<26^Se<<21^Se<<7)+(ke^Se&(_e^ke))+659060556|0)|0,ae=ae+(ie&he^Ee&(ie^he))+(ie>>>2^ie>>>13^ie>>>22^ie<<30^ie<<19^ie<<10)|0,Ee=Ee+(ke=(nt=(it>>>7^it>>>18^it>>>3^it<<25^it<<14)+(ye>>>17^ye>>>19^ye>>>10^ye<<15^ye<<13)+nt+St|0)+ke+(we>>>6^we>>>11^we>>>25^we<<26^we<<21^we<<7)+(_e^we&(Se^_e))+883997877|0)|0,ke=ke+(ae&ie^he&(ae^ie))+(ae>>>2^ae>>>13^ae>>>22^ae<<30^ae<<19^ae<<10)|0,he=he+(_e=(it=(q>>>7^q>>>18^q>>>3^q<<25^q<<14)+(qe>>>17^qe>>>19^qe>>>10^qe<<15^qe<<13)+it+bt|0)+_e+(Ee>>>6^Ee>>>11^Ee>>>25^Ee<<26^Ee<<21^Ee<<7)+(Se^Ee&(we^Se))+958139571|0)|0,_e=_e+(ke&ae^ie&(ke^ae))+(ke>>>2^ke>>>13^ke>>>22^ke<<30^ke<<19^ke<<10)|0,ie=ie+(Se=(q=(Q>>>7^Q>>>18^Q>>>3^Q<<25^Q<<14)+(nt>>>17^nt>>>19^nt>>>10^nt<<15^nt<<13)+q+At|0)+Se+(he>>>6^he>>>11^he>>>25^he<<26^he<<21^he<<7)+(we^he&(Ee^we))+1322822218|0)|0,Se=Se+(_e&ke^ae&(_e^ke))+(_e>>>2^_e>>>13^_e>>>22^_e<<30^_e<<19^_e<<10)|0,ae=ae+(we=(Q=(te>>>7^te>>>18^te>>>3^te<<25^te<<14)+(it>>>17^it>>>19^it>>>10^it<<15^it<<13)+Q+Et|0)+we+(ie>>>6^ie>>>11^ie>>>25^ie<<26^ie<<21^ie<<7)+(Ee^ie&(he^Ee))+1537002063|0)|0,we=we+(Se&_e^ke&(Se^_e))+(Se>>>2^Se>>>13^Se>>>22^Se<<30^Se<<19^Se<<10)|0,ke=ke+(Ee=(te=(oe>>>7^oe>>>18^oe>>>3^oe<<25^oe<<14)+(q>>>17^q>>>19^q>>>10^q<<15^q<<13)+te+R|0)+Ee+(ae>>>6^ae>>>11^ae>>>25^ae<<26^ae<<21^ae<<7)+(he^ae&(ie^he))+1747873779|0)|0,Ee=Ee+(we&Se^_e&(we^Se))+(we>>>2^we>>>13^we>>>22^we<<30^we<<19^we<<10)|0,_e=_e+(he=(oe=(Ce>>>7^Ce>>>18^Ce>>>3^Ce<<25^Ce<<14)+(Q>>>17^Q>>>19^Q>>>10^Q<<15^Q<<13)+oe+ye|0)+he+(ke>>>6^ke>>>11^ke>>>25^ke<<26^ke<<21^ke<<7)+(ie^ke&(ae^ie))+1955562222|0)|0,he=he+(Ee&we^Se&(Ee^we))+(Ee>>>2^Ee>>>13^Ee>>>22^Ee<<30^Ee<<19^Ee<<10)|0,Se=Se+(ie=(Ce=(ve>>>7^ve>>>18^ve>>>3^ve<<25^ve<<14)+(te>>>17^te>>>19^te>>>10^te<<15^te<<13)+Ce+qe|0)+ie+(_e>>>6^_e>>>11^_e>>>25^_e<<26^_e<<21^_e<<7)+(ae^_e&(ke^ae))+2024104815|0)|0,ie=ie+(he&Ee^we&(he^Ee))+(he>>>2^he>>>13^he>>>22^he<<30^he<<19^he<<10)|0,we=we+(ae=(ve=(Te>>>7^Te>>>18^Te>>>3^Te<<25^Te<<14)+(oe>>>17^oe>>>19^oe>>>10^oe<<15^oe<<13)+ve+nt|0)+ae+(Se>>>6^Se>>>11^Se>>>25^Se<<26^Se<<21^Se<<7)+(ke^Se&(_e^ke))+2227730452|0)|0,ae=ae+(ie&he^Ee&(ie^he))+(ie>>>2^ie>>>13^ie>>>22^ie<<30^ie<<19^ie<<10)|0,Ee=Ee+(ke=(Te=(St>>>7^St>>>18^St>>>3^St<<25^St<<14)+(Ce>>>17^Ce>>>19^Ce>>>10^Ce<<15^Ce<<13)+Te+it|0)+ke+(we>>>6^we>>>11^we>>>25^we<<26^we<<21^we<<7)+(_e^we&(Se^_e))+2361852424|0)|0,ke=ke+(ae&ie^he&(ae^ie))+(ae>>>2^ae>>>13^ae>>>22^ae<<30^ae<<19^ae<<10)|0,he=he+(_e=(St=(bt>>>7^bt>>>18^bt>>>3^bt<<25^bt<<14)+(ve>>>17^ve>>>19^ve>>>10^ve<<15^ve<<13)+St+q|0)+_e+(Ee>>>6^Ee>>>11^Ee>>>25^Ee<<26^Ee<<21^Ee<<7)+(Se^Ee&(we^Se))+2428436474|0)|0,_e=_e+(ke&ae^ie&(ke^ae))+(ke>>>2^ke>>>13^ke>>>22^ke<<30^ke<<19^ke<<10)|0,ie=ie+(Se=(bt=(At>>>7^At>>>18^At>>>3^At<<25^At<<14)+(Te>>>17^Te>>>19^Te>>>10^Te<<15^Te<<13)+bt+Q|0)+Se+(he>>>6^he>>>11^he>>>25^he<<26^he<<21^he<<7)+(we^he&(Ee^we))+2756734187|0)|0,Se=Se+(_e&ke^ae&(_e^ke))+(_e>>>2^_e>>>13^_e>>>22^_e<<30^_e<<19^_e<<10)|0,ae=ae+(we=(At=(Et>>>7^Et>>>18^Et>>>3^Et<<25^Et<<14)+(St>>>17^St>>>19^St>>>10^St<<15^St<<13)+At+te|0)+we+(ie>>>6^ie>>>11^ie>>>25^ie<<26^ie<<21^ie<<7)+(Ee^ie&(he^Ee))+3204031479|0)|0,we=we+(Se&_e^ke&(Se^_e))+(Se>>>2^Se>>>13^Se>>>22^Se<<30^Se<<19^Se<<10)|0,ke=ke+(Ee=(Et=(R>>>7^R>>>18^R>>>3^R<<25^R<<14)+(bt>>>17^bt>>>19^bt>>>10^bt<<15^bt<<13)+Et+oe|0)+Ee+(ae>>>6^ae>>>11^ae>>>25^ae<<26^ae<<21^ae<<7)+(he^ae&(ie^he))+3329325298|0)|0,o=o+(Ee=Ee+(we&Se^_e&(we^Se))+(we>>>2^we>>>13^we>>>22^we<<30^we<<19^we<<10)|0)|0,u=u+we|0,f=f+Se|0,w=w+_e|0,g=g+ke|0,b=b+ae|0,L=L+ie|0,$=$+he|0}function ze(R){rr(Ye[0|(R|=0)]<<24|Ye[1|R]<<16|Ye[2|R]<<8|Ye[3|R],Ye[4|R]<<24|Ye[5|R]<<16|Ye[6|R]<<8|Ye[7|R],Ye[8|R]<<24|Ye[9|R]<<16|Ye[10|R]<<8|Ye[11|R],Ye[12|R]<<24|Ye[13|R]<<16|Ye[14|R]<<8|Ye[15|R],Ye[16|R]<<24|Ye[17|R]<<16|Ye[18|R]<<8|Ye[19|R],Ye[20|R]<<24|Ye[21|R]<<16|Ye[22|R]<<8|Ye[23|R],Ye[24|R]<<24|Ye[25|R]<<16|Ye[26|R]<<8|Ye[27|R],Ye[28|R]<<24|Ye[29|R]<<16|Ye[30|R]<<8|Ye[31|R],Ye[32|R]<<24|Ye[33|R]<<16|Ye[34|R]<<8|Ye[35|R],Ye[36|R]<<24|Ye[37|R]<<16|Ye[38|R]<<8|Ye[39|R],Ye[40|R]<<24|Ye[41|R]<<16|Ye[42|R]<<8|Ye[43|R],Ye[44|R]<<24|Ye[45|R]<<16|Ye[46|R]<<8|Ye[47|R],Ye[48|R]<<24|Ye[49|R]<<16|Ye[50|R]<<8|Ye[51|R],Ye[52|R]<<24|Ye[53|R]<<16|Ye[54|R]<<8|Ye[55|R],Ye[56|R]<<24|Ye[57|R]<<16|Ye[58|R]<<8|Ye[59|R],Ye[60|R]<<24|Ye[61|R]<<16|Ye[62|R]<<8|Ye[63|R])}function yt(R){Ye[0|(R|=0)]=o>>>24,Ye[1|R]=o>>>16&255,Ye[2|R]=o>>>8&255,Ye[3|R]=255&o,Ye[4|R]=u>>>24,Ye[5|R]=u>>>16&255,Ye[6|R]=u>>>8&255,Ye[7|R]=255&u,Ye[8|R]=f>>>24,Ye[9|R]=f>>>16&255,Ye[10|R]=f>>>8&255,Ye[11|R]=255&f,Ye[12|R]=w>>>24,Ye[13|R]=w>>>16&255,Ye[14|R]=w>>>8&255,Ye[15|R]=255&w,Ye[16|R]=g>>>24,Ye[17|R]=g>>>16&255,Ye[18|R]=g>>>8&255,Ye[19|R]=255&g,Ye[20|R]=b>>>24,Ye[21|R]=b>>>16&255,Ye[22|R]=b>>>8&255,Ye[23|R]=255&b,Ye[24|R]=L>>>24,Ye[25|R]=L>>>16&255,Ye[26|R]=L>>>8&255,Ye[27|R]=255&L,Ye[28|R]=$>>>24,Ye[29|R]=$>>>16&255,Ye[30|R]=$>>>8&255,Ye[31|R]=255&$}function Ot(){o=1779033703,u=3144134277,f=1013904242,w=2773480762,g=1359893119,b=2600822924,L=528734635,$=1541459225,j=se=0}function Kt(R,ye){ye|=0;var qe=0;if(63&(R|=0))return-1;for(;(0|ye)>=64;)ze(R),R=R+64|0,ye=ye-64|0,qe=qe+64|0;return(j=j+qe|0)>>>0<qe>>>0&&(se=se+1|0),0|qe}function Nt(R,ye,qe){qe|=0;var nt=0,it=0;if(63&(R|=0)||~qe&&31&qe)return-1;if((0|(ye|=0))>=64){if(-1==(0|(nt=0|Kt(R,ye))))return-1;R=R+nt|0,ye=ye-nt|0}if(nt=nt+ye|0,(j=j+ye|0)>>>0<ye>>>0&&(se=se+1|0),Ye[R|ye]=128,(0|ye)>=56){for(it=ye+1|0;(0|it)<64;it=it+1|0)Ye[R|it]=0;ze(R),ye=0,Ye[0|R]=0}for(it=ye+1|0;(0|it)<59;it=it+1|0)Ye[R|it]=0;return Ye[56|R]=se>>>21&255,Ye[57|R]=se>>>13&255,Ye[58|R]=se>>>5&255,Ye[59|R]=se<<3&255|j>>>29,Ye[60|R]=j>>>21&255,Ye[61|R]=j>>>13&255,Ye[62|R]=j>>>5&255,Ye[63|R]=j<<3&255,ze(R),~qe&&yt(qe),0|nt}function Gt(){o=pe,u=xe,f=Ke,w=Qe,g=Be,b=le,L=Xe,$=He,j=64,se=0}function xt(){o=$e,u=rt,f=Je,w=dt,g=It,b=Ut,L=zt,$=pt,j=64,se=0}function Ne(R,ye,qe){qe|=0;var nt=0,it=0,q=0,Q=0,te=0,oe=0,Ce=0,ve=0,Te=0;return 63&(R|=0)||~qe&&31&qe?-1:(Te=0|Nt(R,ye|=0,-1),nt=o,it=u,q=f,Q=w,te=g,oe=b,Ce=L,ve=$,xt(),rr(nt,it,q,Q,te,oe,Ce,ve,2147483648,0,0,0,0,0,0,768),~qe&&yt(qe),0|Te)}return{reset:Ot,init:function Zt(R,ye,qe,nt,it,q,Q,te,oe,Ce){o=R|=0,u=ye|=0,f=qe|=0,w=nt|=0,g=it|=0,b=q|=0,L=Q|=0,$=te|=0,j=oe|=0,se=Ce|=0},process:Kt,finish:Nt,hmac_reset:Gt,hmac_init:function ge(R,ye,qe,nt,it,q,Q,te,oe,Ce,ve,Te,St,bt,At,Et){R|=0,ye|=0,qe|=0,nt|=0,it|=0,q|=0,Q|=0,te|=0,oe|=0,Ce|=0,ve|=0,Te|=0,St|=0,bt|=0,At|=0,Et|=0,Ot(),rr(1549556828^R,1549556828^ye,1549556828^qe,1549556828^nt,1549556828^it,1549556828^q,1549556828^Q,1549556828^te,1549556828^oe,1549556828^Ce,1549556828^ve,1549556828^Te,1549556828^St,1549556828^bt,1549556828^At,1549556828^Et),$e=o,rt=u,Je=f,dt=w,It=g,Ut=b,zt=L,pt=$,Ot(),rr(909522486^R,909522486^ye,909522486^qe,909522486^nt,909522486^it,909522486^q,909522486^Q,909522486^te,909522486^oe,909522486^Ce,909522486^ve,909522486^Te,909522486^St,909522486^bt,909522486^At,909522486^Et),pe=o,xe=u,Ke=f,Qe=w,Be=g,le=b,Xe=L,He=$,j=64,se=0},hmac_finish:Ne,pbkdf2_generate_block:function Oe(R,ye,qe,nt,it){nt|=0,it|=0;var q=0,Q=0,te=0,oe=0,Ce=0,ve=0,Te=0,St=0,bt=0,At=0,Et=0,Ee=0,we=0,Se=0,_e=0,ke=0;if(63&(R|=0)||~it&&31&it)return-1;for(Ye[R+(ye|=0)|0]=(qe|=0)>>>24,Ye[R+ye+1|0]=qe>>>16&255,Ye[R+ye+2|0]=qe>>>8&255,Ye[R+ye+3|0]=255&qe,Ne(R,ye+4|0,-1),q=bt=o,Q=At=u,te=Et=f,oe=Ee=w,Ce=we=g,ve=Se=b,Te=_e=L,St=ke=$,nt=nt-1|0;(0|nt)>0;)Gt(),rr(bt,At,Et,Ee,we,Se,_e,ke,2147483648,0,0,0,0,0,0,768),bt=o,At=u,Et=f,Ee=w,we=g,Se=b,_e=L,ke=$,xt(),rr(bt,At,Et,Ee,we,Se,_e,ke,2147483648,0,0,0,0,0,0,768),bt=o,At=u,Et=f,Ee=w,we=g,Se=b,_e=L,ke=$,q^=o,Q^=u,te^=f,oe^=w,Ce^=g,ve^=b,Te^=L,St^=$,nt=nt-1|0;return o=q,u=Q,f=te,w=oe,g=Ce,b=ve,L=Te,$=St,~it&&yt(it),0}}}({Uint8Array},0,this.heap.buffer),this.reset()),{heap:this.heap,asm:this.asm}}release_asm(){void 0!==this.heap&&void 0!==this.asm&&(ga.push(this.heap),va.push(this.asm)),this.heap=void 0,this.asm=void 0}static bytes(e){return(new r).process(e).finish().result}}return r.NAME="sha256",r})();var oi=un;function un(r,t){if(!r)throw Error(t||"Assertion failed")}un.equal=function(r,t,e){if(r!=t)throw Error(e||"Assertion failed: "+r+" != "+t)};var hs=void 0!==i?i:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function gi(r,t){return r(t={exports:{}},t.exports),t.exports}var ma=gi(function(r){r.exports="function"==typeof Object.create?function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:function(t,e){t.super_=e;var n=function(){};n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t}});function xa(r){return(r>>>24|r>>>8&65280|r<<8&16711680|(255&r)<<24)>>>0}function re(r){return 1===r.length?"0"+r:r}function ce(r){return 7===r.length?"0"+r:6===r.length?"00"+r:5===r.length?"000"+r:4===r.length?"0000"+r:3===r.length?"00000"+r:2===r.length?"000000"+r:1===r.length?"0000000"+r:r}var fe={inherits:ma,toArray:function(r,t){if(Array.isArray(r))return r.slice();if(!r)return[];var e=[];if("string"==typeof r)if(t){if("hex"===t)for((r=r.replace(/[^a-z0-9]+/gi,"")).length%2!=0&&(r="0"+r),n=0;n<r.length;n+=2)e.push(parseInt(r[n]+r[n+1],16))}else for(var n=0;n<r.length;n++){var a=r.charCodeAt(n),o=a>>8,u=255&a;o?e.push(o,u):e.push(u)}else for(n=0;n<r.length;n++)e[n]=0|r[n];return e},toHex:function(r){for(var t="",e=0;e<r.length;e++)t+=re(r[e].toString(16));return t},htonl:xa,toHex32:function(r,t){for(var e="",n=0;n<r.length;n++){var a=r[n];"little"===t&&(a=xa(a)),e+=ce(a.toString(16))}return e},zero2:re,zero8:ce,join32:function(r,t,e,n){var a=e-t;oi(a%4==0);for(var o=Array(a/4),u=0,f=t;u<o.length;u++,f+=4)o[u]=("big"===n?r[f]<<24|r[f+1]<<16|r[f+2]<<8|r[f+3]:r[f+3]<<24|r[f+2]<<16|r[f+1]<<8|r[f])>>>0;return o},split32:function(r,t){for(var e=Array(4*r.length),n=0,a=0;n<r.length;n++,a+=4){var o=r[n];"big"===t?(e[a]=o>>>24,e[a+1]=o>>>16&255,e[a+2]=o>>>8&255,e[a+3]=255&o):(e[a+3]=o>>>24,e[a+2]=o>>>16&255,e[a+1]=o>>>8&255,e[a]=255&o)}return e},rotr32:function(r,t){return r>>>t|r<<32-t},rotl32:function(r,t){return r<<t|r>>>32-t},sum32:function(r,t){return r+t>>>0},sum32_3:function(r,t,e){return r+t+e>>>0},sum32_4:function(r,t,e,n){return r+t+e+n>>>0},sum32_5:function(r,t,e,n,a){return r+t+e+n+a>>>0},sum64:function(r,t,e,n){var o=n+r[t+1]>>>0;r[t]=(o<n?1:0)+e+r[t]>>>0,r[t+1]=o},sum64_hi:function(r,t,e,n){return(t+n>>>0<t?1:0)+r+e>>>0},sum64_lo:function(r,t,e,n){return t+n>>>0},sum64_4_hi:function(r,t,e,n,a,o,u,f){var w=0,g=t;return w+=(g=g+n>>>0)<t?1:0,w+=(g=g+o>>>0)<o?1:0,r+e+a+u+(w+=(g=g+f>>>0)<f?1:0)>>>0},sum64_4_lo:function(r,t,e,n,a,o,u,f){return t+n+o+f>>>0},sum64_5_hi:function(r,t,e,n,a,o,u,f,w,g){var b=0,L=t;return b+=(L=L+n>>>0)<t?1:0,b+=(L=L+o>>>0)<o?1:0,b+=(L=L+f>>>0)<f?1:0,r+e+a+u+w+(b+=(L=L+g>>>0)<g?1:0)>>>0},sum64_5_lo:function(r,t,e,n,a,o,u,f,w,g){return t+n+o+f+g>>>0},rotr64_hi:function(r,t,e){return(t<<32-e|r>>>e)>>>0},rotr64_lo:function(r,t,e){return(r<<32-e|t>>>e)>>>0},shr64_hi:function(r,t,e){return r>>>e},shr64_lo:function(r,t,e){return(r<<32-e|t>>>e)>>>0}};function Ve(){this.pending=null,this.pendingTotal=0,this.blockSize=this.constructor.blockSize,this.outSize=this.constructor.outSize,this.hmacStrength=this.constructor.hmacStrength,this.padLength=this.constructor.padLength/8,this.endian="big",this._delta8=this.blockSize/8,this._delta32=this.blockSize/32}var ft=Ve;Ve.prototype.update=function(r,t){if(r=fe.toArray(r,t),this.pending=this.pending?this.pending.concat(r):r,this.pendingTotal+=r.length,this.pending.length>=this._delta8){var e=(r=this.pending).length%this._delta8;this.pending=r.slice(r.length-e,r.length),0===this.pending.length&&(this.pending=null),r=fe.join32(r,0,r.length-e,this.endian);for(var n=0;n<r.length;n+=this._delta32)this._update(r,n,n+this._delta32)}return this},Ve.prototype.digest=function(r){return this.update(this._pad()),oi(null===this.pending),this._digest(r)},Ve.prototype._pad=function(){var r=this.pendingTotal,t=this._delta8,e=t-(r+this.padLength)%t,n=Array(e+this.padLength);n[0]=128;for(var a=1;a<e;a++)n[a]=0;if(r<<=3,"big"===this.endian){for(var o=8;o<this.padLength;o++)n[a++]=0;n[a++]=0,n[a++]=0,n[a++]=0,n[a++]=0,n[a++]=r>>>24&255,n[a++]=r>>>16&255,n[a++]=r>>>8&255,n[a++]=255&r}else for(n[a++]=255&r,n[a++]=r>>>8&255,n[a++]=r>>>16&255,n[a++]=r>>>24&255,n[a++]=0,n[a++]=0,n[a++]=0,n[a++]=0,o=8;o<this.padLength;o++)n[a++]=0;return n};var ht={BlockHash:ft},Bt=fe.rotr32;function Dt(r,t,e){return r&t^~r&e}function br(r,t,e){return r&t^r&e^t&e}function Zr(r,t,e){return r^t^e}var Wr={ft_1:function(r,t,e,n){return 0===r?Dt(t,e,n):1===r||3===r?Zr(t,e,n):2===r?br(t,e,n):void 0},ch32:Dt,maj32:br,p32:Zr,s0_256:function(r){return Bt(r,2)^Bt(r,13)^Bt(r,22)},s1_256:function(r){return Bt(r,6)^Bt(r,11)^Bt(r,25)},g0_256:function(r){return Bt(r,7)^Bt(r,18)^r>>>3},g1_256:function(r){return Bt(r,17)^Bt(r,19)^r>>>10}},Rr=fe.sum32,vn=fe.sum32_4,vi=fe.sum32_5,dn=Wr.ch32,pn=Wr.maj32,mi=Wr.s0_256,Sn=Wr.s1_256,Vi=Wr.g0_256,Gc=Wr.g1_256,no=ht.BlockHash,jc=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function _n(){if(!(this instanceof _n))return new _n;no.call(this),this.h=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],this.k=jc,this.W=Array(64)}fe.inherits(_n,no);var ds=_n;function Vn(){if(!(this instanceof Vn))return new Vn;ds.call(this),this.h=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428]}_n.blockSize=512,_n.outSize=256,_n.hmacStrength=192,_n.padLength=64,_n.prototype._update=function(r,t){for(var e=this.W,n=0;n<16;n++)e[n]=r[t+n];for(;n<e.length;n++)e[n]=vn(Gc(e[n-2]),e[n-7],Vi(e[n-15]),e[n-16]);var a=this.h[0],o=this.h[1],u=this.h[2],f=this.h[3],w=this.h[4],g=this.h[5],b=this.h[6],L=this.h[7];for(oi(this.k.length===e.length),n=0;n<e.length;n++){var $=vi(L,Sn(w),dn(w,g,b),this.k[n],e[n]),j=Rr(mi(a),pn(a,o,u));L=b,b=g,g=w,w=Rr(f,$),f=u,u=o,o=a,a=Rr($,j)}this.h[0]=Rr(this.h[0],a),this.h[1]=Rr(this.h[1],o),this.h[2]=Rr(this.h[2],u),this.h[3]=Rr(this.h[3],f),this.h[4]=Rr(this.h[4],w),this.h[5]=Rr(this.h[5],g),this.h[6]=Rr(this.h[6],b),this.h[7]=Rr(this.h[7],L)},_n.prototype._digest=function(r){return"hex"===r?fe.toHex32(this.h,"big"):fe.split32(this.h,"big")},fe.inherits(Vn,ds);var io=Vn;Vn.blockSize=512,Vn.outSize=224,Vn.hmacStrength=192,Vn.padLength=64,Vn.prototype._digest=function(r){return"hex"===r?fe.toHex32(this.h.slice(0,7),"big"):fe.split32(this.h.slice(0,7),"big")};var kn=fe.rotr64_hi,Tn=fe.rotr64_lo,ao=fe.shr64_hi,so=fe.shr64_lo,$n=fe.sum64,ps=fe.sum64_hi,ys=fe.sum64_lo,Wc=fe.sum64_4_hi,Qc=fe.sum64_4_lo,$c=fe.sum64_5_hi,Yc=fe.sum64_5_lo,oo=ht.BlockHash,Xc=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function mn(){if(!(this instanceof mn))return new mn;oo.call(this),this.h=[1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209],this.k=Xc,this.W=Array(160)}fe.inherits(mn,oo);var zi=mn;function qc(r,t,e,n,a){var o=r&e^~r&a;return o<0&&(o+=4294967296),o}function Jc(r,t,e,n,a,o){var u=t&n^~t&o;return u<0&&(u+=4294967296),u}function eu(r,t,e,n,a){var o=r&e^r&a^e&a;return o<0&&(o+=4294967296),o}function tu(r,t,e,n,a,o){var u=t&n^t&o^n&o;return u<0&&(u+=4294967296),u}function ru(r,t){var e=kn(r,t,28)^kn(t,r,2)^kn(t,r,7);return e<0&&(e+=4294967296),e}function nu(r,t){var e=Tn(r,t,28)^Tn(t,r,2)^Tn(t,r,7);return e<0&&(e+=4294967296),e}function iu(r,t){var e=kn(r,t,14)^kn(r,t,18)^kn(t,r,9);return e<0&&(e+=4294967296),e}function au(r,t){var e=Tn(r,t,14)^Tn(r,t,18)^Tn(t,r,9);return e<0&&(e+=4294967296),e}function su(r,t){var e=kn(r,t,1)^kn(r,t,8)^ao(r,t,7);return e<0&&(e+=4294967296),e}function ou(r,t){var e=Tn(r,t,1)^Tn(r,t,8)^so(r,t,7);return e<0&&(e+=4294967296),e}function cu(r,t){var e=kn(r,t,19)^kn(t,r,29)^ao(r,t,6);return e<0&&(e+=4294967296),e}function uu(r,t){var e=Tn(r,t,19)^Tn(t,r,29)^so(r,t,6);return e<0&&(e+=4294967296),e}function zn(){if(!(this instanceof zn))return new zn;zi.call(this),this.h=[3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]}mn.blockSize=1024,mn.outSize=512,mn.hmacStrength=192,mn.padLength=128,mn.prototype._prepareBlock=function(r,t){for(var e=this.W,n=0;n<32;n++)e[n]=r[t+n];for(;n<e.length;n+=2){var a=cu(e[n-4],e[n-3]),o=uu(e[n-4],e[n-3]),u=e[n-14],f=e[n-13],w=su(e[n-30],e[n-29]),g=ou(e[n-30],e[n-29]),b=e[n-32],L=e[n-31];e[n]=Wc(a,o,u,f,w,g,b,L),e[n+1]=Qc(a,o,u,f,w,g,b,L)}},mn.prototype._update=function(r,t){this._prepareBlock(r,t);var e=this.W,n=this.h[0],a=this.h[1],o=this.h[2],u=this.h[3],f=this.h[4],w=this.h[5],g=this.h[6],b=this.h[7],L=this.h[8],$=this.h[9],j=this.h[10],se=this.h[11],pe=this.h[12],xe=this.h[13],Ke=this.h[14],Qe=this.h[15];oi(this.k.length===e.length);for(var Be=0;Be<e.length;Be+=2){var le=Ke,Xe=Qe,He=iu(L,$),$e=au(L,$),rt=qc(L,0,j,0,pe),Je=Jc(0,$,0,se,0,xe),dt=this.k[Be],It=this.k[Be+1],Ut=e[Be],zt=e[Be+1],pt=$c(le,Xe,He,$e,rt,Je,dt,It,Ut,zt),Ye=Yc(le,Xe,He,$e,rt,Je,dt,It,Ut,zt);le=ru(n,a),Xe=nu(n,a),He=eu(n,0,o,0,f),$e=tu(0,a,0,u,0,w);var rr=ps(le,Xe,He,$e),ze=ys(le,Xe,He,$e);Ke=pe,Qe=xe,pe=j,xe=se,j=L,se=$,L=ps(g,b,pt,Ye),$=ys(b,b,pt,Ye),g=f,b=w,f=o,w=u,o=n,u=a,n=ps(pt,Ye,rr,ze),a=ys(pt,Ye,rr,ze)}$n(this.h,0,n,a),$n(this.h,2,o,u),$n(this.h,4,f,w),$n(this.h,6,g,b),$n(this.h,8,L,$),$n(this.h,10,j,se),$n(this.h,12,pe,xe),$n(this.h,14,Ke,Qe)},mn.prototype._digest=function(r){return"hex"===r?fe.toHex32(this.h,"big"):fe.split32(this.h,"big")},fe.inherits(zn,zi);var co=zn;zn.blockSize=1024,zn.outSize=384,zn.hmacStrength=192,zn.padLength=128,zn.prototype._digest=function(r){return"hex"===r?fe.toHex32(this.h.slice(0,12),"big"):fe.split32(this.h.slice(0,12),"big")};var ba=fe.rotl32,uo=fe.sum32,Zi=fe.sum32_3,lo=fe.sum32_4,fo=ht.BlockHash;function Bn(){if(!(this instanceof Bn))return new Bn;fo.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.endian="little"}fe.inherits(Bn,fo);var ho=Bn;function po(r,t,e,n){return r<=15?t^e^n:r<=31?t&e|~t&n:r<=47?(t|~e)^n:r<=63?t&n|e&~n:t^(e|~n)}function lu(r){return r<=15?0:r<=31?1518500249:r<=47?1859775393:r<=63?2400959708:2840853838}function fu(r){return r<=15?1352829926:r<=31?1548603684:r<=47?1836072691:r<=63?2053994217:0}Bn.blockSize=512,Bn.outSize=160,Bn.hmacStrength=192,Bn.padLength=64,Bn.prototype._update=function(r,t){for(var e=this.h[0],n=this.h[1],a=this.h[2],o=this.h[3],u=this.h[4],f=e,w=n,g=a,b=o,L=u,$=0;$<80;$++){var j=uo(ba(lo(e,po($,n,a,o),r[hu[$]+t],lu($)),pu[$]),u);e=u,u=o,o=ba(a,10),a=n,n=j,j=uo(ba(lo(f,po(79-$,w,g,b),r[du[$]+t],fu($)),yu[$]),L),f=L,L=b,b=ba(g,10),g=w,w=j}j=Zi(this.h[1],a,b),this.h[1]=Zi(this.h[2],o,L),this.h[2]=Zi(this.h[3],u,f),this.h[3]=Zi(this.h[4],e,w),this.h[4]=Zi(this.h[0],n,g),this.h[0]=j},Bn.prototype._digest=function(r){return"hex"===r?fe.toHex32(this.h,"little"):fe.split32(this.h,"little")};var hu=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],du=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],pu=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],yu=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11],gu={ripemd160:ho};function gs(r,t){let e=r[0],n=r[1],a=r[2],o=r[3];e=tn(e,n,a,o,t[0],7,-680876936),o=tn(o,e,n,a,t[1],12,-389564586),a=tn(a,o,e,n,t[2],17,606105819),n=tn(n,a,o,e,t[3],22,-1044525330),e=tn(e,n,a,o,t[4],7,-176418897),o=tn(o,e,n,a,t[5],12,1200080426),a=tn(a,o,e,n,t[6],17,-1473231341),n=tn(n,a,o,e,t[7],22,-45705983),e=tn(e,n,a,o,t[8],7,1770035416),o=tn(o,e,n,a,t[9],12,-1958414417),a=tn(a,o,e,n,t[10],17,-42063),n=tn(n,a,o,e,t[11],22,-1990404162),e=tn(e,n,a,o,t[12],7,1804603682),o=tn(o,e,n,a,t[13],12,-40341101),a=tn(a,o,e,n,t[14],17,-1502002290),n=tn(n,a,o,e,t[15],22,1236535329),e=rn(e,n,a,o,t[1],5,-165796510),o=rn(o,e,n,a,t[6],9,-1069501632),a=rn(a,o,e,n,t[11],14,643717713),n=rn(n,a,o,e,t[0],20,-373897302),e=rn(e,n,a,o,t[5],5,-701558691),o=rn(o,e,n,a,t[10],9,38016083),a=rn(a,o,e,n,t[15],14,-660478335),n=rn(n,a,o,e,t[4],20,-405537848),e=rn(e,n,a,o,t[9],5,568446438),o=rn(o,e,n,a,t[14],9,-1019803690),a=rn(a,o,e,n,t[3],14,-187363961),n=rn(n,a,o,e,t[8],20,1163531501),e=rn(e,n,a,o,t[13],5,-1444681467),o=rn(o,e,n,a,t[2],9,-51403784),a=rn(a,o,e,n,t[7],14,1735328473),n=rn(n,a,o,e,t[12],20,-1926607734),e=nn(e,n,a,o,t[5],4,-378558),o=nn(o,e,n,a,t[8],11,-2022574463),a=nn(a,o,e,n,t[11],16,1839030562),n=nn(n,a,o,e,t[14],23,-35309556),e=nn(e,n,a,o,t[1],4,-1530992060),o=nn(o,e,n,a,t[4],11,1272893353),a=nn(a,o,e,n,t[7],16,-155497632),n=nn(n,a,o,e,t[10],23,-1094730640),e=nn(e,n,a,o,t[13],4,681279174),o=nn(o,e,n,a,t[0],11,-358537222),a=nn(a,o,e,n,t[3],16,-722521979),n=nn(n,a,o,e,t[6],23,76029189),e=nn(e,n,a,o,t[9],4,-640364487),o=nn(o,e,n,a,t[12],11,-421815835),a=nn(a,o,e,n,t[15],16,530742520),n=nn(n,a,o,e,t[2],23,-995338651),e=an(e,n,a,o,t[0],6,-198630844),o=an(o,e,n,a,t[7],10,1126891415),a=an(a,o,e,n,t[14],15,-1416354905),n=an(n,a,o,e,t[5],21,-57434055),e=an(e,n,a,o,t[12],6,1700485571),o=an(o,e,n,a,t[3],10,-1894986606),a=an(a,o,e,n,t[10],15,-1051523),n=an(n,a,o,e,t[1],21,-2054922799),e=an(e,n,a,o,t[8],6,1873313359),o=an(o,e,n,a,t[15],10,-30611744),a=an(a,o,e,n,t[6],15,-1560198380),n=an(n,a,o,e,t[13],21,1309151649),e=an(e,n,a,o,t[4],6,-145523070),o=an(o,e,n,a,t[11],10,-1120210379),a=an(a,o,e,n,t[2],15,718787259),n=an(n,a,o,e,t[9],21,-343485551),r[0]=Yn(e,r[0]),r[1]=Yn(n,r[1]),r[2]=Yn(a,r[2]),r[3]=Yn(o,r[3])}function Ea(r,t,e,n,a,o){return t=Yn(Yn(t,r),Yn(n,o)),Yn(t<<a|t>>>32-a,e)}function tn(r,t,e,n,a,o,u){return Ea(t&e|~t&n,r,t,a,o,u)}function rn(r,t,e,n,a,o,u){return Ea(t&n|e&~n,r,t,a,o,u)}function nn(r,t,e,n,a,o,u){return Ea(t^e^n,r,t,a,o,u)}function an(r,t,e,n,a,o,u){return Ea(e^(t|~n),r,t,a,o,u)}function vu(r){const t=[];let e;for(e=0;e<64;e+=4)t[e>>2]=r.charCodeAt(e)+(r.charCodeAt(e+1)<<8)+(r.charCodeAt(e+2)<<16)+(r.charCodeAt(e+3)<<24);return t}const yo="0123456789abcdef".split("");function mu(r){let t="",e=0;for(;e<4;e++)t+=yo[r>>8*e+4&15]+yo[r>>8*e&15];return t}function Yn(r,t){return r+t&4294967295}const wa=z.getWebCrypto(),Ca=z.getNodeCrypto(),xu=Ca&&Ca.getHashes();function ci(r){if(Ca&&xu.includes(r))return function(){var t=(0,s.Z)(function*(e){const n=Ca.createHash(r);return Ze(e,a=>{n.update(a)},()=>new Uint8Array(n.digest()))});return function(e){return t.apply(this,arguments)}}()}function Aa(r,t){return function(){var e=(0,s.Z)(function*(n,a=ut){if(y(n)&&(n=yield Le(n)),!z.isStream(n)&&wa&&t&&n.length>=a.minBytesForWebCrypto)return new Uint8Array(yield wa.digest(t,n));const o=r();return Ze(n,u=>{o.update(u)},()=>new Uint8Array(o.digest()))});return function(n){return e.apply(this,arguments)}}()}function go(r,t){return function(){var e=(0,s.Z)(function*(n,a=ut){if(y(n)&&(n=yield Le(n)),z.isStream(n)){const o=new r;return Ze(n,u=>{o.process(u)},()=>o.finish().result)}return wa&&t&&n.length>=a.minBytesForWebCrypto?new Uint8Array(yield wa.digest(t,n)):r.bytes(n)});return function(n){return e.apply(this,arguments)}}()}const ui={md5:ci("md5")||function(){var r=(0,s.Z)(function*(t){const e=function(n){const a=n.length,o=[1732584193,-271733879,-1732584194,271733878];let u;for(u=64;u<=n.length;u+=64)gs(o,vu(n.substring(u-64,u)));n=n.substring(u-64);const f=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(u=0;u<n.length;u++)f[u>>2]|=n.charCodeAt(u)<<(u%4<<3);if(f[u>>2]|=128<<(u%4<<3),u>55)for(gs(o,f),u=0;u<16;u++)f[u]=0;return f[14]=8*a,gs(o,f),o}(z.uint8ArrayToString(t));return z.hexToUint8Array(function(n){for(let a=0;a<n.length;a++)n[a]=mu(n[a]);return n.join("")}(e))});return function(t){return r.apply(this,arguments)}}(),sha1:ci("sha1")||go(Hn,"SHA-1"),sha224:ci("sha224")||Aa(io),sha256:ci("sha256")||go(fs,"SHA-256"),sha384:ci("sha384")||Aa(co,"SHA-384"),sha512:ci("sha512")||Aa(zi,"SHA-512"),ripemd:ci("ripemd160")||Aa(ho)};var xi={md5:ui.md5,sha1:ui.sha1,sha224:ui.sha224,sha256:ui.sha256,sha384:ui.sha384,sha512:ui.sha512,ripemd:ui.ripemd,digest:function(r,t){switch(r){case Z.hash.md5:return this.md5(t);case Z.hash.sha1:return this.sha1(t);case Z.hash.ripemd:return this.ripemd(t);case Z.hash.sha256:return this.sha256(t);case Z.hash.sha384:return this.sha384(t);case Z.hash.sha512:return this.sha512(t);case Z.hash.sha224:return this.sha224(t);default:throw Error("Invalid hash function.")}},getHashByteLength:function(r){switch(r){case Z.hash.md5:return 16;case Z.hash.sha1:case Z.hash.ripemd:return 20;case Z.hash.sha256:return 32;case Z.hash.sha384:return 48;case Z.hash.sha512:return 64;case Z.hash.sha224:return 28;default:throw Error("Invalid hash algorithm.")}}};class bi{static encrypt(t,e,n){return new bi(e,n).encrypt(t)}static decrypt(t,e,n){return new bi(e,n).decrypt(t)}constructor(t,e,n){this.aes=n||new dr(t,e,!0,"CFB"),delete this.aes.padding}encrypt(t){return cr(this.aes.AES_Encrypt_process(t),this.aes.AES_Encrypt_finish())}decrypt(t){return cr(this.aes.AES_Decrypt_process(t),this.aes.AES_Decrypt_finish())}}var In=gi(function(r){!function(t){var e=function(ge){var Ne,Oe=new Float64Array(16);if(ge)for(Ne=0;Ne<ge.length;Ne++)Oe[Ne]=ge[Ne];return Oe},n=function(){throw Error("no PRNG")},a=new Uint8Array(32);a[0]=9;var o=e(),u=e([1]),f=e([56129,1]),w=e([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),g=e([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),b=e([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),L=e([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),$=e([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function j(ge,Ne,Oe,R){return function(ye,qe,nt,it,q){var Q,te=0;for(Q=0;Q<32;Q++)te|=ye[qe+Q]^nt[it+Q];return(1&te-1>>>8)-1}(ge,Ne,Oe,R)}function se(ge,Ne){var Oe;for(Oe=0;Oe<16;Oe++)ge[Oe]=0|Ne[Oe]}function pe(ge){var Ne,Oe,R=1;for(Ne=0;Ne<16;Ne++)Oe=ge[Ne]+R+65535,R=Math.floor(Oe/65536),ge[Ne]=Oe-65536*R;ge[0]+=R-1+37*(R-1)}function xe(ge,Ne,Oe){for(var R,ye=~(Oe-1),qe=0;qe<16;qe++)ge[qe]^=R=ye&(ge[qe]^Ne[qe]),Ne[qe]^=R}function Ke(ge,Ne){var Oe,R,ye,qe=e(),nt=e();for(Oe=0;Oe<16;Oe++)nt[Oe]=Ne[Oe];for(pe(nt),pe(nt),pe(nt),R=0;R<2;R++){for(qe[0]=nt[0]-65517,Oe=1;Oe<15;Oe++)qe[Oe]=nt[Oe]-65535-(qe[Oe-1]>>16&1),qe[Oe-1]&=65535;qe[15]=nt[15]-32767-(qe[14]>>16&1),ye=qe[15]>>16&1,qe[14]&=65535,xe(nt,qe,1-ye)}for(Oe=0;Oe<16;Oe++)ge[2*Oe]=255&nt[Oe],ge[2*Oe+1]=nt[Oe]>>8}function Qe(ge,Ne){var Oe=new Uint8Array(32),R=new Uint8Array(32);return Ke(Oe,ge),Ke(R,Ne),j(Oe,0,R,0)}function Be(ge){var Ne=new Uint8Array(32);return Ke(Ne,ge),1&Ne[0]}function le(ge,Ne){var Oe;for(Oe=0;Oe<16;Oe++)ge[Oe]=Ne[2*Oe]+(Ne[2*Oe+1]<<8);ge[15]&=32767}function Xe(ge,Ne,Oe){for(var R=0;R<16;R++)ge[R]=Ne[R]+Oe[R]}function He(ge,Ne,Oe){for(var R=0;R<16;R++)ge[R]=Ne[R]-Oe[R]}function $e(ge,Ne,Oe){var R,ye,qe=0,nt=0,it=0,q=0,Q=0,te=0,oe=0,Ce=0,ve=0,Te=0,St=0,bt=0,At=0,Et=0,Ee=0,we=0,Se=0,_e=0,ke=0,ae=0,ie=0,he=0,vt=0,tr=0,ur=0,hr=0,sr=0,Or=0,Vr=0,jr=0,qr=0,ar=Oe[0],xr=Oe[1],vr=Oe[2],er=Oe[3],Ir=Oe[4],Sr=Oe[5],Br=Oe[6],st=Oe[7],ot=Oe[8],wt=Oe[9],Wt=Oe[10],Yt=Oe[11],nr=Oe[12],Jt=Oe[13],Er=Oe[14],Pr=Oe[15];qe+=(R=Ne[0])*ar,nt+=R*xr,it+=R*vr,q+=R*er,Q+=R*Ir,te+=R*Sr,oe+=R*Br,Ce+=R*st,ve+=R*ot,Te+=R*wt,St+=R*Wt,bt+=R*Yt,At+=R*nr,Et+=R*Jt,Ee+=R*Er,we+=R*Pr,nt+=(R=Ne[1])*ar,it+=R*xr,q+=R*vr,Q+=R*er,te+=R*Ir,oe+=R*Sr,Ce+=R*Br,ve+=R*st,Te+=R*ot,St+=R*wt,bt+=R*Wt,At+=R*Yt,Et+=R*nr,Ee+=R*Jt,we+=R*Er,Se+=R*Pr,it+=(R=Ne[2])*ar,q+=R*xr,Q+=R*vr,te+=R*er,oe+=R*Ir,Ce+=R*Sr,ve+=R*Br,Te+=R*st,St+=R*ot,bt+=R*wt,At+=R*Wt,Et+=R*Yt,Ee+=R*nr,we+=R*Jt,Se+=R*Er,_e+=R*Pr,q+=(R=Ne[3])*ar,Q+=R*xr,te+=R*vr,oe+=R*er,Ce+=R*Ir,ve+=R*Sr,Te+=R*Br,St+=R*st,bt+=R*ot,At+=R*wt,Et+=R*Wt,Ee+=R*Yt,we+=R*nr,Se+=R*Jt,_e+=R*Er,ke+=R*Pr,Q+=(R=Ne[4])*ar,te+=R*xr,oe+=R*vr,Ce+=R*er,ve+=R*Ir,Te+=R*Sr,St+=R*Br,bt+=R*st,At+=R*ot,Et+=R*wt,Ee+=R*Wt,we+=R*Yt,Se+=R*nr,_e+=R*Jt,ke+=R*Er,ae+=R*Pr,te+=(R=Ne[5])*ar,oe+=R*xr,Ce+=R*vr,ve+=R*er,Te+=R*Ir,St+=R*Sr,bt+=R*Br,At+=R*st,Et+=R*ot,Ee+=R*wt,we+=R*Wt,Se+=R*Yt,_e+=R*nr,ke+=R*Jt,ae+=R*Er,ie+=R*Pr,oe+=(R=Ne[6])*ar,Ce+=R*xr,ve+=R*vr,Te+=R*er,St+=R*Ir,bt+=R*Sr,At+=R*Br,Et+=R*st,Ee+=R*ot,we+=R*wt,Se+=R*Wt,_e+=R*Yt,ke+=R*nr,ae+=R*Jt,ie+=R*Er,he+=R*Pr,Ce+=(R=Ne[7])*ar,ve+=R*xr,Te+=R*vr,St+=R*er,bt+=R*Ir,At+=R*Sr,Et+=R*Br,Ee+=R*st,we+=R*ot,Se+=R*wt,_e+=R*Wt,ke+=R*Yt,ae+=R*nr,ie+=R*Jt,he+=R*Er,vt+=R*Pr,ve+=(R=Ne[8])*ar,Te+=R*xr,St+=R*vr,bt+=R*er,At+=R*Ir,Et+=R*Sr,Ee+=R*Br,we+=R*st,Se+=R*ot,_e+=R*wt,ke+=R*Wt,ae+=R*Yt,ie+=R*nr,he+=R*Jt,vt+=R*Er,tr+=R*Pr,Te+=(R=Ne[9])*ar,St+=R*xr,bt+=R*vr,At+=R*er,Et+=R*Ir,Ee+=R*Sr,we+=R*Br,Se+=R*st,_e+=R*ot,ke+=R*wt,ae+=R*Wt,ie+=R*Yt,he+=R*nr,vt+=R*Jt,tr+=R*Er,ur+=R*Pr,St+=(R=Ne[10])*ar,bt+=R*xr,At+=R*vr,Et+=R*er,Ee+=R*Ir,we+=R*Sr,Se+=R*Br,_e+=R*st,ke+=R*ot,ae+=R*wt,ie+=R*Wt,he+=R*Yt,vt+=R*nr,tr+=R*Jt,ur+=R*Er,hr+=R*Pr,bt+=(R=Ne[11])*ar,At+=R*xr,Et+=R*vr,Ee+=R*er,we+=R*Ir,Se+=R*Sr,_e+=R*Br,ke+=R*st,ae+=R*ot,ie+=R*wt,he+=R*Wt,vt+=R*Yt,tr+=R*nr,ur+=R*Jt,hr+=R*Er,sr+=R*Pr,At+=(R=Ne[12])*ar,Et+=R*xr,Ee+=R*vr,we+=R*er,Se+=R*Ir,_e+=R*Sr,ke+=R*Br,ae+=R*st,ie+=R*ot,he+=R*wt,vt+=R*Wt,tr+=R*Yt,ur+=R*nr,hr+=R*Jt,sr+=R*Er,Or+=R*Pr,Et+=(R=Ne[13])*ar,Ee+=R*xr,we+=R*vr,Se+=R*er,_e+=R*Ir,ke+=R*Sr,ae+=R*Br,ie+=R*st,he+=R*ot,vt+=R*wt,tr+=R*Wt,ur+=R*Yt,hr+=R*nr,sr+=R*Jt,Or+=R*Er,Vr+=R*Pr,Ee+=(R=Ne[14])*ar,we+=R*xr,Se+=R*vr,_e+=R*er,ke+=R*Ir,ae+=R*Sr,ie+=R*Br,he+=R*st,vt+=R*ot,tr+=R*wt,ur+=R*Wt,hr+=R*Yt,sr+=R*nr,Or+=R*Jt,Vr+=R*Er,jr+=R*Pr,we+=(R=Ne[15])*ar,nt+=38*(_e+=R*vr),it+=38*(ke+=R*er),q+=38*(ae+=R*Ir),Q+=38*(ie+=R*Sr),te+=38*(he+=R*Br),oe+=38*(vt+=R*st),Ce+=38*(tr+=R*ot),ve+=38*(ur+=R*wt),Te+=38*(hr+=R*Wt),St+=38*(sr+=R*Yt),bt+=38*(Or+=R*nr),At+=38*(Vr+=R*Jt),Et+=38*(jr+=R*Er),Ee+=38*(qr+=R*Pr),qe=(R=(qe+=38*(Se+=R*xr))+(ye=1)+65535)-65536*(ye=Math.floor(R/65536)),nt=(R=nt+ye+65535)-65536*(ye=Math.floor(R/65536)),it=(R=it+ye+65535)-65536*(ye=Math.floor(R/65536)),q=(R=q+ye+65535)-65536*(ye=Math.floor(R/65536)),Q=(R=Q+ye+65535)-65536*(ye=Math.floor(R/65536)),te=(R=te+ye+65535)-65536*(ye=Math.floor(R/65536)),oe=(R=oe+ye+65535)-65536*(ye=Math.floor(R/65536)),Ce=(R=Ce+ye+65535)-65536*(ye=Math.floor(R/65536)),ve=(R=ve+ye+65535)-65536*(ye=Math.floor(R/65536)),Te=(R=Te+ye+65535)-65536*(ye=Math.floor(R/65536)),St=(R=St+ye+65535)-65536*(ye=Math.floor(R/65536)),bt=(R=bt+ye+65535)-65536*(ye=Math.floor(R/65536)),At=(R=At+ye+65535)-65536*(ye=Math.floor(R/65536)),Et=(R=Et+ye+65535)-65536*(ye=Math.floor(R/65536)),Ee=(R=Ee+ye+65535)-65536*(ye=Math.floor(R/65536)),we=(R=we+ye+65535)-65536*(ye=Math.floor(R/65536)),qe=(R=(qe+=ye-1+37*(ye-1))+(ye=1)+65535)-65536*(ye=Math.floor(R/65536)),nt=(R=nt+ye+65535)-65536*(ye=Math.floor(R/65536)),it=(R=it+ye+65535)-65536*(ye=Math.floor(R/65536)),q=(R=q+ye+65535)-65536*(ye=Math.floor(R/65536)),Q=(R=Q+ye+65535)-65536*(ye=Math.floor(R/65536)),te=(R=te+ye+65535)-65536*(ye=Math.floor(R/65536)),oe=(R=oe+ye+65535)-65536*(ye=Math.floor(R/65536)),Ce=(R=Ce+ye+65535)-65536*(ye=Math.floor(R/65536)),ve=(R=ve+ye+65535)-65536*(ye=Math.floor(R/65536)),Te=(R=Te+ye+65535)-65536*(ye=Math.floor(R/65536)),St=(R=St+ye+65535)-65536*(ye=Math.floor(R/65536)),bt=(R=bt+ye+65535)-65536*(ye=Math.floor(R/65536)),At=(R=At+ye+65535)-65536*(ye=Math.floor(R/65536)),Et=(R=Et+ye+65535)-65536*(ye=Math.floor(R/65536)),Ee=(R=Ee+ye+65535)-65536*(ye=Math.floor(R/65536)),we=(R=we+ye+65535)-65536*(ye=Math.floor(R/65536)),ge[0]=qe+=ye-1+37*(ye-1),ge[1]=nt,ge[2]=it,ge[3]=q,ge[4]=Q,ge[5]=te,ge[6]=oe,ge[7]=Ce,ge[8]=ve,ge[9]=Te,ge[10]=St,ge[11]=bt,ge[12]=At,ge[13]=Et,ge[14]=Ee,ge[15]=we}function rt(ge,Ne){$e(ge,Ne,Ne)}function Je(ge,Ne){var Oe,R=e();for(Oe=0;Oe<16;Oe++)R[Oe]=Ne[Oe];for(Oe=253;Oe>=0;Oe--)rt(R,R),2!==Oe&&4!==Oe&&$e(R,R,Ne);for(Oe=0;Oe<16;Oe++)ge[Oe]=R[Oe]}function dt(ge,Ne,Oe){var R,ye,qe=new Uint8Array(32),nt=new Float64Array(80),it=e(),q=e(),Q=e(),te=e(),oe=e(),Ce=e();for(ye=0;ye<31;ye++)qe[ye]=Ne[ye];for(qe[31]=127&Ne[31]|64,qe[0]&=248,le(nt,Oe),ye=0;ye<16;ye++)q[ye]=nt[ye],te[ye]=it[ye]=Q[ye]=0;for(it[0]=te[0]=1,ye=254;ye>=0;--ye)xe(it,q,R=qe[ye>>>3]>>>(7&ye)&1),xe(Q,te,R),Xe(oe,it,Q),He(it,it,Q),Xe(Q,q,te),He(q,q,te),rt(te,oe),rt(Ce,it),$e(it,Q,it),$e(Q,q,oe),Xe(oe,it,Q),He(it,it,Q),rt(q,it),He(Q,te,Ce),$e(it,Q,f),Xe(it,it,te),$e(Q,Q,it),$e(it,te,Ce),$e(te,q,nt),rt(q,oe),xe(it,q,R),xe(Q,te,R);for(ye=0;ye<16;ye++)nt[ye+16]=it[ye],nt[ye+32]=Q[ye],nt[ye+48]=q[ye],nt[ye+64]=te[ye];var ve=nt.subarray(32),Te=nt.subarray(16);return Je(ve,ve),$e(Te,Te,ve),Ke(ge,Te),0}function It(ge,Ne){return dt(ge,Ne,a)}function Ut(ge,Ne){var Oe=e(),R=e(),ye=e(),qe=e(),nt=e(),it=e(),q=e(),Q=e(),te=e();He(Oe,ge[1],ge[0]),He(te,Ne[1],Ne[0]),$e(Oe,Oe,te),Xe(R,ge[0],ge[1]),Xe(te,Ne[0],Ne[1]),$e(R,R,te),$e(ye,ge[3],Ne[3]),$e(ye,ye,g),$e(qe,ge[2],Ne[2]),Xe(qe,qe,qe),He(nt,R,Oe),He(it,qe,ye),Xe(q,qe,ye),Xe(Q,R,Oe),$e(ge[0],nt,it),$e(ge[1],Q,q),$e(ge[2],q,it),$e(ge[3],nt,Q)}function zt(ge,Ne,Oe){var R;for(R=0;R<4;R++)xe(ge[R],Ne[R],Oe)}function pt(ge,Ne){var Oe=e(),R=e(),ye=e();Je(ye,Ne[2]),$e(Oe,Ne[0],ye),$e(R,Ne[1],ye),Ke(ge,R),ge[31]^=Be(Oe)<<7}function Ye(ge,Ne,Oe){var R,ye;for(se(ge[0],o),se(ge[1],u),se(ge[2],u),se(ge[3],o),ye=255;ye>=0;--ye)zt(ge,Ne,R=Oe[ye/8|0]>>(7&ye)&1),Ut(Ne,ge),Ut(ge,ge),zt(ge,Ne,R)}function rr(ge,Ne){var Oe=[e(),e(),e(),e()];se(Oe[0],b),se(Oe[1],L),se(Oe[2],u),$e(Oe[3],b,L),Ye(ge,Oe,Ne)}function ze(ge,Ne,Oe){var R,ye,qe=[e(),e(),e(),e()];for(Oe||n(Ne,32),(R=t.hash(Ne.subarray(0,32)))[0]&=248,R[31]&=127,R[31]|=64,rr(qe,R),pt(ge,qe),ye=0;ye<32;ye++)Ne[ye+32]=ge[ye];return 0}var ge,yt=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function Ot(ge,Ne){var Oe,R,ye,qe;for(R=63;R>=32;--R){for(Oe=0,ye=R-32,qe=R-12;ye<qe;++ye)Ne[ye]+=Oe-16*Ne[R]*yt[ye-(R-32)],Oe=Math.floor((Ne[ye]+128)/256),Ne[ye]-=256*Oe;Ne[ye]+=Oe,Ne[R]=0}for(Oe=0,ye=0;ye<32;ye++)Ne[ye]+=Oe-(Ne[31]>>4)*yt[ye],Oe=Ne[ye]>>8,Ne[ye]&=255;for(ye=0;ye<32;ye++)Ne[ye]-=Oe*yt[ye];for(R=0;R<32;R++)Ne[R+1]+=Ne[R]>>8,ge[R]=255&Ne[R]}function Zt(ge){var Ne,Oe=new Float64Array(64);for(Ne=0;Ne<64;Ne++)Oe[Ne]=ge[Ne];for(Ne=0;Ne<64;Ne++)ge[Ne]=0;Ot(ge,Oe)}function Gt(){for(var ge=0;ge<arguments.length;ge++)if(!(arguments[ge]instanceof Uint8Array))throw new TypeError("unexpected type, use Uint8Array")}function xt(ge){for(var Ne=0;Ne<ge.length;Ne++)ge[Ne]=0}t.scalarMult=function(ge,Ne){if(Gt(ge,Ne),32!==ge.length)throw Error("bad n size");if(32!==Ne.length)throw Error("bad p size");var Oe=new Uint8Array(32);return dt(Oe,ge,Ne),Oe},t.box={},t.box.keyPair=function(){var ge,Ne,Oe=new Uint8Array(32),R=new Uint8Array(32);return ge=Oe,n(Ne=R,32),It(ge,Ne),{publicKey:Oe,secretKey:R}},t.box.keyPair.fromSecretKey=function(ge){if(Gt(ge),32!==ge.length)throw Error("bad secret key size");var Ne=new Uint8Array(32);return It(Ne,ge),{publicKey:Ne,secretKey:new Uint8Array(ge)}},t.sign=function(ge,Ne){if(Gt(ge,Ne),64!==Ne.length)throw Error("bad secret key size");var Oe=new Uint8Array(64+ge.length);return function(R,ye,qe,nt){var it,q,Q,te,oe,Ce=new Float64Array(64),ve=[e(),e(),e(),e()];(it=t.hash(nt.subarray(0,32)))[0]&=248,it[31]&=127,it[31]|=64;var Te=qe+64;for(te=0;te<qe;te++)R[64+te]=ye[te];for(te=0;te<32;te++)R[32+te]=it[32+te];for(Zt(Q=t.hash(R.subarray(32,Te))),rr(ve,Q),pt(R,ve),te=32;te<64;te++)R[te]=nt[te];for(Zt(q=t.hash(R.subarray(0,Te))),te=0;te<64;te++)Ce[te]=0;for(te=0;te<32;te++)Ce[te]=Q[te];for(te=0;te<32;te++)for(oe=0;oe<32;oe++)Ce[te+oe]+=q[te]*it[oe];Ot(R.subarray(32),Ce)}(Oe,ge,ge.length,Ne),Oe},t.sign.detached=function(ge,Ne){for(var Oe=t.sign(ge,Ne),R=new Uint8Array(64),ye=0;ye<R.length;ye++)R[ye]=Oe[ye];return R},t.sign.detached.verify=function(ge,Ne,Oe){if(Gt(ge,Ne,Oe),64!==Ne.length)throw Error("bad signature size");if(32!==Oe.length)throw Error("bad public key size");var R,ye=new Uint8Array(64+ge.length),qe=new Uint8Array(64+ge.length);for(R=0;R<64;R++)ye[R]=Ne[R];for(R=0;R<ge.length;R++)ye[R+64]=ge[R];return function(nt,it,q,Q){var te,oe,Ce=new Uint8Array(32),ve=[e(),e(),e(),e()],Te=[e(),e(),e(),e()];if(q<64||function Kt(ge,Ne){var Oe=e(),R=e(),ye=e(),qe=e(),nt=e(),it=e(),q=e();return se(ge[2],u),le(ge[1],Ne),rt(ye,ge[1]),$e(qe,ye,w),He(ye,ye,ge[2]),Xe(qe,ge[2],qe),rt(nt,qe),rt(it,nt),$e(q,it,nt),$e(Oe,q,ye),$e(Oe,Oe,qe),function(Q,te){var oe,Ce=e();for(oe=0;oe<16;oe++)Ce[oe]=te[oe];for(oe=250;oe>=0;oe--)rt(Ce,Ce),1!==oe&&$e(Ce,Ce,te);for(oe=0;oe<16;oe++)Q[oe]=Ce[oe]}(Oe,Oe),$e(Oe,Oe,ye),$e(Oe,Oe,qe),$e(Oe,Oe,qe),$e(ge[0],Oe,qe),rt(R,ge[0]),$e(R,R,qe),Qe(R,ye)&&$e(ge[0],ge[0],$),rt(R,ge[0]),$e(R,R,qe),Qe(R,ye)?-1:(Be(ge[0])===Ne[31]>>7&&He(ge[0],o,ge[0]),$e(ge[3],ge[0],ge[1]),0)}(Te,Q))return-1;for(te=0;te<q;te++)nt[te]=it[te];for(te=0;te<32;te++)nt[te+32]=Q[te];if(Zt(oe=t.hash(nt.subarray(0,q))),Ye(ve,Te,oe),rr(Te,it.subarray(32)),Ut(ve,Te),pt(Ce,ve),q-=64,j(it,0,Ce,0)){for(te=0;te<q;te++)nt[te]=0;return-1}for(te=0;te<q;te++)nt[te]=it[te+64];return q}(qe,ye,ye.length,Oe)>=0},t.sign.keyPair=function(){var ge=new Uint8Array(32),Ne=new Uint8Array(64);return ze(ge,Ne),{publicKey:ge,secretKey:Ne}},t.sign.keyPair.fromSecretKey=function(ge){if(Gt(ge),64!==ge.length)throw Error("bad secret key size");for(var Ne=new Uint8Array(32),Oe=0;Oe<Ne.length;Oe++)Ne[Oe]=ge[32+Oe];return{publicKey:Ne,secretKey:new Uint8Array(ge)}},t.sign.keyPair.fromSeed=function(ge){if(Gt(ge),32!==ge.length)throw Error("bad seed size");for(var Ne=new Uint8Array(32),Oe=new Uint8Array(64),R=0;R<32;R++)Oe[R]=ge[R];return ze(Ne,Oe,!0),{publicKey:Ne,secretKey:Oe}},t.setPRNG=function(ge){n=ge},(ge=typeof self<"u"?self.crypto||self.msCrypto:null)&&ge.getRandomValues?t.setPRNG(function(Ne,Oe){var R,ye=new Uint8Array(Oe);for(R=0;R<Oe;R+=65536)ge.getRandomValues(ye.subarray(R,R+Math.min(Oe-R,65536)));for(R=0;R<Oe;R++)Ne[R]=ye[R];xt(ye)}):(ge=void 0)&&ge.randomBytes&&t.setPRNG(function(Ne,Oe){var R,ye=ge.randomBytes(Oe);for(R=0;R<Oe;R++)Ne[R]=ye[R];xt(ye)})}(r.exports?r.exports:self.nacl=self.nacl||{})});const vo=z.getNodeCrypto();function Pn(r){return vs.apply(this,arguments)}function vs(){return vs=(0,s.Z)(function*(r){const t=new Uint8Array(r);if(typeof crypto<"u"&&crypto.getRandomValues)crypto.getRandomValues(t);else if(vo){const e=vo.randomBytes(t.length);t.set(e)}else{if(!xs.buffer)throw Error("No secure random number generator available.");yield xs.get(t)}return t}),vs.apply(this,arguments)}function Zn(r,t){return ms.apply(this,arguments)}function ms(){return ms=(0,s.Z)(function*(r,t){const e=yield z.getBigInteger();if(t.lt(r))throw Error("Illegal parameter value: max <= min");const n=t.sub(r),a=n.byteLength();return new e(yield Pn(a+8)).mod(n).add(r)}),ms.apply(this,arguments)}const xs=new class{constructor(){this.buffer=null,this.size=null,this.callback=null}init(r,t){this.buffer=new Uint8Array(r),this.size=0,this.callback=t}set(r){if(!this.buffer)throw Error("RandomBuffer is not initialized");if(!(r instanceof Uint8Array))throw Error("Invalid type: buf not an Uint8Array");const t=this.buffer.length-this.size;r.length>t&&(r=r.subarray(0,t)),this.buffer.set(r,this.size),this.size+=r.length}get(r){var t=this;return(0,s.Z)(function*(){if(!t.buffer)throw Error("RandomBuffer is not initialized");if(!(r instanceof Uint8Array))throw Error("Invalid type: buf not an Uint8Array");if(t.size<r.length){if(!t.callback)throw Error("Random number buffer depleted");return yield t.callback(),t.get(r)}for(let e=0;e<r.length;e++)r[e]=t.buffer[--t.size],t.buffer[t.size]=0})()}};var bu=Object.freeze({__proto__:null,getRandomBytes:Pn,getRandomBigInteger:Zn,randomBuffer:xs});function mo(r,t,e){return bs.apply(this,arguments)}function bs(){return bs=(0,s.Z)(function*(r,t,e){const n=yield z.getBigInteger(),a=new n(1),o=a.leftShift(new n(r-1)),u=new n(30),f=[1,6,5,4,3,2,1,4,3,2,1,2,1,4,3,2,1,2,1,4,3,2,1,6,5,4,3,2,1,2],w=yield Zn(o,o.leftShift(a));let g=w.mod(u).toNumber();do{w.iadd(new n(f[g])),g=(g+f[g])%f.length,w.bitLength()>r&&(w.imod(o.leftShift(a)).iadd(o),g=w.mod(u).toNumber())}while(!(yield xo(w,t,e)));return w}),bs.apply(this,arguments)}function xo(r,t,e){return Es.apply(this,arguments)}function Es(){return Es=(0,s.Z)(function*(r,t,e){return!(t&&!r.dec().gcd(t).isOne()||!(yield(n=(0,s.Z)(function*(a){const o=yield z.getBigInteger();return Eu.every(u=>0!==a.mod(new o(u)))}),function(a){return n.apply(this,arguments)})(r))||!(yield function(){var n=(0,s.Z)(function*(a,o){const u=yield z.getBigInteger();return(o=o||new u(2)).modExp(a.dec(),a).isOne()});return function(a,o){return n.apply(this,arguments)}}()(r))||!(yield function(){var n=(0,s.Z)(function*(a,o,u){const f=yield z.getBigInteger(),w=a.bitLength();o||(o=Math.max(1,w/48|0));const g=a.dec();let b=0;for(;!g.getBit(b);)b++;const L=a.rightShift(new f(b));for(;o>0;o--){let $,j=(u?u():yield Zn(new f(2),g)).modExp(L,a);if(!j.isOne()&&!j.equal(g)){for($=1;$<b;$++){if(j=j.mul(j).mod(a),j.isOne())return!1;if(j.equal(g))break}if($===b)return!1}}return!0});return function(a,o,u){return n.apply(this,arguments)}}()(r,e)));var n}),Es.apply(this,arguments)}const Eu=[7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997,1009,1013,1019,1021,1031,1033,1039,1049,1051,1061,1063,1069,1087,1091,1093,1097,1103,1109,1117,1123,1129,1151,1153,1163,1171,1181,1187,1193,1201,1213,1217,1223,1229,1231,1237,1249,1259,1277,1279,1283,1289,1291,1297,1301,1303,1307,1319,1321,1327,1361,1367,1373,1381,1399,1409,1423,1427,1429,1433,1439,1447,1451,1453,1459,1471,1481,1483,1487,1489,1493,1499,1511,1523,1531,1543,1549,1553,1559,1567,1571,1579,1583,1597,1601,1607,1609,1613,1619,1621,1627,1637,1657,1663,1667,1669,1693,1697,1699,1709,1721,1723,1733,1741,1747,1753,1759,1777,1783,1787,1789,1801,1811,1823,1831,1847,1861,1867,1871,1873,1877,1879,1889,1901,1907,1913,1931,1933,1949,1951,1973,1979,1987,1993,1997,1999,2003,2011,2017,2027,2029,2039,2053,2063,2069,2081,2083,2087,2089,2099,2111,2113,2129,2131,2137,2141,2143,2153,2161,2179,2203,2207,2213,2221,2237,2239,2243,2251,2267,2269,2273,2281,2287,2293,2297,2309,2311,2333,2339,2341,2347,2351,2357,2371,2377,2381,2383,2389,2393,2399,2411,2417,2423,2437,2441,2447,2459,2467,2473,2477,2503,2521,2531,2539,2543,2549,2551,2557,2579,2591,2593,2609,2617,2621,2633,2647,2657,2659,2663,2671,2677,2683,2687,2689,2693,2699,2707,2711,2713,2719,2729,2731,2741,2749,2753,2767,2777,2789,2791,2797,2801,2803,2819,2833,2837,2843,2851,2857,2861,2879,2887,2897,2903,2909,2917,2927,2939,2953,2957,2963,2969,2971,2999,3001,3011,3019,3023,3037,3041,3049,3061,3067,3079,3083,3089,3109,3119,3121,3137,3163,3167,3169,3181,3187,3191,3203,3209,3217,3221,3229,3251,3253,3257,3259,3271,3299,3301,3307,3313,3319,3323,3329,3331,3343,3347,3359,3361,3371,3373,3389,3391,3407,3413,3433,3449,3457,3461,3463,3467,3469,3491,3499,3511,3517,3527,3529,3533,3539,3541,3547,3557,3559,3571,3581,3583,3593,3607,3613,3617,3623,3631,3637,3643,3659,3671,3673,3677,3691,3697,3701,3709,3719,3727,3733,3739,3761,3767,3769,3779,3793,3797,3803,3821,3823,3833,3847,3851,3853,3863,3877,3881,3889,3907,3911,3917,3919,3923,3929,3931,3943,3947,3967,3989,4001,4003,4007,4013,4019,4021,4027,4049,4051,4057,4073,4079,4091,4093,4099,4111,4127,4129,4133,4139,4153,4157,4159,4177,4201,4211,4217,4219,4229,4231,4241,4243,4253,4259,4261,4271,4273,4283,4289,4297,4327,4337,4339,4349,4357,4363,4373,4391,4397,4409,4421,4423,4441,4447,4451,4457,4463,4481,4483,4493,4507,4513,4517,4519,4523,4547,4549,4561,4567,4583,4591,4597,4603,4621,4637,4639,4643,4649,4651,4657,4663,4673,4679,4691,4703,4721,4723,4729,4733,4751,4759,4783,4787,4789,4793,4799,4801,4813,4817,4831,4861,4871,4877,4889,4903,4909,4919,4931,4933,4937,4943,4951,4957,4967,4969,4973,4987,4993,4999],Un=[];function ws(r,t){return Cs.apply(this,arguments)}function Cs(){return Cs=(0,s.Z)(function*(r,t){const e=r.length;if(e>t-11)throw Error("Message too long");const n=yield(o=(0,s.Z)(function*(u){const f=new Uint8Array(u);let w=0;for(;w<u;){const g=yield Pn(u-w);for(let b=0;b<g.length;b++)0!==g[b]&&(f[w++]=g[b])}return f}),function(u){return o.apply(this,arguments)})(t-e-3),a=new Uint8Array(t);var o;return a[1]=2,a.set(n,2),a.set(r,t-e),a}),Cs.apply(this,arguments)}function As(r,t){let e=2,n=1;for(let f=e;f<r.length;f++)n&=0!==r[f],e+=n;const a=e-2,o=r.subarray(e+1),u=0===r[0]&2===r[1]&a>=8&!n;if(t)return z.selectUint8Array(u,o,t);if(u)return o;throw Error("Decryption error")}function Ss(r,t,e){return _s.apply(this,arguments)}function _s(){return _s=(0,s.Z)(function*(r,t,e){let n;if(t.length!==xi.getHashByteLength(r))throw Error("Invalid hash length");const a=new Uint8Array(Un[r].length);for(n=0;n<Un[r].length;n++)a[n]=Un[r][n];const o=a.length+t.length;if(e<o+11)throw Error("Intended encoded message length too short");const u=new Uint8Array(e-o-3).fill(255),f=new Uint8Array(e);return f[1]=1,f.set(u,2),f.set(a,e-o),f.set(t,e-t.length),f}),_s.apply(this,arguments)}Un[1]=[48,32,48,12,6,8,42,134,72,134,247,13,2,5,5,0,4,16],Un[2]=[48,33,48,9,6,5,43,14,3,2,26,5,0,4,20],Un[3]=[48,33,48,9,6,5,43,36,3,2,1,5,0,4,20],Un[8]=[48,49,48,13,6,9,96,134,72,1,101,3,4,2,1,5,0,4,32],Un[9]=[48,65,48,13,6,9,96,134,72,1,101,3,4,2,2,5,0,4,48],Un[10]=[48,81,48,13,6,9,96,134,72,1,101,3,4,2,3,5,0,4,64],Un[11]=[48,45,48,13,6,9,96,134,72,1,101,3,4,2,4,5,0,4,28];var wu=Object.freeze({__proto__:null,emeEncode:ws,emeDecode:As,emsaEncode:Ss});const Ei=z.getWebCrypto(),sn=z.getNodeCrypto(),wi=sn?(void 0).define("RSAPrivateKey",function(){this.seq().obj(this.key("version").int(),this.key("modulus").int(),this.key("publicExponent").int(),this.key("privateExponent").int(),this.key("prime1").int(),this.key("prime2").int(),this.key("exponent1").int(),this.key("exponent2").int(),this.key("coefficient").int())}):void 0,Sa=sn?(void 0).define("RSAPubliceKey",function(){this.seq().obj(this.key("modulus").int(),this.key("publicExponent").int())}):void 0;var Cu=Object.freeze({__proto__:null,sign:function(){var r=(0,s.Z)(function*(t,e,n,a,o,u,f,w,g){if(e&&!z.isStream(e))if(z.getWebCrypto())try{return yield(b=(0,s.Z)(function*(L,$,j,se,pe,xe,Ke,Qe){const Be=yield(He=(0,s.Z)(function*($e,rt,Je,dt,It,Ut){const zt=yield z.getBigInteger(),pt=new zt(dt),Ye=new zt(It),rr=new zt(Je);let ze=rr.mod(Ye.dec()),yt=rr.mod(pt.dec());return yt=yt.toUint8Array(),ze=ze.toUint8Array(),{kty:"RSA",n:Vt($e,!0),e:Vt(rt,!0),d:Vt(Je,!0),p:Vt(It,!0),q:Vt(dt,!0),dp:Vt(ze,!0),dq:Vt(yt,!0),qi:Vt(Ut,!0),ext:!0}}),function($e,rt,Je,dt,It,Ut){return He.apply(this,arguments)})(j,se,pe,xe,Ke,Qe),le={name:"RSASSA-PKCS1-v1_5",hash:{name:L}},Xe=yield Ei.importKey("jwk",Be,le,!1,["sign"]);var He;return new Uint8Array(yield Ei.sign("RSASSA-PKCS1-v1_5",Xe,$))}),function(L,$,j,se,pe,xe,Ke,Qe){return b.apply(this,arguments)})(Z.read(Z.webHash,t),e,n,a,o,u,f,w)}catch(b){z.printDebugError(b)}else if(z.getNodeCrypto())return function(){var b=(0,s.Z)(function*(L,$,j,se,pe,xe,Ke,Qe){const{default:Be}=yield M.e(2983).then(M.bind(M,2983)),le=new Be(xe),Xe=new Be(Ke),He=new Be(pe),$e=He.mod(Xe.subn(1)),rt=He.mod(le.subn(1)),Je=sn.createSign(Z.read(Z.hash,L));Je.write($),Je.end();const dt={version:0,modulus:new Be(j),publicExponent:new Be(se),privateExponent:new Be(pe),prime1:new Be(Ke),prime2:new Be(xe),exponent1:$e,exponent2:rt,coefficient:new Be(Qe)};if(void 0!==sn.createPrivateKey){const Ut=wi.encode(dt,"der");return new Uint8Array(Je.sign({key:Ut,format:"der",type:"pkcs1"}))}const It=wi.encode(dt,"pem",{label:"RSA PRIVATE KEY"});return new Uint8Array(Je.sign(It))});return function(L,$,j,se,pe,xe,Ke,Qe){return b.apply(this,arguments)}}()(t,e,n,a,o,u,f,w);var b;return function(){var b=(0,s.Z)(function*(L,$,j,se){const pe=yield z.getBigInteger();$=new pe($);const xe=new pe(yield Ss(L,se,$.byteLength()));if(j=new pe(j),xe.gte($))throw Error("Message size cannot exceed modulus size");return xe.modExp(j,$).toUint8Array("be",$.byteLength())});return function(L,$,j,se){return b.apply(this,arguments)}}()(t,n,o,g)});return function(e,n,a,o,u,f,w,g,b){return r.apply(this,arguments)}}(),verify:function(){var r=(0,s.Z)(function*(t,e,n,a,o,u){if(e&&!z.isStream(e))if(z.getWebCrypto())try{return yield(f=(0,s.Z)(function*(w,g,b,L,$){const j=(xe=$,{kty:"RSA",n:Vt(L,!0),e:Vt(xe,!0),ext:!0}),se=yield Ei.importKey("jwk",j,{name:"RSASSA-PKCS1-v1_5",hash:{name:w}},!1,["verify"]);var xe;return Ei.verify("RSASSA-PKCS1-v1_5",se,b,g)}),function(w,g,b,L,$){return f.apply(this,arguments)})(Z.read(Z.webHash,t),e,n,a,o)}catch(f){z.printDebugError(f)}else if(z.getNodeCrypto())return function(){var f=(0,s.Z)(function*(w,g,b,L,$){const{default:j}=yield M.e(2983).then(M.bind(M,2983)),se=sn.createVerify(Z.read(Z.hash,w));se.write(g),se.end();const pe={modulus:new j(L),publicExponent:new j($)};let xe;xe=void 0!==sn.createPrivateKey?{key:Sa.encode(pe,"der"),format:"der",type:"pkcs1"}:Sa.encode(pe,"pem",{label:"RSA PUBLIC KEY"});try{return yield se.verify(xe,b)}catch{return!1}});return function(w,g,b,L,$){return f.apply(this,arguments)}}()(t,e,n,a,o);var f;return function(){var f=(0,s.Z)(function*(w,g,b,L,$){const j=yield z.getBigInteger();if(b=new j(b),g=new j(g),L=new j(L),g.gte(b))throw Error("Signature size cannot exceed modulus size");const se=g.modExp(L,b).toUint8Array("be",b.byteLength()),pe=yield Ss(w,$,b.byteLength());return z.equalsUint8Array(se,pe)});return function(w,g,b,L,$){return f.apply(this,arguments)}}()(t,n,a,o,u)});return function(e,n,a,o,u,f){return r.apply(this,arguments)}}(),encrypt:function(){var r=(0,s.Z)(function*(t,e,n){return z.getNodeCrypto()?(a=(0,s.Z)(function*(o,u,f){const{default:w}=yield M.e(2983).then(M.bind(M,2983)),g={modulus:new w(u),publicExponent:new w(f)};let b;return b=void 0!==sn.createPrivateKey?{key:Sa.encode(g,"der"),format:"der",type:"pkcs1",padding:sn.constants.RSA_PKCS1_PADDING}:{key:Sa.encode(g,"pem",{label:"RSA PUBLIC KEY"}),padding:sn.constants.RSA_PKCS1_PADDING},new Uint8Array(sn.publicEncrypt(b,o))}),function(o,u,f){return a.apply(this,arguments)})(t,e,n):function(){var a=(0,s.Z)(function*(o,u,f){const w=yield z.getBigInteger();if(u=new w(u),o=new w(yield ws(o,u.byteLength())),f=new w(f),o.gte(u))throw Error("Message size cannot exceed modulus size");return o.modExp(f,u).toUint8Array("be",u.byteLength())});return function(o,u,f){return a.apply(this,arguments)}}()(t,e,n);var a});return function(e,n,a){return r.apply(this,arguments)}}(),decrypt:function(){var r=(0,s.Z)(function*(t,e,n,a,o,u,f,w){return z.getNodeCrypto()?(g=(0,s.Z)(function*(b,L,$,j,se,pe,xe,Ke){const{default:Qe}=yield M.e(2983).then(M.bind(M,2983)),Be=new Qe(se),le=new Qe(pe),Xe=new Qe(j),He=Xe.mod(le.subn(1)),$e=Xe.mod(Be.subn(1)),rt={version:0,modulus:new Qe(L),publicExponent:new Qe($),privateExponent:new Qe(j),prime1:new Qe(pe),prime2:new Qe(se),exponent1:He,exponent2:$e,coefficient:new Qe(xe)};let Je;Je=void 0!==sn.createPrivateKey?{key:wi.encode(rt,"der"),format:"der",type:"pkcs1",padding:sn.constants.RSA_PKCS1_PADDING}:{key:wi.encode(rt,"pem",{label:"RSA PRIVATE KEY"}),padding:sn.constants.RSA_PKCS1_PADDING};try{return new Uint8Array(sn.privateDecrypt(Je,b))}catch{if(Ke)return Ke;throw Error("Decryption error")}}),function(b,L,$,j,se,pe,xe,Ke){return g.apply(this,arguments)})(t,e,n,a,o,u,f,w):function(){var g=(0,s.Z)(function*(b,L,$,j,se,pe,xe,Ke){const Qe=yield z.getBigInteger();if(b=new Qe(b),L=new Qe(L),$=new Qe($),j=new Qe(j),se=new Qe(se),pe=new Qe(pe),xe=new Qe(xe),b.gte(L))throw Error("Data too large.");const Be=j.mod(pe.dec()),le=j.mod(se.dec()),Xe=(yield Zn(new Qe(2),L)).mod(L),He=Xe.modInv(L).modExp($,L),$e=(b=b.mul(He).mod(L)).modExp(le,se),rt=b.modExp(Be,pe);let Je=xe.mul(rt.sub($e)).mod(pe).mul(se).add($e);return Je=Je.mul(Xe).mod(L),As(Je.toUint8Array("be",L.byteLength()),Ke)});return function(b,L,$,j,se,pe,xe,Ke){return g.apply(this,arguments)}}()(t,e,n,a,o,u,f,w);var g});return function(e,n,a,o,u,f,w,g){return r.apply(this,arguments)}}(),generate:function(){var r=(0,s.Z)(function*(t,e){if(e=new(yield z.getBigInteger())(e),z.getWebCrypto()){const f={name:"RSASSA-PKCS1-v1_5",modulusLength:t,publicExponent:e.toUint8Array(),hash:{name:"SHA-1"}},w=yield Ei.generateKey(f,!0,["sign","verify"]),g=yield Ei.exportKey("jwk",w.privateKey);return{n:_t(g.n),e:e.toUint8Array(),d:_t(g.d),p:_t(g.q),q:_t(g.p),u:_t(g.qi)}}if(z.getNodeCrypto()&&sn.generateKeyPair&&wi){const f={modulusLength:t,publicExponent:e.toNumber(),publicKeyEncoding:{type:"pkcs1",format:"der"},privateKeyEncoding:{type:"pkcs1",format:"der"}},w=yield new Promise((g,b)=>sn.generateKeyPair("rsa",f,(L,$,j)=>{L?b(L):g(wi.decode(j,"der"))}));return{n:w.modulus.toArrayLike(Uint8Array),e:w.publicExponent.toArrayLike(Uint8Array),d:w.privateExponent.toArrayLike(Uint8Array),p:w.prime2.toArrayLike(Uint8Array),q:w.prime1.toArrayLike(Uint8Array),u:w.coefficient.toArrayLike(Uint8Array)}}let n,a,o;do{a=yield mo(t-(t>>1),e,40),n=yield mo(t>>1,e,40),o=n.mul(a)}while(o.bitLength()!==t);const u=n.dec().imul(a.dec());return a.lt(n)&&([n,a]=[a,n]),{n:o.toUint8Array(),e:e.toUint8Array(),d:e.modInv(u).toUint8Array(),p:n.toUint8Array(),q:a.toUint8Array(),u:n.modInv(a).toUint8Array()}});return function(e,n){return r.apply(this,arguments)}}(),validateParams:function(){var r=(0,s.Z)(function*(t,e,n,a,o,u){const f=yield z.getBigInteger();if(t=new f(t),a=new f(a),o=new f(o),!a.mul(o).equal(t))return!1;const w=new f(2);if(u=new f(u),!a.mul(u).mod(o).isOne())return!1;e=new f(e),n=new f(n);const g=new f(Math.floor(t.bitLength()/3)),b=yield Zn(w,w.leftShift(g)),L=b.mul(n).mul(e);return!(!L.mod(a.dec()).equal(b)||!L.mod(o.dec()).equal(b))});return function(e,n,a,o,u,f){return r.apply(this,arguments)}}()}),Au=Object.freeze({__proto__:null,encrypt:function(){var r=(0,s.Z)(function*(t,e,n,a){const o=yield z.getBigInteger();e=new o(e),n=new o(n),a=new o(a);const u=new o(yield ws(t,e.byteLength())),f=yield Zn(new o(1),e.dec());return{c1:n.modExp(f,e).toUint8Array(),c2:a.modExp(f,e).imul(u).imod(e).toUint8Array()}});return function(e,n,a,o){return r.apply(this,arguments)}}(),decrypt:function(){var r=(0,s.Z)(function*(t,e,n,a,o){const u=yield z.getBigInteger();return t=new u(t),e=new u(e),n=new u(n),a=new u(a),As(t.modExp(a,n).modInv(n).imul(e).imod(n).toUint8Array("be",n.byteLength()),o)});return function(e,n,a,o,u){return r.apply(this,arguments)}}(),validateParams:function(){var r=(0,s.Z)(function*(t,e,n,a){const o=yield z.getBigInteger();t=new o(t),e=new o(e),n=new o(n);const u=new o(1);if(e.lte(u)||e.gte(t))return!1;const f=new o(t.bitLength()),w=new o(1023);if(f.lt(w)||!e.modExp(t.dec(),t).isOne())return!1;let g=e;const b=new o(1),L=new o(2).leftShift(new o(17));for(;b.lt(L);){if(g=g.mul(e).imod(t),g.isOne())return!1;b.iinc()}a=new o(a);const $=new o(2),j=yield Zn($.leftShift(f.dec()),$.leftShift(f)),se=t.dec().imul(j).iadd(a);return!!n.equal(e.modExp(se,t))});return function(e,n,a,o){return r.apply(this,arguments)}}()});class Dn{constructor(t){if(t instanceof Dn)this.oid=t.oid;else if(z.isArray(t)||z.isUint8Array(t)){if(6===(t=new Uint8Array(t))[0]){if(t[1]!==t.length-2)throw Error("Length mismatch in DER encoded oid");t=t.subarray(2)}this.oid=t}else this.oid=""}read(t){if(t.length>=1){const e=t[0];if(t.length>=1+e)return this.oid=t.subarray(1,1+e),1+this.oid.length}throw Error("Invalid oid")}write(){return z.concatUint8Array([new Uint8Array([this.oid.length]),this.oid])}toHex(){return z.uint8ArrayToHex(this.oid)}getName(){const t=this.toHex();if(Z.curve[t])return Z.write(Z.curve,t);throw Error("Unknown curve object identifier.")}}function _a(r,t){return r.keyPair({priv:t})}function ka(r,t){const e=r.keyPair({pub:t});if(!0!==e.validate().result)throw Error("Invalid elliptic public key");return e}function Ci(r){return ks.apply(this,arguments)}function ks(){return ks=(0,s.Z)(function*(r){if(!ut.useIndutnyElliptic)throw Error("This curve is only supported in the full build of OpenPGP.js");const{default:t}=yield Promise.all([M.e(2983),M.e(9222)]).then(M.bind(M,9222));return new t.ec(r)}),ks.apply(this,arguments)}function Eo(r){let t,e=0;const n=r[0];return n<192?([e]=r,t=1):n<255?(e=(r[0]-192<<8)+r[1]+192,t=2):255===n&&(e=z.readNumber(r.subarray(1,5)),t=5),{len:e,offset:t}}function Gi(r){return r<192?new Uint8Array([r]):r>191&&r<8384?new Uint8Array([192+(r-192>>8),r-192&255]):z.concatUint8Array([new Uint8Array([255]),z.writeNumber(r,4)])}function Su(r){if(r<0||r>30)throw Error("Partial Length power must be between 1 and 30");return new Uint8Array([224+r])}function wo(r){return new Uint8Array([192|r])}function Co(r,t){return z.concatUint8Array([wo(r),Gi(t)])}function Ta(r){return[Z.packet.literalData,Z.packet.compressedData,Z.packet.symmetricallyEncryptedData,Z.packet.symEncryptedIntegrityProtectedData,Z.packet.aeadEncryptedData].includes(r)}function _u(r,t){return Ts.apply(this,arguments)}function Ts(){return Ts=(0,s.Z)(function*(r,t){const e=Ae(r);let n,a;try{const o=yield e.peekBytes(2);if(!o||o.length<2||0==(128&o[0]))throw Error("Error during parsing. This message / key probably does not conform to a valid OpenPGP format.");const u=yield e.readByte();let f,w,g=-1,b=-1;b=0,0!=(64&u)&&(b=1),b?g=63&u:(g=(63&u)>>2,w=3&u);const L=Ta(g);let $,j=null;if(L){if("array"===z.isStream(r)){const pe=new v;n=Re(pe),j=pe}else{const pe=new D;n=Re(pe.writable),j=pe.readable}a=t({tag:g,packet:j})}else j=[];do{if(b){const pe=yield e.readByte();if($=!1,pe<192)f=pe;else if(pe>=192&&pe<224)f=(pe-192<<8)+(yield e.readByte())+192;else if(pe>223&&pe<255){if(f=1<<(31&pe),$=!0,!L)throw new TypeError("This packet type does not support partial lengths.")}else f=(yield e.readByte())<<24|(yield e.readByte())<<16|(yield e.readByte())<<8|(yield e.readByte())}else switch(w){case 0:f=yield e.readByte();break;case 1:f=(yield e.readByte())<<8|(yield e.readByte());break;case 2:f=(yield e.readByte())<<24|(yield e.readByte())<<16|(yield e.readByte())<<8|(yield e.readByte());break;default:f=1/0}if(f>0){let pe=0;for(;;){n&&(yield n.ready);const{done:xe,value:Ke}=yield e.read();if(xe){if(f===1/0)break;throw Error("Unexpected end of packet")}const Qe=f===1/0?Ke:Ke.subarray(0,f-pe);if(n?yield n.write(Qe):j.push(Qe),pe+=Ke.length,pe>=f){e.unshift(Ke.subarray(f-pe+Ke.length));break}}}}while($);const se=yield e.peekBytes(L?1/0:2);return n?(yield n.ready,yield n.close()):(j=z.concatUint8Array(j),yield t({tag:g,packet:j})),!se||!se.length}catch(o){if(n)return yield n.abort(o),!0;throw o}finally{n&&(yield a),e.releaseLock()}}),Ts.apply(this,arguments)}class Gr extends Error{constructor(...t){super(...t),Error.captureStackTrace&&Error.captureStackTrace(this,Gr),this.name="UnsupportedError"}}class Bs{constructor(t,e){this.tag=t,this.rawContent=e}write(){return this.rawContent}}const Is=z.getWebCrypto(),Ba=z.getNodeCrypto(),Rn={p256:"P-256",p384:"P-384",p521:"P-521"},Gn=Ba?Ba.getCurves():[],Xn=Ba?{secp256k1:Gn.includes("secp256k1")?"secp256k1":void 0,p256:Gn.includes("prime256v1")?"prime256v1":void 0,p384:Gn.includes("secp384r1")?"secp384r1":void 0,p521:Gn.includes("secp521r1")?"secp521r1":void 0,ed25519:Gn.includes("ED25519")?"ED25519":void 0,curve25519:Gn.includes("X25519")?"X25519":void 0,brainpoolP256r1:Gn.includes("brainpoolP256r1")?"brainpoolP256r1":void 0,brainpoolP384r1:Gn.includes("brainpoolP384r1")?"brainpoolP384r1":void 0,brainpoolP512r1:Gn.includes("brainpoolP512r1")?"brainpoolP512r1":void 0}:{},Ia={p256:{oid:[6,8,42,134,72,206,61,3,1,7],keyType:Z.publicKey.ecdsa,hash:Z.hash.sha256,cipher:Z.symmetric.aes128,node:Xn.p256,web:Rn.p256,payloadSize:32,sharedSize:256},p384:{oid:[6,5,43,129,4,0,34],keyType:Z.publicKey.ecdsa,hash:Z.hash.sha384,cipher:Z.symmetric.aes192,node:Xn.p384,web:Rn.p384,payloadSize:48,sharedSize:384},p521:{oid:[6,5,43,129,4,0,35],keyType:Z.publicKey.ecdsa,hash:Z.hash.sha512,cipher:Z.symmetric.aes256,node:Xn.p521,web:Rn.p521,payloadSize:66,sharedSize:528},secp256k1:{oid:[6,5,43,129,4,0,10],keyType:Z.publicKey.ecdsa,hash:Z.hash.sha256,cipher:Z.symmetric.aes128,node:Xn.secp256k1,payloadSize:32},ed25519:{oid:[6,9,43,6,1,4,1,218,71,15,1],keyType:Z.publicKey.eddsa,hash:Z.hash.sha512,node:!1,payloadSize:32},curve25519:{oid:[6,10,43,6,1,4,1,151,85,1,5,1],keyType:Z.publicKey.ecdh,hash:Z.hash.sha256,cipher:Z.symmetric.aes128,node:!1,payloadSize:32},brainpoolP256r1:{oid:[6,9,43,36,3,3,2,8,1,1,7],keyType:Z.publicKey.ecdsa,hash:Z.hash.sha256,cipher:Z.symmetric.aes128,node:Xn.brainpoolP256r1,payloadSize:32},brainpoolP384r1:{oid:[6,9,43,36,3,3,2,8,1,1,11],keyType:Z.publicKey.ecdsa,hash:Z.hash.sha384,cipher:Z.symmetric.aes192,node:Xn.brainpoolP384r1,payloadSize:48},brainpoolP512r1:{oid:[6,9,43,36,3,3,2,8,1,1,13],keyType:Z.publicKey.ecdsa,hash:Z.hash.sha512,cipher:Z.symmetric.aes256,node:Xn.brainpoolP512r1,payloadSize:64}};class jn{constructor(t,e){try{(z.isArray(t)||z.isUint8Array(t))&&(t=new Dn(t)),t instanceof Dn&&(t=t.getName()),this.name=Z.write(Z.curve,t)}catch{throw new Gr("Unknown curve")}this.keyType=(e=e||Ia[this.name]).keyType,this.oid=e.oid,this.hash=e.hash,this.cipher=e.cipher,this.node=e.node&&Ia[this.name],this.web=e.web&&Ia[this.name],this.payloadSize=e.payloadSize,this.web&&z.getWebCrypto()?this.type="web":this.node&&z.getNodeCrypto()?this.type="node":"curve25519"===this.name?this.type="curve25519":"ed25519"===this.name&&(this.type="ed25519")}genKeyPair(){var t=this;return(0,s.Z)(function*(){let e;switch(t.type){case"web":try{return yield(a=(0,s.Z)(function*(o){const u=yield Is.generateKey({name:"ECDSA",namedCurve:Rn[o]},!0,["sign","verify"]),f=yield Is.exportKey("jwk",u.privateKey);return{publicKey:So(yield Is.exportKey("jwk",u.publicKey)),privateKey:_t(f.d)}}),function(o){return a.apply(this,arguments)})(t.name)}catch(a){z.printDebugError("Browser did not support generating ec key "+a.message);break}case"node":return function(){var a=(0,s.Z)(function*(o){const u=Ba.createECDH(Xn[o]);return yield u.generateKeys(),{publicKey:new Uint8Array(u.getPublicKey()),privateKey:new Uint8Array(u.getPrivateKey())}});return function(o){return a.apply(this,arguments)}}()(t.name);case"curve25519":{const a=yield Pn(32);a[0]=127&a[0]|64,a[31]&=248;const o=a.slice().reverse();return e=In.box.keyPair.fromSecretKey(o),{publicKey:z.concatUint8Array([new Uint8Array([64]),e.publicKey]),privateKey:a}}case"ed25519":{const a=yield Pn(32),o=In.sign.keyPair.fromSeed(a);return{publicKey:z.concatUint8Array([new Uint8Array([64]),o.publicKey]),privateKey:a}}}var a;return e=yield(yield Ci(t.name)).genKeyPair({entropy:z.uint8ArrayToString(yield Pn(32))}),{publicKey:new Uint8Array(e.getPublic("array",!1)),privateKey:e.getPrivate().toArrayLike(Uint8Array)}})()}}function Ao(r,t,e,n){return Ps.apply(this,arguments)}function Ps(){return Ps=(0,s.Z)(function*(r,t,e,n){const a={p256:!0,p384:!0,p521:!0,secp256k1:!0,curve25519:r===Z.publicKey.ecdh,brainpoolP256r1:!0,brainpoolP384r1:!0,brainpoolP512r1:!0},o=t.getName();if(!a[o])return!1;if("curve25519"===o){n=n.slice().reverse();const{publicKey:f}=In.box.keyPair.fromSecretKey(n);e=new Uint8Array(e);const w=new Uint8Array([64,...f]);return!!z.equalsUint8Array(w,e)}const u=yield Ci(o);try{e=ka(u,e).getPublic()}catch{return!1}return!!_a(u,n).getPublic().eq(e)}),Ps.apply(this,arguments)}function So(r){const t=_t(r.x),e=_t(r.y),n=new Uint8Array(t.length+e.length+1);return n[0]=4,n.set(t,1),n.set(e,t.length+1),n}function Pa(r,t,e){const n=r,a=e.slice(1,n+1),o=e.slice(n+1,2*n+1);return{kty:"EC",crv:t,x:Vt(a,!0),y:Vt(o,!0),ext:!0}}function _o(r,t,e,n){const a=Pa(r,t,e);return a.d=Vt(n,!0),a}const Ua=z.getWebCrypto(),Ai=z.getNodeCrypto();function ko(r,t,e,n,a,o){return Us.apply(this,arguments)}function Us(){return Us=(0,s.Z)(function*(r,t,e,n,a,o){const u=new jn(r);if(e&&!z.isStream(e)){const f={publicKey:n,privateKey:a};switch(u.type){case"web":try{return yield(w=(0,s.Z)(function*(g,b,L,$){const j=g.payloadSize,se=_o(g.payloadSize,Rn[g.name],$.publicKey,$.privateKey),pe=yield Ua.importKey("jwk",se,{name:"ECDSA",namedCurve:Rn[g.name],hash:{name:Z.read(Z.webHash,g.hash)}},!1,["sign"]),xe=new Uint8Array(yield Ua.sign({name:"ECDSA",namedCurve:Rn[g.name],hash:{name:Z.read(Z.webHash,b)}},pe,L));return{r:xe.slice(0,j),s:xe.slice(j,j<<1)}}),function(g,b,L,$){return w.apply(this,arguments)})(u,t,e,f)}catch(w){if("p521"!==u.name&&("DataError"===w.name||"OperationError"===w.name))throw w;z.printDebugError("Browser did not support signing: "+w.message)}break;case"node":{const w=yield(g=(0,s.Z)(function*(b,L,$,j){const se=Ai.createSign(Z.read(Z.hash,L));se.write($),se.end();const pe=ku.encode({version:1,parameters:b.oid,privateKey:Array.from(j.privateKey),publicKey:{unused:0,data:Array.from(j.publicKey)}},"pem",{label:"EC PRIVATE KEY"});return Bo.decode(se.sign(pe),"der")}),function(b,L,$,j){return g.apply(this,arguments)})(u,t,e,f);return{r:w.r.toArrayLike(Uint8Array),s:w.s.toArrayLike(Uint8Array)}}}}var g,w,f;return(f=(0,s.Z)(function*(w,g,b){const $=_a(yield Ci(w.name),b).sign(g);return{r:$.r.toArrayLike(Uint8Array),s:$.s.toArrayLike(Uint8Array)}}),function(w,g,b){return f.apply(this,arguments)})(u,o,a)}),Us.apply(this,arguments)}function To(r,t,e,n,a,o){return Ds.apply(this,arguments)}function Ds(){return Ds=(0,s.Z)(function*(r,t,e,n,a,o){const u=new jn(r);if(n&&!z.isStream(n))switch(u.type){case"web":try{return yield(f=(0,s.Z)(function*(w,g,{r:b,s:L},$,j){const se=Pa(w.payloadSize,Rn[w.name],j),pe=yield Ua.importKey("jwk",se,{name:"ECDSA",namedCurve:Rn[w.name],hash:{name:Z.read(Z.webHash,w.hash)}},!1,["verify"]),xe=z.concatUint8Array([b,L]).buffer;return Ua.verify({name:"ECDSA",namedCurve:Rn[w.name],hash:{name:Z.read(Z.webHash,g)}},pe,xe,$)}),function(w,g,b,L,$){return f.apply(this,arguments)})(u,t,e,n,a)}catch(f){if("p521"!==u.name&&("DataError"===f.name||"OperationError"===f.name))throw f;z.printDebugError("Browser did not support verifying: "+f.message)}break;case"node":return function(){var f=(0,s.Z)(function*(w,g,{r:b,s:L},$,j){const{default:se}=yield M.e(2983).then(M.bind(M,2983)),pe=Ai.createVerify(Z.read(Z.hash,g));pe.write($),pe.end();const xe=Bu.encode({algorithm:{algorithm:[1,2,840,10045,2,1],parameters:w.oid},subjectPublicKey:{unused:0,data:Array.from(j)}},"pem",{label:"PUBLIC KEY"}),Ke=Bo.encode({r:new se(b),s:new se(L)},"der");try{return pe.verify(xe,Ke)}catch{return!1}});return function(w,g,b,L,$){return f.apply(this,arguments)}}()(u,t,e,n,a)}var f;return function(){var f=(0,s.Z)(function*(w,g,b,L){return ka(yield Ci(w.name),L).verify(b,g)});return function(w,g,b,L){return f.apply(this,arguments)}}()(u,e,void 0===t?n:o,a)}),Ds.apply(this,arguments)}const Da=void 0,Bo=Ai?Da.define("ECDSASignature",function(){this.seq().obj(this.key("r").int(),this.key("s").int())}):void 0,ku=Ai?Da.define("ECPrivateKey",function(){this.seq().obj(this.key("version").int(),this.key("privateKey").octstr(),this.key("parameters").explicit(0).optional().any(),this.key("publicKey").explicit(1).optional().bitstr())}):void 0,Tu=Ai?Da.define("AlgorithmIdentifier",function(){this.seq().obj(this.key("algorithm").objid(),this.key("parameters").optional().any())}):void 0,Bu=Ai?Da.define("SubjectPublicKeyInfo",function(){this.seq().obj(this.key("algorithm").use(Tu),this.key("subjectPublicKey").bitstr())}):void 0;var Iu=Object.freeze({__proto__:null,sign:ko,verify:To,validateParams:function(){var r=(0,s.Z)(function*(t,e,n){const a=new jn(t);if(a.keyType!==Z.publicKey.ecdsa)return!1;switch(a.type){case"web":case"node":{const o=yield Pn(8),u=Z.hash.sha256,f=yield xi.digest(u,o);try{const w=yield ko(t,u,o,e,n,f);return yield To(t,u,w,o,e,f)}catch{return!1}}default:return Ao(Z.publicKey.ecdsa,t,e,n)}});return function(e,n,a){return r.apply(this,arguments)}}()});In.hash=r=>new Uint8Array(zi().update(r).digest());var Pu=Object.freeze({__proto__:null,sign:function(){var r=(0,s.Z)(function*(t,e,n,a,o,u){if(xi.getHashByteLength(e)<xi.getHashByteLength(Z.hash.sha256))throw Error("Hash algorithm too weak: sha256 or stronger is required for EdDSA.");const f=z.concatUint8Array([o,a.subarray(1)]),w=In.sign.detached(u,f);return{r:w.subarray(0,32),s:w.subarray(32)}});return function(e,n,a,o,u,f){return r.apply(this,arguments)}}(),verify:function(){var r=(0,s.Z)(function*(t,e,{r:n,s:a},o,u,f){const w=z.concatUint8Array([n,a]);return In.sign.detached.verify(f,w,u.subarray(1))});return function(e,n,a,o,u,f){return r.apply(this,arguments)}}(),validateParams:function(){var r=(0,s.Z)(function*(t,e,n){if("ed25519"!==t.getName())return!1;const{publicKey:a}=In.sign.keyPair.fromSeed(n),o=new Uint8Array([64,...a]);return z.equalsUint8Array(e,o)});return function(e,n,a){return r.apply(this,arguments)}}()});function Io(r,t){const e=new cn["aes"+8*r.length](r),n=new Uint32Array([2795939494,2795939494]),a=Ra(t);let o=n;const u=a,f=a.length/2,w=new Uint32Array([0,0]);let g=new Uint32Array(4);for(let b=0;b<=5;++b)for(let L=0;L<f;++L)w[1]=f*b+(1+L),g[0]=o[0],g[1]=o[1],g[2]=u[2*L],g[3]=u[2*L+1],g=Ra(e.encrypt(Na(g))),o=g.subarray(0,2),o[0]^=w[0],o[1]^=w[1],u[2*L]=g[2],u[2*L+1]=g[3];return Na(o,u)}function Po(r,t){const e=new cn["aes"+8*r.length](r),n=new Uint32Array([2795939494,2795939494]),a=Ra(t);let o=a.subarray(0,2);const u=a.subarray(2),f=a.length/2-1,w=new Uint32Array([0,0]);let g=new Uint32Array(4);for(let b=5;b>=0;--b)for(let L=f-1;L>=0;--L)w[1]=f*b+(L+1),g[0]=o[0]^w[0],g[1]=o[1]^w[1],g[2]=u[2*L],g[3]=u[2*L+1],g=Ra(e.decrypt(Na(g))),o=g.subarray(0,2),u[2*L]=g[2],u[2*L+1]=g[3];if(o[0]===n[0]&&o[1]===n[1])return Na(u);throw Error("Key Data Integrity failed")}function Ra(r){const{length:t}=r,e=function(o){if(z.isString(o)){const{length:u}=o,f=new ArrayBuffer(u),w=new Uint8Array(f);for(let g=0;g<u;++g)w[g]=o.charCodeAt(g);return f}return new Uint8Array(o).buffer}(r),n=new DataView(e),a=new Uint32Array(t/4);for(let o=0;o<t/4;++o)a[o]=n.getUint32(4*o);return a}function Na(){let r=0;for(let a=0;a<arguments.length;++a)r+=4*arguments[a].length;const t=new ArrayBuffer(r),e=new DataView(t);let n=0;for(let a=0;a<arguments.length;++a){for(let o=0;o<arguments[a].length;++o)e.setUint32(n+4*o,arguments[a][o]);n+=4*arguments[a].length}return new Uint8Array(t)}var Uu=Object.freeze({__proto__:null,wrap:Io,unwrap:Po});function Uo(r){const t=8-r.length%8,e=new Uint8Array(r.length+t).fill(t);return e.set(r),e}function Do(r){const t=r.length;if(t>0){const e=r[t-1];if(e>=1){const n=r.subarray(t-e),a=new Uint8Array(e).fill(e);if(z.equalsUint8Array(n,a))return r.subarray(0,t-e)}}throw Error("Invalid padding")}var Du=Object.freeze({__proto__:null,encode:Uo,decode:Do});const qn=z.getWebCrypto(),Ro=z.getNodeCrypto();function No(r,t,e,n){return z.concatUint8Array([t.write(),new Uint8Array([r]),e.write(),z.stringToUint8Array("Anonymous Sender    "),n.subarray(0,20)])}function Lo(r,t,e,n){return Rs.apply(this,arguments)}function Rs(){return Rs=(0,s.Z)(function*(r,t,e,n,a=!1,o=!1){let u;if(a){for(u=0;u<t.length&&0===t[u];u++);t=t.subarray(u)}if(o){for(u=t.length-1;u>=0&&0===t[u];u--);t=t.subarray(0,u+1)}return(yield xi.digest(r,z.concatUint8Array([new Uint8Array([0,0,0,1]),t,n]))).subarray(0,e)}),Rs.apply(this,arguments)}function Ns(){return Ns=(0,s.Z)(function*(r,t){switch(r.type){case"curve25519":{const e=yield Pn(32),{secretKey:n,sharedKey:a}=yield Ko(r,t,null,e);let{publicKey:o}=In.box.keyPair.fromSecretKey(n);return o=z.concatUint8Array([new Uint8Array([64]),o]),{publicKey:o,sharedKey:a}}case"web":if(r.web&&z.getWebCrypto())try{return yield(e=(0,s.Z)(function*(n,a){const o=Pa(n.payloadSize,n.web.web,a);let u=qn.generateKey({name:"ECDH",namedCurve:n.web.web},!0,["deriveKey","deriveBits"]),f=qn.importKey("jwk",o,{name:"ECDH",namedCurve:n.web.web},!1,[]);[u,f]=yield Promise.all([u,f]);let w=qn.deriveBits({name:"ECDH",namedCurve:n.web.web,public:f},u.privateKey,n.web.sharedSize),g=qn.exportKey("jwk",u.publicKey);[w,g]=yield Promise.all([w,g]);const b=new Uint8Array(w);return{publicKey:new Uint8Array(So(g)),sharedKey:b}}),function(n,a){return e.apply(this,arguments)})(r,t)}catch(e){z.printDebugError(e)}break;case"node":return function(){var e=(0,s.Z)(function*(n,a){const o=Ro.createECDH(n.node.node);o.generateKeys();const u=new Uint8Array(o.computeSecret(a));return{publicKey:new Uint8Array(o.getPublicKey()),sharedKey:u}});return function(n,a){return e.apply(this,arguments)}}()(r,t)}var e;return function(){var e=(0,s.Z)(function*(n,a){const o=yield Ci(n.name),u=yield n.genKeyPair();a=ka(o,a);const f=_a(o,u.privateKey),w=u.publicKey,g=f.derive(a.getPublic()),b=o.curve.p.byteLength();return{publicKey:w,sharedKey:g.toArrayLike(Uint8Array,"be",b)}});return function(n,a){return e.apply(this,arguments)}}()(r,t)}),Ns.apply(this,arguments)}function Ko(r,t,e,n){return Ls.apply(this,arguments)}function Ls(){return Ls=(0,s.Z)(function*(r,t,e,n){if(n.length!==r.payloadSize){const a=new Uint8Array(r.payloadSize);a.set(n,r.payloadSize-n.length),n=a}switch(r.type){case"curve25519":{const a=n.slice().reverse();return{secretKey:a,sharedKey:In.scalarMult(a,t.subarray(1))}}case"web":if(r.web&&z.getWebCrypto())try{return yield(a=(0,s.Z)(function*(o,u,f,w){const g=_o(o.payloadSize,o.web.web,f,w);let b=qn.importKey("jwk",g,{name:"ECDH",namedCurve:o.web.web},!0,["deriveKey","deriveBits"]);const L=Pa(o.payloadSize,o.web.web,u);let $=qn.importKey("jwk",L,{name:"ECDH",namedCurve:o.web.web},!0,[]);[b,$]=yield Promise.all([b,$]);let j=qn.deriveBits({name:"ECDH",namedCurve:o.web.web,public:$},b,o.web.sharedSize),se=qn.exportKey("jwk",b);[j,se]=yield Promise.all([j,se]);const pe=new Uint8Array(j);return{secretKey:_t(se.d),sharedKey:pe}}),function(o,u,f,w){return a.apply(this,arguments)})(r,t,e,n)}catch(a){z.printDebugError(a)}break;case"node":return function(){var a=(0,s.Z)(function*(o,u,f){const w=Ro.createECDH(o.node.node);w.setPrivateKey(f);const g=new Uint8Array(w.computeSecret(u));return{secretKey:new Uint8Array(w.getPrivateKey()),sharedKey:g}});return function(o,u,f){return a.apply(this,arguments)}}()(r,t,n)}var a;return function(){var a=(0,s.Z)(function*(o,u,f){const w=yield Ci(o.name);u=ka(w,u),f=_a(w,f);const g=new Uint8Array(f.getPrivate()),b=f.derive(u.getPublic()),L=w.curve.p.byteLength();return{secretKey:g,sharedKey:b.toArrayLike(Uint8Array,"be",L)}});return function(o,u,f){return a.apply(this,arguments)}}()(r,t,n)}),Ls.apply(this,arguments)}var Nu=Object.freeze({__proto__:null,validateParams:function(){var r=(0,s.Z)(function*(t,e,n){return Ao(Z.publicKey.ecdh,t,e,n)});return function(e,n,a){return r.apply(this,arguments)}}(),encrypt:function(){var r=(0,s.Z)(function*(t,e,n,a,o){const u=Uo(n),f=new jn(t),{publicKey:w,sharedKey:g}=yield function Ru(r,t){return Ns.apply(this,arguments)}(f,a),b=No(Z.publicKey.ecdh,t,e,o),{keySize:L}=Si(e.cipher);return{publicKey:w,wrappedKey:Io(yield Lo(e.hash,g,L,b),u)}});return function(e,n,a,o,u){return r.apply(this,arguments)}}(),decrypt:function(){var r=(0,s.Z)(function*(t,e,n,a,o,u,f){const w=new jn(t),{sharedKey:g}=yield Ko(w,n,o,u),b=No(Z.publicKey.ecdh,t,e,f),{keySize:L}=Si(e.cipher);let $;for(let j=0;j<3;j++)try{return Do(Po(yield Lo(e.hash,g,L,b,1===j,2===j),a))}catch(se){$=se}throw $});return function(e,n,a,o,u,f,w){return r.apply(this,arguments)}}()}),Nr={rsa:Cu,elgamal:Au,elliptic:Object.freeze({__proto__:null,Curve:jn,ecdh:Nu,ecdsa:Iu,eddsa:Pu,generate:function(){var r=(0,s.Z)(function*(t){const e=yield z.getBigInteger();t=new jn(t);const n=yield t.genKeyPair(),a=new e(n.publicKey).toUint8Array(),o=new e(n.privateKey).toUint8Array("be",t.payloadSize);return{oid:t.oid,Q:a,secret:o,hash:t.hash,cipher:t.cipher}});return function(e){return r.apply(this,arguments)}}(),getPreferredHashAlgo:function(r){return Ia[Z.write(Z.curve,r.toHex())].hash}}),dsa:Object.freeze({__proto__:null,sign:function(){var r=(0,s.Z)(function*(t,e,n,a,o,u){const f=yield z.getBigInteger(),w=new f(1);let g,b,L,$;a=new f(a),o=new f(o),n=new f(n),u=new f(u),n=n.mod(a),u=u.mod(o);const j=new f(e.subarray(0,o.byteLength())).mod(o);for(;;){if(g=yield Zn(w,o),b=n.modExp(g,a).imod(o),b.isZero())continue;const se=u.mul(b).imod(o);if($=j.add(se).imod(o),L=g.modInv(o).imul($).imod(o),!L.isZero())break}return{r:b.toUint8Array("be",o.byteLength()),s:L.toUint8Array("be",o.byteLength())}});return function(e,n,a,o,u,f){return r.apply(this,arguments)}}(),verify:function(){var r=(0,s.Z)(function*(t,e,n,a,o,u,f,w){const g=yield z.getBigInteger(),b=new g(0);if(e=new g(e),n=new g(n),u=new g(u),f=new g(f),o=new g(o),w=new g(w),e.lte(b)||e.gte(f)||n.lte(b)||n.gte(f))return z.printDebug("invalid DSA Signature"),!1;const L=new g(a.subarray(0,f.byteLength())).imod(f),$=n.modInv(f);if($.isZero())return z.printDebug("invalid DSA Signature"),!1;o=o.mod(u),w=w.mod(u);const j=L.mul($).imod(f),se=e.mul($).imod(f),pe=o.modExp(j,u),xe=w.modExp(se,u);return pe.mul(xe).imod(u).imod(f).equal(e)});return function(e,n,a,o,u,f,w,g){return r.apply(this,arguments)}}(),validateParams:function(){var r=(0,s.Z)(function*(t,e,n,a,o){const u=yield z.getBigInteger();t=new u(t),e=new u(e),n=new u(n),a=new u(a);const f=new u(1);if(n.lte(f)||n.gte(t)||!t.dec().mod(e).isZero()||!n.modExp(e,t).isOne())return!1;const w=new u(e.bitLength()),g=new u(150);if(w.lt(g)||!(yield xo(e,null,32)))return!1;o=new u(o);const b=new u(2),L=yield Zn(b.leftShift(w.dec()),b.leftShift(w)),$=e.mul(L).add(o);return!!a.equal(n.modExp($,t))});return function(e,n,a,o,u){return r.apply(this,arguments)}}()}),nacl:In};class Oo{constructor(t){t=void 0===t?new Uint8Array([]):z.isString(t)?z.stringToUint8Array(t):new Uint8Array(t),this.data=t}read(t){if(t.length>=1){const e=t[0];if(t.length>=1+e)return this.data=t.subarray(1,1+e),1+this.data.length}throw Error("Invalid symmetric key")}write(){return z.concatUint8Array([new Uint8Array([this.data.length]),this.data])}}class Mo{constructor(t){if(t){const{hash:e,cipher:n}=t;this.hash=e,this.cipher=n}else this.hash=null,this.cipher=null}read(t){if(t.length<4||3!==t[0]||1!==t[1])throw Error("Cannot read KDFParams");return this.hash=t[2],this.cipher=t[3],4}write(){return new Uint8Array([3,1,this.hash,this.cipher])}}function Si(r){const t=Z.read(Z.symmetric,r);return cn[t]}function Ks(r){try{r.getName()}catch{throw new Gr("Unknown curve OID")}}var Lu=Object.freeze({__proto__:null,publicKeyEncrypt:function(){var r=(0,s.Z)(function*(t,e,n,a){switch(t){case Z.publicKey.rsaEncrypt:case Z.publicKey.rsaEncryptSign:{const{n:o,e:u}=e;return{c:yield Nr.rsa.encrypt(n,o,u)}}case Z.publicKey.elgamal:{const{p:o,g:u,y:f}=e;return Nr.elgamal.encrypt(n,o,u,f)}case Z.publicKey.ecdh:{const{oid:o,Q:u,kdfParams:f}=e,{publicKey:w,wrappedKey:g}=yield Nr.elliptic.ecdh.encrypt(o,f,n,u,a);return{V:w,C:new Oo(g)}}default:return[]}});return function(e,n,a,o){return r.apply(this,arguments)}}(),publicKeyDecrypt:function(){var r=(0,s.Z)(function*(t,e,n,a,o,u){switch(t){case Z.publicKey.rsaEncryptSign:case Z.publicKey.rsaEncrypt:{const{c:f}=a,{n:w,e:g}=e,{d:b,p:L,q:$,u:j}=n;return Nr.rsa.decrypt(f,w,g,b,L,$,j,u)}case Z.publicKey.elgamal:{const{c1:f,c2:w}=a;return Nr.elgamal.decrypt(f,w,e.p,n.x,u)}case Z.publicKey.ecdh:{const{oid:f,Q:w,kdfParams:g}=e,{d:b}=n,{V:L,C:$}=a;return Nr.elliptic.ecdh.decrypt(f,g,L,$.data,w,b,o)}default:throw Error("Unknown public key encryption algorithm.")}});return function(e,n,a,o,u,f){return r.apply(this,arguments)}}(),parsePublicKeyParams:function(r,t){let e=0;switch(r){case Z.publicKey.rsaEncrypt:case Z.publicKey.rsaEncryptSign:case Z.publicKey.rsaSign:{const n=z.readMPI(t.subarray(e));e+=n.length+2;const a=z.readMPI(t.subarray(e));return e+=a.length+2,{read:e,publicParams:{n,e:a}}}case Z.publicKey.dsa:{const n=z.readMPI(t.subarray(e));e+=n.length+2;const a=z.readMPI(t.subarray(e));e+=a.length+2;const o=z.readMPI(t.subarray(e));e+=o.length+2;const u=z.readMPI(t.subarray(e));return e+=u.length+2,{read:e,publicParams:{p:n,q:a,g:o,y:u}}}case Z.publicKey.elgamal:{const n=z.readMPI(t.subarray(e));e+=n.length+2;const a=z.readMPI(t.subarray(e));e+=a.length+2;const o=z.readMPI(t.subarray(e));return e+=o.length+2,{read:e,publicParams:{p:n,g:a,y:o}}}case Z.publicKey.ecdsa:{const n=new Dn;e+=n.read(t),Ks(n);const a=z.readMPI(t.subarray(e));return e+=a.length+2,{read:e,publicParams:{oid:n,Q:a}}}case Z.publicKey.eddsa:{const n=new Dn;e+=n.read(t),Ks(n);let a=z.readMPI(t.subarray(e));return e+=a.length+2,a=z.leftPad(a,33),{read:e,publicParams:{oid:n,Q:a}}}case Z.publicKey.ecdh:{const n=new Dn;e+=n.read(t),Ks(n);const a=z.readMPI(t.subarray(e));e+=a.length+2;const o=new Mo;return e+=o.read(t.subarray(e)),{read:e,publicParams:{oid:n,Q:a,kdfParams:o}}}default:throw new Gr("Unknown public key encryption algorithm.")}},parsePrivateKeyParams:function(r,t,e){let n=0;switch(r){case Z.publicKey.rsaEncrypt:case Z.publicKey.rsaEncryptSign:case Z.publicKey.rsaSign:{const a=z.readMPI(t.subarray(n));n+=a.length+2;const o=z.readMPI(t.subarray(n));n+=o.length+2;const u=z.readMPI(t.subarray(n));n+=u.length+2;const f=z.readMPI(t.subarray(n));return n+=f.length+2,{read:n,privateParams:{d:a,p:o,q:u,u:f}}}case Z.publicKey.dsa:case Z.publicKey.elgamal:{const a=z.readMPI(t.subarray(n));return n+=a.length+2,{read:n,privateParams:{x:a}}}case Z.publicKey.ecdsa:case Z.publicKey.ecdh:{const a=new jn(e.oid);let o=z.readMPI(t.subarray(n));return n+=o.length+2,o=z.leftPad(o,a.payloadSize),{read:n,privateParams:{d:o}}}case Z.publicKey.eddsa:{const a=new jn(e.oid);let o=z.readMPI(t.subarray(n));return n+=o.length+2,o=z.leftPad(o,a.payloadSize),{read:n,privateParams:{seed:o}}}default:throw new Gr("Unknown public key encryption algorithm.")}},parseEncSessionKeyParams:function(r,t){let e=0;switch(r){case Z.publicKey.rsaEncrypt:case Z.publicKey.rsaEncryptSign:return{c:z.readMPI(t.subarray(e))};case Z.publicKey.elgamal:{const n=z.readMPI(t.subarray(e));return e+=n.length+2,{c1:n,c2:z.readMPI(t.subarray(e))}}case Z.publicKey.ecdh:{const n=z.readMPI(t.subarray(e));e+=n.length+2;const a=new Oo;return a.read(t.subarray(e)),{V:n,C:a}}default:throw new Gr("Unknown public key encryption algorithm.")}},serializeParams:function(r,t){const e=Object.keys(t).map(n=>{const a=t[n];return z.isUint8Array(a)?z.uint8ArrayToMPI(a):a.write()});return z.concatUint8Array(e)},generateParams:function(r,t,e){switch(r){case Z.publicKey.rsaEncrypt:case Z.publicKey.rsaEncryptSign:case Z.publicKey.rsaSign:return Nr.rsa.generate(t,65537).then(({n,e:a,d:o,p:u,q:f,u:w})=>({privateParams:{d:o,p:u,q:f,u:w},publicParams:{n,e:a}}));case Z.publicKey.ecdsa:return Nr.elliptic.generate(e).then(({oid:n,Q:a,secret:o})=>({privateParams:{d:o},publicParams:{oid:new Dn(n),Q:a}}));case Z.publicKey.eddsa:return Nr.elliptic.generate(e).then(({oid:n,Q:a,secret:o})=>({privateParams:{seed:o},publicParams:{oid:new Dn(n),Q:a}}));case Z.publicKey.ecdh:return Nr.elliptic.generate(e).then(({oid:n,Q:a,secret:o,hash:u,cipher:f})=>({privateParams:{d:o},publicParams:{oid:new Dn(n),Q:a,kdfParams:new Mo({hash:u,cipher:f})}}));case Z.publicKey.dsa:case Z.publicKey.elgamal:throw Error("Unsupported algorithm for key generation.");default:throw Error("Unknown public key algorithm.")}},validateParams:function(){var r=(0,s.Z)(function*(t,e,n){if(!e||!n)throw Error("Missing key parameters");switch(t){case Z.publicKey.rsaEncrypt:case Z.publicKey.rsaEncryptSign:case Z.publicKey.rsaSign:{const{n:a,e:o}=e,{d:u,p:f,q:w,u:g}=n;return Nr.rsa.validateParams(a,o,u,f,w,g)}case Z.publicKey.dsa:{const{p:a,q:o,g:u,y:f}=e,{x:w}=n;return Nr.dsa.validateParams(a,o,u,f,w)}case Z.publicKey.elgamal:{const{p:a,g:o,y:u}=e,{x:f}=n;return Nr.elgamal.validateParams(a,o,u,f)}case Z.publicKey.ecdsa:case Z.publicKey.ecdh:{const a=Nr.elliptic[Z.read(Z.publicKey,t)],{oid:o,Q:u}=e,{d:f}=n;return a.validateParams(o,u,f)}case Z.publicKey.eddsa:{const{oid:a,Q:o}=e,{seed:u}=n;return Nr.elliptic.eddsa.validateParams(a,o,u)}default:throw Error("Unknown public key algorithm.")}});return function(e,n,a){return r.apply(this,arguments)}}(),getPrefixRandom:function(){var r=(0,s.Z)(function*(t){const{blockSize:e}=Si(t),n=yield Pn(e),a=new Uint8Array([n[n.length-2],n[n.length-1]]);return z.concat([n,a])});return function(e){return r.apply(this,arguments)}}(),generateSessionKey:function(r){const{keySize:t}=Si(r);return Pn(t)},getAEADMode:function(r){const t=Z.read(Z.aead,r);return Qo[t]},getCipher:Si});const Fo=z.getWebCrypto(),La=z.getNodeCrypto(),li=La?La.getCiphers():[],Ka={idea:li.includes("idea-cfb")?"idea-cfb":void 0,tripledes:li.includes("des-ede3-cfb")?"des-ede3-cfb":void 0,cast5:li.includes("cast5-cfb")?"cast5-cfb":void 0,blowfish:li.includes("bf-cfb")?"bf-cfb":void 0,aes128:li.includes("aes-128-cfb")?"aes-128-cfb":void 0,aes192:li.includes("aes-192-cfb")?"aes-192-cfb":void 0,aes256:li.includes("aes-256-cfb")?"aes-256-cfb":void 0};var Ku=Object.freeze({__proto__:null,encrypt:function(){var r=(0,s.Z)(function*(t,e,n,a,o){const u=Z.read(Z.symmetric,t);if(z.getNodeCrypto()&&Ka[u])return function($,j,se,pe){const xe=Z.read(Z.symmetric,$),Ke=new La.createCipheriv(Ka[xe],j,pe);return Ze(se,Qe=>new Uint8Array(Ke.update(Qe)))}(t,e,n,a);if("aes"===u.substr(0,3))return function($,j,se,pe,xe){if(z.getWebCrypto()&&24!==j.length&&!z.isStream(se)&&se.length>=3e3*xe.minBytesForWebCrypto)return(Qe=(0,s.Z)(function*(Be,le,Xe,He){const $e="AES-CBC",rt=yield Fo.importKey("raw",le,{name:$e},!1,["encrypt"]),{blockSize:Je}=Si(Be),dt=z.concatUint8Array([new Uint8Array(Je),Xe]),It=new Uint8Array(yield Fo.encrypt({name:$e,iv:He},rt,dt)).subarray(0,Xe.length);return function(Ut,zt){for(let pt=0;pt<Ut.length;pt++)Ut[pt]=Ut[pt]^zt[pt]}(It,Xe),It}),function(Be,le,Xe,He){return Qe.apply(this,arguments)})($,j,se,pe);var Qe;const Ke=new bi(j,pe);return Ze(se,Qe=>Ke.aes.AES_Encrypt_process(Qe),()=>Ke.aes.AES_Encrypt_finish())}(t,e,n,a,o);const f=new cn[u](e),w=f.blockSize,g=a.slice();let b=new Uint8Array;const L=$=>{$&&(b=z.concatUint8Array([b,$]));const j=new Uint8Array(b.length);let se,pe=0;for(;$?b.length>=w:b.length;){const xe=f.encrypt(g);for(se=0;se<w;se++)g[se]=b[se]^xe[se],j[pe++]=g[se];b=b.subarray(w)}return j.subarray(0,pe)};return Ze(n,L,L)});return function(e,n,a,o,u){return r.apply(this,arguments)}}(),decrypt:function(){var r=(0,s.Z)(function*(t,e,n,a){const o=Z.read(Z.symmetric,t);if(z.getNodeCrypto()&&Ka[o])return function(L,$,j,se){const pe=Z.read(Z.symmetric,L),xe=new La.createDecipheriv(Ka[pe],$,se);return Ze(j,Ke=>new Uint8Array(xe.update(Ke)))}(t,e,n,a);if("aes"===o.substr(0,3))return function(L,$,j,se){if(z.isStream(j)){const pe=new bi($,se);return Ze(j,xe=>pe.aes.AES_Decrypt_process(xe),()=>pe.aes.AES_Decrypt_finish())}return bi.decrypt(j,$,se)}(0,e,n,a);const u=new cn[o](e),f=u.blockSize;let w=a,g=new Uint8Array;const b=L=>{L&&(g=z.concatUint8Array([g,L]));const $=new Uint8Array(g.length);let j,se=0;for(;L?g.length>=f:g.length;){const pe=u.encrypt(w);for(w=g,j=0;j<f;j++)$[se++]=w[j]^pe[j];g=g.subarray(f)}return $.subarray(0,se)};return Ze(n,b,b)});return function(e,n,a,o){return r.apply(this,arguments)}}()});class Oa{static encrypt(t,e,n){return new Oa(e,n).encrypt(t)}static decrypt(t,e,n){return new Oa(e,n).encrypt(t)}constructor(t,e,n){this.aes=n||new dr(t,void 0,!1,"CTR"),delete this.aes.padding,this.AES_CTR_set_options(e)}encrypt(t){return cr(this.aes.AES_Encrypt_process(t),this.aes.AES_Encrypt_finish())}decrypt(t){return cr(this.aes.AES_Encrypt_process(t),this.aes.AES_Encrypt_finish())}AES_CTR_set_options(t,e,n){let{asm:a}=this.aes.acquire_asm();if(void 0!==n){if(n<8||n>48)throw new Hr("illegal counter size");let o=Math.pow(2,n)-1;a.set_mask(0,0,o/4294967296|0,0|o)}else n=48,a.set_mask(0,0,65535,4294967295);if(void 0===t)throw Error("nonce is required");{let o=t.length;if(!o||o>16)throw new Hr("illegal nonce size");let u=new DataView(new ArrayBuffer(16));new Uint8Array(u.buffer).set(t),a.set_nonce(u.getUint32(0),u.getUint32(4),u.getUint32(8),u.getUint32(12))}if(void 0!==e){if(e<0||e>=Math.pow(2,n))throw new Hr("illegal counter value");a.set_counter(0,0,e/4294967296|0,0|e)}}}class Ma{static encrypt(t,e,n=!0,a){return new Ma(e,a,n).encrypt(t)}static decrypt(t,e,n=!0,a){return new Ma(e,a,n).decrypt(t)}constructor(t,e,n=!0,a){this.aes=a||new dr(t,e,n,"CBC")}encrypt(t){return cr(this.aes.AES_Encrypt_process(t),this.aes.AES_Encrypt_finish())}decrypt(t){return cr(this.aes.AES_Decrypt_process(t),this.aes.AES_Decrypt_finish())}}const Ho=z.getWebCrypto(),Ou=z.getNodeCrypto();function Vo(r,t){const e=r.length-16;for(let n=0;n<16;n++)r[n+e]^=t[n];return r}const Fa=new Uint8Array(16);function Mu(r){return Os.apply(this,arguments)}function Os(){return Os=(0,s.Z)(function*(r){const t=yield(a=(0,s.Z)(function*(o){return z.getWebCrypto()&&24!==o.length?(o=yield Ho.importKey("raw",o,{name:"AES-CBC",length:8*o.length},!1,["encrypt"]),function(){var u=(0,s.Z)(function*(f){const w=yield Ho.encrypt({name:"AES-CBC",iv:Fa,length:128},o,f);return new Uint8Array(w).subarray(0,w.byteLength-16)});return function(f){return u.apply(this,arguments)}}()):z.getNodeCrypto()?function(){var u=(0,s.Z)(function*(f){const w=new Ou.createCipheriv("aes-"+8*o.length+"-cbc",o,Fa).update(f);return new Uint8Array(w)});return function(f){return u.apply(this,arguments)}}():function(){var u=(0,s.Z)(function*(f){return Ma.encrypt(f,o,!1,Fa)});return function(f){return u.apply(this,arguments)}}()}),function(o){return a.apply(this,arguments)})(r),e=z.double(yield t(Fa)),n=z.double(e);var a;return function(){var a=(0,s.Z)(function*(o){return(yield t(function(u,f,w){if(u.length&&u.length%16==0)return Vo(u,f);const g=new Uint8Array(u.length+(16-u.length%16));return g.set(u),g[u.length]=128,Vo(g,w)}(o,e,n))).subarray(-16)});return function(o){return a.apply(this,arguments)}}()}),Os.apply(this,arguments)}const zo=z.getWebCrypto(),Fu=z.getNodeCrypto(),Hu=z.getNodeBuffer(),Zo=new Uint8Array(16),Ms=new Uint8Array(16);Ms[15]=1;const Fs=new Uint8Array(16);function Vu(r){return Hs.apply(this,arguments)}function Hs(){return Hs=(0,s.Z)(function*(r){const t=yield Mu(r);return function(e,n){return t(z.concatUint8Array([e,n]))}}),Hs.apply(this,arguments)}function zu(r){return Vs.apply(this,arguments)}function Vs(){return Vs=(0,s.Z)(function*(r){return z.getWebCrypto()&&24!==r.length?(r=yield zo.importKey("raw",r,{name:"AES-CTR",length:8*r.length},!1,["encrypt"]),function(){var t=(0,s.Z)(function*(e,n){const a=yield zo.encrypt({name:"AES-CTR",counter:n,length:128},r,e);return new Uint8Array(a)});return function(e,n){return t.apply(this,arguments)}}()):z.getNodeCrypto()?function(){var t=(0,s.Z)(function*(e,n){const a=new Fu.createCipheriv("aes-"+8*r.length+"-ctr",r,n),o=Hu.concat([a.update(e),a.final()]);return new Uint8Array(o)});return function(e,n){return t.apply(this,arguments)}}():function(){var t=(0,s.Z)(function*(e,n){return Oa.encrypt(e,r,n)});return function(e,n){return t.apply(this,arguments)}}()}),Vs.apply(this,arguments)}function ji(r,t){return zs.apply(this,arguments)}function zs(){return zs=(0,s.Z)(function*(r,t){if(r!==Z.symmetric.aes128&&r!==Z.symmetric.aes192&&r!==Z.symmetric.aes256)throw Error("EAX mode supports only AES cipher");const[e,n]=yield Promise.all([Vu(t),zu(t)]);return{encrypt:(a=(0,s.Z)(function*(o,u,f){const[w,g]=yield Promise.all([e(Zo,u),e(Ms,f)]),b=yield n(o,w),L=yield e(Fs,b);for(let $=0;$<16;$++)L[$]^=g[$]^w[$];return z.concatUint8Array([b,L])}),function(u,f,w){return a.apply(this,arguments)}),decrypt:function(){var a=(0,s.Z)(function*(o,u,f){if(o.length<16)throw Error("Invalid EAX ciphertext");const w=o.subarray(0,-16),g=o.subarray(-16),[b,L,$]=yield Promise.all([e(Zo,u),e(Ms,f),e(Fs,w)]),j=$;for(let se=0;se<16;se++)j[se]^=L[se]^b[se];if(!z.equalsUint8Array(g,j))throw Error("Authentication tag mismatch");return yield n(w,b)});return function(u,f,w){return a.apply(this,arguments)}}()};var a}),zs.apply(this,arguments)}function Go(r){let t=0;for(let e=1;0==(r&e);e<<=1)t++;return t}function ln(r,t){for(let e=0;e<r.length;e++)r[e]^=t[e];return r}function Ha(r,t){return ln(r.slice(),t)}Fs[15]=2,ji.getNonce=function(r,t){const e=r.slice();for(let n=0;n<t.length;n++)e[8+n]^=t[n];return e},ji.blockLength=16,ji.ivLength=16,ji.tagLength=16;const Zs=new Uint8Array(16),Zu=new Uint8Array([1]);function Wi(r,t){return Gs.apply(this,arguments)}function Gs(){return Gs=(0,s.Z)(function*(r,t){let e,n,a,o=0;function u(f,w,g,b){const L=w.length/16|0;!function(He,$e){const rt=z.nbits(Math.max(He.length,$e.length)/16|0)-1;for(let Je=o+1;Je<=rt;Je++)a[Je]=z.double(a[Je-1]);o=rt}(w,b);const $=z.concatUint8Array([Zs.subarray(0,15-g.length),Zu,g]),j=63&$[15];$[15]&=192;const se=e($),pe=z.concatUint8Array([se,Ha(se.subarray(0,8),se.subarray(1,9))]),xe=z.shiftRight(pe.subarray(0+(j>>3),17+(j>>3)),8-(7&j)).subarray(1),Ke=new Uint8Array(16),Qe=new Uint8Array(w.length+16);let Be,le=0;for(Be=0;Be<L;Be++)ln(xe,a[Go(Be+1)]),Qe.set(ln(f(Ha(xe,w)),xe),le),ln(Ke,f===e?w:Qe.subarray(le)),w=w.subarray(16),le+=16;if(w.length){ln(xe,a.x);const He=e(xe);Qe.set(Ha(w,He),le);const $e=new Uint8Array(16);$e.set(f===e?w:Qe.subarray(le,-16),0),$e[w.length]=128,ln(Ke,$e),le+=w.length}const Xe=ln(e(ln(ln(Ke,xe),a.$)),function(He){if(!He.length)return Zs;const $e=He.length/16|0,rt=new Uint8Array(16),Je=new Uint8Array(16);for(let dt=0;dt<$e;dt++)ln(rt,a[Go(dt+1)]),ln(Je,e(Ha(rt,He))),He=He.subarray(16);if(He.length){ln(rt,a.x);const dt=new Uint8Array(16);dt.set(He,0),dt[He.length]=128,ln(dt,rt),ln(Je,e(dt))}return Je}(b));return Qe.set(Xe,le),Qe}return function(f,w){const g=Z.read(Z.symmetric,f),b=new cn[g](w);e=b.encrypt.bind(b),n=b.decrypt.bind(b);const L=e(Zs),$=z.double(L);a=[],a[0]=z.double($),a.x=L,a.$=$}(r,t),{encrypt:(f=(0,s.Z)(function*(w,g,b){return u(e,w,g,b)}),function(g,b,L){return f.apply(this,arguments)}),decrypt:function(){var f=(0,s.Z)(function*(w,g,b){if(w.length<16)throw Error("Invalid OCB ciphertext");const L=w.subarray(-16);w=w.subarray(0,-16);const $=u(n,w,g,b);if(z.equalsUint8Array(L,$.subarray(-16)))return $.subarray(0,-16);throw Error("Authentication tag mismatch")});return function(g,b,L){return f.apply(this,arguments)}}()};var f}),Gs.apply(this,arguments)}Wi.getNonce=function(r,t){const e=r.slice();for(let n=0;n<t.length;n++)e[7+n]^=t[n];return e},Wi.blockLength=16,Wi.ivLength=15,Wi.tagLength=16;class fi{constructor(t,e,n,a=16,o){this.tagSize=a,this.gamma0=0,this.counter=1,this.aes=o||new dr(t,void 0,!1,"CTR");let{asm:u,heap:f}=this.aes.acquire_asm();if(u.gcm_init(),this.tagSize<4||this.tagSize>16)throw new Hr("illegal tagSize value");const w=e.length||0,g=new Uint8Array(16);12!==w?(this._gcm_mac_process(e),f[0]=0,f[1]=0,f[2]=0,f[3]=0,f[4]=0,f[5]=0,f[6]=0,f[7]=0,f[8]=0,f[9]=0,f[10]=0,f[11]=w>>>29,f[12]=w>>>21&255,f[13]=w>>>13&255,f[14]=w>>>5&255,f[15]=w<<3&255,u.mac(Lt.MAC.GCM,Lt.HEAP_DATA,16),u.get_iv(Lt.HEAP_DATA),u.set_iv(0,0,0,0),g.set(f.subarray(0,16))):(g.set(e),g[15]=1);const b=new DataView(g.buffer);if(this.gamma0=b.getUint32(12),u.set_nonce(b.getUint32(0),b.getUint32(4),b.getUint32(8),0),u.set_mask(0,0,0,4294967295),void 0!==n){if(n.length>68719476704)throw new Hr("illegal adata length");n.length?(this.adata=n,this._gcm_mac_process(n)):this.adata=void 0}else this.adata=void 0;if(this.counter<1||this.counter>4294967295)throw new RangeError("counter must be a positive 32-bit integer");u.set_counter(0,0,0,this.gamma0+this.counter|0)}static encrypt(t,e,n,a,o){return new fi(e,n,a,o).encrypt(t)}static decrypt(t,e,n,a,o){return new fi(e,n,a,o).decrypt(t)}encrypt(t){return this.AES_GCM_encrypt(t)}decrypt(t){return this.AES_GCM_decrypt(t)}AES_GCM_Encrypt_process(t){let e=0,n=t.length||0,{asm:a,heap:o}=this.aes.acquire_asm(),u=this.counter,f=this.aes.pos,w=this.aes.len,g=0,b=w+n&-16,L=0;if((u-1<<4)+w+n>68719476704)throw new RangeError("counter overflow");const $=new Uint8Array(b);for(;n>0;)L=Xt(o,f+w,t,e,n),w+=L,e+=L,n-=L,L=a.cipher(Lt.ENC.CTR,Lt.HEAP_DATA+f,w),L=a.mac(Lt.MAC.GCM,Lt.HEAP_DATA+f,L),L&&$.set(o.subarray(f,f+L),g),u+=L>>>4,g+=L,L<w?(f+=L,w-=L):(f=0,w=0);return this.counter=u,this.aes.pos=f,this.aes.len=w,$}AES_GCM_Encrypt_finish(){let{asm:t,heap:e}=this.aes.acquire_asm(),n=this.counter,a=this.tagSize,o=this.adata,u=this.aes.pos,f=this.aes.len;const w=new Uint8Array(f+a);t.cipher(Lt.ENC.CTR,Lt.HEAP_DATA+u,f+15&-16),f&&w.set(e.subarray(u,u+f));let g=f;for(;15&g;g++)e[u+g]=0;t.mac(Lt.MAC.GCM,Lt.HEAP_DATA+u,g);const b=void 0!==o?o.length:0,L=(n-1<<4)+f;return e[0]=0,e[1]=0,e[2]=0,e[3]=b>>>29,e[4]=b>>>21,e[5]=b>>>13&255,e[6]=b>>>5&255,e[7]=b<<3&255,e[8]=e[9]=e[10]=0,e[11]=L>>>29,e[12]=L>>>21&255,e[13]=L>>>13&255,e[14]=L>>>5&255,e[15]=L<<3&255,t.mac(Lt.MAC.GCM,Lt.HEAP_DATA,16),t.get_iv(Lt.HEAP_DATA),t.set_counter(0,0,0,this.gamma0),t.cipher(Lt.ENC.CTR,Lt.HEAP_DATA,16),w.set(e.subarray(0,a),f),this.counter=1,this.aes.pos=0,this.aes.len=0,w}AES_GCM_Decrypt_process(t){let e=0,n=t.length||0,{asm:a,heap:o}=this.aes.acquire_asm(),u=this.counter,f=this.tagSize,w=this.aes.pos,g=this.aes.len,b=0,L=g+n>f?g+n-f&-16:0,$=g+n-L,j=0;if((u-1<<4)+g+n>68719476704)throw new RangeError("counter overflow");const se=new Uint8Array(L);for(;n>$;)j=Xt(o,w+g,t,e,n-$),g+=j,e+=j,n-=j,j=a.mac(Lt.MAC.GCM,Lt.HEAP_DATA+w,j),j=a.cipher(Lt.DEC.CTR,Lt.HEAP_DATA+w,j),j&&se.set(o.subarray(w,w+j),b),u+=j>>>4,b+=j,w=0,g=0;return n>0&&(g+=Xt(o,0,t,e,n)),this.counter=u,this.aes.pos=w,this.aes.len=g,se}AES_GCM_Decrypt_finish(){let{asm:t,heap:e}=this.aes.acquire_asm(),n=this.tagSize,a=this.adata,o=this.counter,u=this.aes.pos,f=this.aes.len,w=f-n;if(f<n)throw new $r("authentication tag not found");const g=new Uint8Array(w),b=new Uint8Array(e.subarray(u+w,u+f));let L=w;for(;15&L;L++)e[u+L]=0;t.mac(Lt.MAC.GCM,Lt.HEAP_DATA+u,L),t.cipher(Lt.DEC.CTR,Lt.HEAP_DATA+u,L),w&&g.set(e.subarray(u,u+w));const $=void 0!==a?a.length:0,j=(o-1<<4)+f-n;e[0]=0,e[1]=0,e[2]=0,e[3]=$>>>29,e[4]=$>>>21,e[5]=$>>>13&255,e[6]=$>>>5&255,e[7]=$<<3&255,e[8]=e[9]=e[10]=0,e[11]=j>>>29,e[12]=j>>>21&255,e[13]=j>>>13&255,e[14]=j>>>5&255,e[15]=j<<3&255,t.mac(Lt.MAC.GCM,Lt.HEAP_DATA,16),t.get_iv(Lt.HEAP_DATA),t.set_counter(0,0,0,this.gamma0),t.cipher(Lt.ENC.CTR,Lt.HEAP_DATA,16);let se=0;for(let pe=0;pe<n;++pe)se|=b[pe]^e[pe];if(se)throw new Yr("data integrity check failed");return this.counter=1,this.aes.pos=0,this.aes.len=0,g}AES_GCM_decrypt(t){const e=this.AES_GCM_Decrypt_process(t),n=this.AES_GCM_Decrypt_finish(),a=new Uint8Array(e.length+n.length);return e.length&&a.set(e),n.length&&a.set(n,e.length),a}AES_GCM_encrypt(t){const e=this.AES_GCM_Encrypt_process(t),n=this.AES_GCM_Encrypt_finish(),a=new Uint8Array(e.length+n.length);return e.length&&a.set(e),n.length&&a.set(n,e.length),a}_gcm_mac_process(t){let{asm:e,heap:n}=this.aes.acquire_asm(),a=0,o=t.length||0,u=0;for(;o>0;){for(u=Xt(n,0,t,a,o),a+=u,o-=u;15&u;)n[u++]=0;e.mac(Lt.MAC.GCM,Lt.HEAP_DATA,u)}}}const js=z.getWebCrypto(),jo=z.getNodeCrypto(),Wo=z.getNodeBuffer();function _i(r,t){return Ws.apply(this,arguments)}function Ws(){return Ws=(0,s.Z)(function*(r,t){if(r!==Z.symmetric.aes128&&r!==Z.symmetric.aes192&&r!==Z.symmetric.aes256)throw Error("GCM mode supports only AES cipher");if(z.getWebCrypto()&&24!==t.length){const e=yield js.importKey("raw",t,{name:"AES-GCM"},!1,["encrypt","decrypt"]);return{encrypt:(n=(0,s.Z)(function*(a,o,u=new Uint8Array){if(!a.length)return fi.encrypt(a,t,o,u);const f=yield js.encrypt({name:"AES-GCM",iv:o,additionalData:u,tagLength:128},e,a);return new Uint8Array(f)}),function(o,u){return n.apply(this,arguments)}),decrypt:function(){var n=(0,s.Z)(function*(a,o,u=new Uint8Array){if(16===a.length)return fi.decrypt(a,t,o,u);const f=yield js.decrypt({name:"AES-GCM",iv:o,additionalData:u,tagLength:128},e,a);return new Uint8Array(f)});return function(o,u){return n.apply(this,arguments)}}()}}var n,e;return z.getNodeCrypto()?{encrypt:(e=(0,s.Z)(function*(n,a,o=new Uint8Array){const u=new jo.createCipheriv("aes-"+8*t.length+"-gcm",t,a);u.setAAD(o);const f=Wo.concat([u.update(n),u.final(),u.getAuthTag()]);return new Uint8Array(f)}),function(a,o){return e.apply(this,arguments)}),decrypt:function(){var e=(0,s.Z)(function*(n,a,o=new Uint8Array){const u=new jo.createDecipheriv("aes-"+8*t.length+"-gcm",t,a);u.setAAD(o),u.setAuthTag(n.slice(n.length-16,n.length));const f=Wo.concat([u.update(n.slice(0,n.length-16)),u.final()]);return new Uint8Array(f)});return function(a,o){return e.apply(this,arguments)}}()}:{encrypt:function(){var e=(0,s.Z)(function*(n,a,o){return fi.encrypt(n,t,a,o)});return function(a,o,u){return e.apply(this,arguments)}}(),decrypt:function(){var e=(0,s.Z)(function*(n,a,o){return fi.decrypt(n,t,a,o)});return function(a,o,u){return e.apply(this,arguments)}}()}}),Ws.apply(this,arguments)}_i.getNonce=function(r,t){const e=r.slice();for(let n=0;n<t.length;n++)e[4+n]^=t[n];return e},_i.blockLength=16,_i.ivLength=12,_i.tagLength=16;var Qo={cfb:Ku,gcm:_i,experimentalGCM:_i,eax:ji,ocb:Wi},Gu=Object.freeze({__proto__:null,parseSignatureParams:function(r,t){let e=0;switch(r){case Z.publicKey.rsaEncryptSign:case Z.publicKey.rsaEncrypt:case Z.publicKey.rsaSign:return{s:z.readMPI(t.subarray(e))};case Z.publicKey.dsa:case Z.publicKey.ecdsa:{const n=z.readMPI(t.subarray(e));return e+=n.length+2,{r:n,s:z.readMPI(t.subarray(e))}}case Z.publicKey.eddsa:{let n=z.readMPI(t.subarray(e));e+=n.length+2,n=z.leftPad(n,32);let a=z.readMPI(t.subarray(e));return a=z.leftPad(a,32),{r:n,s:a}}default:throw new Gr("Unknown signature algorithm.")}},verify:function(){var r=(0,s.Z)(function*(t,e,n,a,o,u){switch(t){case Z.publicKey.rsaEncryptSign:case Z.publicKey.rsaEncrypt:case Z.publicKey.rsaSign:{const{n:f,e:w}=a,g=z.leftPad(n.s,f.length);return Nr.rsa.verify(e,o,g,f,w,u)}case Z.publicKey.dsa:{const{g:f,p:w,q:g,y:b}=a,{r:L,s:$}=n;return Nr.dsa.verify(e,L,$,u,f,w,g,b)}case Z.publicKey.ecdsa:{const{oid:f,Q:w}=a,g=new Nr.elliptic.Curve(f).payloadSize,b=z.leftPad(n.r,g),L=z.leftPad(n.s,g);return Nr.elliptic.ecdsa.verify(f,e,{r:b,s:L},o,w,u)}case Z.publicKey.eddsa:{const{oid:f,Q:w}=a;return Nr.elliptic.eddsa.verify(f,e,n,o,w,u)}default:throw Error("Unknown signature algorithm.")}});return function(e,n,a,o,u,f){return r.apply(this,arguments)}}(),sign:function(){var r=(0,s.Z)(function*(t,e,n,a,o,u){if(!n||!a)throw Error("Missing key parameters");switch(t){case Z.publicKey.rsaEncryptSign:case Z.publicKey.rsaEncrypt:case Z.publicKey.rsaSign:{const{n:f,e:w}=n,{d:g,p:b,q:L,u:$}=a;return{s:yield Nr.rsa.sign(e,o,f,w,g,b,L,$,u)}}case Z.publicKey.dsa:{const{g:f,p:w,q:g}=n,{x:b}=a;return Nr.dsa.sign(e,u,f,w,g,b)}case Z.publicKey.elgamal:throw Error("Signing with Elgamal is not defined in the OpenPGP standard.");case Z.publicKey.ecdsa:{const{oid:f,Q:w}=n,{d:g}=a;return Nr.elliptic.ecdsa.sign(f,e,o,w,g,u)}case Z.publicKey.eddsa:{const{oid:f,Q:w}=n,{seed:g}=a;return Nr.elliptic.eddsa.sign(f,e,o,w,g,u)}default:throw Error("Unknown signature algorithm.")}});return function(e,n,a,o,u,f){return r.apply(this,arguments)}}()});const Mt={cipher:cn,hash:xi,mode:Qo,publicKey:Nr,signature:Gu,random:bu,pkcs1:wu,pkcs5:Du,aesKW:Uu};Object.assign(Mt,Lu);var Qi=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";function $o(r,t){return r.length===t?r:r.subarray?r.subarray(0,t):(r.length=t,r)}const Yo={arraySet:function(r,t,e,n,a){if(t.subarray&&r.subarray)r.set(t.subarray(e,e+n),a);else for(let o=0;o<n;o++)r[a+o]=t[e+o]},flattenChunks:function(r){let t,e,n,a,o;for(n=0,t=0,e=r.length;t<e;t++)n+=r[t].length;const u=new Uint8Array(n);for(a=0,t=0,e=r.length;t<e;t++)o=r[t],u.set(o,a),a+=o.length;return u}},Xo={arraySet:function(r,t,e,n,a){for(let o=0;o<n;o++)r[a+o]=t[e+o]},flattenChunks:function(r){return[].concat.apply([],r)}};let Nn=Qi?Uint8Array:Array,yn=Qi?Uint16Array:Array,Va=Qi?Int32Array:Array,qo=Qi?Yo.flattenChunks:Xo.flattenChunks,Ln=Qi?Yo.arraySet:Xo.arraySet;function ki(r){let t=r.length;for(;--t>=0;)r[t]=0}const Qs=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],za=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],ju=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],Jo=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],Wn=Array(576);ki(Wn);const $i=Array(60);ki($i);const Yi=Array(512);ki(Yi);const Xi=Array(256);ki(Xi);const $s=Array(29);ki($s);const Za=Array(30);function Ys(r,t,e,n,a){this.static_tree=r,this.extra_bits=t,this.extra_base=e,this.elems=n,this.max_length=a,this.has_stree=r&&r.length}let ec,tc,rc;function Xs(r,t){this.dyn_tree=r,this.max_code=0,this.stat_desc=t}function nc(r){return r<256?Yi[r]:Yi[256+(r>>>7)]}function qi(r,t){r.pending_buf[r.pending++]=255&t,r.pending_buf[r.pending++]=t>>>8&255}function fn(r,t,e){r.bi_valid>16-e?(r.bi_buf|=t<<r.bi_valid&65535,qi(r,r.bi_buf),r.bi_buf=t>>16-r.bi_valid,r.bi_valid+=e-16):(r.bi_buf|=t<<r.bi_valid&65535,r.bi_valid+=e)}function Kn(r,t,e){fn(r,e[2*t],e[2*t+1])}function ic(r,t){let e=0;do{e|=1&r,r>>>=1,e<<=1}while(--t>0);return e>>>1}function ac(r,t,e){const n=Array(16);let a,o,u=0;for(a=1;a<=15;a++)n[a]=u=u+e[a-1]<<1;for(o=0;o<=t;o++){const f=r[2*o+1];0!==f&&(r[2*o]=ic(n[f]++,f))}}function sc(r){let t;for(t=0;t<286;t++)r.dyn_ltree[2*t]=0;for(t=0;t<30;t++)r.dyn_dtree[2*t]=0;for(t=0;t<19;t++)r.bl_tree[2*t]=0;r.dyn_ltree[512]=1,r.opt_len=r.static_len=0,r.last_lit=r.matches=0}function oc(r){r.bi_valid>8?qi(r,r.bi_buf):r.bi_valid>0&&(r.pending_buf[r.pending++]=r.bi_buf),r.bi_buf=0,r.bi_valid=0}function cc(r,t,e,n){const a=2*t,o=2*e;return r[a]<r[o]||r[a]===r[o]&&n[t]<=n[e]}function qs(r,t,e){const n=r.heap[e];let a=e<<1;for(;a<=r.heap_len&&(a<r.heap_len&&cc(t,r.heap[a+1],r.heap[a],r.depth)&&a++,!cc(t,n,r.heap[a],r.depth));)r.heap[e]=r.heap[a],e=a,a<<=1;r.heap[e]=n}function uc(r,t,e){let n,a,o,u,f=0;if(0!==r.last_lit)do{n=r.pending_buf[r.d_buf+2*f]<<8|r.pending_buf[r.d_buf+2*f+1],a=r.pending_buf[r.l_buf+f],f++,0===n?Kn(r,a,t):(o=Xi[a],Kn(r,o+256+1,t),u=Qs[o],0!==u&&(a-=$s[o],fn(r,a,u)),n--,o=nc(n),Kn(r,o,e),u=za[o],0!==u&&(n-=Za[o],fn(r,n,u)))}while(f<r.last_lit);Kn(r,256,t)}function Js(r,t){const e=t.dyn_tree,n=t.stat_desc.static_tree,a=t.stat_desc.has_stree,o=t.stat_desc.elems;let u,f,w,g=-1;for(r.heap_len=0,r.heap_max=573,u=0;u<o;u++)0!==e[2*u]?(r.heap[++r.heap_len]=g=u,r.depth[u]=0):e[2*u+1]=0;for(;r.heap_len<2;)w=r.heap[++r.heap_len]=g<2?++g:0,e[2*w]=1,r.depth[w]=0,r.opt_len--,a&&(r.static_len-=n[2*w+1]);for(t.max_code=g,u=r.heap_len>>1;u>=1;u--)qs(r,e,u);w=o;do{u=r.heap[1],r.heap[1]=r.heap[r.heap_len--],qs(r,e,1),f=r.heap[1],r.heap[--r.heap_max]=u,r.heap[--r.heap_max]=f,e[2*w]=e[2*u]+e[2*f],r.depth[w]=(r.depth[u]>=r.depth[f]?r.depth[u]:r.depth[f])+1,e[2*u+1]=e[2*f+1]=w,r.heap[1]=w++,qs(r,e,1)}while(r.heap_len>=2);r.heap[--r.heap_max]=r.heap[1],function(b,L){const $=L.dyn_tree,j=L.max_code,se=L.stat_desc.static_tree,pe=L.stat_desc.has_stree,xe=L.stat_desc.extra_bits,Ke=L.stat_desc.extra_base,Qe=L.stat_desc.max_length;let Be,le,Xe,He,$e,rt,Je=0;for(He=0;He<=15;He++)b.bl_count[He]=0;for($[2*b.heap[b.heap_max]+1]=0,Be=b.heap_max+1;Be<573;Be++)le=b.heap[Be],He=$[2*$[2*le+1]+1]+1,He>Qe&&(He=Qe,Je++),$[2*le+1]=He,le>j||(b.bl_count[He]++,$e=0,le>=Ke&&($e=xe[le-Ke]),rt=$[2*le],b.opt_len+=rt*(He+$e),pe&&(b.static_len+=rt*(se[2*le+1]+$e)));if(0!==Je){do{for(He=Qe-1;0===b.bl_count[He];)He--;b.bl_count[He]--,b.bl_count[He+1]+=2,b.bl_count[Qe]--,Je-=2}while(Je>0);for(He=Qe;0!==He;He--)for(le=b.bl_count[He];0!==le;)Xe=b.heap[--Be],Xe>j||($[2*Xe+1]!==He&&(b.opt_len+=(He-$[2*Xe+1])*$[2*Xe],$[2*Xe+1]=He),le--)}}(r,t),ac(e,g,r.bl_count)}function lc(r,t,e){let n,a,o=-1,u=t[1],f=0,w=7,g=4;for(0===u&&(w=138,g=3),t[2*(e+1)+1]=65535,n=0;n<=e;n++)a=u,u=t[2*(n+1)+1],++f<w&&a===u||(f<g?r.bl_tree[2*a]+=f:0!==a?(a!==o&&r.bl_tree[2*a]++,r.bl_tree[32]++):f<=10?r.bl_tree[34]++:r.bl_tree[36]++,f=0,o=a,0===u?(w=138,g=3):a===u?(w=6,g=3):(w=7,g=4))}function fc(r,t,e){let n,a,o=-1,u=t[1],f=0,w=7,g=4;for(0===u&&(w=138,g=3),n=0;n<=e;n++)if(a=u,u=t[2*(n+1)+1],!(++f<w&&a===u)){if(f<g)do{Kn(r,a,r.bl_tree)}while(0!=--f);else 0!==a?(a!==o&&(Kn(r,a,r.bl_tree),f--),Kn(r,16,r.bl_tree),fn(r,f-3,2)):f<=10?(Kn(r,17,r.bl_tree),fn(r,f-3,3)):(Kn(r,18,r.bl_tree),fn(r,f-11,7));f=0,o=a,0===u?(w=138,g=3):a===u?(w=6,g=3):(w=7,g=4)}}ki(Za);let hc=!1;function dc(r,t,e,n){var a,o,u;fn(r,0+(n?1:0),3),o=t,u=e,oc(a=r),qi(a,u),qi(a,~u),Ln(a.pending_buf,a.window,o,u,a.pending),a.pending+=u}function Jn(r,t,e){return r.pending_buf[r.d_buf+2*r.last_lit]=t>>>8&255,r.pending_buf[r.d_buf+2*r.last_lit+1]=255&t,r.pending_buf[r.l_buf+r.last_lit]=255&e,r.last_lit++,0===t?r.dyn_ltree[2*e]++:(r.matches++,t--,r.dyn_ltree[2*(Xi[e]+256+1)]++,r.dyn_dtree[2*nc(t)]++),r.last_lit===r.lit_bufsize-1}function Ji(r,t,e,n){let a=65535&r|0,o=r>>>16&65535|0,u=0;for(;0!==e;){u=e>2e3?2e3:e,e-=u;do{a=a+t[n++]|0,o=o+a|0}while(--u);a%=65521,o%=65521}return a|o<<16|0}const Yu=function(){let r;const t=[];for(let e=0;e<256;e++){r=e;for(let n=0;n<8;n++)r=1&r?3988292384^r>>>1:r>>>1;t[e]=r}return t}();function Xr(r,t,e,n){const a=Yu,o=n+e;r^=-1;for(let u=n;u<o;u++)r=r>>>8^a[255&(r^t[u])];return-1^r}var ea={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"};function ei(r,t){return r.msg=ea[t],t}function pc(r){return(r<<1)-(r>4?9:0)}function ti(r){let t=r.length;for(;--t>=0;)r[t]=0}function ri(r){const t=r.state;let e=t.pending;e>r.avail_out&&(e=r.avail_out),0!==e&&(Ln(r.output,t.pending_buf,t.pending_out,e,r.next_out),r.next_out+=e,t.pending_out+=e,r.total_out+=e,r.avail_out-=e,t.pending-=e,0===t.pending&&(t.pending_out=0))}function Jr(r,t){(function $u(r,t,e,n){let a,o,u=0;r.level>0?(2===r.strm.data_type&&(r.strm.data_type=function(f){let w,g=4093624447;for(w=0;w<=31;w++,g>>>=1)if(1&g&&0!==f.dyn_ltree[2*w])return 0;if(0!==f.dyn_ltree[18]||0!==f.dyn_ltree[20]||0!==f.dyn_ltree[26])return 1;for(w=32;w<256;w++)if(0!==f.dyn_ltree[2*w])return 1;return 0}(r)),Js(r,r.l_desc),Js(r,r.d_desc),u=function(f){let w;for(lc(f,f.dyn_ltree,f.l_desc.max_code),lc(f,f.dyn_dtree,f.d_desc.max_code),Js(f,f.bl_desc),w=18;w>=3&&0===f.bl_tree[2*Jo[w]+1];w--);return f.opt_len+=3*(w+1)+5+5+4,w}(r),a=r.opt_len+3+7>>>3,o=r.static_len+3+7>>>3,o<=a&&(a=o)):a=o=e+5,e+4<=a&&-1!==t?dc(r,t,e,n):4===r.strategy||o===a?(fn(r,2+(n?1:0),3),uc(r,Wn,$i)):(fn(r,4+(n?1:0),3),function(f,w,g,b){let L;for(fn(f,w-257,5),fn(f,g-1,5),fn(f,b-4,4),L=0;L<b;L++)fn(f,f.bl_tree[2*Jo[L]+1],3);fc(f,f.dyn_ltree,w-1),fc(f,f.dyn_dtree,g-1)}(r,r.l_desc.max_code+1,r.d_desc.max_code+1,u+1),uc(r,r.dyn_ltree,r.dyn_dtree)),sc(r),n&&oc(r)})(r,r.block_start>=0?r.block_start:-1,r.strstart-r.block_start,t),r.block_start=r.strstart,ri(r.strm)}function gr(r,t){r.pending_buf[r.pending++]=t}function ta(r,t){r.pending_buf[r.pending++]=t>>>8&255,r.pending_buf[r.pending++]=255&t}function Xu(r,t,e,n){let a=r.avail_in;return a>n&&(a=n),0===a?0:(r.avail_in-=a,Ln(t,r.input,r.next_in,a,e),1===r.state.wrap?r.adler=Ji(r.adler,t,a,e):2===r.state.wrap&&(r.adler=Xr(r.adler,t,a,e)),r.next_in+=a,r.total_in+=a,a)}function yc(r,t){let e,n,a=r.max_chain_length,o=r.strstart,u=r.prev_length,f=r.nice_match;const w=r.strstart>r.w_size-262?r.strstart-(r.w_size-262):0,g=r.window,b=r.w_mask,L=r.prev,$=r.strstart+258;let j=g[o+u-1],se=g[o+u];r.prev_length>=r.good_match&&(a>>=2),f>r.lookahead&&(f=r.lookahead);do{if(e=t,g[e+u]===se&&g[e+u-1]===j&&g[e]===g[o]&&g[++e]===g[o+1]){o+=2,e++;do{}while(g[++o]===g[++e]&&g[++o]===g[++e]&&g[++o]===g[++e]&&g[++o]===g[++e]&&g[++o]===g[++e]&&g[++o]===g[++e]&&g[++o]===g[++e]&&g[++o]===g[++e]&&o<$);if(n=258-($-o),o=$-258,n>u){if(r.match_start=t,u=n,n>=f)break;j=g[o+u-1],se=g[o+u]}}}while((t=L[t&b])>w&&0!=--a);return u<=r.lookahead?u:r.lookahead}function hi(r){const t=r.w_size;let e,n,a,o,u;do{if(o=r.window_size-r.lookahead-r.strstart,r.strstart>=t+(t-262)){Ln(r.window,r.window,t,t,0),r.match_start-=t,r.strstart-=t,r.block_start-=t,n=r.hash_size,e=n;do{a=r.head[--e],r.head[e]=a>=t?a-t:0}while(--n);n=t,e=n;do{a=r.prev[--e],r.prev[e]=a>=t?a-t:0}while(--n);o+=t}if(0===r.strm.avail_in)break;if(n=Xu(r.strm,r.window,r.strstart+r.lookahead,o),r.lookahead+=n,r.lookahead+r.insert>=3)for(u=r.strstart-r.insert,r.ins_h=r.window[u],r.ins_h=(r.ins_h<<r.hash_shift^r.window[u+1])&r.hash_mask;r.insert&&(r.ins_h=(r.ins_h<<r.hash_shift^r.window[u+3-1])&r.hash_mask,r.prev[u&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=u,u++,r.insert--,!(r.lookahead+r.insert<3)););}while(r.lookahead<262&&0!==r.strm.avail_in)}function e0(r,t){let e,n;for(;;){if(r.lookahead<262){if(hi(r),r.lookahead<262&&0===t)return 1;if(0===r.lookahead)break}if(e=0,r.lookahead>=3&&(r.ins_h=(r.ins_h<<r.hash_shift^r.window[r.strstart+3-1])&r.hash_mask,e=r.prev[r.strstart&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=r.strstart),0!==e&&r.strstart-e<=r.w_size-262&&(r.match_length=yc(r,e)),r.match_length>=3)if(n=Jn(r,r.strstart-r.match_start,r.match_length-3),r.lookahead-=r.match_length,r.match_length<=r.max_lazy_match&&r.lookahead>=3){r.match_length--;do{r.strstart++,r.ins_h=(r.ins_h<<r.hash_shift^r.window[r.strstart+3-1])&r.hash_mask,e=r.prev[r.strstart&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=r.strstart}while(0!=--r.match_length);r.strstart++}else r.strstart+=r.match_length,r.match_length=0,r.ins_h=r.window[r.strstart],r.ins_h=(r.ins_h<<r.hash_shift^r.window[r.strstart+1])&r.hash_mask;else n=Jn(r,0,r.window[r.strstart]),r.lookahead--,r.strstart++;if(n&&(Jr(r,!1),0===r.strm.avail_out))return 1}return r.insert=r.strstart<2?r.strstart:2,4===t?(Jr(r,!0),0===r.strm.avail_out?3:4):r.last_lit&&(Jr(r,!1),0===r.strm.avail_out)?1:2}function Ti(r,t){let e,n,a;for(;;){if(r.lookahead<262){if(hi(r),r.lookahead<262&&0===t)return 1;if(0===r.lookahead)break}if(e=0,r.lookahead>=3&&(r.ins_h=(r.ins_h<<r.hash_shift^r.window[r.strstart+3-1])&r.hash_mask,e=r.prev[r.strstart&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=r.strstart),r.prev_length=r.match_length,r.prev_match=r.match_start,r.match_length=2,0!==e&&r.prev_length<r.max_lazy_match&&r.strstart-e<=r.w_size-262&&(r.match_length=yc(r,e),r.match_length<=5&&(1===r.strategy||3===r.match_length&&r.strstart-r.match_start>4096)&&(r.match_length=2)),r.prev_length>=3&&r.match_length<=r.prev_length){a=r.strstart+r.lookahead-3,n=Jn(r,r.strstart-1-r.prev_match,r.prev_length-3),r.lookahead-=r.prev_length-1,r.prev_length-=2;do{++r.strstart<=a&&(r.ins_h=(r.ins_h<<r.hash_shift^r.window[r.strstart+3-1])&r.hash_mask,e=r.prev[r.strstart&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=r.strstart)}while(0!=--r.prev_length);if(r.match_available=0,r.match_length=2,r.strstart++,n&&(Jr(r,!1),0===r.strm.avail_out))return 1}else if(r.match_available){if(n=Jn(r,0,r.window[r.strstart-1]),n&&Jr(r,!1),r.strstart++,r.lookahead--,0===r.strm.avail_out)return 1}else r.match_available=1,r.strstart++,r.lookahead--}return r.match_available&&(n=Jn(r,0,r.window[r.strstart-1]),r.match_available=0),r.insert=r.strstart<2?r.strstart:2,4===t?(Jr(r,!0),0===r.strm.avail_out?3:4):r.last_lit&&(Jr(r,!1),0===r.strm.avail_out)?1:2}class On{constructor(t,e,n,a,o){this.good_length=t,this.max_lazy=e,this.nice_length=n,this.max_chain=a,this.func=o}}const ra=[new On(0,0,0,0,function(r,t){let e=65535;for(e>r.pending_buf_size-5&&(e=r.pending_buf_size-5);;){if(r.lookahead<=1){if(hi(r),0===r.lookahead&&0===t)return 1;if(0===r.lookahead)break}r.strstart+=r.lookahead,r.lookahead=0;const n=r.block_start+e;if((0===r.strstart||r.strstart>=n)&&(r.lookahead=r.strstart-n,r.strstart=n,Jr(r,!1),0===r.strm.avail_out)||r.strstart-r.block_start>=r.w_size-262&&(Jr(r,!1),0===r.strm.avail_out))return 1}return r.insert=0,4===t?(Jr(r,!0),0===r.strm.avail_out?3:4):(r.strstart>r.block_start&&Jr(r,!1),1)}),new On(4,4,8,4,e0),new On(4,5,16,8,e0),new On(4,6,32,32,e0),new On(4,4,16,16,Ti),new On(8,16,32,32,Ti),new On(8,16,128,128,Ti),new On(8,32,128,256,Ti),new On(32,128,258,1024,Ti),new On(32,258,258,4096,Ti)];class qu{constructor(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=8,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new yn(1146),this.dyn_dtree=new yn(122),this.bl_tree=new yn(78),ti(this.dyn_ltree),ti(this.dyn_dtree),ti(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new yn(16),this.heap=new yn(573),ti(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new yn(573),ti(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}}function e1(r,t){let e,n,a,o;if(!r||!r.state||t>5||t<0)return r?ei(r,-2):-2;if(n=r.state,!r.output||!r.input&&0!==r.avail_in||666===n.status&&4!==t)return ei(r,0===r.avail_out?-5:-2);if(n.strm=r,e=n.last_flush,n.last_flush=t,42===n.status)if(2===n.wrap)r.adler=0,gr(n,31),gr(n,139),gr(n,8),n.gzhead?(gr(n,(n.gzhead.text?1:0)+(n.gzhead.hcrc?2:0)+(n.gzhead.extra?4:0)+(n.gzhead.name?8:0)+(n.gzhead.comment?16:0)),gr(n,255&n.gzhead.time),gr(n,n.gzhead.time>>8&255),gr(n,n.gzhead.time>>16&255),gr(n,n.gzhead.time>>24&255),gr(n,9===n.level?2:n.strategy>=2||n.level<2?4:0),gr(n,255&n.gzhead.os),n.gzhead.extra&&n.gzhead.extra.length&&(gr(n,255&n.gzhead.extra.length),gr(n,n.gzhead.extra.length>>8&255)),n.gzhead.hcrc&&(r.adler=Xr(r.adler,n.pending_buf,n.pending,0)),n.gzindex=0,n.status=69):(gr(n,0),gr(n,0),gr(n,0),gr(n,0),gr(n,0),gr(n,9===n.level?2:n.strategy>=2||n.level<2?4:0),gr(n,3),n.status=113);else{let f=8+(n.w_bits-8<<4)<<8,w=-1;w=n.strategy>=2||n.level<2?0:n.level<6?1:6===n.level?2:3,f|=w<<6,0!==n.strstart&&(f|=32),f+=31-f%31,n.status=113,ta(n,f),0!==n.strstart&&(ta(n,r.adler>>>16),ta(n,65535&r.adler)),r.adler=1}if(69===n.status)if(n.gzhead.extra){for(a=n.pending;n.gzindex<(65535&n.gzhead.extra.length)&&(n.pending!==n.pending_buf_size||(n.gzhead.hcrc&&n.pending>a&&(r.adler=Xr(r.adler,n.pending_buf,n.pending-a,a)),ri(r),a=n.pending,n.pending!==n.pending_buf_size));)gr(n,255&n.gzhead.extra[n.gzindex]),n.gzindex++;n.gzhead.hcrc&&n.pending>a&&(r.adler=Xr(r.adler,n.pending_buf,n.pending-a,a)),n.gzindex===n.gzhead.extra.length&&(n.gzindex=0,n.status=73)}else n.status=73;if(73===n.status)if(n.gzhead.name){a=n.pending;do{if(n.pending===n.pending_buf_size&&(n.gzhead.hcrc&&n.pending>a&&(r.adler=Xr(r.adler,n.pending_buf,n.pending-a,a)),ri(r),a=n.pending,n.pending===n.pending_buf_size)){o=1;break}o=n.gzindex<n.gzhead.name.length?255&n.gzhead.name.charCodeAt(n.gzindex++):0,gr(n,o)}while(0!==o);n.gzhead.hcrc&&n.pending>a&&(r.adler=Xr(r.adler,n.pending_buf,n.pending-a,a)),0===o&&(n.gzindex=0,n.status=91)}else n.status=91;if(91===n.status)if(n.gzhead.comment){a=n.pending;do{if(n.pending===n.pending_buf_size&&(n.gzhead.hcrc&&n.pending>a&&(r.adler=Xr(r.adler,n.pending_buf,n.pending-a,a)),ri(r),a=n.pending,n.pending===n.pending_buf_size)){o=1;break}o=n.gzindex<n.gzhead.comment.length?255&n.gzhead.comment.charCodeAt(n.gzindex++):0,gr(n,o)}while(0!==o);n.gzhead.hcrc&&n.pending>a&&(r.adler=Xr(r.adler,n.pending_buf,n.pending-a,a)),0===o&&(n.status=103)}else n.status=103;if(103===n.status&&(n.gzhead.hcrc?(n.pending+2>n.pending_buf_size&&ri(r),n.pending+2<=n.pending_buf_size&&(gr(n,255&r.adler),gr(n,r.adler>>8&255),r.adler=0,n.status=113)):n.status=113),0!==n.pending){if(ri(r),0===r.avail_out)return n.last_flush=-1,0}else if(0===r.avail_in&&pc(t)<=pc(e)&&4!==t)return ei(r,-5);if(666===n.status&&0!==r.avail_in)return ei(r,-5);if(0!==r.avail_in||0!==n.lookahead||0!==t&&666!==n.status){var u=2===n.strategy?function(f,w){let g;for(;;){if(0===f.lookahead&&(hi(f),0===f.lookahead)){if(0===w)return 1;break}if(f.match_length=0,g=Jn(f,0,f.window[f.strstart]),f.lookahead--,f.strstart++,g&&(Jr(f,!1),0===f.strm.avail_out))return 1}return f.insert=0,4===w?(Jr(f,!0),0===f.strm.avail_out?3:4):f.last_lit&&(Jr(f,!1),0===f.strm.avail_out)?1:2}(n,t):3===n.strategy?function(f,w){let g,b,L,$;const j=f.window;for(;;){if(f.lookahead<=258){if(hi(f),f.lookahead<=258&&0===w)return 1;if(0===f.lookahead)break}if(f.match_length=0,f.lookahead>=3&&f.strstart>0&&(L=f.strstart-1,b=j[L],b===j[++L]&&b===j[++L]&&b===j[++L])){$=f.strstart+258;do{}while(b===j[++L]&&b===j[++L]&&b===j[++L]&&b===j[++L]&&b===j[++L]&&b===j[++L]&&b===j[++L]&&b===j[++L]&&L<$);f.match_length=258-($-L),f.match_length>f.lookahead&&(f.match_length=f.lookahead)}if(f.match_length>=3?(g=Jn(f,1,f.match_length-3),f.lookahead-=f.match_length,f.strstart+=f.match_length,f.match_length=0):(g=Jn(f,0,f.window[f.strstart]),f.lookahead--,f.strstart++),g&&(Jr(f,!1),0===f.strm.avail_out))return 1}return f.insert=0,4===w?(Jr(f,!0),0===f.strm.avail_out?3:4):f.last_lit&&(Jr(f,!1),0===f.strm.avail_out)?1:2}(n,t):ra[n.level].func(n,t);if(3!==u&&4!==u||(n.status=666),1===u||3===u)return 0===r.avail_out&&(n.last_flush=-1),0;if(2===u&&(1===t?function Qu(r){var t;fn(r,2,3),Kn(r,256,Wn),16===(t=r).bi_valid?(qi(t,t.bi_buf),t.bi_buf=0,t.bi_valid=0):t.bi_valid>=8&&(t.pending_buf[t.pending++]=255&t.bi_buf,t.bi_buf>>=8,t.bi_valid-=8)}(n):5!==t&&(dc(n,0,0,!1),3===t&&(ti(n.head),0===n.lookahead&&(n.strstart=0,n.block_start=0,n.insert=0))),ri(r),0===r.avail_out))return n.last_flush=-1,0}return 4!==t?0:n.wrap<=0?1:(2===n.wrap?(gr(n,255&r.adler),gr(n,r.adler>>8&255),gr(n,r.adler>>16&255),gr(n,r.adler>>24&255),gr(n,255&r.total_in),gr(n,r.total_in>>8&255),gr(n,r.total_in>>16&255),gr(n,r.total_in>>24&255)):(ta(n,r.adler>>>16),ta(n,65535&r.adler)),ri(r),n.wrap>0&&(n.wrap=-n.wrap),0!==n.pending?0:1)}try{String.fromCharCode.call(null,0)}catch{}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{}const t0=new Nn(256);for(let r=0;r<256;r++)t0[r]=r>=252?6:r>=248?5:r>=240?4:r>=224?3:r>=192?2:1;function r0(r){let t,e,n,a,o=0;const u=r.length;for(n=0;n<u;n++)t=r.charCodeAt(n),55296==(64512&t)&&n+1<u&&(e=r.charCodeAt(n+1),56320==(64512&e)&&(t=65536+(t-55296<<10)+(e-56320),n++)),o+=t<128?1:t<2048?2:t<65536?3:4;const f=new Nn(o);for(a=0,n=0;a<o;n++)t=r.charCodeAt(n),55296==(64512&t)&&n+1<u&&(e=r.charCodeAt(n+1),56320==(64512&e)&&(t=65536+(t-55296<<10)+(e-56320),n++)),t<128?f[a++]=t:t<2048?(f[a++]=192|t>>>6,f[a++]=128|63&t):t<65536?(f[a++]=224|t>>>12,f[a++]=128|t>>>6&63,f[a++]=128|63&t):(f[a++]=240|t>>>18,f[a++]=128|t>>>12&63,f[a++]=128|t>>>6&63,f[a++]=128|63&t);return f}t0[254]=t0[254]=1;class gc{constructor(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}}class n0{constructor(t){this.options={level:-1,method:8,chunkSize:16384,windowBits:15,memLevel:8,strategy:0,...t||{}};const e=this.options;e.raw&&e.windowBits>0?e.windowBits=-e.windowBits:e.gzip&&e.windowBits>0&&e.windowBits<16&&(e.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new gc,this.strm.avail_out=0;var n,o=function(u,f,w,g,b,L){if(!u)return-2;let $=1;if(-1===f&&(f=6),g<0?($=0,g=-g):g>15&&($=2,g-=16),b<1||b>9||8!==w||g<8||g>15||f<0||f>9||L<0||L>4)return ei(u,-2);8===g&&(g=9);const j=new qu;return u.state=j,j.strm=u,j.wrap=$,j.gzhead=null,j.w_bits=g,j.w_size=1<<j.w_bits,j.w_mask=j.w_size-1,j.hash_bits=b+7,j.hash_size=1<<j.hash_bits,j.hash_mask=j.hash_size-1,j.hash_shift=~~((j.hash_bits+3-1)/3),j.window=new Nn(2*j.w_size),j.head=new yn(j.hash_size),j.prev=new yn(j.w_size),j.lit_bufsize=1<<b+6,j.pending_buf_size=4*j.lit_bufsize,j.pending_buf=new Nn(j.pending_buf_size),j.d_buf=1*j.lit_bufsize,j.l_buf=3*j.lit_bufsize,j.level=f,j.strategy=L,j.method=w,function Ju(r){const t=function(e){let n;return e&&e.state?(e.total_in=e.total_out=0,e.data_type=2,n=e.state,n.pending=0,n.pending_out=0,n.wrap<0&&(n.wrap=-n.wrap),n.status=n.wrap?42:113,e.adler=2===n.wrap?0:1,n.last_flush=0,function Wu(r){hc||(function(){let t,e,n,a,o;const u=Array(16);for(n=0,a=0;a<28;a++)for($s[a]=n,t=0;t<1<<Qs[a];t++)Xi[n++]=a;for(Xi[n-1]=a,o=0,a=0;a<16;a++)for(Za[a]=o,t=0;t<1<<za[a];t++)Yi[o++]=a;for(o>>=7;a<30;a++)for(Za[a]=o<<7,t=0;t<1<<za[a]-7;t++)Yi[256+o++]=a;for(e=0;e<=15;e++)u[e]=0;for(t=0;t<=143;)Wn[2*t+1]=8,t++,u[8]++;for(;t<=255;)Wn[2*t+1]=9,t++,u[9]++;for(;t<=279;)Wn[2*t+1]=7,t++,u[7]++;for(;t<=287;)Wn[2*t+1]=8,t++,u[8]++;for(ac(Wn,287,u),t=0;t<30;t++)$i[2*t+1]=5,$i[2*t]=ic(t,5);ec=new Ys(Wn,Qs,257,286,15),tc=new Ys($i,za,0,30,15),rc=new Ys([],ju,0,19,7)}(),hc=!0),r.l_desc=new Xs(r.dyn_ltree,ec),r.d_desc=new Xs(r.dyn_dtree,tc),r.bl_desc=new Xs(r.bl_tree,rc),r.bi_buf=0,r.bi_valid=0,sc(r)}(n),0):ei(e,-2)}(r);return 0===t&&((e=r.state).window_size=2*e.w_size,ti(e.head),e.max_lazy_match=ra[e.level].max_lazy,e.good_match=ra[e.level].good_length,e.nice_match=ra[e.level].nice_length,e.max_chain_length=ra[e.level].max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=2,e.match_available=0,e.ins_h=0),t;var e}(u)}(this.strm,e.level,e.method,e.windowBits,e.memLevel,e.strategy);if(0!==o)throw Error(ea[o]);if(e.header&&(n=this.strm)&&n.state&&(2!==n.state.wrap||(n.state.gzhead=e.header)),e.dictionary){let u;if(u="string"==typeof e.dictionary?r0(e.dictionary):e.dictionary instanceof ArrayBuffer?new Uint8Array(e.dictionary):e.dictionary,0!==(o=function(f,w){let g,b,L,$,j,se,pe,xe,Ke=w.length;if(!f||!f.state||(g=f.state,$=g.wrap,2===$||1===$&&42!==g.status||g.lookahead))return-2;for(1===$&&(f.adler=Ji(f.adler,w,Ke,0)),g.wrap=0,Ke>=g.w_size&&(0===$&&(ti(g.head),g.strstart=0,g.block_start=0,g.insert=0),xe=new Nn(g.w_size),Ln(xe,w,Ke-g.w_size,g.w_size,0),w=xe,Ke=g.w_size),j=f.avail_in,se=f.next_in,pe=f.input,f.avail_in=Ke,f.next_in=0,f.input=w,hi(g);g.lookahead>=3;){b=g.strstart,L=g.lookahead-2;do{g.ins_h=(g.ins_h<<g.hash_shift^g.window[b+3-1])&g.hash_mask,g.prev[b&g.w_mask]=g.head[g.ins_h],g.head[g.ins_h]=b,b++}while(--L);g.strstart=b,g.lookahead=2,hi(g)}return g.strstart+=g.lookahead,g.block_start=g.strstart,g.insert=g.lookahead,g.lookahead=0,g.match_length=g.prev_length=2,g.match_available=0,f.next_in=se,f.input=pe,f.avail_in=j,g.wrap=$,0}(this.strm,u)))throw Error(ea[o]);this._dict_set=!0}}push(t,e){const{strm:n,options:{chunkSize:a}}=this;var o,u;if(this.ended)return!1;u=e===~~e?e:!0===e?4:0,n.input="string"==typeof t?r0(t):t instanceof ArrayBuffer?new Uint8Array(t):t,n.next_in=0,n.avail_in=n.input.length;do{if(0===n.avail_out&&(n.output=new Nn(a),n.next_out=0,n.avail_out=a),1!==(o=e1(n,u))&&0!==o)return this.onEnd(o),this.ended=!0,!1;0!==n.avail_out&&(0!==n.avail_in||4!==u&&2!==u)||this.onData($o(n.output,n.next_out))}while((n.avail_in>0||0===n.avail_out)&&1!==o);return 4===u?(o=function(f){let w;return f&&f.state?(w=f.state.status,42!==w&&69!==w&&73!==w&&91!==w&&103!==w&&113!==w&&666!==w?ei(f,-2):(f.state=null,113===w?ei(f,-3):0)):-2}(this.strm),this.onEnd(o),this.ended=!0,0===o):2!==u||(this.onEnd(0),n.avail_out=0,!0)}onData(t){this.chunks.push(t)}onEnd(t){0===t&&(this.result=qo(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg}}function t1(r,t){let e,n,a,o,u,f,w,g,b,L;const $=r.state;e=r.next_in;const j=r.input,se=e+(r.avail_in-5);n=r.next_out;const pe=r.output,xe=n-(t-r.avail_out),Ke=n+(r.avail_out-257),Qe=$.dmax,Be=$.wsize,le=$.whave,Xe=$.wnext,He=$.window;a=$.hold,o=$.bits;const $e=$.lencode,rt=$.distcode,Je=(1<<$.lenbits)-1,dt=(1<<$.distbits)-1;e:do{o<15&&(a+=j[e++]<<o,o+=8,a+=j[e++]<<o,o+=8),u=$e[a&Je];t:for(;;){if(f=u>>>24,a>>>=f,o-=f,f=u>>>16&255,0===f)pe[n++]=65535&u;else{if(!(16&f)){if(0==(64&f)){u=$e[(65535&u)+(a&(1<<f)-1)];continue t}if(32&f){$.mode=12;break e}r.msg="invalid literal/length code",$.mode=30;break e}w=65535&u,f&=15,f&&(o<f&&(a+=j[e++]<<o,o+=8),w+=a&(1<<f)-1,a>>>=f,o-=f),o<15&&(a+=j[e++]<<o,o+=8,a+=j[e++]<<o,o+=8),u=rt[a&dt];r:for(;;){if(f=u>>>24,a>>>=f,o-=f,f=u>>>16&255,!(16&f)){if(0==(64&f)){u=rt[(65535&u)+(a&(1<<f)-1)];continue r}r.msg="invalid distance code",$.mode=30;break e}if(g=65535&u,f&=15,o<f&&(a+=j[e++]<<o,o+=8,o<f&&(a+=j[e++]<<o,o+=8)),g+=a&(1<<f)-1,g>Qe){r.msg="invalid distance too far back",$.mode=30;break e}if(a>>>=f,o-=f,f=n-xe,g>f){if(f=g-f,f>le&&$.sane){r.msg="invalid distance too far back",$.mode=30;break e}if(b=0,L=He,0===Xe){if(b+=Be-f,f<w){w-=f;do{pe[n++]=He[b++]}while(--f);b=n-g,L=pe}}else if(Xe<f){if(b+=Be+Xe-f,f-=Xe,f<w){w-=f;do{pe[n++]=He[b++]}while(--f);if(b=0,Xe<w){f=Xe,w-=f;do{pe[n++]=He[b++]}while(--f);b=n-g,L=pe}}}else if(b+=Xe-f,f<w){w-=f;do{pe[n++]=He[b++]}while(--f);b=n-g,L=pe}for(;w>2;)pe[n++]=L[b++],pe[n++]=L[b++],pe[n++]=L[b++],w-=3;w&&(pe[n++]=L[b++],w>1&&(pe[n++]=L[b++]))}else{b=n-g;do{pe[n++]=pe[b++],pe[n++]=pe[b++],pe[n++]=pe[b++],w-=3}while(w>2);w&&(pe[n++]=pe[b++],w>1&&(pe[n++]=pe[b++]))}break}}break}}while(e<se&&n<Ke);w=o>>3,e-=w,o-=w<<3,a&=(1<<o)-1,r.next_in=e,r.next_out=n,r.avail_in=e<se?se-e+5:5-(e-se),r.avail_out=n<Ke?Ke-n+257:257-(n-Ke),$.hold=a,$.bits=o}const r1=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],n1=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],i1=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],a1=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];function na(r,t,e,n,a,o,u,f){const w=f.bits;let g,b,L,$,j,se=0,pe=0,xe=0,Ke=0,Qe=0,Be=0,le=0,Xe=0,He=0,$e=0,rt=null,Je=0;const dt=new yn(16),It=new yn(16);let Ut,zt,pt,Ye=null,rr=0;for(se=0;se<=15;se++)dt[se]=0;for(pe=0;pe<n;pe++)dt[t[e+pe]]++;for(Qe=w,Ke=15;Ke>=1&&0===dt[Ke];Ke--);if(Qe>Ke&&(Qe=Ke),0===Ke)return a[o++]=20971520,a[o++]=20971520,f.bits=1,0;for(xe=1;xe<Ke&&0===dt[xe];xe++);for(Qe<xe&&(Qe=xe),Xe=1,se=1;se<=15;se++)if(Xe<<=1,Xe-=dt[se],Xe<0)return-1;if(Xe>0&&(0===r||1!==Ke))return-1;for(It[1]=0,se=1;se<15;se++)It[se+1]=It[se]+dt[se];for(pe=0;pe<n;pe++)0!==t[e+pe]&&(u[It[t[e+pe]]++]=pe);0===r?(rt=Ye=u,j=19):1===r?(rt=r1,Je-=257,Ye=n1,rr-=257,j=256):(rt=i1,Ye=a1,j=-1),$e=0,pe=0,se=xe,$=o,Be=Qe,le=0,L=-1,He=1<<Qe;const ze=He-1;if(1===r&&He>852||2===r&&He>592)return 1;for(;;){Ut=se-le,u[pe]<j?(zt=0,pt=u[pe]):u[pe]>j?(zt=Ye[rr+u[pe]],pt=rt[Je+u[pe]]):(zt=96,pt=0),g=1<<se-le,b=1<<Be,xe=b;do{b-=g,a[$+($e>>le)+b]=Ut<<24|zt<<16|pt|0}while(0!==b);for(g=1<<se-1;$e&g;)g>>=1;if(0!==g?($e&=g-1,$e+=g):$e=0,pe++,0==--dt[se]){if(se===Ke)break;se=t[e+u[pe]]}if(se>Qe&&($e&ze)!==L){for(0===le&&(le=Qe),$+=xe,Be=se-le,Xe=1<<Be;Be+le<Ke&&(Xe-=dt[Be+le],!(Xe<=0));)Be++,Xe<<=1;if(He+=1<<Be,1===r&&He>852||2===r&&He>592)return 1;L=$e&ze,a[L]=Qe<<24|Be<<16|$-o|0}}return 0!==$e&&(a[$+$e]=se-le<<24|64<<16|0),f.bits=Qe,0}function vc(r){return(r>>>24&255)+(r>>>8&65280)+((65280&r)<<8)+((255&r)<<24)}class s1{constructor(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new yn(320),this.work=new yn(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}}let i0,a0,mc=!0;function u1(r){if(mc){let t;for(i0=new Va(512),a0=new Va(32),t=0;t<144;)r.lens[t++]=8;for(;t<256;)r.lens[t++]=9;for(;t<280;)r.lens[t++]=7;for(;t<288;)r.lens[t++]=8;for(na(1,r.lens,0,288,i0,0,r.work,{bits:9}),t=0;t<32;)r.lens[t++]=5;na(2,r.lens,0,32,a0,0,r.work,{bits:5}),mc=!1}r.lencode=i0,r.lenbits=9,r.distcode=a0,r.distbits=5}function xc(r,t,e,n){let a;const o=r.state;return null===o.window&&(o.wsize=1<<o.wbits,o.wnext=0,o.whave=0,o.window=new Nn(o.wsize)),n>=o.wsize?(Ln(o.window,t,e-o.wsize,o.wsize,0),o.wnext=0,o.whave=o.wsize):(a=o.wsize-o.wnext,a>n&&(a=n),Ln(o.window,t,e-n,a,o.wnext),(n-=a)?(Ln(o.window,t,e-n,n,0),o.wnext=n,o.whave=o.wsize):(o.wnext+=a,o.wnext===o.wsize&&(o.wnext=0),o.whave<o.wsize&&(o.whave+=a))),0}function l1(r,t){let e,n,a,o,u,f,w,g,b,L,$,j,se,pe,xe,Ke,Qe,Be,le,Xe,He,$e,rt,Je,dt=0,It=new Nn(4);const Ut=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!r||!r.state||!r.output||!r.input&&0!==r.avail_in)return-2;e=r.state,12===e.mode&&(e.mode=13),u=r.next_out,a=r.output,w=r.avail_out,o=r.next_in,n=r.input,f=r.avail_in,g=e.hold,b=e.bits,L=f,$=w,$e=0;e:for(;;)switch(e.mode){case 1:if(0===e.wrap){e.mode=13;break}for(;b<16;){if(0===f)break e;f--,g+=n[o++]<<b,b+=8}if(2&e.wrap&&35615===g){e.check=0,It[0]=255&g,It[1]=g>>>8&255,e.check=Xr(e.check,It,2,0),g=0,b=0,e.mode=2;break}if(e.flags=0,e.head&&(e.head.done=!1),!(1&e.wrap)||(((255&g)<<8)+(g>>8))%31){r.msg="incorrect header check",e.mode=30;break}if(8!=(15&g)){r.msg="unknown compression method",e.mode=30;break}if(g>>>=4,b-=4,He=8+(15&g),0===e.wbits)e.wbits=He;else if(He>e.wbits){r.msg="invalid window size",e.mode=30;break}e.dmax=1<<He,r.adler=e.check=1,e.mode=512&g?10:12,g=0,b=0;break;case 2:for(;b<16;){if(0===f)break e;f--,g+=n[o++]<<b,b+=8}if(e.flags=g,8!=(255&e.flags)){r.msg="unknown compression method",e.mode=30;break}if(57344&e.flags){r.msg="unknown header flags set",e.mode=30;break}e.head&&(e.head.text=g>>8&1),512&e.flags&&(It[0]=255&g,It[1]=g>>>8&255,e.check=Xr(e.check,It,2,0)),g=0,b=0,e.mode=3;case 3:for(;b<32;){if(0===f)break e;f--,g+=n[o++]<<b,b+=8}e.head&&(e.head.time=g),512&e.flags&&(It[0]=255&g,It[1]=g>>>8&255,It[2]=g>>>16&255,It[3]=g>>>24&255,e.check=Xr(e.check,It,4,0)),g=0,b=0,e.mode=4;case 4:for(;b<16;){if(0===f)break e;f--,g+=n[o++]<<b,b+=8}e.head&&(e.head.xflags=255&g,e.head.os=g>>8),512&e.flags&&(It[0]=255&g,It[1]=g>>>8&255,e.check=Xr(e.check,It,2,0)),g=0,b=0,e.mode=5;case 5:if(1024&e.flags){for(;b<16;){if(0===f)break e;f--,g+=n[o++]<<b,b+=8}e.length=g,e.head&&(e.head.extra_len=g),512&e.flags&&(It[0]=255&g,It[1]=g>>>8&255,e.check=Xr(e.check,It,2,0)),g=0,b=0}else e.head&&(e.head.extra=null);e.mode=6;case 6:if(1024&e.flags&&(j=e.length,j>f&&(j=f),j&&(e.head&&(He=e.head.extra_len-e.length,e.head.extra||(e.head.extra=Array(e.head.extra_len)),Ln(e.head.extra,n,o,j,He)),512&e.flags&&(e.check=Xr(e.check,n,j,o)),f-=j,o+=j,e.length-=j),e.length))break e;e.length=0,e.mode=7;case 7:if(2048&e.flags){if(0===f)break e;j=0;do{He=n[o+j++],e.head&&He&&e.length<65536&&(e.head.name+=String.fromCharCode(He))}while(He&&j<f);if(512&e.flags&&(e.check=Xr(e.check,n,j,o)),f-=j,o+=j,He)break e}else e.head&&(e.head.name=null);e.length=0,e.mode=8;case 8:if(4096&e.flags){if(0===f)break e;j=0;do{He=n[o+j++],e.head&&He&&e.length<65536&&(e.head.comment+=String.fromCharCode(He))}while(He&&j<f);if(512&e.flags&&(e.check=Xr(e.check,n,j,o)),f-=j,o+=j,He)break e}else e.head&&(e.head.comment=null);e.mode=9;case 9:if(512&e.flags){for(;b<16;){if(0===f)break e;f--,g+=n[o++]<<b,b+=8}if(g!==(65535&e.check)){r.msg="header crc mismatch",e.mode=30;break}g=0,b=0}e.head&&(e.head.hcrc=e.flags>>9&1,e.head.done=!0),r.adler=e.check=0,e.mode=12;break;case 10:for(;b<32;){if(0===f)break e;f--,g+=n[o++]<<b,b+=8}r.adler=e.check=vc(g),g=0,b=0,e.mode=11;case 11:if(0===e.havedict)return r.next_out=u,r.avail_out=w,r.next_in=o,r.avail_in=f,e.hold=g,e.bits=b,2;r.adler=e.check=1,e.mode=12;case 12:if(5===t||6===t)break e;case 13:if(e.last){g>>>=7&b,b-=7&b,e.mode=27;break}for(;b<3;){if(0===f)break e;f--,g+=n[o++]<<b,b+=8}switch(e.last=1&g,g>>>=1,b-=1,3&g){case 0:e.mode=14;break;case 1:if(u1(e),e.mode=20,6===t){g>>>=2,b-=2;break e}break;case 2:e.mode=17;break;case 3:r.msg="invalid block type",e.mode=30}g>>>=2,b-=2;break;case 14:for(g>>>=7&b,b-=7&b;b<32;){if(0===f)break e;f--,g+=n[o++]<<b,b+=8}if((65535&g)!=(g>>>16^65535)){r.msg="invalid stored block lengths",e.mode=30;break}if(e.length=65535&g,g=0,b=0,e.mode=15,6===t)break e;case 15:e.mode=16;case 16:if(j=e.length,j){if(j>f&&(j=f),j>w&&(j=w),0===j)break e;Ln(a,n,o,j,u),f-=j,o+=j,w-=j,u+=j,e.length-=j;break}e.mode=12;break;case 17:for(;b<14;){if(0===f)break e;f--,g+=n[o++]<<b,b+=8}if(e.nlen=257+(31&g),g>>>=5,b-=5,e.ndist=1+(31&g),g>>>=5,b-=5,e.ncode=4+(15&g),g>>>=4,b-=4,e.nlen>286||e.ndist>30){r.msg="too many length or distance symbols",e.mode=30;break}e.have=0,e.mode=18;case 18:for(;e.have<e.ncode;){for(;b<3;){if(0===f)break e;f--,g+=n[o++]<<b,b+=8}e.lens[Ut[e.have++]]=7&g,g>>>=3,b-=3}for(;e.have<19;)e.lens[Ut[e.have++]]=0;if(e.lencode=e.lendyn,e.lenbits=7,rt={bits:e.lenbits},$e=na(0,e.lens,0,19,e.lencode,0,e.work,rt),e.lenbits=rt.bits,$e){r.msg="invalid code lengths set",e.mode=30;break}e.have=0,e.mode=19;case 19:for(;e.have<e.nlen+e.ndist;){for(;dt=e.lencode[g&(1<<e.lenbits)-1],xe=dt>>>24,Ke=dt>>>16&255,Qe=65535&dt,!(xe<=b);){if(0===f)break e;f--,g+=n[o++]<<b,b+=8}if(Qe<16)g>>>=xe,b-=xe,e.lens[e.have++]=Qe;else{if(16===Qe){for(Je=xe+2;b<Je;){if(0===f)break e;f--,g+=n[o++]<<b,b+=8}if(g>>>=xe,b-=xe,0===e.have){r.msg="invalid bit length repeat",e.mode=30;break}He=e.lens[e.have-1],j=3+(3&g),g>>>=2,b-=2}else if(17===Qe){for(Je=xe+3;b<Je;){if(0===f)break e;f--,g+=n[o++]<<b,b+=8}g>>>=xe,b-=xe,He=0,j=3+(7&g),g>>>=3,b-=3}else{for(Je=xe+7;b<Je;){if(0===f)break e;f--,g+=n[o++]<<b,b+=8}g>>>=xe,b-=xe,He=0,j=11+(127&g),g>>>=7,b-=7}if(e.have+j>e.nlen+e.ndist){r.msg="invalid bit length repeat",e.mode=30;break}for(;j--;)e.lens[e.have++]=He}}if(30===e.mode)break;if(0===e.lens[256]){r.msg="invalid code -- missing end-of-block",e.mode=30;break}if(e.lenbits=9,rt={bits:e.lenbits},$e=na(1,e.lens,0,e.nlen,e.lencode,0,e.work,rt),e.lenbits=rt.bits,$e){r.msg="invalid literal/lengths set",e.mode=30;break}if(e.distbits=6,e.distcode=e.distdyn,rt={bits:e.distbits},$e=na(2,e.lens,e.nlen,e.ndist,e.distcode,0,e.work,rt),e.distbits=rt.bits,$e){r.msg="invalid distances set",e.mode=30;break}if(e.mode=20,6===t)break e;case 20:e.mode=21;case 21:if(f>=6&&w>=258){r.next_out=u,r.avail_out=w,r.next_in=o,r.avail_in=f,e.hold=g,e.bits=b,t1(r,$),u=r.next_out,a=r.output,w=r.avail_out,o=r.next_in,n=r.input,f=r.avail_in,g=e.hold,b=e.bits,12===e.mode&&(e.back=-1);break}for(e.back=0;dt=e.lencode[g&(1<<e.lenbits)-1],xe=dt>>>24,Ke=dt>>>16&255,Qe=65535&dt,!(xe<=b);){if(0===f)break e;f--,g+=n[o++]<<b,b+=8}if(Ke&&0==(240&Ke)){for(Be=xe,le=Ke,Xe=Qe;dt=e.lencode[Xe+((g&(1<<Be+le)-1)>>Be)],xe=dt>>>24,Ke=dt>>>16&255,Qe=65535&dt,!(Be+xe<=b);){if(0===f)break e;f--,g+=n[o++]<<b,b+=8}g>>>=Be,b-=Be,e.back+=Be}if(g>>>=xe,b-=xe,e.back+=xe,e.length=Qe,0===Ke){e.mode=26;break}if(32&Ke){e.back=-1,e.mode=12;break}if(64&Ke){r.msg="invalid literal/length code",e.mode=30;break}e.extra=15&Ke,e.mode=22;case 22:if(e.extra){for(Je=e.extra;b<Je;){if(0===f)break e;f--,g+=n[o++]<<b,b+=8}e.length+=g&(1<<e.extra)-1,g>>>=e.extra,b-=e.extra,e.back+=e.extra}e.was=e.length,e.mode=23;case 23:for(;dt=e.distcode[g&(1<<e.distbits)-1],xe=dt>>>24,Ke=dt>>>16&255,Qe=65535&dt,!(xe<=b);){if(0===f)break e;f--,g+=n[o++]<<b,b+=8}if(0==(240&Ke)){for(Be=xe,le=Ke,Xe=Qe;dt=e.distcode[Xe+((g&(1<<Be+le)-1)>>Be)],xe=dt>>>24,Ke=dt>>>16&255,Qe=65535&dt,!(Be+xe<=b);){if(0===f)break e;f--,g+=n[o++]<<b,b+=8}g>>>=Be,b-=Be,e.back+=Be}if(g>>>=xe,b-=xe,e.back+=xe,64&Ke){r.msg="invalid distance code",e.mode=30;break}e.offset=Qe,e.extra=15&Ke,e.mode=24;case 24:if(e.extra){for(Je=e.extra;b<Je;){if(0===f)break e;f--,g+=n[o++]<<b,b+=8}e.offset+=g&(1<<e.extra)-1,g>>>=e.extra,b-=e.extra,e.back+=e.extra}if(e.offset>e.dmax){r.msg="invalid distance too far back",e.mode=30;break}e.mode=25;case 25:if(0===w)break e;if(j=$-w,e.offset>j){if(j=e.offset-j,j>e.whave&&e.sane){r.msg="invalid distance too far back",e.mode=30;break}j>e.wnext?(j-=e.wnext,se=e.wsize-j):se=e.wnext-j,j>e.length&&(j=e.length),pe=e.window}else pe=a,se=u-e.offset,j=e.length;j>w&&(j=w),w-=j,e.length-=j;do{a[u++]=pe[se++]}while(--j);0===e.length&&(e.mode=21);break;case 26:if(0===w)break e;a[u++]=e.length,w--,e.mode=21;break;case 27:if(e.wrap){for(;b<32;){if(0===f)break e;f--,g|=n[o++]<<b,b+=8}if($-=w,r.total_out+=$,e.total+=$,$&&(r.adler=e.check=e.flags?Xr(e.check,a,$,u-$):Ji(e.check,a,$,u-$)),$=w,(e.flags?g:vc(g))!==e.check){r.msg="incorrect data check",e.mode=30;break}g=0,b=0}e.mode=28;case 28:if(e.wrap&&e.flags){for(;b<32;){if(0===f)break e;f--,g+=n[o++]<<b,b+=8}if(g!==(4294967295&e.total)){r.msg="incorrect length check",e.mode=30;break}g=0,b=0}e.mode=29;case 29:$e=1;break e;case 30:$e=-3;break e;default:return-2}return r.next_out=u,r.avail_out=w,r.next_in=o,r.avail_in=f,e.hold=g,e.bits=b,(e.wsize||$!==r.avail_out&&e.mode<30&&(e.mode<27||4!==t))&&xc(r,r.output,r.next_out,$-r.avail_out),L-=r.avail_in,$-=r.avail_out,r.total_in+=L,r.total_out+=$,e.total+=$,e.wrap&&$&&(r.adler=e.check=e.flags?Xr(e.check,a,$,r.next_out-$):Ji(e.check,a,$,r.next_out-$)),r.data_type=e.bits+(e.last?64:0)+(12===e.mode?128:0)+(20===e.mode||15===e.mode?256:0),(0===L&&0===$||4===t)&&0===$e&&($e=-5),$e}function bc(r,t){const e=t.length;let n,a;return r&&r.state?(n=r.state,0!==n.wrap&&11!==n.mode?-2:11===n.mode&&(a=1,a=Ji(a,t,e,0),a!==n.check)?-3:(xc(r,t,e,e),n.havedict=1,0)):-2}class f1{constructor(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}}class Ec{constructor(t){this.options={chunkSize:16384,windowBits:0,...t||{}};const e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,0===e.windowBits&&(e.windowBits=-15)),!(e.windowBits>=0&&e.windowBits<16)||t&&t.windowBits||(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&0==(15&e.windowBits)&&(e.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new gc,this.strm.avail_out=0;let n=function c1(r,t){let e,n;return r?(n=new s1,r.state=n,n.window=null,e=function(a,o){let u,f;return a&&a.state?(f=a.state,o<0?(u=0,o=-o):(u=1+(o>>4),o<48&&(o&=15)),o&&(o<8||o>15)?-2:(null!==f.window&&f.wbits!==o&&(f.window=null),f.wrap=u,f.wbits=o,function o1(r){let t;return r&&r.state?(t=r.state,t.wsize=0,t.whave=0,t.wnext=0,function(e){let n;return e&&e.state?(n=e.state,e.total_in=e.total_out=n.total=0,e.msg="",n.wrap&&(e.adler=1&n.wrap),n.mode=1,n.last=0,n.havedict=0,n.dmax=32768,n.head=null,n.hold=0,n.bits=0,n.lencode=n.lendyn=new Va(852),n.distcode=n.distdyn=new Va(592),n.sane=1,n.back=-1,0):-2}(r)):-2}(a))):-2}(r,t),0!==e&&(r.state=null),e):-2}(this.strm,e.windowBits);if(0!==n||(this.header=new f1,function(a,o){let u;a&&a.state&&(u=a.state,0==(2&u.wrap)||(u.head=o,o.done=!1))}(this.strm,this.header),e.dictionary&&("string"==typeof e.dictionary?e.dictionary=r0(e.dictionary):e.dictionary instanceof ArrayBuffer&&(e.dictionary=new Uint8Array(e.dictionary)),e.raw&&(n=bc(this.strm,e.dictionary),0!==n))))throw Error(ea[n])}push(t,e){const{strm:n,options:{chunkSize:a,dictionary:o}}=this;let u,f,w=!1;if(this.ended)return!1;f=e===~~e?e:!0===e?4:0,n.input="string"==typeof t?function(g){const b=new Nn(g.length);for(let L=0,$=b.length;L<$;L++)b[L]=g.charCodeAt(L);return b}(t):t instanceof ArrayBuffer?new Uint8Array(t):t,n.next_in=0,n.avail_in=n.input.length;do{if(0===n.avail_out&&(n.output=new Nn(a),n.next_out=0,n.avail_out=a),u=l1(n,0),2===u&&o&&(u=bc(this.strm,o)),-5===u&&!0===w&&(u=0,w=!1),1!==u&&0!==u)return this.onEnd(u),this.ended=!0,!1;n.next_out&&(0!==n.avail_out&&1!==u&&(0!==n.avail_in||4!==f&&2!==f)||this.onData($o(n.output,n.next_out))),0===n.avail_in&&0===n.avail_out&&(w=!0)}while((n.avail_in>0||0===n.avail_out)&&1!==u);return 1===u&&(f=4),4===f?(u=function(g){if(!g||!g.state)return-2;const b=g.state;return b.window&&(b.window=null),g.state=null,0}(this.strm),this.onEnd(u),this.ended=!0,0===u):2!==f||(this.onEnd(0),n.avail_out=0,!0)}onData(t){this.chunks.push(t)}onEnd(t){0===t&&(this.result=qo(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg}}var wc=[0,1,3,7,15,31,63,127,255],ia=function(r){this.stream=r,this.bitOffset=0,this.curByte=0,this.hasByte=!1};ia.prototype._ensureByte=function(){this.hasByte||(this.curByte=this.stream.readByte(),this.hasByte=!0)},ia.prototype.read=function(r){for(var t=0;r>0;){this._ensureByte();var e=8-this.bitOffset;if(r>=e)t<<=e,t|=wc[e]&this.curByte,this.hasByte=!1,this.bitOffset=0,r-=e;else{t<<=r;var n=e-r;t|=(this.curByte&wc[r]<<n)>>n,this.bitOffset+=r,r=0}}return t},ia.prototype.seek=function(r){var t=r%8,e=(r-t)/8;this.bitOffset=t,this.stream.seek(e),this.hasByte=!1},ia.prototype.pi=function(){var r,t=new Uint8Array(6);for(r=0;r<t.length;r++)t[r]=this.read(8);return Array.prototype.map.call(t,n=>("00"+n.toString(16)).slice(-2)).join("")};var h1=ia,di=function(){};di.prototype.readByte=function(){throw Error("abstract method readByte() not implemented")},di.prototype.read=function(r,t,e){for(var n=0;n<e;){var a=this.readByte();if(a<0)return 0===n?-1:n;r[t++]=a,n++}return n},di.prototype.seek=function(r){throw Error("abstract method seek() not implemented")},di.prototype.writeByte=function(r){throw Error("abstract method readByte() not implemented")},di.prototype.write=function(r,t,e){var n;for(n=0;n<e;n++)this.writeByte(r[t++]);return e},di.prototype.flush=function(){};var s0,Cc=di,d1=(s0=new Uint32Array([0,79764919,159529838,222504665,319059676,398814059,445009330,507990021,638119352,583659535,797628118,726387553,890018660,835552979,1015980042,944750013,1276238704,1221641927,1167319070,1095957929,1595256236,1540665371,1452775106,1381403509,1780037320,1859660671,1671105958,1733955601,2031960084,2111593891,1889500026,1952343757,2552477408,2632100695,2443283854,2506133561,2334638140,2414271883,2191915858,2254759653,3190512472,3135915759,3081330742,3009969537,2905550212,2850959411,2762807018,2691435357,3560074640,3505614887,3719321342,3648080713,3342211916,3287746299,3467911202,3396681109,4063920168,4143685023,4223187782,4286162673,3779000052,3858754371,3904687514,3967668269,881225847,809987520,1023691545,969234094,662832811,591600412,771767749,717299826,311336399,374308984,453813921,533576470,25881363,88864420,134795389,214552010,2023205639,2086057648,1897238633,1976864222,1804852699,1867694188,1645340341,1724971778,1587496639,1516133128,1461550545,1406951526,1302016099,1230646740,1142491917,1087903418,2896545431,2825181984,2770861561,2716262478,3215044683,3143675388,3055782693,3001194130,2326604591,2389456536,2200899649,2280525302,2578013683,2640855108,2418763421,2498394922,3769900519,3832873040,3912640137,3992402750,4088425275,4151408268,4197601365,4277358050,3334271071,3263032808,3476998961,3422541446,3585640067,3514407732,3694837229,3640369242,1762451694,1842216281,1619975040,1682949687,2047383090,2127137669,1938468188,2001449195,1325665622,1271206113,1183200824,1111960463,1543535498,1489069629,1434599652,1363369299,622672798,568075817,748617968,677256519,907627842,853037301,1067152940,995781531,51762726,131386257,177728840,240578815,269590778,349224269,429104020,491947555,4046411278,4126034873,4172115296,4234965207,3794477266,3874110821,3953728444,4016571915,3609705398,3555108353,3735388376,3664026991,3290680682,3236090077,3449943556,3378572211,3174993278,3120533705,3032266256,2961025959,2923101090,2868635157,2813903052,2742672763,2604032198,2683796849,2461293480,2524268063,2284983834,2364738477,2175806836,2238787779,1569362073,1498123566,1409854455,1355396672,1317987909,1246755826,1192025387,1137557660,2072149281,2135122070,1912620623,1992383480,1753615357,1816598090,1627664531,1707420964,295390185,358241886,404320391,483945776,43990325,106832002,186451547,266083308,932423249,861060070,1041341759,986742920,613929101,542559546,756411363,701822548,3316196985,3244833742,3425377559,3370778784,3601682597,3530312978,3744426955,3689838204,3819031489,3881883254,3928223919,4007849240,4037393693,4100235434,4180117107,4259748804,2310601993,2373574846,2151335527,2231098320,2596047829,2659030626,2470359227,2550115596,2947551409,2876312838,2788305887,2733848168,3165939309,3094707162,3040238851,2985771188]),function(){var r=4294967295;this.getCRC=function(){return~r>>>0},this.updateCRC=function(t){r=r<<8^s0[255&(r>>>24^t)]},this.updateCRCRun=function(t,e){for(;e-- >0;)r=r<<8^s0[255&(r>>>24^t)]}}),Ac=function(r,t){var e,n=r[t];for(e=t;e>0;e--)r[e]=r[e-1];return r[0]=n,n},ni={"-1":"Bad file checksum","-2":"Not bzip data","-3":"Unexpected input EOF","-4":"Unexpected output EOF","-5":"Data error","-6":"Out of memory","-7":"Obsolete (pre 0.9.5) bzip format not supported."},en=function(r,t){var e=ni[r]||"unknown error";t&&(e+=": "+t);var n=new TypeError(e);throw n.errorCode=r,n},aa=function(r,t){this.writePos=this.writeCurrent=this.writeCount=0,this._start_bunzip(r,t)};aa.prototype._init_block=function(){return this._get_next_block()?(this.blockCRC=new d1,!0):(this.writeCount=-1,!1)},aa.prototype._start_bunzip=function(r,t){var e=new Uint8Array(4);4===r.read(e,0,4)&&"BZh"===String.fromCharCode(e[0],e[1],e[2])||en(-2,"bad magic");var n=e[3]-48;(n<1||n>9)&&en(-2,"level out of range"),this.reader=new h1(r),this.dbufSize=1e5*n,this.nextoutput=0,this.outputStream=t,this.streamCRC=0},aa.prototype._get_next_block=function(){var r,t,e,n=this.reader,a=n.pi();if("177245385090"===a)return!1;"314159265359"!==a&&en(-2),this.targetBlockCRC=n.read(32)>>>0,this.streamCRC=(this.targetBlockCRC^(this.streamCRC<<1|this.streamCRC>>>31))>>>0,n.read(1)&&en(-7);var o=n.read(24);o>this.dbufSize&&en(-5,"initial position out of bounds");var u=n.read(16),f=new Uint8Array(256),w=0;for(r=0;r<16;r++)if(u&1<<15-r){var g=16*r;for(e=n.read(16),t=0;t<16;t++)e&1<<15-t&&(f[w++]=g+t)}var b=n.read(3);(b<2||b>6)&&en(-5);var L=n.read(15);0===L&&en(-5);var $=new Uint8Array(256);for(r=0;r<b;r++)$[r]=r;var j=new Uint8Array(L);for(r=0;r<L;r++){for(t=0;n.read(1);t++)t>=b&&en(-5);j[r]=Ac($,t)}var se,pe=w+2,xe=[];for(t=0;t<b;t++){var Ke,Qe,Be=new Uint8Array(pe),le=new Uint16Array(21);for(u=n.read(5),r=0;r<pe;r++){for(;(u<1||u>20)&&en(-5),n.read(1);)n.read(1)?u--:u++;Be[r]=u}for(Ke=Qe=Be[0],r=1;r<pe;r++)Be[r]>Qe?Qe=Be[r]:Be[r]<Ke&&(Ke=Be[r]);xe.push(se={}),se.permute=new Uint16Array(258),se.limit=new Uint32Array(22),se.base=new Uint32Array(21),se.minLen=Ke,se.maxLen=Qe;var Xe=0;for(r=Ke;r<=Qe;r++)for(le[r]=se.limit[r]=0,u=0;u<pe;u++)Be[u]===r&&(se.permute[Xe++]=u);for(r=0;r<pe;r++)le[Be[r]]++;for(Xe=u=0,r=Ke;r<Qe;r++)se.limit[r]=(Xe+=le[r])-1,se.base[r+1]=(Xe<<=1)-(u+=le[r]);se.limit[Qe+1]=Number.MAX_VALUE,se.limit[Qe]=Xe+le[Qe]-1,se.base[Ke]=0}var He=new Uint32Array(256);for(r=0;r<256;r++)$[r]=r;var $e,rt=0,Je=0,dt=0,It=this.dbuf=new Uint32Array(this.dbufSize);for(pe=0;;){for(pe--||(pe=49,dt>=L&&en(-5),se=xe[j[dt++]]),t=n.read(r=se.minLen);r>se.maxLen&&en(-5),!(t<=se.limit[r]);r++)t=t<<1|n.read(1);((t-=se.base[r])<0||t>=258)&&en(-5);var Ut=se.permute[t];if(0!==Ut&&1!==Ut){if(rt)for(rt=0,Je+u>this.dbufSize&&en(-5),He[$e=f[$[0]]]+=u;u--;)It[Je++]=$e;if(Ut>w)break;Je>=this.dbufSize&&en(-5),He[$e=f[$e=Ac($,r=Ut-1)]]++,It[Je++]=$e}else rt||(rt=1,u=0),u+=0===Ut?rt:2*rt,rt<<=1}for((o<0||o>=Je)&&en(-5),t=0,r=0;r<256;r++)e=t+He[r],He[r]=t,t=e;for(r=0;r<Je;r++)It[He[$e=255&It[r]]]|=r<<8,He[$e]++;var zt=0,pt=0,Ye=0;return Je&&(pt=255&(zt=It[o]),zt>>=8,Ye=-1),this.writePos=zt,this.writeCurrent=pt,this.writeCount=Je,this.writeRun=Ye,!0},aa.prototype._read_bunzip=function(r,t){var e,n,a;if(this.writeCount<0)return 0;for(var o=this.dbuf,u=this.writePos,f=this.writeCurrent,w=this.writeCount,g=this.writeRun;w;){for(w--,n=f,f=255&(u=o[u]),u>>=8,3==g++?(e=f,a=n,f=-1):(e=1,a=f),this.blockCRC.updateCRCRun(a,e);e--;)this.outputStream.writeByte(a),this.nextoutput++;f!=n&&(g=0)}return this.writeCount=w,this.blockCRC.getCRC()!==this.targetBlockCRC&&en(-5,"Bad block CRC (got "+this.blockCRC.getCRC().toString(16)+" expected "+this.targetBlockCRC.toString(16)+")"),this.nextoutput};var Sc=function(r,t,e){for(var n=function(r){if("readByte"in r)return r;var t=new Cc;return t.pos=0,t.readByte=function(){return r[this.pos++]},t.seek=function(e){this.pos=e},t.eof=function(){return this.pos>=r.length},t}(r),a=function(r){var t=new Cc,e=!0;if(r)if("number"==typeof r)t.buffer=new Uint8Array(r),e=!1;else{if("writeByte"in r)return r;t.buffer=r,e=!1}else t.buffer=new Uint8Array(16384);return t.pos=0,t.writeByte=function(n){if(e&&this.pos>=this.buffer.length){var a=new Uint8Array(2*this.buffer.length);a.set(this.buffer),this.buffer=a}this.buffer[this.pos++]=n},t.getBuffer=function(){if(this.pos!==this.buffer.length){if(!e)throw new TypeError("outputsize does not match decoded input");var n=new Uint8Array(this.pos);n.set(this.buffer.subarray(0,this.pos)),this.buffer=n}return this.buffer},t._coerced=!0,t}(t),o=new aa(n,a);!("eof"in n)||!n.eof();)if(o._init_block())o._read_bunzip();else{var u=o.reader.read(32)>>>0;if(u!==o.streamCRC&&en(-5,"Bad stream CRC (got "+o.streamCRC.toString(16)+" expected "+u.toString(16)+")"),!e||!("eof"in n)||n.eof())break;o._start_bunzip(n,a)}if("getBuffer"in a)return a.getBuffer()};class ii{static get tag(){return Z.packet.literalData}constructor(t=new Date){this.format=Z.literal.utf8,this.date=z.normalizeDate(t),this.text=null,this.data=null,this.filename=""}setText(t,e=Z.literal.utf8){this.format=e,this.text=t,this.data=null}getText(t=!1){return(null===this.text||z.isStream(this.text))&&(this.text=z.decodeUTF8(z.nativeEOL(this.getBytes(t)))),this.text}setBytes(t,e){this.format=e,this.data=t,this.text=null}getBytes(t=!1){return null===this.data&&(this.data=z.canonicalizeEOL(z.encodeUTF8(this.text))),t?ct(this.data):this.data}setFilename(t){this.filename=t}getFilename(){return this.filename}read(t){var e=this;return(0,s.Z)(function*(){yield tt(t,function(){var n=(0,s.Z)(function*(a){const o=yield a.readByte(),u=yield a.readByte();e.filename=z.decodeUTF8(yield a.readBytes(u)),e.date=z.readDate(yield a.readBytes(4));let f=a.remainder();y(f)&&(f=yield Le(f)),e.setBytes(f,o)});return function(a){return n.apply(this,arguments)}}())})()}writeHeader(){const t=z.encodeUTF8(this.filename),e=new Uint8Array([t.length]),n=new Uint8Array([this.format]),a=z.writeDate(this.date);return z.concatUint8Array([n,e,t,a])}write(){const t=this.writeHeader(),e=this.getBytes();return z.concat([t,e])}}const sa=Symbol("verified"),g1=new Set([Z.signatureSubpacket.issuer,Z.signatureSubpacket.issuerFingerprint,Z.signatureSubpacket.embeddedSignature]);class Qr{static get tag(){return Z.packet.signature}constructor(){this.version=null,this.signatureType=null,this.hashAlgorithm=null,this.publicKeyAlgorithm=null,this.signatureData=null,this.unhashedSubpackets=[],this.signedHashValue=null,this.created=null,this.signatureExpirationTime=null,this.signatureNeverExpires=!0,this.exportable=null,this.trustLevel=null,this.trustAmount=null,this.regularExpression=null,this.revocable=null,this.keyExpirationTime=null,this.keyNeverExpires=null,this.preferredSymmetricAlgorithms=null,this.revocationKeyClass=null,this.revocationKeyAlgorithm=null,this.revocationKeyFingerprint=null,this.issuerKeyID=new qt,this.rawNotations=[],this.notations={},this.preferredHashAlgorithms=null,this.preferredCompressionAlgorithms=null,this.keyServerPreferences=null,this.preferredKeyServer=null,this.isPrimaryUserID=null,this.policyURI=null,this.keyFlags=null,this.signersUserID=null,this.reasonForRevocationFlag=null,this.reasonForRevocationString=null,this.features=null,this.signatureTargetPublicKeyAlgorithm=null,this.signatureTargetHashAlgorithm=null,this.signatureTargetHash=null,this.embeddedSignature=null,this.issuerKeyVersion=null,this.issuerFingerprint=null,this.preferredAEADAlgorithms=null,this.revoked=null,this[sa]=null}read(t){let e=0;if(this.version=t[e++],4!==this.version&&5!==this.version)throw new Gr(`Version ${this.version} of the signature packet is unsupported.`);if(this.signatureType=t[e++],this.publicKeyAlgorithm=t[e++],this.hashAlgorithm=t[e++],e+=this.readSubPackets(t.subarray(e,t.length),!0),!this.created)throw Error("Missing signature creation time subpacket.");this.signatureData=t.subarray(0,e),e+=this.readSubPackets(t.subarray(e,t.length),!1),this.signedHashValue=t.subarray(e,e+2),e+=2,this.params=Mt.signature.parseSignatureParams(this.publicKeyAlgorithm,t.subarray(e,t.length))}writeParams(){var t=this;return this.params instanceof Promise?ee((0,s.Z)(function*(){return Mt.serializeParams(t.publicKeyAlgorithm,yield t.params)})):Mt.serializeParams(this.publicKeyAlgorithm,this.params)}write(){const t=[];return t.push(this.signatureData),t.push(this.writeUnhashedSubPackets()),t.push(this.signedHashValue),t.push(this.writeParams()),z.concat(t)}sign(t,e,n=new Date,a=!1){var o=this;return(0,s.Z)(function*(){o.version=5===t.version?5:4;const u=[new Uint8Array([o.version,o.signatureType,o.publicKeyAlgorithm,o.hashAlgorithm])];o.created=z.normalizeDate(n),o.issuerKeyVersion=t.version,o.issuerFingerprint=t.getFingerprintBytes(),o.issuerKeyID=t.getKeyID(),u.push(o.writeHashedSubPackets()),o.signatureData=z.concat(u);const f=o.toHash(o.signatureType,e,a),w=yield o.hash(o.signatureType,e,f,a);o.signedHashValue=Rt(Ht(w),0,2);const g=function(){var b=(0,s.Z)(function*(){return Mt.signature.sign(o.publicKeyAlgorithm,o.hashAlgorithm,t.publicParams,t.privateParams,f,yield Le(w))});return function(){return b.apply(this,arguments)}}();z.isStream(w)?o.params=g():(o.params=yield g(),o[sa]=!0)})()}writeHashedSubPackets(){const t=Z.signatureSubpacket,e=[];let n;if(null===this.created)throw Error("Missing signature creation time");e.push(Lr(t.signatureCreationTime,z.writeDate(this.created))),null!==this.signatureExpirationTime&&e.push(Lr(t.signatureExpirationTime,z.writeNumber(this.signatureExpirationTime,4))),null!==this.exportable&&e.push(Lr(t.exportableCertification,new Uint8Array([this.exportable?1:0]))),null!==this.trustLevel&&(n=new Uint8Array([this.trustLevel,this.trustAmount]),e.push(Lr(t.trustSignature,n))),null!==this.regularExpression&&e.push(Lr(t.regularExpression,this.regularExpression)),null!==this.revocable&&e.push(Lr(t.revocable,new Uint8Array([this.revocable?1:0]))),null!==this.keyExpirationTime&&e.push(Lr(t.keyExpirationTime,z.writeNumber(this.keyExpirationTime,4))),null!==this.preferredSymmetricAlgorithms&&(n=z.stringToUint8Array(z.uint8ArrayToString(this.preferredSymmetricAlgorithms)),e.push(Lr(t.preferredSymmetricAlgorithms,n))),null!==this.revocationKeyClass&&(n=new Uint8Array([this.revocationKeyClass,this.revocationKeyAlgorithm]),n=z.concat([n,this.revocationKeyFingerprint]),e.push(Lr(t.revocationKey,n))),this.rawNotations.forEach(([{name:u,value:f,humanReadable:w}])=>{n=[new Uint8Array([w?128:0,0,0,0])],n.push(z.writeNumber(u.length,2)),n.push(z.writeNumber(f.length,2)),n.push(z.stringToUint8Array(u)),n.push(f),n=z.concat(n),e.push(Lr(t.notationData,n))}),null!==this.preferredHashAlgorithms&&(n=z.stringToUint8Array(z.uint8ArrayToString(this.preferredHashAlgorithms)),e.push(Lr(t.preferredHashAlgorithms,n))),null!==this.preferredCompressionAlgorithms&&(n=z.stringToUint8Array(z.uint8ArrayToString(this.preferredCompressionAlgorithms)),e.push(Lr(t.preferredCompressionAlgorithms,n))),null!==this.keyServerPreferences&&(n=z.stringToUint8Array(z.uint8ArrayToString(this.keyServerPreferences)),e.push(Lr(t.keyServerPreferences,n))),null!==this.preferredKeyServer&&e.push(Lr(t.preferredKeyServer,z.stringToUint8Array(this.preferredKeyServer))),null!==this.isPrimaryUserID&&e.push(Lr(t.primaryUserID,new Uint8Array([this.isPrimaryUserID?1:0]))),null!==this.policyURI&&e.push(Lr(t.policyURI,z.stringToUint8Array(this.policyURI))),null!==this.keyFlags&&(n=z.stringToUint8Array(z.uint8ArrayToString(this.keyFlags)),e.push(Lr(t.keyFlags,n))),null!==this.signersUserID&&e.push(Lr(t.signersUserID,z.stringToUint8Array(this.signersUserID))),null!==this.reasonForRevocationFlag&&(n=z.stringToUint8Array(String.fromCharCode(this.reasonForRevocationFlag)+this.reasonForRevocationString),e.push(Lr(t.reasonForRevocation,n))),null!==this.features&&(n=z.stringToUint8Array(z.uint8ArrayToString(this.features)),e.push(Lr(t.features,n))),null!==this.signatureTargetPublicKeyAlgorithm&&(n=[new Uint8Array([this.signatureTargetPublicKeyAlgorithm,this.signatureTargetHashAlgorithm])],n.push(z.stringToUint8Array(this.signatureTargetHash)),n=z.concat(n),e.push(Lr(t.signatureTarget,n))),null!==this.preferredAEADAlgorithms&&(n=z.stringToUint8Array(z.uint8ArrayToString(this.preferredAEADAlgorithms)),e.push(Lr(t.preferredAEADAlgorithms,n)));const a=z.concat(e),o=z.writeNumber(a.length,2);return z.concat([o,a])}writeUnhashedSubPackets(){const t=Z.signatureSubpacket,e=[];let n;this.issuerKeyID.isNull()||5===this.issuerKeyVersion||e.push(Lr(t.issuer,this.issuerKeyID.write())),null!==this.embeddedSignature&&e.push(Lr(t.embeddedSignature,this.embeddedSignature.write())),null!==this.issuerFingerprint&&(n=[new Uint8Array([this.issuerKeyVersion]),this.issuerFingerprint],n=z.concat(n),e.push(Lr(t.issuerFingerprint,n))),this.unhashedSubpackets.forEach(u=>{e.push(Gi(u.length)),e.push(u)});const a=z.concat(e),o=z.writeNumber(a.length,2);return z.concat([o,a])}readSubPacket(t,e=!0){let n=0;const a=128&t[n],o=127&t[n];if(e||g1.has(o))switch(n++,o){case Z.signatureSubpacket.signatureCreationTime:this.created=z.readDate(t.subarray(n,t.length));break;case Z.signatureSubpacket.signatureExpirationTime:{const u=z.readNumber(t.subarray(n,t.length));this.signatureNeverExpires=0===u,this.signatureExpirationTime=u;break}case Z.signatureSubpacket.exportableCertification:this.exportable=1===t[n++];break;case Z.signatureSubpacket.trustSignature:this.trustLevel=t[n++],this.trustAmount=t[n++];break;case Z.signatureSubpacket.regularExpression:this.regularExpression=t[n];break;case Z.signatureSubpacket.revocable:this.revocable=1===t[n++];break;case Z.signatureSubpacket.keyExpirationTime:{const u=z.readNumber(t.subarray(n,t.length));this.keyExpirationTime=u,this.keyNeverExpires=0===u;break}case Z.signatureSubpacket.preferredSymmetricAlgorithms:this.preferredSymmetricAlgorithms=[...t.subarray(n,t.length)];break;case Z.signatureSubpacket.revocationKey:this.revocationKeyClass=t[n++],this.revocationKeyAlgorithm=t[n++],this.revocationKeyFingerprint=t.subarray(n,n+20);break;case Z.signatureSubpacket.issuer:this.issuerKeyID.read(t.subarray(n,t.length));break;case Z.signatureSubpacket.notationData:{const u=!!(128&t[n]);n+=4;const f=z.readNumber(t.subarray(n,n+2));n+=2;const w=z.readNumber(t.subarray(n,n+2));n+=2;const g=z.uint8ArrayToString(t.subarray(n,n+f)),b=t.subarray(n+f,n+f+w);this.rawNotations.push({name:g,humanReadable:u,value:b,critical:a}),u&&(this.notations[g]=z.uint8ArrayToString(b));break}case Z.signatureSubpacket.preferredHashAlgorithms:this.preferredHashAlgorithms=[...t.subarray(n,t.length)];break;case Z.signatureSubpacket.preferredCompressionAlgorithms:this.preferredCompressionAlgorithms=[...t.subarray(n,t.length)];break;case Z.signatureSubpacket.keyServerPreferences:this.keyServerPreferences=[...t.subarray(n,t.length)];break;case Z.signatureSubpacket.preferredKeyServer:this.preferredKeyServer=z.uint8ArrayToString(t.subarray(n,t.length));break;case Z.signatureSubpacket.primaryUserID:this.isPrimaryUserID=0!==t[n++];break;case Z.signatureSubpacket.policyURI:this.policyURI=z.uint8ArrayToString(t.subarray(n,t.length));break;case Z.signatureSubpacket.keyFlags:this.keyFlags=[...t.subarray(n,t.length)];break;case Z.signatureSubpacket.signersUserID:this.signersUserID=z.uint8ArrayToString(t.subarray(n,t.length));break;case Z.signatureSubpacket.reasonForRevocation:this.reasonForRevocationFlag=t[n++],this.reasonForRevocationString=z.uint8ArrayToString(t.subarray(n,t.length));break;case Z.signatureSubpacket.features:this.features=[...t.subarray(n,t.length)];break;case Z.signatureSubpacket.signatureTarget:{this.signatureTargetPublicKeyAlgorithm=t[n++],this.signatureTargetHashAlgorithm=t[n++];const u=Mt.getHashByteLength(this.signatureTargetHashAlgorithm);this.signatureTargetHash=z.uint8ArrayToString(t.subarray(n,n+u));break}case Z.signatureSubpacket.embeddedSignature:this.embeddedSignature=new Qr,this.embeddedSignature.read(t.subarray(n,t.length));break;case Z.signatureSubpacket.issuerFingerprint:this.issuerKeyVersion=t[n++],this.issuerFingerprint=t.subarray(n,t.length),this.issuerKeyID.read(5===this.issuerKeyVersion?this.issuerFingerprint:this.issuerFingerprint.subarray(-8));break;case Z.signatureSubpacket.preferredAEADAlgorithms:this.preferredAEADAlgorithms=[...t.subarray(n,t.length)];break;default:{const u=Error("Unknown signature subpacket type "+o);if(a)throw u;z.printDebug(u)}}else this.unhashedSubpackets.push(t.subarray(n,t.length))}readSubPackets(t,e=!0,n){const a=z.readNumber(t.subarray(0,2));let o=2;for(;o<2+a;){const u=Eo(t.subarray(o,t.length));o+=u.offset,this.readSubPacket(t.subarray(o,o+u.len),e,n),o+=u.len}return o}toSign(t,e){const n=Z.signature;switch(t){case n.binary:return null!==e.text?z.encodeUTF8(e.getText(!0)):e.getBytes(!0);case n.text:{const a=e.getBytes(!0);return z.canonicalizeEOL(a)}case n.standalone:return new Uint8Array(0);case n.certGeneric:case n.certPersona:case n.certCasual:case n.certPositive:case n.certRevocation:{let a,o;if(e.userID)o=180,a=e.userID;else{if(!e.userAttribute)throw Error("Either a userID or userAttribute packet needs to be supplied for certification.");o=209,a=e.userAttribute}const u=a.write();return z.concat([this.toSign(n.key,e),new Uint8Array([o]),z.writeNumber(u.length,4),u])}case n.subkeyBinding:case n.subkeyRevocation:case n.keyBinding:return z.concat([this.toSign(n.key,e),this.toSign(n.key,{key:e.bind})]);case n.key:if(void 0===e.key)throw Error("Key packet is required for this signature.");return e.key.writeForHash(this.version);case n.keyRevocation:return this.toSign(n.key,e);case n.timestamp:return new Uint8Array(0);case n.thirdParty:throw Error("Not implemented");default:throw Error("Unknown signature type.")}}calculateTrailer(t,e){let n=0;return Ze(Ht(this.signatureData),a=>{n+=a.length},()=>{const a=[];return 5!==this.version||this.signatureType!==Z.signature.binary&&this.signatureType!==Z.signature.text||a.push(e?new Uint8Array(6):t.writeHeader()),a.push(new Uint8Array([this.version,255])),5===this.version&&a.push(new Uint8Array(4)),a.push(z.writeNumber(n,4)),z.concat(a)})}toHash(t,e,n=!1){const a=this.toSign(t,e);return z.concat([a,this.signatureData,this.calculateTrailer(e,n)])}hash(t,e,n,a=!1){var o=this;return(0,s.Z)(function*(){return n||(n=o.toHash(t,e,a)),Mt.hash.digest(o.hashAlgorithm,n)})()}verify(t,e,n,a=new Date,o=!1,u=ut){var f=this;return(0,s.Z)(function*(){if(!f.issuerKeyID.equals(t.getKeyID()))throw Error("Signature was not issued by the given public key");if(f.publicKeyAlgorithm!==t.algorithm)throw Error("Public key algorithm used to sign signature does not match issuer key algorithm.");if(!f[sa]||e===Z.signature.binary||e===Z.signature.text){let b,L;if(f.hashed?L=yield f.hashed:(b=f.toHash(e,n,o),L=yield f.hash(e,n,b)),L=yield Le(L),f.signedHashValue[0]!==L[0]||f.signedHashValue[1]!==L[1])throw Error("Signed digest did not match");if(f.params=yield f.params,f[sa]=yield Mt.signature.verify(f.publicKeyAlgorithm,f.hashAlgorithm,f.params,t.publicParams,b,L),!f[sa])throw Error("Signature verification failed")}const g=z.normalizeDate(a);if(g&&f.created>g)throw Error("Signature creation time is in the future");if(g&&g>=f.getExpirationTime())throw Error("Signature is expired");if(u.rejectHashAlgorithms.has(f.hashAlgorithm))throw Error("Insecure hash algorithm: "+Z.read(Z.hash,f.hashAlgorithm).toUpperCase());if(u.rejectMessageHashAlgorithms.has(f.hashAlgorithm)&&[Z.signature.binary,Z.signature.text].includes(f.signatureType))throw Error("Insecure message hash algorithm: "+Z.read(Z.hash,f.hashAlgorithm).toUpperCase());if(f.rawNotations.forEach(({name:b,critical:L})=>{if(L&&u.knownNotations.indexOf(b)<0)throw Error("Unknown critical notation: "+b)}),null!==f.revocationKeyClass)throw Error("This key is intended to be revoked with an authorized key, which OpenPGP.js does not support.")})()}isExpired(t=new Date){const e=z.normalizeDate(t);return null!==e&&!(this.created<=e&&e<this.getExpirationTime())}getExpirationTime(){return this.signatureNeverExpires?1/0:new Date(this.created.getTime()+1e3*this.signatureExpirationTime)}}function Lr(r,t){const e=[];return e.push(Gi(t.length+1)),e.push(new Uint8Array([r])),e.push(t),z.concat(e)}class xn{static get tag(){return Z.packet.onePassSignature}constructor(){this.version=null,this.signatureType=null,this.hashAlgorithm=null,this.publicKeyAlgorithm=null,this.issuerKeyID=null,this.flags=null}read(t){let e=0;if(this.version=t[e++],3!==this.version)throw new Gr(`Version ${this.version} of the one-pass signature packet is unsupported.`);return this.signatureType=t[e++],this.hashAlgorithm=t[e++],this.publicKeyAlgorithm=t[e++],this.issuerKeyID=new qt,this.issuerKeyID.read(t.subarray(e,e+8)),e+=8,this.flags=t[e++],this}write(){const t=new Uint8Array([3,this.signatureType,this.hashAlgorithm,this.publicKeyAlgorithm]),e=new Uint8Array([this.flags]);return z.concatUint8Array([t,this.issuerKeyID.write(),e])}calculateTrailer(...t){var e=this;return ee((0,s.Z)(function*(){return Qr.prototype.calculateTrailer.apply(yield e.correspondingSig,t)}))}verify(){var t=arguments,e=this;return(0,s.Z)(function*(){const n=yield e.correspondingSig;if(!n||n.constructor.tag!==Z.packet.signature)throw Error("Corresponding signature packet missing");if(n.signatureType!==e.signatureType||n.hashAlgorithm!==e.hashAlgorithm||n.publicKeyAlgorithm!==e.publicKeyAlgorithm||!n.issuerKeyID.equals(e.issuerKeyID))throw Error("Corresponding signature packet does not match one-pass signature packet");return n.hashed=e.hashed,n.verify.apply(n,t)})()}}function v1(r,t){if(!t[r]){let e;try{e=Z.read(Z.packet,r)}catch{throw new Gr("Unknown packet type with tag: "+r)}throw Error("Packet not allowed in this context: "+e)}return new t[r]}xn.prototype.hash=Qr.prototype.hash,xn.prototype.toHash=Qr.prototype.toHash,xn.prototype.toSign=Qr.prototype.toSign;class fr extends Array{static fromBinary(t,e,n=ut){return(0,s.Z)(function*(){const a=new fr;return yield a.read(t,e,n),a})()}read(t,e,n=ut){var a=this;return(0,s.Z)(function*(){a.stream=Ct(t,function(){var u=(0,s.Z)(function*(f,w){const g=Re(w);try{for(;;)if(yield g.ready,yield _u(f,function(){var b=(0,s.Z)(function*(L){try{if(L.tag===Z.packet.marker||L.tag===Z.packet.trust)return;const $=v1(L.tag,e);$.packets=new fr,$.fromStream=z.isStream(L.packet),yield $.read(L.packet,n),yield g.write($)}catch($){const se=!(n.ignoreMalformedPackets||$ instanceof Gr);if(!n.ignoreUnsupportedPackets&&$ instanceof Gr||se||Ta(L.tag))yield g.abort($);else{const pe=new Bs(L.tag,L.packet);yield g.write(pe)}z.printDebugError($)}});return function(L){return b.apply(this,arguments)}}()))return yield g.ready,void(yield g.close())}catch(b){yield g.abort(b)}});return function(f,w){return u.apply(this,arguments)}}());const o=Ae(a.stream);for(;;){const{done:u,value:f}=yield o.read();if(u?a.stream=null:a.push(f),u||Ta(f.constructor.tag))break}o.releaseLock()})()}write(){const t=[];for(let e=0;e<this.length;e++){const n=this[e]instanceof Bs?this[e].tag:this[e].constructor.tag,a=this[e].write();if(z.isStream(a)&&Ta(this[e].constructor.tag)){let o=[],u=0;const f=512;t.push(wo(n)),t.push(Ze(a,w=>{if(o.push(w),u+=w.length,u>=f){const g=Math.min(Math.log(u)/Math.LN2|0,30),b=2**g,L=z.concat([Su(g)].concat(o));return o=[L.subarray(1+b)],u=o[0].length,L.subarray(0,1+b)}},()=>z.concat([Gi(u)].concat(o))))}else{if(z.isStream(a)){let o=0;t.push(Ze(Ht(a),u=>{o+=u.length},()=>Co(n,o)))}else t.push(Co(n,a.length));t.push(a)}}return z.concat(t)}filterByTag(...t){const e=new fr,n=a=>o=>a===o;for(let a=0;a<this.length;a++)t.some(n(this[a].constructor.tag))&&e.push(this[a]);return e}findPacket(t){return this.find(e=>e.constructor.tag===t)}indexOfTag(...t){const e=[],n=this,a=o=>u=>o===u;for(let o=0;o<this.length;o++)t.some(a(n[o].constructor.tag))&&e.push(o);return e}}const m1=z.constructAllowedPackets([ii,xn,Qr]);class oa{static get tag(){return Z.packet.compressedData}constructor(t=ut){this.packets=null,this.algorithm=t.preferredCompressionAlgorithm,this.compressed=null,this.deflateLevel=t.deflateLevel}read(t,e=ut){var n=this;return(0,s.Z)(function*(){yield tt(t,function(){var a=(0,s.Z)(function*(o){n.algorithm=yield o.readByte(),n.compressed=o.remainder(),yield n.decompress(e)});return function(o){return a.apply(this,arguments)}}())})()}write(){return null===this.compressed&&this.compress(),z.concat([new Uint8Array([this.algorithm]),this.compressed])}decompress(t=ut){var e=this;return(0,s.Z)(function*(){const n=Z.read(Z.compression,e.algorithm),a=b1[n];if(!a)throw Error(n+" decompression not supported");e.packets=yield fr.fromBinary(a(e.compressed),m1,t)})()}compress(){const t=Z.read(Z.compression,this.algorithm),e=x1[t];if(!e)throw Error(t+" compression not supported");this.compressed=e(this.packets.write(),this.deflateLevel)}}const Mn=z.getNodeZlib();function _c(r){return r}function Ga(r,t,e={}){return function(n){return!z.isStream(n)||y(n)?ee(()=>Le(n).then(a=>new Promise((o,u)=>{r(a,e,(f,w)=>{if(f)return u(f);o(w)})}))):I(p(n).pipe(t(e)))}}function ja(r,t={}){return function(e){const n=new r(t);return Ze(e,a=>{if(a.length)return n.push(a,2),n.result},()=>{if(r===n0)return n.push([],4),n.result})}}function kc(r){return function(t){return ee((0,s.Z)(function*(){return r(yield Le(t))}))}}const x1=Mn?{zip:(r,t)=>Ga(Mn.deflateRaw,Mn.createDeflateRaw,{level:t})(r),zlib:(r,t)=>Ga(Mn.deflate,Mn.createDeflate,{level:t})(r)}:{zip:(r,t)=>ja(n0,{raw:!0,level:t})(r),zlib:(r,t)=>ja(n0,{level:t})(r)},b1=Mn?{uncompressed:_c,zip:Ga(Mn.inflateRaw,Mn.createInflateRaw),zlib:Ga(Mn.inflate,Mn.createInflate),bzip2:kc(Sc)}:{uncompressed:_c,zip:ja(Ec,{raw:!0}),zlib:ja(Ec),bzip2:kc(Sc)},E1=z.constructAllowedPackets([ii,oa,xn,Qr]);class Tc{static get tag(){return Z.packet.symEncryptedIntegrityProtectedData}constructor(){this.version=1,this.encrypted=null,this.packets=null}read(t){var e=this;return(0,s.Z)(function*(){yield tt(t,function(){var n=(0,s.Z)(function*(a){const o=yield a.readByte();if(1!==o)throw new Gr(`Version ${o} of the SEIP packet is unsupported.`);e.encrypted=a.remainder()});return function(a){return n.apply(this,arguments)}}())})()}write(){return z.concat([new Uint8Array([1]),this.encrypted])}encrypt(t,e,n=ut){var a=this;return(0,s.Z)(function*(){const{blockSize:o}=Mt.getCipher(t);let u=a.packets.write();y(u)&&(u=yield Le(u));const f=yield Mt.getPrefixRandom(t),w=new Uint8Array([211,20]),g=z.concat([f,u,w]),b=yield Mt.hash.sha1(ct(g)),L=z.concat([g,b]);return a.encrypted=yield Mt.mode.cfb.encrypt(t,e,L,new Uint8Array(o),n),!0})()}decrypt(t,e,n=ut){var a=this;return(0,s.Z)(function*(){const{blockSize:o}=Mt.getCipher(t);let u=Ht(a.encrypted);y(u)&&(u=yield Le(u));const f=yield Mt.mode.cfb.decrypt(t,e,u,new Uint8Array(o)),w=Rt(ct(f),-20),g=Rt(f,0,-20),b=Promise.all([Le(yield Mt.hash.sha1(ct(g))),Le(w)]).then(([j,se])=>{if(!z.equalsUint8Array(j,se))throw Error("Modification detected.");return new Uint8Array}),L=Rt(g,o+2);let $=Rt(L,0,-2);return $=de([$,ee(()=>b)]),z.isStream(u)&&n.allowUnauthenticatedStream||($=yield Le($)),a.packets=yield fr.fromBinary($,E1,n),!0})()}}const w1=z.constructAllowedPackets([ii,oa,xn,Qr]);class Wa{static get tag(){return Z.packet.aeadEncryptedData}constructor(){this.version=1,this.cipherAlgorithm=null,this.aeadAlgorithm=Z.aead.eax,this.chunkSizeByte=null,this.iv=null,this.encrypted=null,this.packets=null}read(t){var e=this;return(0,s.Z)(function*(){yield tt(t,function(){var n=(0,s.Z)(function*(a){const o=yield a.readByte();if(1!==o)throw new Gr(`Version ${o} of the AEAD-encrypted data packet is not supported.`);e.cipherAlgorithm=yield a.readByte(),e.aeadAlgorithm=yield a.readByte(),e.chunkSizeByte=yield a.readByte();const u=Mt.getAEADMode(e.aeadAlgorithm);e.iv=yield a.readBytes(u.ivLength),e.encrypted=a.remainder()});return function(a){return n.apply(this,arguments)}}())})()}write(){return z.concat([new Uint8Array([this.version,this.cipherAlgorithm,this.aeadAlgorithm,this.chunkSizeByte]),this.iv,this.encrypted])}decrypt(t,e,n=ut){var a=this;return(0,s.Z)(function*(){a.packets=yield fr.fromBinary(yield a.crypt("decrypt",e,Ht(a.encrypted)),w1,n)})()}encrypt(t,e,n=ut){var a=this;return(0,s.Z)(function*(){a.cipherAlgorithm=t;const{ivLength:o}=Mt.getAEADMode(a.aeadAlgorithm);a.iv=yield Mt.random.getRandomBytes(o),a.chunkSizeByte=n.aeadChunkSizeByte;const u=a.packets.write();a.encrypted=yield a.crypt("encrypt",e,u)})()}crypt(t,e,n){var a=this;return(0,s.Z)(function*(){const o=Mt.getAEADMode(a.aeadAlgorithm),u=yield o(a.cipherAlgorithm,e),f="decrypt"===t?o.tagLength:0,w="encrypt"===t?o.tagLength:0,g=2**(a.chunkSizeByte+6)+f,b=new ArrayBuffer(21),L=new Uint8Array(b,0,13),$=new Uint8Array(b),j=new DataView(b),se=new Uint8Array(b,5,8);L.set([192|Wa.tag,a.version,a.cipherAlgorithm,a.aeadAlgorithm,a.chunkSizeByte],0);let pe=0,xe=Promise.resolve(),Ke=0,Qe=0;const Be=a.iv;return Ct(n,function(){var le=(0,s.Z)(function*(Xe,He){if("array"!==z.isStream(Xe)){const Je=new D({},{highWaterMark:z.getHardwareConcurrency()*2**(a.chunkSizeByte+6),size:dt=>dt.length});Fe(Je.readable,He),He=Je.writable}const $e=Ae(Xe),rt=Re(He);try{for(;;){let Je=(yield $e.readBytes(g+f))||new Uint8Array;const dt=Je.subarray(Je.length-f);let It,Ut;if(Je=Je.subarray(0,Je.length-f),!pe||Je.length?($e.unshift(dt),It=u[t](Je,o.getNonce(Be,se),L),Qe+=Je.length-f+w):(j.setInt32(17,Ke),It=u[t](dt,o.getNonce(Be,se),$),Qe+=w,Ut=!0),Ke+=Je.length-f,xe=xe.then(()=>It).then(function(){var zt=(0,s.Z)(function*(pt){yield rt.ready,yield rt.write(pt),Qe-=pt.length});return function(pt){return zt.apply(this,arguments)}}()).catch(zt=>rt.abort(zt)),(Ut||Qe>rt.desiredSize)&&(yield xe),Ut){yield rt.close();break}j.setInt32(9,++pe)}}catch(Je){yield rt.abort(Je)}});return function(Xe,He){return le.apply(this,arguments)}}())})()}}class o0{static get tag(){return Z.packet.publicKeyEncryptedSessionKey}constructor(){this.version=3,this.publicKeyID=new qt,this.publicKeyAlgorithm=null,this.sessionKey=null,this.sessionKeyAlgorithm=null,this.encrypted={}}read(t){if(this.version=t[0],3!==this.version)throw new Gr(`Version ${this.version} of the PKESK packet is unsupported.`);this.publicKeyID.read(t.subarray(1,t.length)),this.publicKeyAlgorithm=t[9],this.encrypted=Mt.parseEncSessionKeyParams(this.publicKeyAlgorithm,t.subarray(10))}write(){const t=[new Uint8Array([this.version]),this.publicKeyID.write(),new Uint8Array([this.publicKeyAlgorithm]),Mt.serializeParams(this.publicKeyAlgorithm,this.encrypted)];return z.concatUint8Array(t)}encrypt(t){var e=this;return(0,s.Z)(function*(){const n=z.concatUint8Array([new Uint8Array([Z.write(Z.symmetric,e.sessionKeyAlgorithm)]),e.sessionKey,z.writeChecksum(e.sessionKey)]),a=Z.write(Z.publicKey,e.publicKeyAlgorithm);e.encrypted=yield Mt.publicKeyEncrypt(a,t.publicParams,n,t.getFingerprintBytes())})()}decrypt(t,e){var n=this;return(0,s.Z)(function*(){if(n.publicKeyAlgorithm!==t.algorithm)throw Error("Decryption error");const a=e?z.concatUint8Array([new Uint8Array([e.sessionKeyAlgorithm]),e.sessionKey,z.writeChecksum(e.sessionKey)]):null,o=yield Mt.publicKeyDecrypt(n.publicKeyAlgorithm,t.publicParams,t.privateParams,n.encrypted,t.getFingerprintBytes(),a),u=o[0],f=o.subarray(1,o.length-2),w=o.subarray(o.length-2),g=z.writeChecksum(f),b=g[0]===w[0]&g[1]===w[1];if(e){const L=b&u===e.sessionKeyAlgorithm&f.length===e.sessionKey.length;n.sessionKeyAlgorithm=z.selectUint8(L,u,e.sessionKeyAlgorithm),n.sessionKey=z.selectUint8Array(L,f,e.sessionKey)}else{if(!b||!Z.read(Z.symmetric,u))throw Error("Decryption error");n.sessionKey=f,n.sessionKeyAlgorithm=u}})()}}class ca{constructor(t=ut){this.algorithm=Z.hash.sha256,this.type="iterated",this.c=t.s2kIterationCountByte,this.salt=null}getCount(){return 16+(15&this.c)<<6+(this.c>>4)}read(t){let e=0;switch(this.type=Z.read(Z.s2k,t[e++]),this.algorithm=t[e++],this.type){case"simple":break;case"salted":this.salt=t.subarray(e,e+8),e+=8;break;case"iterated":this.salt=t.subarray(e,e+8),e+=8,this.c=t[e++];break;case"gnu":if("GNU"!==z.uint8ArrayToString(t.subarray(e,e+3)))throw Error("Unknown s2k type.");if(e+=3,1e3+t[e++]!==1001)throw Error("Unknown s2k gnu protection mode.");this.type="gnu-dummy";break;default:throw Error("Unknown s2k type.")}return e}write(){if("gnu-dummy"===this.type)return new Uint8Array([101,0,...z.stringToUint8Array("GNU"),1]);const t=[new Uint8Array([Z.write(Z.s2k,this.type),this.algorithm])];switch(this.type){case"simple":break;case"salted":t.push(this.salt);break;case"iterated":t.push(this.salt),t.push(new Uint8Array([this.c]));break;case"gnu":throw Error("GNU s2k type not supported.");default:throw Error("Unknown s2k type.")}return z.concatUint8Array(t)}produceKey(t,e){var n=this;return(0,s.Z)(function*(){t=z.encodeUTF8(t);const a=[];let o=0,u=0;for(;o<e;){let f;switch(n.type){case"simple":f=z.concatUint8Array([new Uint8Array(u),t]);break;case"salted":f=z.concatUint8Array([new Uint8Array(u),n.salt,t]);break;case"iterated":{const g=z.concatUint8Array([n.salt,t]);let b=g.length;const L=Math.max(n.getCount(),b);f=new Uint8Array(u+L),f.set(g,u);for(let $=u+b;$<L;$+=b,b*=2)f.copyWithin($,u,$);break}case"gnu":throw Error("GNU s2k type not supported.");default:throw Error("Unknown s2k type.")}const w=yield Mt.hash.digest(n.algorithm,f);a.push(w),o+=w.length,u++}return z.concatUint8Array(a).subarray(0,e)})()}}class Bi{static get tag(){return Z.packet.symEncryptedSessionKey}constructor(t=ut){this.version=t.aeadProtect?5:4,this.sessionKey=null,this.sessionKeyEncryptionAlgorithm=null,this.sessionKeyAlgorithm=Z.symmetric.aes256,this.aeadAlgorithm=Z.write(Z.aead,t.preferredAEADAlgorithm),this.encrypted=null,this.s2k=null,this.iv=null}read(t){let e=0;if(this.version=t[e++],4!==this.version&&5!==this.version)throw new Gr(`Version ${this.version} of the SKESK packet is unsupported.`);const n=t[e++];if(5===this.version&&(this.aeadAlgorithm=t[e++]),this.s2k=new ca,e+=this.s2k.read(t.subarray(e,t.length)),5===this.version){const a=Mt.getAEADMode(this.aeadAlgorithm);this.iv=t.subarray(e,e+=a.ivLength)}5===this.version||e<t.length?(this.encrypted=t.subarray(e,t.length),this.sessionKeyEncryptionAlgorithm=n):this.sessionKeyAlgorithm=n}write(){const t=null===this.encrypted?this.sessionKeyAlgorithm:this.sessionKeyEncryptionAlgorithm;let e;return 5===this.version?e=z.concatUint8Array([new Uint8Array([this.version,t,this.aeadAlgorithm]),this.s2k.write(),this.iv,this.encrypted]):(e=z.concatUint8Array([new Uint8Array([this.version,t]),this.s2k.write()]),null!==this.encrypted&&(e=z.concatUint8Array([e,this.encrypted]))),e}decrypt(t){var e=this;return(0,s.Z)(function*(){const n=null!==e.sessionKeyEncryptionAlgorithm?e.sessionKeyEncryptionAlgorithm:e.sessionKeyAlgorithm,{blockSize:a,keySize:o}=Mt.getCipher(n),u=yield e.s2k.produceKey(t,o);if(5===e.version){const f=Mt.getAEADMode(e.aeadAlgorithm),w=new Uint8Array([192|Bi.tag,e.version,e.sessionKeyEncryptionAlgorithm,e.aeadAlgorithm]),g=yield f(n,u);e.sessionKey=yield g.decrypt(e.encrypted,e.iv,w)}else if(null!==e.encrypted){const f=yield Mt.mode.cfb.decrypt(n,u,e.encrypted,new Uint8Array(a));e.sessionKeyAlgorithm=Z.write(Z.symmetric,f[0]),e.sessionKey=f.subarray(1,f.length)}else e.sessionKey=u})()}encrypt(t,e=ut){var n=this;return(0,s.Z)(function*(){const a=null!==n.sessionKeyEncryptionAlgorithm?n.sessionKeyEncryptionAlgorithm:n.sessionKeyAlgorithm;n.sessionKeyEncryptionAlgorithm=a,n.s2k=new ca(e),n.s2k.salt=yield Mt.random.getRandomBytes(8);const{blockSize:o,keySize:u}=Mt.getCipher(a),f=yield n.s2k.produceKey(t,u);if(null===n.sessionKey&&(n.sessionKey=yield Mt.generateSessionKey(n.sessionKeyAlgorithm)),5===n.version){const w=Mt.getAEADMode(n.aeadAlgorithm);n.iv=yield Mt.random.getRandomBytes(w.ivLength);const g=new Uint8Array([192|Bi.tag,n.version,n.sessionKeyEncryptionAlgorithm,n.aeadAlgorithm]),b=yield w(a,f);n.encrypted=yield b.encrypt(n.sessionKey,n.iv,g)}else{const w=z.concatUint8Array([new Uint8Array([n.sessionKeyAlgorithm]),n.sessionKey]);n.encrypted=yield Mt.mode.cfb.encrypt(a,f,w,new Uint8Array(o),e)}})()}}class bn{static get tag(){return Z.packet.publicKey}constructor(t=new Date,e=ut){this.version=e.v5Keys?5:4,this.created=z.normalizeDate(t),this.algorithm=null,this.publicParams=null,this.expirationTimeV3=0,this.fingerprint=null,this.keyID=null}static fromSecretKeyPacket(t){const e=new bn,{version:n,created:a,algorithm:o,publicParams:u,keyID:f,fingerprint:w}=t;return e.version=n,e.created=a,e.algorithm=o,e.publicParams=u,e.keyID=f,e.fingerprint=w,e}read(t){var e=this;return(0,s.Z)(function*(){let n=0;if(e.version=t[n++],4===e.version||5===e.version){e.created=z.readDate(t.subarray(n,n+4)),n+=4,e.algorithm=t[n++],5===e.version&&(n+=4);const{read:a,publicParams:o}=Mt.parsePublicKeyParams(e.algorithm,t.subarray(n));return e.publicParams=o,n+=a,yield e.computeFingerprintAndKeyID(),n}throw new Gr(`Version ${e.version} of the key packet is unsupported.`)})()}write(){const t=[];t.push(new Uint8Array([this.version])),t.push(z.writeDate(this.created)),t.push(new Uint8Array([this.algorithm]));const e=Mt.serializeParams(this.algorithm,this.publicParams);return 5===this.version&&t.push(z.writeNumber(e.length,4)),t.push(e),z.concatUint8Array(t)}writeForHash(t){const e=this.writePublicKey();return z.concatUint8Array(5===t?[new Uint8Array([154]),z.writeNumber(e.length,4),e]:[new Uint8Array([153]),z.writeNumber(e.length,2),e])}isDecrypted(){return null}getCreationTime(){return this.created}getKeyID(){return this.keyID}computeFingerprintAndKeyID(){var t=this;return(0,s.Z)(function*(){if(yield t.computeFingerprint(),t.keyID=new qt,5===t.version)t.keyID.read(t.fingerprint.subarray(0,8));else{if(4!==t.version)throw Error("Unsupported key version");t.keyID.read(t.fingerprint.subarray(12,20))}})()}computeFingerprint(){var t=this;return(0,s.Z)(function*(){const e=t.writeForHash(t.version);if(5===t.version)t.fingerprint=yield Mt.hash.sha256(e);else{if(4!==t.version)throw Error("Unsupported key version");t.fingerprint=yield Mt.hash.sha1(e)}})()}getFingerprintBytes(){return this.fingerprint}getFingerprint(){return z.uint8ArrayToHex(this.getFingerprintBytes())}hasSameFingerprintAs(t){return this.version===t.version&&z.equalsUint8Array(this.writePublicKey(),t.writePublicKey())}getAlgorithmInfo(){const t={};t.algorithm=Z.read(Z.publicKey,this.algorithm);const e=this.publicParams.n||this.publicParams.p;return e?t.bits=z.uint8ArrayBitLength(e):t.curve=this.publicParams.oid.getName(),t}}bn.prototype.readPublicKey=bn.prototype.read,bn.prototype.writePublicKey=bn.prototype.write;const C1=z.constructAllowedPackets([ii,oa,xn,Qr]);class ua extends bn{static get tag(){return Z.packet.publicSubkey}constructor(t,e){super(t,e)}static fromSecretSubkeyPacket(t){const e=new ua,{version:n,created:a,algorithm:o,publicParams:u,keyID:f,fingerprint:w}=t;return e.version=n,e.created=a,e.algorithm=o,e.publicParams=u,e.keyID=f,e.fingerprint=w,e}}class c0{static get tag(){return Z.packet.userAttribute}constructor(){this.attributes=[]}read(t){let e=0;for(;e<t.length;){const n=Eo(t.subarray(e,t.length));e+=n.offset,this.attributes.push(z.uint8ArrayToString(t.subarray(e,e+n.len))),e+=n.len}}write(){const t=[];for(let e=0;e<this.attributes.length;e++)t.push(Gi(this.attributes[e].length)),t.push(z.stringToUint8Array(this.attributes[e]));return z.concatUint8Array(t)}equals(t){return!!(t&&t instanceof c0)&&this.attributes.every(function(e,n){return e===t.attributes[n]})}}class Qa extends bn{static get tag(){return Z.packet.secretKey}constructor(t=new Date,e=ut){super(t,e),this.keyMaterial=null,this.isEncrypted=null,this.s2kUsage=0,this.s2k=null,this.symmetric=null,this.aead=null,this.privateParams=null}read(t){var e=this;return(0,s.Z)(function*(){let n=yield e.readPublicKey(t);if(e.s2kUsage=t[n++],5===e.version&&n++,255===e.s2kUsage||254===e.s2kUsage||253===e.s2kUsage){if(e.symmetric=t[n++],253===e.s2kUsage&&(e.aead=t[n++]),e.s2k=new ca,n+=e.s2k.read(t.subarray(n,t.length)),"gnu-dummy"===e.s2k.type)return}else e.s2kUsage&&(e.symmetric=e.s2kUsage);if(e.s2kUsage&&(e.iv=t.subarray(n,n+Mt.getCipher(e.symmetric).blockSize),n+=e.iv.length),5===e.version&&(n+=4),e.keyMaterial=t.subarray(n),e.isEncrypted=!!e.s2kUsage,!e.isEncrypted){const a=e.keyMaterial.subarray(0,-2);if(!z.equalsUint8Array(z.writeChecksum(a),e.keyMaterial.subarray(-2)))throw Error("Key checksum mismatch");try{const{privateParams:o}=Mt.parsePrivateKeyParams(e.algorithm,a,e.publicParams);e.privateParams=o}catch(o){throw o instanceof Gr?o:Error("Error reading MPIs")}}})()}write(){const t=[this.writePublicKey()];t.push(new Uint8Array([this.s2kUsage]));const e=[];return 255!==this.s2kUsage&&254!==this.s2kUsage&&253!==this.s2kUsage||(e.push(this.symmetric),253===this.s2kUsage&&e.push(this.aead),e.push(...this.s2k.write())),this.s2kUsage&&"gnu-dummy"!==this.s2k.type&&e.push(...this.iv),5===this.version&&t.push(new Uint8Array([e.length])),t.push(new Uint8Array(e)),this.isDummy()||(this.s2kUsage||(this.keyMaterial=Mt.serializeParams(this.algorithm,this.privateParams)),5===this.version&&t.push(z.writeNumber(this.keyMaterial.length,4)),t.push(this.keyMaterial),this.s2kUsage||t.push(z.writeChecksum(this.keyMaterial))),z.concatUint8Array(t)}isDecrypted(){return!1===this.isEncrypted}isDummy(){return!(!this.s2k||"gnu-dummy"!==this.s2k.type)}makeDummy(t=ut){this.isDummy()||(this.isDecrypted()&&this.clearPrivateParams(),this.isEncrypted=null,this.keyMaterial=null,this.s2k=new ca(t),this.s2k.algorithm=0,this.s2k.c=0,this.s2k.type="gnu-dummy",this.s2kUsage=254,this.symmetric=Z.symmetric.aes256)}encrypt(t,e=ut){var n=this;return(0,s.Z)(function*(){if(n.isDummy())return;if(!n.isDecrypted())throw Error("Key packet is already encrypted");if(!t)throw Error("A non-empty passphrase is required for key encryption.");n.s2k=new ca(e),n.s2k.salt=yield Mt.random.getRandomBytes(8);const a=Mt.serializeParams(n.algorithm,n.privateParams);n.symmetric=Z.symmetric.aes256;const o=yield Bc(n.s2k,t,n.symmetric),{blockSize:u}=Mt.getCipher(n.symmetric);if(n.iv=yield Mt.random.getRandomBytes(u),e.aeadProtect){n.s2kUsage=253,n.aead=Z.aead.eax;const f=Mt.getAEADMode(n.aead),w=yield f(n.symmetric,o);n.keyMaterial=yield w.encrypt(a,n.iv.subarray(0,f.ivLength),new Uint8Array)}else n.s2kUsage=254,n.keyMaterial=yield Mt.mode.cfb.encrypt(n.symmetric,o,z.concatUint8Array([a,yield Mt.hash.sha1(a,e)]),n.iv,e)})()}decrypt(t){var e=this;return(0,s.Z)(function*(){if(e.isDummy())return!1;if(e.isDecrypted())throw Error("Key packet is already decrypted.");let n,a;if(254!==e.s2kUsage&&253!==e.s2kUsage)throw 255===e.s2kUsage?Error("Encrypted private key is authenticated using an insecure two-byte hash"):Error("Private key is encrypted using an insecure S2K function: unsalted MD5");if(n=yield Bc(e.s2k,t,e.symmetric),253===e.s2kUsage){const o=Mt.getAEADMode(e.aead),u=yield o(e.symmetric,n);try{a=yield u.decrypt(e.keyMaterial,e.iv.subarray(0,o.ivLength),new Uint8Array)}catch(f){throw"Authentication tag mismatch"===f.message?Error("Incorrect key passphrase: "+f.message):f}}else{const o=yield Mt.mode.cfb.decrypt(e.symmetric,n,e.keyMaterial,e.iv);a=o.subarray(0,-20);const u=yield Mt.hash.sha1(a);if(!z.equalsUint8Array(u,o.subarray(-20)))throw Error("Incorrect key passphrase")}try{const{privateParams:o}=Mt.parsePrivateKeyParams(e.algorithm,a,e.publicParams);e.privateParams=o}catch{throw Error("Error reading MPIs")}e.isEncrypted=!1,e.keyMaterial=null,e.s2kUsage=0})()}validate(){var t=this;return(0,s.Z)(function*(){if(t.isDummy())return;if(!t.isDecrypted())throw Error("Key is not decrypted");let e;try{e=yield Mt.validateParams(t.algorithm,t.publicParams,t.privateParams)}catch{e=!1}if(!e)throw Error("Key is invalid")})()}generate(t,e){var n=this;return(0,s.Z)(function*(){const{privateParams:a,publicParams:o}=yield Mt.generateParams(n.algorithm,t,e);n.privateParams=a,n.publicParams=o,n.isEncrypted=!1})()}clearPrivateParams(){this.isDummy()||(Object.keys(this.privateParams).forEach(t=>{this.privateParams[t].fill(0),delete this.privateParams[t]}),this.privateParams=null,this.isEncrypted=!0)}}function Bc(r,t,e){return u0.apply(this,arguments)}function u0(){return u0=(0,s.Z)(function*(r,t,e){const{keySize:n}=Mt.getCipher(e);return r.produceKey(t,n)}),u0.apply(this,arguments)}var S1=gi(function(r){!function(t){function e(a){function o(){return er<Ir}function u(){return er}function f(st){er=st}function w(){er=0,Ir=vr.length}function g(st,ot){return{name:st,tokens:ot||"",semantic:ot||"",children:[]}}function b(st,ot){var wt;return null===ot?null:((wt=g(st)).tokens=ot.tokens,wt.semantic=ot.semantic,wt.children.push(ot),wt)}function L(st,ot){return null!==ot&&(st.tokens+=ot.tokens,st.semantic+=ot.semantic),st.children.push(ot),st}function $(st){var ot;return o()&&st(ot=vr[er])?(er+=1,g("token",ot)):null}function j(st){return function(){return b("literal",$(function(ot){return ot===st}))}}function se(){var st=arguments;return function(){var ot,wt,Wt,Yt;for(Yt=u(),wt=g("and"),ot=0;ot<st.length;ot+=1){if(null===(Wt=st[ot]()))return f(Yt),null;L(wt,Wt)}return wt}}function pe(){var st=arguments;return function(){var ot,wt,Wt;for(Wt=u(),ot=0;ot<st.length;ot+=1){if(null!==(wt=st[ot]()))return wt;f(Wt)}return null}}function xe(st){return function(){var ot,wt;return wt=u(),null!==(ot=st())?ot:(f(wt),g("opt"))}}function Ke(st){return function(){var ot=st();return null!==ot&&(ot.semantic=""),ot}}function Qe(st){return function(){var ot=st();return null!==ot&&ot.semantic.length>0&&(ot.semantic=" "),ot}}function Be(st,ot){return function(){var wt,Wt,Yt,nr,Jt;for(nr=u(),wt=g("star"),Yt=0,Jt=void 0===ot?0:ot;null!==(Wt=st());)Yt+=1,L(wt,Wt);return Yt>=Jt?wt:(f(nr),null)}}function le(st){return st.charCodeAt(0)>=128}function Xe(){return b("cr",j("\r")())}function He(){return b("crlf",se(Xe,Je)())}function $e(){return b("dquote",j('"')())}function rt(){return b("htab",j("\t")())}function Je(){return b("lf",j("\n")())}function dt(){return b("sp",j(" ")())}function It(){return b("vchar",$(function(st){var ot=st.charCodeAt(0),wt=33<=ot&&ot<=126;return a.rfc6532&&(wt=wt||le(st)),wt}))}function Ut(){return b("wsp",pe(dt,rt)())}function zt(){var st=b("quoted-pair",pe(se(j("\\"),pe(It,Ut)),Ee)());return null===st?null:(st.semantic=st.semantic[1],st)}function pt(){return b("fws",pe(Se,se(xe(se(Be(Ut),Ke(He))),Be(Ut,1)))())}function Ye(){return b("ctext",pe(function(){return $(function(st){var ot=st.charCodeAt(0),wt=33<=ot&&ot<=39||42<=ot&&ot<=91||93<=ot&&ot<=126;return a.rfc6532&&(wt=wt||le(st)),wt})},At)())}function rr(){return b("ccontent",pe(Ye,zt,ze)())}function ze(){return b("comment",se(j("("),Be(se(xe(pt),rr)),xe(pt),j(")"))())}function yt(){return b("cfws",pe(se(Be(se(xe(pt),ze),1),xe(pt)),pt)())}function Ot(){return b("atext",$(function(st){var ot="a"<=st&&st<="z"||"A"<=st&&st<="Z"||"0"<=st&&st<="9"||["!","#","$","%","&","'","*","+","-","/","=","?","^","_","`","{","|","}","~"].indexOf(st)>=0;return a.rfc6532&&(ot=ot||le(st)),ot}))}function Zt(){return b("atom",se(Qe(xe(yt)),Be(Ot,1),Qe(xe(yt)))())}function Kt(){var st,ot;return null===(st=b("dot-atom-text",Be(Ot,1)()))||null!==(ot=Be(se(j("."),Be(Ot,1)))())&&L(st,ot),st}function Nt(){return b("dot-atom",se(Ke(xe(yt)),Kt,Ke(xe(yt)))())}function Gt(){return b("qtext",pe(function(){return $(function(st){var ot=st.charCodeAt(0),wt=33===ot||35<=ot&&ot<=91||93<=ot&&ot<=126;return a.rfc6532&&(wt=wt||le(st)),wt})},Et)())}function xt(){return b("qcontent",pe(Gt,zt)())}function ge(){return b("quoted-string",se(Ke(xe(yt)),Ke($e),Be(se(xe(Qe(pt)),xt)),xe(Ke(pt)),Ke($e),Ke(xe(yt)))())}function Ne(){return b("word",pe(Zt,ge)())}function Oe(){return b("address",pe(R,nt)())}function R(){return b("mailbox",pe(ye,St)())}function ye(){return b("name-addr",se(xe(it),qe)())}function qe(){return b("angle-addr",pe(se(Ke(xe(yt)),j("<"),St,j(">"),Ke(xe(yt))),_e)())}function nt(){return b("group",se(it,j(":"),xe(te),j(";"),Ke(xe(yt)))())}function it(){return b("display-name",(null!==(st=b("phrase",pe(we,Be(Ne,1))()))&&(st.semantic=st.semantic.replace(/([ \t]|\r\n)+/g," ").replace(/^\s*/,"").replace(/\s*$/,"")),st));var st}function q(){return b("mailbox-list",pe(se(R,Be(se(j(","),R))),ie)())}function Q(){return b("address-list",pe(se(Oe,Be(se(j(","),Oe))),he)())}function te(){return b("group-list",pe(q,Ke(yt),vt)())}function oe(){return b("local-part",pe(tr,Nt,ge)())}function Ce(){return b("dtext",pe(function(){return $(function(st){var ot=st.charCodeAt(0),wt=33<=ot&&ot<=90||94<=ot&&ot<=126;return a.rfc6532&&(wt=wt||le(st)),wt})},hr)())}function ve(){return b("domain-literal",se(Ke(xe(yt)),j("["),Be(se(xe(pt),Ce)),xe(pt),j("]"),Ke(xe(yt)))())}function Te(){return b("domain",(st=pe(ur,Nt,ve)(),a.rejectTLD&&st&&st.semantic&&st.semantic.indexOf(".")<0?null:(st&&(st.semantic=st.semantic.replace(/\s+/g,"")),st)));var st}function St(){return b("addr-spec",se(oe,j("@"),Te)())}function bt(){return a.strict?null:b("obs-NO-WS-CTL",$(function(st){var ot=st.charCodeAt(0);return 1<=ot&&ot<=8||11===ot||12===ot||14<=ot&&ot<=31||127===ot}))}function At(){return a.strict?null:b("obs-ctext",bt())}function Et(){return a.strict?null:b("obs-qtext",bt())}function Ee(){return a.strict?null:b("obs-qp",se(j("\\"),pe(j("\0"),bt,Je,Xe))())}function we(){return a.strict?null:b("obs-phrase",a.atInDisplayName?se(Ne,Be(pe(Ne,j("."),j("@"),Qe(yt))))():se(Ne,Be(pe(Ne,j("."),Qe(yt))))())}function Se(){return a.strict?null:b("obs-FWS",Be(se(Ke(xe(He)),Ut),1)())}function _e(){return a.strict?null:b("obs-angle-addr",se(Ke(xe(yt)),j("<"),ke,St,j(">"),Ke(xe(yt)))())}function ke(){return a.strict?null:b("obs-route",se(ae,j(":"))())}function ae(){return a.strict?null:b("obs-domain-list",se(Be(pe(Ke(yt),j(","))),j("@"),Te,Be(se(j(","),Ke(xe(yt)),xe(se(j("@"),Te)))))())}function ie(){return a.strict?null:b("obs-mbox-list",se(Be(se(Ke(xe(yt)),j(","))),R,Be(se(j(","),xe(se(R,Ke(yt))))))())}function he(){return a.strict?null:b("obs-addr-list",se(Be(se(Ke(xe(yt)),j(","))),Oe,Be(se(j(","),xe(se(Oe,Ke(yt))))))())}function vt(){return a.strict?null:b("obs-group-list",se(Be(se(Ke(xe(yt)),j(",")),1),Ke(xe(yt)))())}function tr(){return a.strict?null:b("obs-local-part",se(Ne,Be(se(j("."),Ne)))())}function ur(){return a.strict?null:b("obs-domain",se(Zt,Be(se(j("."),Zt)))())}function hr(){return a.strict?null:b("obs-dtext",pe(bt,zt)())}function sr(st,ot){var wt,Wt,Yt;if(null==ot)return null;for(Wt=[ot];Wt.length>0;){if((Yt=Wt.pop()).name===st)return Yt;for(wt=Yt.children.length-1;wt>=0;wt-=1)Wt.push(Yt.children[wt])}return null}function Or(st,ot){var wt,Wt,Yt,nr,Jt;if(null==ot)return null;for(Wt=[ot],nr=[],Jt={},wt=0;wt<st.length;wt+=1)Jt[st[wt]]=!0;for(;Wt.length>0;)if((Yt=Wt.pop()).name in Jt)nr.push(Yt);else for(wt=Yt.children.length-1;wt>=0;wt-=1)Wt.push(Yt.children[wt]);return nr}function Vr(st){var ot,wt,Wt,Yt,nr,Jt;if(null===st)return null;for(ot=[],wt=Or(["group","mailbox"],st),Wt=0;Wt<wt.length;Wt+=1)"group"===(Yt=wt[Wt]).name?ot.push(jr(Yt)):"mailbox"===Yt.name&&ot.push(qr(Yt));return nr={ast:st,addresses:ot},a.simple&&(nr=function(Jt){var Er;if(Jt&&Jt.addresses)for(Er=0;Er<Jt.addresses.length;Er+=1)delete Jt.addresses[Er].node;return Jt}(nr)),a.oneResult?!(Jt=nr)||!a.partial&&Jt.addresses.length>1?null:Jt.addresses&&Jt.addresses[0]:a.simple?nr&&nr.addresses:nr}function jr(st){var ot,wt=sr("display-name",st),Wt=[],Yt=Or(["mailbox"],st);for(ot=0;ot<Yt.length;ot+=1)Wt.push(qr(Yt[ot]));return{node:st,parts:{name:wt},type:st.name,name:ar(wt),addresses:Wt}}function qr(st){var ot=sr("display-name",st),wt=sr("addr-spec",st),Wt=function(Er,Pr){var wn,Cn,An,Fn;if(null==Pr)return null;for(Cn=[Pr],Fn=[];Cn.length>0;)for("cfws"===(An=Cn.pop()).name&&Fn.push(An),wn=An.children.length-1;wn>=0;wn-=1)Cn.push(An.children[wn]);return Fn}(0,st),Yt=Or(["comment"],st),nr=sr("local-part",wt),Jt=sr("domain",wt);return{node:st,parts:{name:ot,address:wt,local:nr,domain:Jt,comments:Wt},type:st.name,name:ar(ot),address:ar(wt),local:ar(nr),domain:ar(Jt),comments:xr(Yt),groupName:ar(st.groupName)}}function ar(st){return null!=st?st.semantic:null}function xr(st){var ot="";if(st)for(var wt=0;wt<st.length;wt+=1)ot+=ar(st[wt]);return ot}var vr,er,Ir,Sr,Br;if(null===(a=n(a,{})))return null;if(vr=a.input,Br={address:Oe,"address-list":Q,"angle-addr":qe,from:function(){return b("from",pe(q,Q)())},group:nt,mailbox:R,"mailbox-list":q,"reply-to":function(){return b("reply-to",Q())},sender:function(){return b("sender",pe(R,Oe)())}}[a.startAt]||Q,!a.strict){if(w(),a.strict=!0,Sr=Br(vr),a.partial||!o())return Vr(Sr);a.strict=!1}return w(),Sr=Br(vr),!a.partial&&o()?null:Vr(Sr)}function n(a,o){function u(b){return"[object String]"===Object.prototype.toString.call(b)}function f(b){return null==b}var w,g,b;if(u(a))a={input:a};else if((b=a)!==Object(b))return null;if(!u(a.input)||!o)return null;for(g in w={oneResult:!1,partial:!1,rejectTLD:!1,rfc6532:!1,simple:!1,startAt:"address-list",strict:!1,atInDisplayName:!1})f(a[g])&&(a[g]=f(o[g])?w[g]:o[g]);return a}e.parseOneAddress=function(a){return e(n(a,{oneResult:!0,rfc6532:!0,simple:!0,startAt:"address-list"}))},e.parseAddressList=function(a){return e(n(a,{rfc6532:!0,simple:!0,startAt:"address-list"}))},e.parseFrom=function(a){return e(n(a,{rfc6532:!0,simple:!0,startAt:"from"}))},e.parseSender=function(a){return e(n(a,{oneResult:!0,rfc6532:!0,simple:!0,startAt:"sender"}))},e.parseReplyTo=function(a){return e(n(a,{rfc6532:!0,simple:!0,startAt:"reply-to"}))},r.exports=e}()});class $a{static get tag(){return Z.packet.userID}constructor(){this.userID="",this.name="",this.email="",this.comment=""}static fromObject(t){if(z.isString(t)||t.name&&!z.isString(t.name)||t.email&&!z.isEmailAddress(t.email)||t.comment&&!z.isString(t.comment))throw Error("Invalid user ID format");const e=new $a;Object.assign(e,t);const n=[];return e.name&&n.push(e.name),e.comment&&n.push(`(${e.comment})`),e.email&&n.push(`<${e.email}>`),e.userID=n.join(" "),e}read(t,e=ut){const n=z.decodeUTF8(t);if(n.length>e.maxUserIDLength)throw Error("User ID string is too long");try{const{name:a,address:o,comments:u}=S1.parseOneAddress({input:n,atInDisplayName:!0});this.comment=u.replace(/^\(|\)$/g,""),this.name=a,this.email=o}catch{}this.userID=n}write(){return z.encodeUTF8(this.userID)}equals(t){return t&&t.userID===this.userID}}class l0 extends Qa{static get tag(){return Z.packet.secretSubkey}constructor(t=new Date,e=ut){super(t,e)}}class pi{constructor(t){this.packets=t||new fr}write(){return this.packets.write()}armor(t=ut){return $t(Z.armor.signature,this.write(),void 0,void 0,void 0,t)}getSigningKeyIDs(){return this.packets.map(t=>t.issuerKeyID)}}function Ic(r,t){return h0.apply(this,arguments)}function h0(){return h0=(0,s.Z)(function*(r,t){const e=new l0(r.date,t);return e.packets=null,e.algorithm=Z.write(Z.publicKey,r.algorithm),yield e.generate(r.rsaBits,r.curve),yield e.computeFingerprintAndKeyID(),e}),h0.apply(this,arguments)}function k1(r,t){return d0.apply(this,arguments)}function d0(){return d0=(0,s.Z)(function*(r,t){const e=new Qa(r.date,t);return e.packets=null,e.algorithm=Z.write(Z.publicKey,r.algorithm),yield e.generate(r.rsaBits,r.curve,r.config),yield e.computeFingerprintAndKeyID(),e}),d0.apply(this,arguments)}function En(r,t,e,n){return p0.apply(this,arguments)}function p0(){return p0=(0,s.Z)(function*(r,t,e,n,a=new Date,o){let u,f;for(let w=r.length-1;w>=0;w--)try{(!u||r[w].created>=u.created)&&(yield r[w].verify(t,e,n,a,void 0,o),u=r[w])}catch(g){f=g}if(!u)throw z.wrapError(`Could not find valid ${Z.read(Z.signature,e)} signature in key ${t.getKeyID().toHex()}`.replace("certGeneric ","self-").replace(/([a-z])([A-Z])/g,(w,g,b)=>g+" "+b.toLowerCase()),f);return u}),p0.apply(this,arguments)}function y0(r,t,e=new Date){const n=z.normalizeDate(e);if(null!==n){const a=Xa(r,t);return!(r.created<=n&&n<a)}return!1}function Pc(r,t,e,n){return g0.apply(this,arguments)}function g0(){return g0=(0,s.Z)(function*(r,t,e,n){const a={};a.key=t,a.bind=r;const o=new Qr;return o.signatureType=Z.signature.subkeyBinding,o.publicKeyAlgorithm=t.algorithm,o.hashAlgorithm=yield Ya(null,r,void 0,void 0,n),e.sign?(o.keyFlags=[Z.keyFlags.signData],o.embeddedSignature=yield Ii(a,null,r,{signatureType:Z.signature.keyBinding},e.date,void 0,void 0,n)):o.keyFlags=[Z.keyFlags.encryptCommunication|Z.keyFlags.encryptStorage],e.keyExpirationTime>0&&(o.keyExpirationTime=e.keyExpirationTime,o.keyNeverExpires=!1),yield o.sign(t,a,e.date),o}),g0.apply(this,arguments)}function Ya(r,t){return v0.apply(this,arguments)}function v0(){return v0=(0,s.Z)(function*(r,t,e=new Date,n={},a){let o=a.preferredHashAlgorithm,u=o;if(r){const f=yield r.getPrimaryUser(e,n,a);f.selfCertification.preferredHashAlgorithms&&([u]=f.selfCertification.preferredHashAlgorithms,o=Mt.hash.getHashByteLength(o)<=Mt.hash.getHashByteLength(u)?u:o)}switch(Object.getPrototypeOf(t)){case Qa.prototype:case bn.prototype:case l0.prototype:case ua.prototype:switch(t.algorithm){case Z.publicKey.ecdh:case Z.publicKey.ecdsa:case Z.publicKey.eddsa:u=Mt.publicKey.elliptic.getPreferredHashAlgo(t.publicParams.oid)}}return Mt.hash.getHashByteLength(o)<=Mt.hash.getHashByteLength(u)?u:o}),v0.apply(this,arguments)}function m0(r){return x0.apply(this,arguments)}function x0(){return x0=(0,s.Z)(function*(r,t=[],e=new Date,n=[],a=ut){const o={symmetric:Z.symmetric.aes128,aead:Z.aead.eax,compression:Z.compression.uncompressed}[r],u={symmetric:a.preferredSymmetricAlgorithm,aead:a.preferredAEADAlgorithm,compression:a.preferredCompressionAlgorithm}[r],f={symmetric:"preferredSymmetricAlgorithms",aead:"preferredAEADAlgorithms",compression:"preferredCompressionAlgorithms"}[r];return(yield Promise.all(t.map(function(){var w=(0,s.Z)(function*(g,b){const L=(yield g.getPrimaryUser(e,n[b],a)).selfCertification[f];return!!L&&L.indexOf(u)>=0});return function(g,b){return w.apply(this,arguments)}}()))).every(Boolean)?u:o}),x0.apply(this,arguments)}function Ii(r,t,e,n,a,o){return b0.apply(this,arguments)}function b0(){return b0=(0,s.Z)(function*(r,t,e,n,a,o,u=!1,f){if(e.isDummy())throw Error("Cannot sign with a gnu-dummy key.");if(!e.isDecrypted())throw Error("Signing key is not decrypted.");const w=new Qr;return Object.assign(w,n),w.publicKeyAlgorithm=e.algorithm,w.hashAlgorithm=yield Ya(t,e,a,o,f),yield w.sign(e,r,a,u),w}),b0.apply(this,arguments)}function yi(r,t,e){return E0.apply(this,arguments)}function E0(){return E0=(0,s.Z)(function*(r,t,e,n=new Date,a){(r=r[e])&&(t[e].length?yield Promise.all(r.map(function(){var o=(0,s.Z)(function*(u){u.isExpired(n)||a&&!(yield a(u))||t[e].some(function(f){return z.equalsUint8Array(f.writeParams(),u.writeParams())})||t[e].push(u)});return function(u){return o.apply(this,arguments)}}())):t[e]=r)}),E0.apply(this,arguments)}function Pi(r,t,e,n,a,o){return w0.apply(this,arguments)}function w0(){return w0=(0,s.Z)(function*(r,t,e,n,a,o,u=new Date,f){o=o||r;const w=[];return yield Promise.all(n.map(function(){var g=(0,s.Z)(function*(b){try{a&&!b.issuerKeyID.equals(a.issuerKeyID)||(yield b.verify(o,t,e,f.revocationsExpire?u:null,!1,f),w.push(b.issuerKeyID))}catch{}});return function(b){return g.apply(this,arguments)}}())),a?(a.revoked=!!w.some(g=>g.equals(a.issuerKeyID))||a.revoked||!1,a.revoked):w.length>0}),w0.apply(this,arguments)}function Xa(r,t){let e;return!1===t.keyNeverExpires&&(e=r.created.getTime()+1e3*t.keyExpirationTime),e?new Date(e):1/0}function C0(r,t={}){switch(r.type=r.type||t.type,r.curve=r.curve||t.curve,r.rsaBits=r.rsaBits||t.rsaBits,r.keyExpirationTime=void 0!==r.keyExpirationTime?r.keyExpirationTime:t.keyExpirationTime,r.passphrase=z.isString(r.passphrase)?r.passphrase:t.passphrase,r.date=r.date||t.date,r.sign=r.sign||!1,r.type){case"ecc":try{r.curve=Z.write(Z.curve,r.curve)}catch{throw Error("Unknown curve")}r.curve!==Z.curve.ed25519&&r.curve!==Z.curve.curve25519||(r.curve=r.sign?Z.curve.ed25519:Z.curve.curve25519),r.algorithm=r.sign?r.curve===Z.curve.ed25519?Z.publicKey.eddsa:Z.publicKey.ecdsa:Z.publicKey.ecdh;break;case"rsa":r.algorithm=Z.publicKey.rsaEncryptSign;break;default:throw Error("Unsupported key type "+r.type)}return r}function Uc(r,t){const e=r.algorithm;return e!==Z.publicKey.rsaEncrypt&&e!==Z.publicKey.elgamal&&e!==Z.publicKey.ecdh&&(!t.keyFlags||0!=(t.keyFlags[0]&Z.keyFlags.signData))}function Dc(r,t){const e=r.algorithm;return e!==Z.publicKey.dsa&&e!==Z.publicKey.rsaSign&&e!==Z.publicKey.ecdsa&&e!==Z.publicKey.eddsa&&(!t.keyFlags||0!=(t.keyFlags[0]&Z.keyFlags.encryptCommunication)||0!=(t.keyFlags[0]&Z.keyFlags.encryptStorage))}function Rc(r,t){return!!t.allowInsecureDecryptionWithSigningKeys||!r.keyFlags||0!=(r.keyFlags[0]&Z.keyFlags.encryptCommunication)||0!=(r.keyFlags[0]&Z.keyFlags.encryptStorage)}function Ui(r,t){const e=Z.write(Z.publicKey,r.algorithm),n=r.getAlgorithmInfo();if(t.rejectPublicKeyAlgorithms.has(e))throw Error(n.algorithm+" keys are considered too weak.");switch(e){case Z.publicKey.rsaEncryptSign:case Z.publicKey.rsaSign:case Z.publicKey.rsaEncrypt:if(n.bits<t.minRSABits)throw Error(`RSA keys shorter than ${t.minRSABits} bits are considered too weak.`);break;case Z.publicKey.ecdsa:case Z.publicKey.eddsa:case Z.publicKey.ecdh:if(t.rejectCurves.has(n.curve))throw Error(`Support for ${n.algorithm} keys using curve ${n.curve} is disabled.`)}}class qa{constructor(t,e){this.userID=t.constructor.tag===Z.packet.userID?t:null,this.userAttribute=t.constructor.tag===Z.packet.userAttribute?t:null,this.selfCertifications=[],this.otherCertifications=[],this.revocationSignatures=[],this.mainKey=e}toPacketList(){const t=new fr;return t.push(this.userID||this.userAttribute),t.push(...this.revocationSignatures),t.push(...this.selfCertifications),t.push(...this.otherCertifications),t}clone(){const t=new qa(this.userID||this.userAttribute,this.mainKey);return t.selfCertifications=[...this.selfCertifications],t.otherCertifications=[...this.otherCertifications],t.revocationSignatures=[...this.revocationSignatures],t}certify(t,e,n){var a=this;return(0,s.Z)(function*(){const o=a.mainKey.keyPacket,u={userID:a.userID,userAttribute:a.userAttribute,key:o},f=new qa(u.userID||u.userAttribute,a.mainKey);return f.otherCertifications=yield Promise.all(t.map(function(){var w=(0,s.Z)(function*(g){if(!g.isPrivate())throw Error("Need private key for signing");if(g.hasSameFingerprintAs(o))throw Error("The user's own key can only be used for self-certifications");const b=yield g.getSigningKey(void 0,e,void 0,n);return Ii(u,g,b.keyPacket,{signatureType:Z.signature.certGeneric,keyFlags:[Z.keyFlags.certifyKeys|Z.keyFlags.signData]},e,void 0,void 0,n)});return function(g){return w.apply(this,arguments)}}())),yield f.update(a,e,n),f})()}isRevoked(t,e,n=new Date,a){var o=this;return(0,s.Z)(function*(){const u=o.mainKey.keyPacket;return Pi(u,Z.signature.certRevocation,{key:u,userID:o.userID,userAttribute:o.userAttribute},o.revocationSignatures,t,e,n,a)})()}verifyCertificate(t,e,n=new Date,a){var o=this;return(0,s.Z)(function*(){const u=o,w={userID:o.userID,userAttribute:o.userAttribute,key:o.mainKey.keyPacket},{issuerKeyID:g}=t,b=e.filter(L=>L.getKeys(g).length>0);return 0===b.length?null:(yield Promise.all(b.map(function(){var L=(0,s.Z)(function*($){const j=yield $.getSigningKey(g,t.created,void 0,a);if(t.revoked||(yield u.isRevoked(t,j.keyPacket,n,a)))throw Error("User certificate is revoked");try{yield t.verify(j.keyPacket,Z.signature.certGeneric,w,n,void 0,a)}catch(se){throw z.wrapError("User certificate is invalid",se)}});return function($){return L.apply(this,arguments)}}())),!0)})()}verifyAllCertifications(t,e=new Date,n){var a=this;return(0,s.Z)(function*(){const o=a,u=a.selfCertifications.concat(a.otherCertifications);return Promise.all(u.map(function(){var f=(0,s.Z)(function*(w){return{keyID:w.issuerKeyID,valid:yield o.verifyCertificate(w,t,e,n).catch(()=>!1)}});return function(w){return f.apply(this,arguments)}}()))})()}verify(t=new Date,e){var n=this;return(0,s.Z)(function*(){if(!n.selfCertifications.length)throw Error("No self-certifications found");const a=n,o=n.mainKey.keyPacket,u={userID:n.userID,userAttribute:n.userAttribute,key:o};let f;for(let w=n.selfCertifications.length-1;w>=0;w--)try{const g=n.selfCertifications[w];if(g.revoked||(yield a.isRevoked(g,void 0,t,e)))throw Error("Self-certification is revoked");try{yield g.verify(o,Z.signature.certGeneric,u,t,void 0,e)}catch(b){throw z.wrapError("Self-certification is invalid",b)}return!0}catch(g){f=g}throw f})()}update(t,e,n){var a=this;return(0,s.Z)(function*(){const o=a.mainKey.keyPacket,u={userID:a.userID,userAttribute:a.userAttribute,key:o};yield yi(t,a,"selfCertifications",e,function(){var f=(0,s.Z)(function*(w){try{return yield w.verify(o,Z.signature.certGeneric,u,e,!1,n),!0}catch{return!1}});return function(w){return f.apply(this,arguments)}}()),yield yi(t,a,"otherCertifications",e),yield yi(t,a,"revocationSignatures",e,function(f){return Pi(o,Z.signature.certRevocation,u,[f],void 0,void 0,e,n)})})()}}class Di{constructor(t,e){this.keyPacket=t,this.bindingSignatures=[],this.revocationSignatures=[],this.mainKey=e}toPacketList(){const t=new fr;return t.push(this.keyPacket),t.push(...this.revocationSignatures),t.push(...this.bindingSignatures),t}clone(){const t=new Di(this.keyPacket,this.mainKey);return t.bindingSignatures=[...this.bindingSignatures],t.revocationSignatures=[...this.revocationSignatures],t}isRevoked(t,e,n=new Date,a=ut){var o=this;return(0,s.Z)(function*(){const u=o.mainKey.keyPacket;return Pi(u,Z.signature.subkeyRevocation,{key:u,bind:o.keyPacket},o.revocationSignatures,t,e,n,a)})()}verify(t=new Date,e=ut){var n=this;return(0,s.Z)(function*(){const a=n.mainKey.keyPacket,o={key:a,bind:n.keyPacket},u=yield En(n.bindingSignatures,a,Z.signature.subkeyBinding,o,t,e);if(u.revoked||(yield n.isRevoked(u,null,t,e)))throw Error("Subkey is revoked");if(y0(n.keyPacket,u,t))throw Error("Subkey is expired");return u})()}getExpirationTime(t=new Date,e=ut){var n=this;return(0,s.Z)(function*(){const a=n.mainKey.keyPacket,o={key:a,bind:n.keyPacket};let u;try{u=yield En(n.bindingSignatures,a,Z.signature.subkeyBinding,o,t,e)}catch{return null}const f=Xa(n.keyPacket,u),w=u.getExpirationTime();return f<w?f:w})()}update(t,e=new Date,n=ut){var a=this;return(0,s.Z)(function*(){const o=a.mainKey.keyPacket;if(!a.hasSameFingerprintAs(t))throw Error("Subkey update method: fingerprints of subkeys not equal");a.keyPacket.constructor.tag===Z.packet.publicSubkey&&t.keyPacket.constructor.tag===Z.packet.secretSubkey&&(a.keyPacket=t.keyPacket);const u=a,f={key:o,bind:u.keyPacket};yield yi(t,a,"bindingSignatures",e,function(){var w=(0,s.Z)(function*(g){for(let b=0;b<u.bindingSignatures.length;b++)if(u.bindingSignatures[b].issuerKeyID.equals(g.issuerKeyID))return g.created>u.bindingSignatures[b].created&&(u.bindingSignatures[b]=g),!1;try{return yield g.verify(o,Z.signature.subkeyBinding,f,e,void 0,n),!0}catch{return!1}});return function(g){return w.apply(this,arguments)}}()),yield yi(t,a,"revocationSignatures",e,function(w){return Pi(o,Z.signature.subkeyRevocation,f,[w],void 0,void 0,e,n)})})()}revoke(t,{flag:e=Z.reasonForRevocation.noReason,string:n=""}={},a=new Date,o=ut){var u=this;return(0,s.Z)(function*(){const f={key:t,bind:u.keyPacket},w=new Di(u.keyPacket,u.mainKey);return w.revocationSignatures.push(yield Ii(f,null,t,{signatureType:Z.signature.subkeyRevocation,reasonForRevocationFlag:Z.write(Z.reasonForRevocation,e),reasonForRevocationString:n},a,void 0,!1,o)),yield w.update(u),w})()}hasSameFingerprintAs(t){return this.keyPacket.hasSameFingerprintAs(t.keyPacket||t)}}["getKeyID","getFingerprint","getAlgorithmInfo","getCreationTime","isDecrypted"].forEach(r=>{Di.prototype[r]=function(){return this.keyPacket[r]()}});const T1=z.constructAllowedPackets([Qr]),Nc=new Set([Z.packet.publicKey,Z.packet.privateKey]),Lc=new Set([Z.packet.publicKey,Z.packet.privateKey,Z.packet.publicSubkey,Z.packet.privateSubkey]);class Kc{packetListToStructure(t,e=new Set){let n,a,o,u;for(const f of t){if(f instanceof Bs){Lc.has(f.tag)&&!u&&(u=Nc.has(f.tag)?Nc:Lc);continue}const w=f.constructor.tag;if(u){if(!u.has(w))continue;u=null}if(e.has(w))throw Error("Unexpected packet type: "+w);switch(w){case Z.packet.publicKey:case Z.packet.secretKey:if(this.keyPacket)throw Error("Key block contains multiple keys");if(this.keyPacket=f,a=this.getKeyID(),!a)throw Error("Missing Key ID");break;case Z.packet.userID:case Z.packet.userAttribute:n=new qa(f,this),this.users.push(n);break;case Z.packet.publicSubkey:case Z.packet.secretSubkey:n=null,o=new Di(f,this),this.subkeys.push(o);break;case Z.packet.signature:switch(f.signatureType){case Z.signature.certGeneric:case Z.signature.certPersona:case Z.signature.certCasual:case Z.signature.certPositive:if(!n){z.printDebug("Dropping certification signatures without preceding user packet");continue}f.issuerKeyID.equals(a)?n.selfCertifications.push(f):n.otherCertifications.push(f);break;case Z.signature.certRevocation:n?n.revocationSignatures.push(f):this.directSignatures.push(f);break;case Z.signature.key:this.directSignatures.push(f);break;case Z.signature.subkeyBinding:if(!o){z.printDebug("Dropping subkey binding signature without preceding subkey packet");continue}o.bindingSignatures.push(f);break;case Z.signature.keyRevocation:this.revocationSignatures.push(f);break;case Z.signature.subkeyRevocation:if(!o){z.printDebug("Dropping subkey revocation signature without preceding subkey packet");continue}o.revocationSignatures.push(f)}}}}toPacketList(){const t=new fr;return t.push(this.keyPacket),t.push(...this.revocationSignatures),t.push(...this.directSignatures),this.users.map(e=>t.push(...e.toPacketList())),this.subkeys.map(e=>t.push(...e.toPacketList())),t}clone(t=!1){const e=new this.constructor(this.toPacketList());return t&&e.getKeys().forEach(n=>{if(n.keyPacket=Object.create(Object.getPrototypeOf(n.keyPacket),Object.getOwnPropertyDescriptors(n.keyPacket)),!n.keyPacket.isDecrypted())return;const a={};Object.keys(n.keyPacket.privateParams).forEach(o=>{a[o]=new Uint8Array(n.keyPacket.privateParams[o])}),n.keyPacket.privateParams=a}),e}getSubkeys(t=null){return this.subkeys.filter(e=>!t||e.getKeyID().equals(t,!0))}getKeys(t=null){const e=[];return t&&!this.getKeyID().equals(t,!0)||e.push(this),e.concat(this.getSubkeys(t))}getKeyIDs(){return this.getKeys().map(t=>t.getKeyID())}getUserIDs(){return this.users.map(t=>t.userID?t.userID.userID:null).filter(t=>null!==t)}write(){return this.toPacketList().write()}getSigningKey(t=null,e=new Date,n={},a=ut){var o=this;return(0,s.Z)(function*(){yield o.verifyPrimaryKey(e,n,a);const u=o.keyPacket,f=o.subkeys.slice().sort((g,b)=>b.keyPacket.created-g.keyPacket.created);let w;for(const g of f)if(!t||g.getKeyID().equals(t))try{yield g.verify(e,a);const b={key:u,bind:g.keyPacket},L=yield En(g.bindingSignatures,u,Z.signature.subkeyBinding,b,e,a);if(!Uc(g.keyPacket,L))continue;if(!L.embeddedSignature)throw Error("Missing embedded signature");return yield En([L.embeddedSignature],g.keyPacket,Z.signature.keyBinding,b,e,a),Ui(g.keyPacket,a),g}catch(b){w=b}try{const g=yield o.getPrimaryUser(e,n,a);if((!t||u.getKeyID().equals(t))&&Uc(u,g.selfCertification))return Ui(u,a),o}catch(g){w=g}throw z.wrapError("Could not find valid signing key packet in key "+o.getKeyID().toHex(),w)})()}getEncryptionKey(t,e=new Date,n={},a=ut){var o=this;return(0,s.Z)(function*(){yield o.verifyPrimaryKey(e,n,a);const u=o.keyPacket,f=o.subkeys.slice().sort((g,b)=>b.keyPacket.created-g.keyPacket.created);let w;for(const g of f)if(!t||g.getKeyID().equals(t))try{yield g.verify(e,a);const b={key:u,bind:g.keyPacket},L=yield En(g.bindingSignatures,u,Z.signature.subkeyBinding,b,e,a);if(Dc(g.keyPacket,L))return Ui(g.keyPacket,a),g}catch(b){w=b}try{const g=yield o.getPrimaryUser(e,n,a);if((!t||u.getKeyID().equals(t))&&Dc(u,g.selfCertification))return Ui(u,a),o}catch(g){w=g}throw z.wrapError("Could not find valid encryption key packet in key "+o.getKeyID().toHex(),w)})()}isRevoked(t,e,n=new Date,a=ut){var o=this;return(0,s.Z)(function*(){return Pi(o.keyPacket,Z.signature.keyRevocation,{key:o.keyPacket},o.revocationSignatures,t,e,n,a)})()}verifyPrimaryKey(t=new Date,e={},n=ut){var a=this;return(0,s.Z)(function*(){const o=a.keyPacket;if(yield a.isRevoked(null,null,t,n))throw Error("Primary key is revoked");const{selfCertification:u}=yield a.getPrimaryUser(t,e,n);if(y0(o,u,t))throw Error("Primary key is expired");const f=yield En(a.directSignatures,o,Z.signature.key,{key:o},t,n).catch(()=>{});if(f&&y0(o,f,t))throw Error("Primary key is expired")})()}getExpirationTime(t,e=ut){var n=this;return(0,s.Z)(function*(){let a;try{const{selfCertification:o}=yield n.getPrimaryUser(null,t,e),u=Xa(n.keyPacket,o),f=o.getExpirationTime(),w=yield En(n.directSignatures,n.keyPacket,Z.signature.key,{key:n.keyPacket},null,e).catch(()=>{});if(w){const g=Xa(n.keyPacket,w);a=Math.min(u,f,g)}else a=u<f?u:f}catch{a=null}return z.normalizeDate(a)})()}getPrimaryUser(t=new Date,e={},n=ut){var a=this;return(0,s.Z)(function*(){const o=a.keyPacket,u=[];let f;for(let L=0;L<a.users.length;L++)try{const $=a.users[L];if(!$.userID)continue;if(void 0!==e.name&&$.userID.name!==e.name||void 0!==e.email&&$.userID.email!==e.email||void 0!==e.comment&&$.userID.comment!==e.comment)throw Error("Could not find user that matches that user ID");const j={userID:$.userID,key:o},se=yield En($.selfCertifications,o,Z.signature.certGeneric,j,t,n);u.push({index:L,user:$,selfCertification:se})}catch($){f=$}if(!u.length)throw f||Error("Could not find primary user");yield Promise.all(u.map(function(){var L=(0,s.Z)(function*($){return $.user.revoked||$.user.isRevoked($.selfCertification,null,t,n)});return function($){return L.apply(this,arguments)}}()));const w=u.sort(function(L,$){const j=L.selfCertification,se=$.selfCertification;return se.revoked-j.revoked||j.isPrimaryUserID-se.isPrimaryUserID||j.created-se.created}).pop(),{user:g,selfCertification:b}=w;if(b.revoked||(yield g.isRevoked(b,null,t,n)))throw Error("Primary user is revoked");return w})()}update(t,e=new Date,n=ut){var a=this;return(0,s.Z)(function*(){if(!a.hasSameFingerprintAs(t))throw Error("Primary key fingerprints must be equal to update the key");if(!a.isPrivate()&&t.isPrivate()){if(a.subkeys.length!==t.subkeys.length||!a.subkeys.every(u=>t.subkeys.some(f=>u.hasSameFingerprintAs(f))))throw Error("Cannot update public key with private key if subkeys mismatch");return t.update(a,n)}const o=a.clone();return yield yi(t,o,"revocationSignatures",e,u=>Pi(o.keyPacket,Z.signature.keyRevocation,o,[u],null,t.keyPacket,e,n)),yield yi(t,o,"directSignatures",e),yield Promise.all(t.users.map(function(){var u=(0,s.Z)(function*(f){const w=o.users.filter(g=>f.userID&&f.userID.equals(g.userID)||f.userAttribute&&f.userAttribute.equals(g.userAttribute));if(w.length>0)yield Promise.all(w.map(g=>g.update(f,e,n)));else{const g=f.clone();g.mainKey=o,o.users.push(g)}});return function(f){return u.apply(this,arguments)}}())),yield Promise.all(t.subkeys.map(function(){var u=(0,s.Z)(function*(f){const w=o.subkeys.filter(g=>g.hasSameFingerprintAs(f));if(w.length>0)yield Promise.all(w.map(g=>g.update(f,e,n)));else{const g=f.clone();g.mainKey=o,o.subkeys.push(g)}});return function(f){return u.apply(this,arguments)}}())),o})()}getRevocationCertificate(t=new Date,e=ut){var n=this;return(0,s.Z)(function*(){const a={key:n.keyPacket},o=yield En(n.revocationSignatures,n.keyPacket,Z.signature.keyRevocation,a,t,e),u=new fr;return u.push(o),$t(Z.armor.publicKey,u.write(),null,null,"This is a revocation certificate")})()}applyRevocationCertificate(t,e=new Date,n=ut){var a=this;return(0,s.Z)(function*(){const o=yield Tt(t,n),u=(yield fr.fromBinary(o.data,T1,n)).findPacket(Z.packet.signature);if(!u||u.signatureType!==Z.signature.keyRevocation)throw Error("Could not find revocation signature packet");if(!u.issuerKeyID.equals(a.getKeyID()))throw Error("Revocation signature does not match key");try{yield u.verify(a.keyPacket,Z.signature.keyRevocation,{key:a.keyPacket},e,void 0,n)}catch(w){throw z.wrapError("Could not verify revocation signature",w)}const f=a.clone();return f.revocationSignatures.push(u),f})()}signPrimaryUser(t,e,n,a=ut){var o=this;return(0,s.Z)(function*(){const{index:u,user:f}=yield o.getPrimaryUser(e,n,a),w=yield f.certify(t,e,a),g=o.clone();return g.users[u]=w,g})()}signAllUsers(t,e=new Date,n=ut){var a=this;return(0,s.Z)(function*(){const o=a.clone();return o.users=yield Promise.all(a.users.map(function(u){return u.certify(t,e,n)})),o})()}verifyPrimaryUser(t,e=new Date,n,a=ut){var o=this;return(0,s.Z)(function*(){const u=o.keyPacket,{user:f}=yield o.getPrimaryUser(e,n,a);return t?yield f.verifyAllCertifications(t,e,a):[{keyID:u.getKeyID(),valid:yield f.verify(e,a).catch(()=>!1)}]})()}verifyAllUsers(t,e=new Date,n=ut){var a=this;return(0,s.Z)(function*(){const o=a.keyPacket,u=[];return yield Promise.all(a.users.map(function(){var f=(0,s.Z)(function*(w){const g=t?yield w.verifyAllCertifications(t,e,n):[{keyID:o.getKeyID(),valid:yield w.verify(e,n).catch(()=>!1)}];u.push(...g.map(b=>({userID:w.userID.userID,keyID:b.keyID,valid:b.valid})))});return function(w){return f.apply(this,arguments)}}())),u})()}}function Oc(r){for(const t of r)switch(t.constructor.tag){case Z.packet.secretKey:return new Ri(r);case Z.packet.publicKey:return new A0(r)}throw Error("No key packet found")}["getKeyID","getFingerprint","getAlgorithmInfo","getCreationTime","hasSameFingerprintAs"].forEach(r=>{Kc.prototype[r]=Di.prototype[r]});class A0 extends Kc{constructor(t){if(super(),this.keyPacket=null,this.revocationSignatures=[],this.directSignatures=[],this.users=[],this.subkeys=[],t&&(this.packetListToStructure(t,new Set([Z.packet.secretKey,Z.packet.secretSubkey])),!this.keyPacket))throw Error("Invalid key: missing public-key packet")}isPrivate(){return!1}toPublic(){return this}armor(t=ut){return $t(Z.armor.publicKey,this.toPacketList().write(),void 0,void 0,void 0,t)}}class Ri extends A0{constructor(t){if(super(),this.packetListToStructure(t,new Set([Z.packet.publicKey,Z.packet.publicSubkey])),!this.keyPacket)throw Error("Invalid key: missing private-key packet")}isPrivate(){return!0}toPublic(){const t=new fr,e=this.toPacketList();for(const n of e)switch(n.constructor.tag){case Z.packet.secretKey:{const a=bn.fromSecretKeyPacket(n);t.push(a);break}case Z.packet.secretSubkey:{const a=ua.fromSecretSubkeyPacket(n);t.push(a);break}default:t.push(n)}return new A0(t)}armor(t=ut){return $t(Z.armor.privateKey,this.toPacketList().write(),void 0,void 0,void 0,t)}getDecryptionKeys(t,e=new Date,n={},a=ut){var o=this;return(0,s.Z)(function*(){const u=o.keyPacket,f=[];for(let g=0;g<o.subkeys.length;g++)if(!t||o.subkeys[g].getKeyID().equals(t,!0))try{const b={key:u,bind:o.subkeys[g].keyPacket};Rc(yield En(o.subkeys[g].bindingSignatures,u,Z.signature.subkeyBinding,b,e,a),a)&&f.push(o.subkeys[g])}catch{}const w=yield o.getPrimaryUser(e,n,a);return t&&!u.getKeyID().equals(t,!0)||!Rc(w.selfCertification,a)||f.push(o),f})()}isDecrypted(){return this.getKeys().some(({keyPacket:t})=>t.isDecrypted())}validate(t=ut){var e=this;return(0,s.Z)(function*(){if(!e.isPrivate())throw Error("Cannot validate a public key");let n;if(e.keyPacket.isDummy()){const a=yield e.getSigningKey(null,null,void 0,{...t,rejectPublicKeyAlgorithms:new Set,minRSABits:0});a&&!a.keyPacket.isDummy()&&(n=a.keyPacket)}else n=e.keyPacket;if(n)return n.validate();{const a=e.getKeys();if(a.map(o=>o.keyPacket.isDummy()).every(Boolean))throw Error("Cannot validate an all-gnu-dummy key");return Promise.all(a.map(function(){var o=(0,s.Z)(function*(u){return u.keyPacket.validate()});return function(u){return o.apply(this,arguments)}}()))}})()}clearPrivateParams(){this.getKeys().forEach(({keyPacket:t})=>{t.isDecrypted()&&t.clearPrivateParams()})}revoke({flag:t=Z.reasonForRevocation.noReason,string:e=""}={},n=new Date,a=ut){var o=this;return(0,s.Z)(function*(){if(!o.isPrivate())throw Error("Need private key for revoking");const u={key:o.keyPacket},f=o.clone();return f.revocationSignatures.push(yield Ii(u,null,o.keyPacket,{signatureType:Z.signature.keyRevocation,reasonForRevocationFlag:Z.write(Z.reasonForRevocation,t),reasonForRevocationString:e},n,void 0,void 0,a)),f})()}addSubkey(t={}){var e=this;return(0,s.Z)(function*(){const n={...ut,...t.config};if(t.passphrase)throw Error("Subkey could not be encrypted here, please encrypt whole key");if(t.rsaBits<n.minRSABits)throw Error(`rsaBits should be at least ${n.minRSABits}, got: ${t.rsaBits}`);const a=e.keyPacket;if(a.isDummy())throw Error("Cannot add subkey to gnu-dummy primary key");if(!a.isDecrypted())throw Error("Key is not decrypted");const o=a.getAlgorithmInfo();o.type=o.curve?"ecc":"rsa",o.rsaBits=o.bits||4096,o.curve=o.curve||"curve25519",t=C0(t,o);const u=yield Ic(t);Ui(u,n);const f=yield Pc(u,a,t,n),w=e.toPacketList();return w.push(u,f),new Ri(w)})()}}const Ja=z.constructAllowedPackets([bn,ua,Qa,l0,$a,c0,Qr]);function Mc(r,t,e,n){return S0.apply(this,arguments)}function S0(){return S0=(0,s.Z)(function*(r,t,e,n){e.passphrase&&(yield r.encrypt(e.passphrase,n)),yield Promise.all(t.map(function(){var u=(0,s.Z)(function*(f,w){const g=e.subkeys[w].passphrase;g&&(yield f.encrypt(g,n))});return function(f,w){return u.apply(this,arguments)}}()));const a=new fr;a.push(r),yield Promise.all(e.userIDs.map(function(){var u=(0,s.Z)(function*(f,w){function g(j,se){return[se,...j.filter(pe=>pe!==se)]}const b=$a.fromObject(f),L={};L.userID=b,L.key=r;const $=new Qr;return $.signatureType=Z.signature.certGeneric,$.publicKeyAlgorithm=r.algorithm,$.hashAlgorithm=yield Ya(null,r,void 0,void 0,n),$.keyFlags=[Z.keyFlags.certifyKeys|Z.keyFlags.signData],$.preferredSymmetricAlgorithms=g([Z.symmetric.aes256,Z.symmetric.aes128,Z.symmetric.aes192],n.preferredSymmetricAlgorithm),n.aeadProtect&&($.preferredAEADAlgorithms=g([Z.aead.eax,Z.aead.ocb],n.preferredAEADAlgorithm)),$.preferredHashAlgorithms=g([Z.hash.sha256,Z.hash.sha512],n.preferredHashAlgorithm),$.preferredCompressionAlgorithms=g([Z.compression.zlib,Z.compression.zip,Z.compression.uncompressed],n.preferredCompressionAlgorithm),0===w&&($.isPrimaryUserID=!0),$.features=[0],$.features[0]|=Z.features.modificationDetection,n.aeadProtect&&($.features[0]|=Z.features.aead),n.v5Keys&&($.features[0]|=Z.features.v5Keys),e.keyExpirationTime>0&&($.keyExpirationTime=e.keyExpirationTime,$.keyNeverExpires=!1),yield $.sign(r,L,e.date),{userIDPacket:b,signaturePacket:$}});return function(f,w){return u.apply(this,arguments)}}())).then(u=>{u.forEach(({userIDPacket:f,signaturePacket:w})=>{a.push(f),a.push(w)})}),yield Promise.all(t.map(function(){var u=(0,s.Z)(function*(f,w){const g=e.subkeys[w];return{secretSubkeyPacket:f,subkeySignaturePacket:yield Pc(f,r,g,n)}});return function(f,w){return u.apply(this,arguments)}}())).then(u=>{u.forEach(({secretSubkeyPacket:f,subkeySignaturePacket:w})=>{a.push(f),a.push(w)})});const o={key:r};return a.push(yield Ii(o,null,r,{signatureType:Z.signature.keyRevocation,reasonForRevocationFlag:Z.reasonForRevocation.noReason,reasonForRevocationString:""},e.date,void 0,void 0,n)),e.passphrase&&r.clearPrivateParams(),yield Promise.all(t.map(function(){var u=(0,s.Z)(function*(f,w){e.subkeys[w].passphrase&&f.clearPrivateParams()});return function(f,w){return u.apply(this,arguments)}}())),new Ri(a)}),S0.apply(this,arguments)}function B1(r){return _0.apply(this,arguments)}function _0(){return _0=(0,s.Z)(function*({armoredKey:r,binaryKey:t,config:e,...n}){if(e={...ut,...e},!r&&!t)throw Error("readKey: must pass options object containing `armoredKey` or `binaryKey`");if(r&&!z.isString(r))throw Error("readKey: options.armoredKey must be a string");if(t&&!z.isUint8Array(t))throw Error("readKey: options.binaryKey must be a Uint8Array");const a=Object.keys(n);if(a.length>0)throw Error("Unknown option: "+a.join(", "));let o;if(r){const{type:u,data:f}=yield Tt(r,e);if(u!==Z.armor.publicKey&&u!==Z.armor.privateKey)throw Error("Armored text not of type key");o=f}else o=t;return Oc(yield fr.fromBinary(o,Ja,e))}),_0.apply(this,arguments)}function I1(r){return k0.apply(this,arguments)}function k0(){return k0=(0,s.Z)(function*({armoredKey:r,binaryKey:t,config:e,...n}){if(e={...ut,...e},!r&&!t)throw Error("readPrivateKey: must pass options object containing `armoredKey` or `binaryKey`");if(r&&!z.isString(r))throw Error("readPrivateKey: options.armoredKey must be a string");if(t&&!z.isUint8Array(t))throw Error("readPrivateKey: options.binaryKey must be a Uint8Array");const a=Object.keys(n);if(a.length>0)throw Error("Unknown option: "+a.join(", "));let o;if(r){const{type:f,data:w}=yield Tt(r,e);if(f!==Z.armor.privateKey)throw Error("Armored text not of type private key");o=w}else o=t;const u=yield fr.fromBinary(o,Ja,e);return new Ri(u)}),k0.apply(this,arguments)}const P1=z.constructAllowedPackets([ii,oa,Wa,Tc,class A1{static get tag(){return Z.packet.symmetricallyEncryptedData}constructor(){this.encrypted=null,this.packets=null}read(t){this.encrypted=t}write(){return this.encrypted}decrypt(t,e,n=ut){var a=this;return(0,s.Z)(function*(){if(!n.allowUnauthenticatedMessages)throw Error("Message is not authenticated.");const{blockSize:o}=Mt.getCipher(t),u=yield Le(Ht(a.encrypted)),f=yield Mt.mode.cfb.decrypt(t,e,u.subarray(o+2),u.subarray(2,o+2));a.packets=yield fr.fromBinary(f,C1,n)})()}encrypt(t,e,n=ut){var a=this;return(0,s.Z)(function*(){const o=a.packets.write(),{blockSize:u}=Mt.getCipher(t),f=yield Mt.getPrefixRandom(t),w=yield Mt.mode.cfb.encrypt(t,e,f,new Uint8Array(u),n),g=yield Mt.mode.cfb.encrypt(t,e,o,w.subarray(2),n);a.encrypted=z.concat([w,g])})()}},o0,Bi,xn,Qr]),U1=z.constructAllowedPackets([Bi]),D1=z.constructAllowedPackets([Qr]);class on{constructor(t){this.packets=t||new fr}getEncryptionKeyIDs(){const t=[];return this.packets.filterByTag(Z.packet.publicKeyEncryptedSessionKey).forEach(function(e){t.push(e.publicKeyID)}),t}getSigningKeyIDs(){const t=this.unwrapCompressed(),e=t.packets.filterByTag(Z.packet.onePassSignature);return e.length>0?e.map(n=>n.issuerKeyID):t.packets.filterByTag(Z.packet.signature).map(n=>n.issuerKeyID)}decrypt(t,e,n,a=new Date,o=ut){var u=this;return(0,s.Z)(function*(){const f=n||(yield u.decryptSessionKeys(t,e,a,o)),w=u.packets.filterByTag(Z.packet.symmetricallyEncryptedData,Z.packet.symEncryptedIntegrityProtectedData,Z.packet.aeadEncryptedData);if(0===w.length)throw Error("No encrypted data found");const g=w[0];let b=null;const L=Promise.all(f.map(function(){var j=(0,s.Z)(function*({algorithm:se,data:pe}){if(!z.isUint8Array(pe)||!z.isString(se))throw Error("Invalid session key for decryption.");try{const xe=Z.write(Z.symmetric,se);yield g.decrypt(xe,pe,o)}catch(xe){z.printDebugError(xe),b=xe}});return function(se){return j.apply(this,arguments)}}()));if(K(g.encrypted),g.encrypted=null,yield L,!g.packets||!g.packets.length)throw b||Error("Decryption failed.");const $=new on(g.packets);return g.packets=new fr,$})()}decryptSessionKeys(t,e,n=new Date,a=ut){var o=this;return(0,s.Z)(function*(){let u,f=[];if(e){const w=o.packets.filterByTag(Z.packet.symEncryptedSessionKey);if(0===w.length)throw Error("No symmetrically encrypted session key packet found.");yield Promise.all(e.map(function(){var g=(0,s.Z)(function*(b,L){let $;$=L?yield fr.fromBinary(w.write(),U1,a):w,yield Promise.all($.map(function(){var j=(0,s.Z)(function*(se){try{yield se.decrypt(b),f.push(se)}catch(pe){z.printDebugError(pe)}});return function(se){return j.apply(this,arguments)}}()))});return function(b,L){return g.apply(this,arguments)}}()))}else{if(!t)throw Error("No key or password specified.");{const w=o.packets.filterByTag(Z.packet.publicKeyEncryptedSessionKey);if(0===w.length)throw Error("No public key encrypted session key packet found.");yield Promise.all(w.map(function(){var g=(0,s.Z)(function*(b){yield Promise.all(t.map(function(){var L=(0,s.Z)(function*($){let j=[Z.symmetric.aes256,Z.symmetric.aes128,Z.symmetric.tripledes,Z.symmetric.cast5];try{const pe=yield $.getPrimaryUser(n,void 0,a);pe.selfCertification.preferredSymmetricAlgorithms&&(j=j.concat(pe.selfCertification.preferredSymmetricAlgorithms))}catch{}const se=(yield $.getDecryptionKeys(b.publicKeyID,null,void 0,a)).map(pe=>pe.keyPacket);yield Promise.all(se.map(function(){var pe=(0,s.Z)(function*(xe){if(xe&&!xe.isDummy()){if(!xe.isDecrypted())throw Error("Decryption key is not decrypted.");if(!a.constantTimePKCS1Decryption||b.publicKeyAlgorithm!==Z.publicKey.rsaEncrypt&&b.publicKeyAlgorithm!==Z.publicKey.rsaEncryptSign&&b.publicKeyAlgorithm!==Z.publicKey.rsaSign&&b.publicKeyAlgorithm!==Z.publicKey.elgamal)try{if(yield b.decrypt(xe),!j.includes(Z.write(Z.symmetric,b.sessionKeyAlgorithm)))throw Error("A non-preferred symmetric algorithm was used.");f.push(b)}catch(Ke){z.printDebugError(Ke),u=Ke}else{const Ke=b.write();yield Promise.all(Array.from(a.constantTimePKCS1DecryptionSupportedSymmetricAlgorithms).map(function(){var Qe=(0,s.Z)(function*(Be){const le=new o0;le.read(Ke);const Xe={sessionKeyAlgorithm:Be,sessionKey:yield Mt.generateSessionKey(Be)};try{yield le.decrypt(xe,Xe),f.push(le)}catch(He){z.printDebugError(He),u=He}});return function(Be){return Qe.apply(this,arguments)}}()))}}});return function(xe){return pe.apply(this,arguments)}}()))});return function($){return L.apply(this,arguments)}}())),K(b.encrypted),b.encrypted=null});return function(b){return g.apply(this,arguments)}}()))}}if(f.length>0){if(f.length>1){const w=new Set;f=f.filter(g=>{const b=g.sessionKeyAlgorithm+z.uint8ArrayToString(g.sessionKey);return!w.has(b)&&(w.add(b),!0)})}return f.map(w=>({data:w.sessionKey,algorithm:Z.read(Z.symmetric,w.sessionKeyAlgorithm)}))}throw u||Error("Session key decryption failed.")})()}getLiteralData(){const t=this.unwrapCompressed().packets.findPacket(Z.packet.literalData);return t&&t.getBytes()||null}getFilename(){const t=this.unwrapCompressed().packets.findPacket(Z.packet.literalData);return t&&t.getFilename()||null}getText(){const t=this.unwrapCompressed().packets.findPacket(Z.packet.literalData);return t?t.getText():null}static generateSessionKey(t=[],e=new Date,n=[],a=ut){return(0,s.Z)(function*(){const o=yield m0("symmetric",t,e,n,a),u=Z.read(Z.symmetric,o),f=a.aeadProtect&&(yield(w=(0,s.Z)(function*(g,b=new Date,L=[],$=ut){let j=!0;return yield Promise.all(g.map(function(){var se=(0,s.Z)(function*(pe,xe){const Ke=yield pe.getPrimaryUser(b,L[xe],$);Ke.selfCertification.features&&Ke.selfCertification.features[0]&Z.features.aead||(j=!1)});return function(pe,xe){return se.apply(this,arguments)}}())),j}),function(g){return w.apply(this,arguments)})(t,e,n,a))?Z.read(Z.aead,yield m0("aead",t,e,n,a)):void 0;var w;return{data:yield Mt.generateSessionKey(o),algorithm:u,aeadAlgorithm:f}})()}encrypt(t,e,n,a=!1,o=[],u=new Date,f=[],w=ut){var g=this;return(0,s.Z)(function*(){if(n){if(!z.isUint8Array(n.data)||!z.isString(n.algorithm))throw Error("Invalid session key for encryption.")}else if(t&&t.length)n=yield on.generateSessionKey(t,u,f,w);else{if(!e||!e.length)throw Error("No keys, passwords, or session key provided.");n=yield on.generateSessionKey(void 0,void 0,void 0,w)}const{data:b,algorithm:L,aeadAlgorithm:$}=n,j=yield on.encryptSessionKey(b,L,$,t,e,a,o,u,f,w);let se;$?(se=new Wa,se.aeadAlgorithm=Z.write(Z.aead,$)):se=new Tc,se.packets=g.packets;const pe=Z.write(Z.symmetric,L);return yield se.encrypt(pe,b,w),j.packets.push(se),se.packets=new fr,j})()}static encryptSessionKey(t,e,n,a,o,u=!1,f=[],w=new Date,g=[],b=ut){return(0,s.Z)(function*(){const L=new fr,$=Z.write(Z.symmetric,e),j=n&&Z.write(Z.aead,n);if(a){const se=yield Promise.all(a.map(function(){var pe=(0,s.Z)(function*(xe,Ke){const Qe=yield xe.getEncryptionKey(f[Ke],w,g,b),Be=new o0;return Be.publicKeyID=u?qt.wildcard():Qe.getKeyID(),Be.publicKeyAlgorithm=Qe.keyPacket.algorithm,Be.sessionKey=t,Be.sessionKeyAlgorithm=$,yield Be.encrypt(Qe.keyPacket),delete Be.sessionKey,Be});return function(xe,Ke){return pe.apply(this,arguments)}}()));L.push(...se)}if(o){const se=function(){var Qe=(0,s.Z)(function*(Be,le){try{return yield Be.decrypt(le),1}catch{return 0}});return function(le,Xe){return Qe.apply(this,arguments)}}(),pe=(Qe,Be)=>Qe+Be,xe=function(){var Qe=(0,s.Z)(function*(Be,le,Xe,He){const $e=new Bi(b);return $e.sessionKey=Be,$e.sessionKeyAlgorithm=le,Xe&&($e.aeadAlgorithm=Xe),yield $e.encrypt(He,b),b.passwordCollisionCheck&&1!==(yield Promise.all(o.map(rt=>se($e,rt)))).reduce(pe)?xe(Be,le,He):(delete $e.sessionKey,$e)});return function(le,Xe,He,$e){return Qe.apply(this,arguments)}}(),Ke=yield Promise.all(o.map(Qe=>xe(t,$,j,Qe)));L.push(...Ke)}return new on(L)})()}sign(t=[],e=null,n=[],a=new Date,o=[],u=ut){var f=this;return(0,s.Z)(function*(){const w=new fr,g=f.packets.findPacket(Z.packet.literalData);if(!g)throw Error("No literal data packet to sign.");let b,L;const $=null===g.text?Z.signature.binary:Z.signature.text;if(e)for(L=e.packets.filterByTag(Z.packet.signature),b=L.length-1;b>=0;b--){const j=L[b],se=new xn;se.signatureType=j.signatureType,se.hashAlgorithm=j.hashAlgorithm,se.publicKeyAlgorithm=j.publicKeyAlgorithm,se.issuerKeyID=j.issuerKeyID,t.length||0!==b||(se.flags=1),w.push(se)}return yield Promise.all(Array.from(t).reverse().map(function(){var j=(0,s.Z)(function*(se,pe){if(!se.isPrivate())throw Error("Need private key for signing");const xe=n[t.length-1-pe],Ke=yield se.getSigningKey(xe,a,o,u),Qe=new xn;return Qe.signatureType=$,Qe.hashAlgorithm=yield Ya(se,Ke.keyPacket,a,o,u),Qe.publicKeyAlgorithm=Ke.keyPacket.algorithm,Qe.issuerKeyID=Ke.getKeyID(),pe===t.length-1&&(Qe.flags=1),Qe});return function(se,pe){return j.apply(this,arguments)}}())).then(j=>{j.forEach(se=>w.push(se))}),w.push(g),w.push(...yield I0(g,t,e,n,a,o,!1,u)),new on(w)})()}compress(t,e=ut){if(t===Z.compression.uncompressed)return this;const n=new oa(e);n.algorithm=t,n.packets=this.packets;const a=new fr;return a.push(n),new on(a)}signDetached(t=[],e=null,n=[],a=new Date,o=[],u=ut){var f=this;return(0,s.Z)(function*(){const w=f.packets.findPacket(Z.packet.literalData);if(!w)throw Error("No literal data packet to sign.");return new pi(yield I0(w,t,e,n,a,o,!0,u))})()}verify(t,e=new Date,n=ut){var a=this;return(0,s.Z)(function*(){const o=a.unwrapCompressed(),u=o.packets.filterByTag(Z.packet.literalData);if(1!==u.length)throw Error("Can only verify message with one literal data packet.");y(o.packets.stream)&&o.packets.push(...yield Le(o.packets.stream,g=>g||[]));const f=o.packets.filterByTag(Z.packet.onePassSignature).reverse(),w=o.packets.filterByTag(Z.packet.signature);return f.length&&!w.length&&z.isStream(o.packets.stream)&&!y(o.packets.stream)?(yield Promise.all(f.map(function(){var g=(0,s.Z)(function*(b){b.correspondingSig=new Promise((L,$)=>{b.correspondingSigResolve=L,b.correspondingSigReject=$}),b.signatureData=ee((0,s.Z)(function*(){return(yield b.correspondingSig).signatureData})),b.hashed=Le(yield b.hash(b.signatureType,u[0],void 0,!1)),b.hashed.catch(()=>{})});return function(b){return g.apply(this,arguments)}}())),o.packets.stream=Ct(o.packets.stream,function(){var g=(0,s.Z)(function*(b,L){const $=Ae(b),j=Re(L);try{for(let se=0;se<f.length;se++){const{value:pe}=yield $.read();f[se].correspondingSigResolve(pe)}yield $.readToEnd(),yield j.ready,yield j.close()}catch(se){f.forEach(pe=>{pe.correspondingSigReject(se)}),yield j.abort(se)}});return function(b,L){return g.apply(this,arguments)}}()),es(f,u,t,e,!1,n)):es(w,u,t,e,!1,n)})()}verifyDetached(t,e,n=new Date,a=ut){const o=this.unwrapCompressed().packets.filterByTag(Z.packet.literalData);if(1!==o.length)throw Error("Can only verify message with one literal data packet.");return es(t.packets,o,e,n,!0,a)}unwrapCompressed(){const t=this.packets.filterByTag(Z.packet.compressedData);return t.length?new on(t[0].packets):this}appendSignature(t,e=ut){var n=this;return(0,s.Z)(function*(){yield n.packets.read(z.isUint8Array(t)?t:(yield Tt(t)).data,D1,e)})()}write(){return this.packets.write()}armor(t=ut){return $t(Z.armor.message,this.write(),null,null,null,t)}}function I0(r,t){return P0.apply(this,arguments)}function P0(){return P0=(0,s.Z)(function*(r,t,e=null,n=[],a=new Date,o=[],u=!1,f=ut){const w=new fr,g=null===r.text?Z.signature.binary:Z.signature.text;if(yield Promise.all(t.map(function(){var b=(0,s.Z)(function*(L,$){const j=o[$];if(!L.isPrivate())throw Error("Need private key for signing");const se=yield L.getSigningKey(n[$],a,j,f);return Ii(r,L,se.keyPacket,{signatureType:g},a,j,u,f)});return function(L,$){return b.apply(this,arguments)}}())).then(b=>{w.push(...b)}),e){const b=e.packets.filterByTag(Z.packet.signature);w.push(...b)}return w}),P0.apply(this,arguments)}function es(r,t,e){return U0.apply(this,arguments)}function U0(){return U0=(0,s.Z)(function*(r,t,e,n=new Date,a=!1,o=ut){return Promise.all(r.filter(function(u){return["text","binary"].includes(Z.read(Z.signature,u.signatureType))}).map(function(){var u=(0,s.Z)(function*(f){return(w=(0,s.Z)(function*(g,b,L,$=new Date,j=!1,se=ut){let pe,xe;for(const Be of L){const le=Be.getKeys(g.issuerKeyID);if(le.length>0){pe=Be,xe=le[0];break}}const Ke=g instanceof xn?g.correspondingSig:g,Qe={keyID:g.issuerKeyID,verified:(0,s.Z)(function*(){if(!xe)throw Error("Could not find signing key with key ID "+g.issuerKeyID.toHex());yield g.verify(xe.keyPacket,g.signatureType,b[0],$,j,se);const Be=yield Ke;if(xe.getCreationTime()>Be.created)throw Error("Key is newer than the signature");try{yield pe.getSigningKey(xe.getKeyID(),Be.created,void 0,se)}catch(le){if(!se.allowInsecureVerificationWithReformattedKeys||!le.message.match(/Signature creation time is in the future/))throw le;yield pe.getSigningKey(xe.getKeyID(),$,void 0,se)}return!0})(),signature:(0,s.Z)(function*(){const Be=yield Ke,le=new fr;return Be&&le.push(Be),new pi(le)})()};return Qe.signature.catch(()=>{}),Qe.verified.catch(()=>{}),Qe}),function(g,b,L){return w.apply(this,arguments)})(f,t,e,n,a,o);var w});return function(f){return u.apply(this,arguments)}}()))}),U0.apply(this,arguments)}function R1(r){return D0.apply(this,arguments)}function D0(){return D0=(0,s.Z)(function*({armoredMessage:r,binaryMessage:t,config:e,...n}){e={...ut,...e};let a=r||t;if(!a)throw Error("readMessage: must pass options object containing `armoredMessage` or `binaryMessage`");if(r&&!z.isString(r)&&!z.isStream(r))throw Error("readMessage: options.armoredMessage must be a string or stream");if(t&&!z.isUint8Array(t)&&!z.isStream(t))throw Error("readMessage: options.binaryMessage must be a Uint8Array or stream");const o=Object.keys(n);if(o.length>0)throw Error("Unknown option: "+o.join(", "));const u=z.isStream(a);if(u&&(yield l(),a=W(a)),r){const{type:g,data:b}=yield Tt(a,e);if(g!==Z.armor.message)throw Error("Armored text not of type message");a=b}const f=yield fr.fromBinary(a,P1,e),w=new on(f);return w.fromStream=u,w}),D0.apply(this,arguments)}function N1(r){return R0.apply(this,arguments)}function R0(){return R0=(0,s.Z)(function*({text:r,binary:t,filename:e,date:n=new Date,format:a=(void 0!==r?"utf8":"binary"),...o}){let u=void 0!==r?r:t;if(void 0===u)throw Error("createMessage: must pass options object containing `text` or `binary`");if(r&&!z.isString(r)&&!z.isStream(r))throw Error("createMessage: options.text must be a string or stream");if(t&&!z.isUint8Array(t)&&!z.isStream(t))throw Error("createMessage: options.binary must be a Uint8Array or stream");const f=Object.keys(o);if(f.length>0)throw Error("Unknown option: "+f.join(", "));const w=z.isStream(u);w&&(yield l(),u=W(u));const g=new ii(n);void 0!==r?g.setText(u,Z.write(Z.literal,a)):g.setBytes(u,Z.write(Z.literal,a)),void 0!==e&&g.setFilename(e);const b=new fr;b.push(g);const L=new on(b);return L.fromStream=w,L}),R0.apply(this,arguments)}function K1(r){return K0.apply(this,arguments)}function K0(){return K0=(0,s.Z)(function*({userIDs:r=[],passphrase:t,type:e="ecc",rsaBits:n=4096,curve:a="curve25519",keyExpirationTime:o=0,date:u=new Date,subkeys:f=[{}],format:w="armored",config:g,...b}){gn(g={...ut,...g}),r=Kr(r);const L=Object.keys(b);if(L.length>0)throw Error("Unknown option: "+L.join(", "));if(0===r.length)throw Error("UserIDs are required for key generation");if("rsa"===e&&n<g.minRSABits)throw Error(`rsaBits should be at least ${g.minRSABits}, got: ${n}`);const $={userIDs:r,passphrase:t,type:e,rsaBits:n,curve:a,keyExpirationTime:o,date:u,subkeys:f};try{const{key:j,revocationCertificate:se}=yield(pe=(0,s.Z)(function*(xe,Ke){xe.sign=!0,(xe=C0(xe)).subkeys=xe.subkeys.map((He,$e)=>C0(xe.subkeys[$e],xe));let Qe=[k1(xe,Ke)];Qe=Qe.concat(xe.subkeys.map(He=>Ic(He,Ke)));const Be=yield Promise.all(Qe),le=yield Mc(Be[0],Be.slice(1),xe,Ke),Xe=yield le.getRevocationCertificate(xe.date,Ke);return le.revocationSignatures=[],{key:le,revocationCertificate:Xe}}),function(xe,Ke){return pe.apply(this,arguments)})($,g);return j.getKeys().forEach(({keyPacket:pe})=>Ui(pe,g)),{privateKey:ai(j,w,g),publicKey:ai(j.toPublic(),w,g),revocationCertificate:se}}catch(j){throw z.wrapError("Error generating keypair",j)}var pe}),K0.apply(this,arguments)}function O1(r){return F0.apply(this,arguments)}function F0(){return F0=(0,s.Z)(function*({privateKey:r,passphrase:t,config:e,...n}){gn(e={...ut,...e});const a=Object.keys(n);if(a.length>0)throw Error("Unknown option: "+a.join(", "));if(!r.isPrivate())throw Error("Cannot decrypt a public key");const o=r.clone(!0),u=z.isArray(t)?t:[t];try{return yield Promise.all(o.getKeys().map(f=>z.anyPromise(u.map(w=>f.keyPacket.decrypt(w))))),yield o.validate(e),o}catch(f){throw o.clearPrivateParams(),z.wrapError("Error decrypting private key",f)}}),F0.apply(this,arguments)}function M1(r){return V0.apply(this,arguments)}function V0(){return V0=(0,s.Z)(function*({message:r,encryptionKeys:t,signingKeys:e,passwords:n,sessionKey:a,format:o="armored",signature:u=null,wildcard:f=!1,signingKeyIDs:w=[],encryptionKeyIDs:g=[],date:b=new Date,signingUserIDs:L=[],encryptionUserIDs:$=[],config:j,...se}){if(gn(j={...ut,...j}),$0(r),Y0(o),t=Kr(t),e=Kr(e),n=Kr(n),w=Kr(w),g=Kr(g),L=Kr(L),$=Kr($),se.detached)throw Error("The `detached` option has been removed from openpgp.encrypt, separately call openpgp.sign instead. Don't forget to remove the `privateKeys` option as well.");if(se.publicKeys)throw Error("The `publicKeys` option has been removed from openpgp.encrypt, pass `encryptionKeys` instead");if(se.privateKeys)throw Error("The `privateKeys` option has been removed from openpgp.encrypt, pass `signingKeys` instead");if(void 0!==se.armor)throw Error("The `armor` option has been removed from openpgp.encrypt, pass `format` instead.");const pe=Object.keys(se);if(pe.length>0)throw Error("Unknown option: "+pe.join(", "));e||(e=[]);const xe=r.fromStream;try{if((e.length||u)&&(r=yield r.sign(e,u,w,b,L,j)),r=r.compress(yield m0("compression",t,b,$,j),j),r=yield r.encrypt(t,n,a,f,g,b,$,j),"object"===o)return r;const Ke="armored"===o;return ts(Ke?r.armor(j):r.write(),xe,Ke?"utf8":"binary")}catch(Ke){throw z.wrapError("Error encrypting message",Ke)}}),V0.apply(this,arguments)}function F1(r){return z0.apply(this,arguments)}function z0(){return z0=(0,s.Z)(function*({message:r,decryptionKeys:t,passwords:e,sessionKeys:n,verificationKeys:a,expectSigned:o=!1,format:u="utf8",signature:f=null,date:w=new Date,config:g,...b}){if(gn(g={...ut,...g}),$0(r),a=Kr(a),t=Kr(t),e=Kr(e),n=Kr(n),b.privateKeys)throw Error("The `privateKeys` option has been removed from openpgp.decrypt, pass `decryptionKeys` instead");if(b.publicKeys)throw Error("The `publicKeys` option has been removed from openpgp.decrypt, pass `verificationKeys` instead");const L=Object.keys(b);if(L.length>0)throw Error("Unknown option: "+L.join(", "));try{const $=yield r.decrypt(t,e,n,w,g);a||(a=[]);const j={};if(j.signatures=f?yield $.verifyDetached(f,a,w,g):yield $.verify(a,w,g),j.data="binary"===u?$.getLiteralData():$.getText(),j.filename=$.getFilename(),Hc(j,r),o){if(0===a.length)throw Error("Verification keys are required to verify message signatures");if(0===j.signatures.length)throw Error("Message is not signed");j.data=de([j.data,ee((0,s.Z)(function*(){yield z.anyPromise(j.signatures.map(se=>se.verified))}))])}return j.data=yield ts(j.data,r.fromStream,u),j}catch($){throw z.wrapError("Error decrypting message",$)}}),z0.apply(this,arguments)}function $0(r){if(!(r instanceof on))throw Error("Parameter [message] needs to be of type Message")}function Y0(r){if("armored"!==r&&"binary"!==r&&"object"!==r)throw Error("Unsupported format "+r)}const H1=Object.keys(ut).length;function gn(r){const t=Object.keys(r);if(t.length!==H1)for(const e of t)if(void 0===ut[e])throw Error("Unknown config property: "+e)}function Kr(r){return r&&!z.isArray(r)&&(r=[r]),r}function ts(r,t){return X0.apply(this,arguments)}function X0(){return X0=(0,s.Z)(function*(r,t,e="utf8"){const n=z.isStream(r);return"array"===n?Le(r):"node"===t?(r=p(r),"binary"!==e&&r.setEncoding(e),r):"web"===t&&"ponyfill"===n?G(r):r}),X0.apply(this,arguments)}function Hc(r,t){r.data=Ct(t.packets.stream,function(){var e=(0,s.Z)(function*(n,a){yield Fe(r.data,a,{preventClose:!0});const o=Re(a);try{yield Le(n,u=>u),yield o.close()}catch(u){yield o.abort(u)}});return function(n,a){return e.apply(this,arguments)}}())}function ai(r,t,e){switch(t){case"object":return r;case"armored":return r.armor(e);case"binary":return r.write();default:throw Error("Unsupported format "+t)}}}}]);